[2025-05-12T04:44:41.213Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-12T04:44:41.214Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:44:41.549Z] [MainLoader] Starting application loading process...
[2025-05-12T04:44:41.549Z] [DatabaseLoader] Attempting database connection...
[2025-05-12T04:44:41.550Z] [Database] Attempting MongoDB connection...
[2025-05-12T04:44:42.497Z] [Database] MongoDB Connected Successfully.
[2025-05-12T04:44:42.497Z] [DatabaseLoader] Database connection successful.
[2025-05-12T04:44:42.498Z] [MainLoader] Database loaded.
[2025-05-12T04:44:42.498Z] [MainLoader] Services will be managed by DI container.
[2025-05-12T04:44:42.499Z] [ExpressLoader] Configuring Express app...
[2025-05-12T04:44:42.505Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-12T04:44:42.508Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-12T04:44:42.509Z] [ExpressLoader] Registered Not Found handler.
[2025-05-12T04:44:42.509Z] [ExpressLoader] Registered Global Error handler.
[2025-05-12T04:44:42.510Z] [ExpressLoader] Express app configured successfully.
[2025-05-12T04:44:42.511Z] [MainLoader] Express loaded.
[2025-05-12T04:44:42.511Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-12T04:44:42.515Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-12T04:44:42.516Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-12T04:44:42.516Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-12T04:44:42.516Z] [MainLoader] Socket.IO loaded.
[2025-05-12T04:44:42.517Z] [JobsLoader] Scheduling background jobs...
[2025-05-12T04:44:42.552Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-12T04:44:42.552Z] [MainLoader] Jobs scheduled.
[2025-05-12T04:44:42.552Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-12T04:44:42.603Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-12T04:44:42.603Z] [MainLoader] All basic loaders completed successfully.
[2025-05-12T04:44:43.805Z] [socketAuth][6oLQmlM2bjPV-BeZAAAB] Authentication attempt. Has token: true
[2025-05-12T04:44:43.811Z] [socketAuth][6oLQmlM2bjPV-BeZAAAB] Token signature validated successfully.
[2025-05-12T04:44:43.814Z] [HistoryService] Initialized.
[2025-05-12T04:44:43.814Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] New connection. Socket ID: 6oLQmlM2bjPV-BeZAAAB. Initial socket.data.userId: null
[2025-05-12T04:44:43.814Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] Client connected, processing authentication. Has token: true
[2025-05-12T04:44:43.815Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] Attempting to fetch user info using token...
[2025-05-12T04:44:43.815Z] [API Client] Attempting to fetch user info.
[2025-05-12T04:44:43.816Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-12T04:44:44.489Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-12T04:44:44.490Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-12T04:44:44.490Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-12T04:44:44.492Z] [HistoryService] Initialized.
[2025-05-12T04:44:44.492Z] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-12T04:44:44.493Z] [INFO] Core event handlers successfully registered.
[2025-05-12T04:44:44.493Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:44.493Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-12T04:44:44.495Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-12T04:44:44.496Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:44:44.527Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-12T04:44:44.804Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:44:44.805Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-12T04:44:44.806Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:44.806Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-12T04:44:47.454Z] [socketAuth][y1jq9hSlXclbMUi4AAAD] Authentication attempt. Has token: true
[2025-05-12T04:44:47.456Z] [socketAuth][y1jq9hSlXclbMUi4AAAD] Token signature validated successfully.
[2025-05-12T04:44:47.457Z] [HistoryService] Initialized.
[2025-05-12T04:44:47.457Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] New connection. Socket ID: y1jq9hSlXclbMUi4AAAD. Initial socket.data.userId: null
[2025-05-12T04:44:47.458Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] Client connected, processing authentication. Has token: true
[2025-05-12T04:44:47.458Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] Attempting to fetch user info using token...
[2025-05-12T04:44:47.459Z] [API Client] Attempting to fetch user info.
[2025-05-12T04:44:47.459Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-12T04:44:47.668Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-12T04:44:47.668Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-12T04:44:47.668Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-12T04:44:47.668Z] [HistoryService] Initialized.
[2025-05-12T04:44:47.669Z] [coreHandlers][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-12T04:44:47.669Z] [INFO] Core event handlers successfully registered.
[2025-05-12T04:44:47.669Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:47.669Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-12T04:44:47.670Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-12T04:44:47.670Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:44:47.674Z] [SERVER SOCKET y1jq9hSlXclbMUi4AAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-12T04:44:47.962Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:44:47.963Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-12T04:44:47.963Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:47.964Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-12T04:46:28.588Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tôi đang theo dõi các hội nghị nào","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-12T04:46:28.590Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589] Request received. UserInput: "tôi đang theo dõi các hội nghị...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-12T04:46:28.590Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-12T04:46:28.800Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-12T04:46:28.801Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-12T04:46:28.801Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:46:29.086Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:46:29.087Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: new conversation from send_message, Count: 20
[2025-05-12T04:46:29.159Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 0
[2025-05-12T04:46:29.160Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:46:29.161Z] --- [6oLQ-1747025188589 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "tôi đang theo dõi các hội nghị nào", Lang: en ---
[2025-05-12T04:46:29.162Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:46:29.163Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:29.164Z] --- [6oLQ-1747025188589 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:46:29.164Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:29.164Z] [6oLQ-1747025188589 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 1
[2025-05-12T04:46:29.166Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-12T04:46:29.166Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-12T04:46:29.166Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:46:29.167Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:46:29.167Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:46:29.167Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:46:29.167Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:46:29.167Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-12T04:46:29.168Z]   - No valid next turn added, sending only history.
[2025-05-12T04:46:30.239Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:46:30.239Z] [6oLQ-1747025188589 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:46:30.240Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:30.244Z] --- [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 27d74688-c79f-4ae3-9b0f-8c0063d326d5 ---
[2025-05-12T04:46:30.244Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:46:30.244Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:46:30.245Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:46:30.246Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:46:30.247Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:46:30.247Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:46:30.247Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:46:30.247Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:46:30.248Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:46:30.248Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:46:30.248Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:46:30.249Z]   - No valid next turn added, sending only history.
[2025-05-12T04:46:31.152Z] Model Finish Reason: STOP
[2025-05-12T04:46:31.152Z] Model requested function call: manageFollow
[2025-05-12T04:46:31.152Z] Arguments: {"action":"list","itemType":"conference"}
[2025-05-12T04:46:31.153Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:46:31.153Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243] ConferenceAgent requests function call: manageFollow
[2025-05-12T04:46:31.154Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Received request.
[2025-05-12T04:46:31.154Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:46:31.155Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:46:31.155Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Executing handler...
[2025-05-12T04:46:31.157Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB] Handler: ManageFollow, Args: {"action":"list","itemType":"conference"}, Auth: true
[2025-05-12T04:46:31.157Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:46:31.158Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:46:31.159Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication, Agent: ConferenceAgent
[2025-05-12T04:46:31.159Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication for ConferenceAgent
[2025-05-12T04:46:31.160Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: listing_followed_items, Agent: ConferenceAgent
[2025-05-12T04:46:31.160Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: listing_followed_items for ConferenceAgent
[2025-05-12T04:46:31.161Z] [FollowService] [GetFollowed conference] Fetching followed items: GET https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/followed
[2025-05-12T04:46:31.820Z] [FollowService] [GetFollowed conference] Success. Found 1 followed item(s).
[2025-05-12T04:46:31.821Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB] ManageFollow: Successfully listed 1 followed conference(s).
[2025-05-12T04:46:31.821Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: list_success, Agent: ConferenceAgent
[2025-05-12T04:46:31.822Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: list_success for ConferenceAgent
[2025-05-12T04:46:31.822Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Handler execution finished. Result indicates error: false
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:46:31.824Z] --- [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-12T04:46:31.825Z] [6oLQ-1747025188589 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-12T04:46:31.825Z] --- [6oLQ-1747025188589 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:46:31.827Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:31.827Z] [6oLQ-1747025188589 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 3
[2025-05-12T04:46:31.827Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-12T04:46:31.828Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-12T04:46:31.828Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:46:31.828Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:46:31.828Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:46:31.829Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:46:31.829Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:46:31.830Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-12T04:46:31.830Z]   - No valid next turn added, sending only history.
[2025-05-12T04:46:32.420Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:46:32.421Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:32.421Z] [6oLQ-1747025188589 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:46:32.422Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:32.422Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.518Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.585Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.679Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.694Z] [6oLQ-1747025188589 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 172
[2025-05-12T04:46:32.695Z] [6oLQ-1747025188589 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-12T04:46:32.696Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:46:32.696Z] --- [6oLQ-1747025188589 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:46:32.697Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-12T04:46:32.799Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:46:32.799Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:46:32.800Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:46:33.084Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:46:33.085Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:54:02.480Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Chi tiết về hội nghị trên mà tôi đã follow","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:54:02.480Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480] Request received. UserInput: "Chi tiết về hội nghị trên mà t...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:54:02.480Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:54:02.555Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 4
[2025-05-12T04:54:02.555Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:54:02.555Z] --- [6oLQ-1747025642480 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Chi tiết về hội nghị trên mà tôi đã follow", Lang: en ---
[2025-05-12T04:54:02.556Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:54:02.556Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:02.557Z] --- [6oLQ-1747025642480 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:54:02.557Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:02.557Z] [6oLQ-1747025642480 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 5
[2025-05-12T04:54:02.558Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-12T04:54:02.558Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-12T04:54:02.558Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:54:02.559Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:54:02.559Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:54:02.559Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:54:02.559Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:54:02.559Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-12T04:54:02.559Z]   - No valid next turn added, sending only history.
[2025-05-12T04:54:04.441Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:54:04.441Z] [6oLQ-1747025642480 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:54:04.442Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:04.442Z] --- [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 7449eb92-a44c-43f6-9f8d-f7fa26582494 ---
[2025-05-12T04:54:04.443Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:54:04.444Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:54:04.444Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:54:04.445Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:54:04.445Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:54:04.446Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:54:04.447Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:54:04.447Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:54:04.448Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:54:04.449Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:54:04.450Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:54:04.450Z]   - No valid next turn added, sending only history.
[2025-05-12T04:54:06.452Z] Model Finish Reason: STOP
[2025-05-12T04:54:06.452Z] Model requested function call: getConferences
[2025-05-12T04:54:06.452Z] Arguments: {"searchQuery":"mode=detail&acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:54:06.452Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:54:06.453Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442] ConferenceAgent requests function call: getConferences
[2025-05-12T04:54:06.453Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:54:06.454Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:54:06.455Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:54:06.455Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:54:06.456Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"mode=detail&acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:54:06.457Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:54:06.457Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:54:06.457Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:54:06.458Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:54:06.458Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:54:06.459Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:54:06.459Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?mode=detail&acronym=INLG&perPage=5&page=1}
[2025-05-12T04:54:07.157Z] [BackendService] [conference] API Success (200). Data length: 7490. Attempting parsing...
[2025-05-12T04:54:07.158Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","creatorId":null,"adminId":"077f9da9-5570-4b2e-80e3-35e875c8f8b2","createdAt":"2025-05-04T06:50:47.094Z","updated...
[2025-05-12T04:54:07.158Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:54:07.159Z] Transforming conference data with Markdown. Search query: mode=detail&acronym=INLG&perPage=5&page=1
[2025-05-12T04:54:07.164Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="mode=detail&acronym=INLG&perPage=5&page=1"
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:54:07.166Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:54:07.166Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:54:07.166Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:54:07.167Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:54:07.167Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:54:07.167Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:54:07.169Z] --- [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:54:07.169Z] [6oLQ-1747025642480 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:54:07.169Z] --- [6oLQ-1747025642480 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:54:07.170Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:07.171Z] [6oLQ-1747025642480 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 7
[2025-05-12T04:54:07.171Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-12T04:54:07.172Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-12T04:54:07.172Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:54:07.173Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:54:07.173Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:54:07.173Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:54:07.173Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:54:07.173Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-12T04:54:07.174Z]   - No valid next turn added, sending only history.
[2025-05-12T04:54:07.764Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:54:07.765Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:07.765Z] [6oLQ-1747025642480 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:54:07.765Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:07.766Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:07.825Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:07.931Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.142Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.298Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.562Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.767Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.024Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.301Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.581Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.866Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:10.143Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:10.425Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:10.690Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.002Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.261Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.555Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.823Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.094Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.404Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.659Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.911Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.177Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.454Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.697Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.983Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:14.244Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:14.479Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:14.776Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.044Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.311Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.590Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.684Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.697Z] [6oLQ-1747025642480 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 7127
[2025-05-12T04:54:15.698Z] [6oLQ-1747025642480 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-12T04:54:15.698Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:54:15.699Z] --- [6oLQ-1747025642480 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:54:15.699Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-12T04:54:15.790Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:54:15.790Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:54:15.790Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:54:16.083Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:54:16.084Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:58:31.111Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Hội nghị diễn ra khi nào","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:58:31.112Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112] Request received. UserInput: "Hội nghị diễn ra khi nào", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:58:31.112Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:58:31.256Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 8
[2025-05-12T04:58:31.256Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:58:31.256Z] --- [6oLQ-1747025911112 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Hội nghị diễn ra khi nào", Lang: en ---
[2025-05-12T04:58:31.257Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:58:31.257Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:31.258Z] --- [6oLQ-1747025911112 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:31.258Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:31.258Z] [6oLQ-1747025911112 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 9
[2025-05-12T04:58:31.259Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-12T04:58:31.259Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-12T04:58:31.259Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:31.259Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:31.260Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:31.260Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:31.260Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:31.260Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-12T04:58:31.261Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:33.281Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:58:33.281Z] [6oLQ-1747025911112 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:58:33.282Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:33.282Z] --- [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 74c446e0-5cd8-4bbd-be8d-1f73c97d1307 ---
[2025-05-12T04:58:33.282Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:58:33.282Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:58:33.283Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:58:33.283Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:58:33.283Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:58:33.284Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:33.284Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:33.284Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:33.284Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:58:33.284Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:33.285Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:58:33.285Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:34.240Z] Model Finish Reason: STOP
[2025-05-12T04:58:34.240Z] Model requested function call: getConferences
[2025-05-12T04:58:34.240Z] Arguments: {"searchQuery":"acronym=INLG&perPage=5&page=1&mode=detail"}
[2025-05-12T04:58:34.240Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:58:34.241Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282] ConferenceAgent requests function call: getConferences
[2025-05-12T04:58:34.241Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:58:34.241Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:58:34.242Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:58:34.243Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:58:34.243Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=INLG&perPage=5&page=1&mode=detail"}
[2025-05-12T04:58:34.243Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:34.245Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:58:34.245Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=5&page=1&mode=detail}
[2025-05-12T04:58:34.902Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:58:34.903Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:58:34.903Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:58:34.903Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=5&page=1&mode=detail
[2025-05-12T04:58:34.904Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:58:34.904Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=INLG&perPage=5&page=1&mode=detail"
[2025-05-12T04:58:34.904Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:34.904Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:34.905Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:58:34.905Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:34.905Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:58:34.907Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:58:34.907Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:58:34.908Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:58:34.909Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:58:34.909Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:58:34.910Z] --- [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:58:34.910Z] [6oLQ-1747025911112 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:58:34.910Z] --- [6oLQ-1747025911112 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:34.911Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:34.911Z] [6oLQ-1747025911112 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 11
[2025-05-12T04:58:34.911Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-12T04:58:34.911Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-12T04:58:34.912Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:58:34.912Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:34.912Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:34.912Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:34.913Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:34.913Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-12T04:58:34.913Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:35.637Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:58:35.638Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:35.638Z] [6oLQ-1747025911112 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:58:35.638Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:35.639Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:35.745Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:35.796Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:35.804Z] [6oLQ-1747025911112 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 114
[2025-05-12T04:58:35.805Z] [6oLQ-1747025911112 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-12T04:58:35.805Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:58:35.806Z] --- [6oLQ-1747025911112 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:58:35.806Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-12T04:58:35.897Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:58:35.897Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:58:35.898Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:58:36.187Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:58:36.188Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:58:49.014Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"cho tôi tới trang web","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:58:49.014Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014] Request received. UserInput: "cho tôi tới trang web", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:58:49.014Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:58:49.154Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 12
[2025-05-12T04:58:49.155Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:58:49.155Z] --- [6oLQ-1747025929014 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "cho tôi tới trang web", Lang: en ---
[2025-05-12T04:58:49.155Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:58:49.155Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:49.156Z] --- [6oLQ-1747025929014 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:49.157Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:49.157Z] [6oLQ-1747025929014 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 13
[2025-05-12T04:58:49.157Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-12T04:58:49.158Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-12T04:58:49.158Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:49.158Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:49.158Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:49.159Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:49.159Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:49.159Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-12T04:58:49.159Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:50.136Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:58:50.136Z] [6oLQ-1747025929014 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:58:50.137Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:50.137Z] --- [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 6afdc5b2-1924-42db-a7c7-d08018a15f09 ---
[2025-05-12T04:58:50.138Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:58:50.138Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:58:50.138Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:58:50.138Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:58:50.139Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:58:50.139Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:50.139Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:50.139Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:50.140Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:58:50.140Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:50.140Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:58:50.141Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:51.976Z] Model Finish Reason: STOP
[2025-05-12T04:58:51.976Z] Model requested function call: getConferences
[2025-05-12T04:58:51.976Z] Arguments: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137] ConferenceAgent requests function call: getConferences
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:58:51.978Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:58:51.978Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:58:51.978Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:51.980Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:51.980Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:58:51.980Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=5&page=1}
[2025-05-12T04:58:52.653Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:58:52.654Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:58:52.654Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:58:52.654Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=5&page=1
[2025-05-12T04:58:52.656Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:58:52.656Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=INLG&perPage=5&page=1"
[2025-05-12T04:58:52.657Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:52.657Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:52.658Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:58:52.658Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:52.658Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:52.659Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:58:52.659Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:52.659Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:58:52.661Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:58:52.662Z] --- [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:58:52.662Z] [6oLQ-1747025929014 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:58:52.663Z] --- [6oLQ-1747025929014 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:52.664Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:52.664Z] [6oLQ-1747025929014 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 15
[2025-05-12T04:58:52.665Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-12T04:58:52.665Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-12T04:58:52.666Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:58:52.666Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:52.667Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:52.667Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:52.668Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:52.669Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-12T04:58:52.669Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:53.617Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:58:53.618Z] [6oLQ-1747025929014 HostAgent Streaming T2 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:58:53.618Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:53.619Z] --- [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: NavigationAgent, Task: 33a496c8-7f2f-4b36-a135-829aced459f8 ---
[2025-05-12T04:58:53.619Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-12T04:58:53.619Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-12T04:58:53.620Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-12T04:58:53.620Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:58:53.620Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:58:53.620Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:53.621Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:53.621Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:53.621Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-12T04:58:53.621Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:53.621Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:58:53.621Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:54.255Z] Model Finish Reason: STOP
[2025-05-12T04:58:54.255Z] Model requested function call: navigation
[2025-05-12T04:58:54.256Z] Arguments: {"url":"https://2025.inlgmeeting.org/"}
[2025-05-12T04:58:54.256Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619] LLM result from NavigationAgent: Status requires_function_call
[2025-05-12T04:58:54.257Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619] NavigationAgent requests function call: navigation
[2025-05-12T04:58:54.257Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-12T04:58:54.257Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: NavigationAgent
[2025-05-12T04:58:54.258Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-12T04:58:54.258Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-12T04:58:54.259Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB] Handler: Navigation, Args: {"url":"https://2025.inlgmeeting.org/"}
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB] Navigation: Valid target URL: https://2025.inlgmeeting.org/
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-12T04:58:54.261Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-12T04:58:54.261Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-12T04:58:54.261Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: NavigationAgent
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-12T04:58:54.262Z] --- [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-12T04:58:54.263Z] --- [6oLQ-1747025929014 HostAgent Streaming Turn 3 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:54.263Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:54.263Z] [6oLQ-1747025929014 History T3 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 17
[2025-05-12T04:58:54.263Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-12T04:58:54.263Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-12T04:58:54.263Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:58:54.264Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:54.264Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:54.264Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:54.264Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:54.264Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-12T04:58:54.264Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:54.968Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:58:54.968Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:54.969Z] [6oLQ-1747025929014 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:58:54.969Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:54.969Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:55.062Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:55.092Z] [6oLQ-1747025929014 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 27
[2025-05-12T04:58:55.093Z] [6oLQ-1747025929014 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 23 thoughts.
[2025-05-12T04:58:55.094Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:58:55.094Z] --- [6oLQ-1747025929014 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:58:55.094Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 18
[2025-05-12T04:58:55.177Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:58:55.177Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:58:55.177Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:58:55.488Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:58:55.489Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:59:01.020Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"mở map","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:59:01.021Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021] Request received. UserInput: "mở map", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:59:01.021Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:59:01.164Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 18
[2025-05-12T04:59:01.165Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:59:01.165Z] --- [6oLQ-1747025941021 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "mở map", Lang: en ---
[2025-05-12T04:59:01.165Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:59:01.166Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:01.166Z] --- [6oLQ-1747025941021 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:01.166Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:01.167Z] [6oLQ-1747025941021 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 19
[2025-05-12T04:59:01.167Z] [GeminiService] Received history with 19 items before mapping (for stream).
[2025-05-12T04:59:01.167Z] [GeminiService] Mapped history (SDK Content[]) with 19 items (for stream).
[2025-05-12T04:59:01.167Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:01.168Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:01.168Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:01.168Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:01.168Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:01.168Z] [GeminiService Stream] Preparing stream request with 19 Content items.
[2025-05-12T04:59:01.168Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:03.167Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:59:03.168Z] [6oLQ-1747025941021 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:59:03.168Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:03.169Z] --- [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: a2d3f89f-9ac9-4308-8b3c-0e6238d59fa2 ---
[2025-05-12T04:59:03.169Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:59:03.169Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:59:03.169Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:59:03.170Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:59:03.170Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:59:03.170Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:03.170Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:03.170Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:03.170Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:59:03.171Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:03.171Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:59:03.171Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:05.007Z] Model Finish Reason: STOP
[2025-05-12T04:59:05.008Z] Model requested function call: getConferences
[2025-05-12T04:59:05.008Z] Arguments: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:59:05.008Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:59:05.008Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168] ConferenceAgent requests function call: getConferences
[2025-05-12T04:59:05.009Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:59:05.009Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:59:05.009Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:59:05.012Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=5&page=1}
[2025-05-12T04:59:05.695Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:59:05.696Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:59:05.696Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:59:05.696Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=5&page=1
[2025-05-12T04:59:05.698Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:59:05.698Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=INLG&perPage=5&page=1"
[2025-05-12T04:59:05.698Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:59:05.698Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:59:05.700Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:59:05.700Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:59:05.700Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:59:05.702Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:59:05.702Z] --- [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:59:05.702Z] [6oLQ-1747025941021 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:59:05.702Z] --- [6oLQ-1747025941021 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:05.703Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:05.703Z] [6oLQ-1747025941021 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 21
[2025-05-12T04:59:05.703Z] [GeminiService] Received history with 21 items before mapping (for stream).
[2025-05-12T04:59:05.703Z] [GeminiService] Mapped history (SDK Content[]) with 21 items (for stream).
[2025-05-12T04:59:05.704Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:59:05.704Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:05.704Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:05.704Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:05.704Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:05.704Z] [GeminiService Stream] Preparing stream request with 21 Content items.
[2025-05-12T04:59:05.705Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:06.612Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:59:06.612Z] [6oLQ-1747025941021 HostAgent Streaming T2 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:59:06.613Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:06.613Z] --- [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: NavigationAgent, Task: ce8d11d5-e126-46d2-8adc-87a0774619f3 ---
[2025-05-12T04:59:06.613Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-12T04:59:06.614Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-12T04:59:06.614Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-12T04:59:06.614Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:59:06.615Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:59:06.615Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:06.615Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:06.615Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:06.615Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-12T04:59:06.616Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:06.616Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:59:06.616Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:07.314Z] Model Finish Reason: STOP
[2025-05-12T04:59:07.315Z] Model requested function call: openGoogleMap
[2025-05-12T04:59:07.315Z] Arguments: {"location":"Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam"}
[2025-05-12T04:59:07.315Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613] LLM result from NavigationAgent: Status requires_function_call
[2025-05-12T04:59:07.315Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613] NavigationAgent requests function call: openGoogleMap
[2025-05-12T04:59:07.316Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Received request.
[2025-05-12T04:59:07.317Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: NavigationAgent
[2025-05-12T04:59:07.317Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-12T04:59:07.318Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Executing handler...
[2025-05-12T04:59:07.319Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB] Handler: OpenGoogleMap, Args: {"location":"Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam"}
[2025-05-12T04:59:07.320Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_map_location, Agent: NavigationAgent
[2025-05-12T04:59:07.321Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_map_location for NavigationAgent
[2025-05-12T04:59:07.321Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB] OpenGoogleMap: Valid location string: Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam
[2025-05-12T04:59:07.324Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: map_action_prepared, Agent: NavigationAgent
[2025-05-12T04:59:07.325Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: map_action_prepared for NavigationAgent
[2025-05-12T04:59:07.325Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Handler execution finished. Result indicates error: false
[2025-05-12T04:59:07.326Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: NavigationAgent
[2025-05-12T04:59:07.326Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-12T04:59:07.327Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-12T04:59:07.327Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-12T04:59:07.327Z] --- [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-12T04:59:07.328Z] [6oLQ-1747025941021 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-12T04:59:07.328Z] --- [6oLQ-1747025941021 HostAgent Streaming Turn 3 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:07.329Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:07.329Z] [6oLQ-1747025941021 History T3 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 23
[2025-05-12T04:59:07.330Z] [GeminiService] Received history with 23 items before mapping (for stream).
[2025-05-12T04:59:07.330Z] [GeminiService] Mapped history (SDK Content[]) with 23 items (for stream).
[2025-05-12T04:59:07.330Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:59:07.330Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:07.331Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:07.331Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:07.331Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:07.332Z] [GeminiService Stream] Preparing stream request with 23 Content items.
[2025-05-12T04:59:07.332Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:08.051Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:59:08.052Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:08.052Z] [6oLQ-1747025941021 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:59:08.052Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:08.053Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:08.109Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:08.116Z] [6oLQ-1747025941021 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 89
[2025-05-12T04:59:08.116Z] [6oLQ-1747025941021 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 23 thoughts.
[2025-05-12T04:59:08.117Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:59:08.117Z] --- [6oLQ-1747025941021 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:59:08.117Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 24
[2025-05-12T04:59:08.206Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:59:08.207Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:59:08.207Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:59:08.494Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:59:08.495Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:59:53.391Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Thêm vào calendar","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:59:53.392Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392] Request received. UserInput: "Thêm vào calendar", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:59:53.392Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:59:53.539Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 24
[2025-05-12T04:59:53.539Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:59:53.539Z] --- [6oLQ-1747025993392 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Thêm vào calendar", Lang: en ---
[2025-05-12T04:59:53.539Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:59:53.540Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:53.540Z] --- [6oLQ-1747025993392 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:53.541Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:53.541Z] [6oLQ-1747025993392 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 25
[2025-05-12T04:59:53.541Z] [GeminiService] Received history with 25 items before mapping (for stream).
[2025-05-12T04:59:53.542Z] [GeminiService] Mapped history (SDK Content[]) with 25 items (for stream).
[2025-05-12T04:59:53.542Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:53.542Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:53.542Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:53.542Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:53.543Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:53.543Z] [GeminiService Stream] Preparing stream request with 25 Content items.
[2025-05-12T04:59:53.543Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:54.497Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:59:54.497Z] [6oLQ-1747025993392 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:59:54.498Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:54.498Z] --- [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 939bb367-941f-4520-bdfc-a4eb034dbf89 ---
[2025-05-12T04:59:54.499Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:59:54.499Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:59:54.499Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:59:54.500Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:59:54.500Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:59:54.500Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:54.500Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:54.500Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:54.501Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:59:54.501Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:54.501Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:59:54.501Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:55.435Z] Model Finish Reason: STOP
[2025-05-12T04:59:55.436Z] Model requested function call: manageCalendar
[2025-05-12T04:59:55.436Z] Arguments: {"itemType":"conference","identifier":"INLG","identifierType":"acronym","action":"add"}
[2025-05-12T04:59:55.436Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:59:55.437Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498] ConferenceAgent requests function call: manageCalendar
[2025-05-12T04:59:55.437Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T04:59:55.437Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:59:55.438Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:59:55.438Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T04:59:55.441Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","identifier":"INLG","identifierType":"acronym","action":"add"}, Auth: true
[2025-05-12T04:59:55.441Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T04:59:55.442Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T04:59:55.442Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T04:59:55.442Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T04:59:55.443Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-12T04:59:55.443Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-12T04:59:55.444Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Attempting to find item ID.
[2025-05-12T04:59:55.444Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Constructed search query: acronym=INLG&perPage=1&page=1
[2025-05-12T04:59:55.445Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=1&page=1}
[2025-05-12T04:59:56.148Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:59:56.148Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:59:56.149Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:59:56.149Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=1&page=1
[2025-05-12T04:59:56.150Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:59:56.150Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Successfully found ID: ed852ee9-43c0-41b7-9525-6e73f0c50390. Details: {"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conf
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-12T04:59:56.152Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T04:59:56.773Z] [CalendarService] [GetUserCalendarEvents] Success. Found 10 event(s) in calendar.
[2025-05-12T04:59:56.774Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-12T04:59:56.774Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-12T04:59:56.775Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-12T04:59:56.775Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-12T04:59:56.775Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: No API call executed for action 'add'. Current status: true
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:59:56.777Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:59:56.777Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:59:56.777Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:59:56.778Z] --- [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 12 ---
[2025-05-12T04:59:56.778Z] [6oLQ-1747025993392 Streaming] Appended 12 thoughts from ConferenceAgent. Total: 15
[2025-05-12T04:59:56.778Z] --- [6oLQ-1747025993392 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:56.779Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:56.779Z] [6oLQ-1747025993392 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 27
[2025-05-12T04:59:56.779Z] [GeminiService] Received history with 27 items before mapping (for stream).
[2025-05-12T04:59:56.779Z] [GeminiService] Mapped history (SDK Content[]) with 27 items (for stream).
[2025-05-12T04:59:56.779Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:59:56.780Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:56.780Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:56.780Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:56.781Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:56.781Z] [GeminiService Stream] Preparing stream request with 27 Content items.
[2025-05-12T04:59:56.782Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:57.494Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:59:57.495Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:57.495Z] [6oLQ-1747025993392 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:59:57.495Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:57.496Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:57.539Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:57.552Z] [6oLQ-1747025993392 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 55
[2025-05-12T04:59:57.553Z] [6oLQ-1747025993392 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 18 thoughts.
[2025-05-12T04:59:57.554Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:59:57.554Z] --- [6oLQ-1747025993392 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:59:57.554Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 28
[2025-05-12T04:59:57.650Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:59:57.650Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:59:57.651Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:59:57.934Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:59:57.934Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:01:46.535Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Là nó đã có sẵn trong lịch của tôi à ?","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:01:46.536Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536] Request received. UserInput: "Là nó đã có sẵn trong lịch của...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:01:46.536Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:01:46.692Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 28
[2025-05-12T05:01:46.692Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:01:46.692Z] --- [6oLQ-1747026106536 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Là nó đã có sẵn trong lịch của tôi à ?", Lang: en ---
[2025-05-12T05:01:46.693Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:01:46.693Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:46.693Z] --- [6oLQ-1747026106536 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:01:46.694Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:46.694Z] [6oLQ-1747026106536 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 29
[2025-05-12T05:01:46.694Z] [GeminiService] Received history with 29 items before mapping (for stream).
[2025-05-12T05:01:46.694Z] [GeminiService] Mapped history (SDK Content[]) with 29 items (for stream).
[2025-05-12T05:01:46.695Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:01:46.695Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:01:46.695Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:01:46.695Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:01:46.695Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:01:46.695Z] [GeminiService Stream] Preparing stream request with 29 Content items.
[2025-05-12T05:01:46.696Z]   - No valid next turn added, sending only history.
[2025-05-12T05:01:47.602Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:01:47.602Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:47.603Z] [6oLQ-1747026106536 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:01:47.603Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:47.603Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:01:47.685Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:01:47.705Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:01:47.715Z] [6oLQ-1747026106536 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 70
[2025-05-12T05:01:47.716Z] [6oLQ-1747026106536 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-12T05:01:47.717Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:01:47.717Z] --- [6oLQ-1747026106536 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:01:47.717Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 30
[2025-05-12T05:01:47.826Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:01:47.827Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:01:47.827Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:01:48.119Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:01:48.119Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:02:00.922Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Vậy xóa khỏi lịch đi","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:02:00.923Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923] Request received. UserInput: "Vậy xóa khỏi lịch đi", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:02:00.923Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:02:01.062Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 30
[2025-05-12T05:02:01.063Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:02:01.063Z] --- [6oLQ-1747026120923 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Vậy xóa khỏi lịch đi", Lang: en ---
[2025-05-12T05:02:01.063Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:02:01.064Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:01.064Z] --- [6oLQ-1747026120923 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:01.065Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:01.065Z] [6oLQ-1747026120923 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 31
[2025-05-12T05:02:01.065Z] [GeminiService] Received history with 31 items before mapping (for stream).
[2025-05-12T05:02:01.065Z] [GeminiService] Mapped history (SDK Content[]) with 31 items (for stream).
[2025-05-12T05:02:01.066Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:01.066Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:01.066Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:01.066Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:01.067Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:01.067Z] [GeminiService Stream] Preparing stream request with 31 Content items.
[2025-05-12T05:02:01.068Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:03.040Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:02:03.041Z] [6oLQ-1747026120923 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:02:03.041Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:03.042Z] --- [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 21ebdba4-07cb-40d9-849d-15f778f3ae22 ---
[2025-05-12T05:02:03.042Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:02:03.042Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:02:03.043Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:02:03.043Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:02:03.044Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:02:03.044Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:03.044Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:03.044Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:03.045Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:02:03.045Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:03.045Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:02:03.046Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:04.850Z] Model Finish Reason: STOP
[2025-05-12T05:02:04.851Z] Model requested function call: manageCalendar
[2025-05-12T05:02:04.851Z] Arguments: {"itemType":"conference","identifier":"INLG","action":"remove","identifierType":"acronym"}
[2025-05-12T05:02:04.851Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:02:04.851Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:02:04.852Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:02:04.852Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:02:04.852Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:02:04.853Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:02:04.853Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","identifier":"INLG","action":"remove","identifierType":"acronym"}, Auth: true
[2025-05-12T05:02:04.853Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:02:04.854Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:02:04.854Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:02:04.855Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:02:04.855Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-12T05:02:04.855Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-12T05:02:04.855Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Attempting to find item ID.
[2025-05-12T05:02:04.856Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Constructed search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:02:04.856Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=1&page=1}
[2025-05-12T05:02:05.531Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T05:02:05.532Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T05:02:05.532Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T05:02:05.532Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:02:05.534Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T05:02:05.534Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Successfully found ID: ed852ee9-43c0-41b7-9525-6e73f0c50390. Details: {"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conf
[2025-05-12T05:02:05.535Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-12T05:02:05.535Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-12T05:02:05.539Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-12T05:02:05.540Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-12T05:02:05.541Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:02:06.164Z] [CalendarService] [GetUserCalendarEvents] Success. Found 10 event(s) in calendar.
[2025-05-12T05:02:06.164Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-12T05:02:06.165Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-12T05:02:06.165Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-12T05:02:06.166Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-12T05:02:06.166Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-12T05:02:06.167Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-12T05:02:06.167Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: preparing_calendar_api_call, Agent: ConferenceAgent
[2025-05-12T05:02:06.167Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: preparing_calendar_api_call for ConferenceAgent
[2025-05-12T05:02:06.168Z] [CalendarService] [removeCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Executing action: PUT https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/remove-event
[2025-05-12T05:02:06.390Z] [CalendarService] [removeCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Action executed successfully.
[2025-05-12T05:02:06.390Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: API call for remove successful.
[2025-05-12T05:02:06.391Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_update_success, Agent: ConferenceAgent
[2025-05-12T05:02:06.391Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_update_success for ConferenceAgent
[2025-05-12T05:02:06.391Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:02:06.392Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:02:06.392Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:02:06.392Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:02:06.393Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:02:06.393Z] --- [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 14 ---
[2025-05-12T05:02:06.393Z] [6oLQ-1747026120923 Streaming] Appended 14 thoughts from ConferenceAgent. Total: 17
[2025-05-12T05:02:06.393Z] --- [6oLQ-1747026120923 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:06.394Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:06.394Z] [6oLQ-1747026120923 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 33
[2025-05-12T05:02:06.394Z] [GeminiService] Received history with 33 items before mapping (for stream).
[2025-05-12T05:02:06.394Z] [GeminiService] Mapped history (SDK Content[]) with 33 items (for stream).
[2025-05-12T05:02:06.394Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:02:06.395Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:06.395Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:06.395Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:06.395Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:06.395Z] [GeminiService Stream] Preparing stream request with 33 Content items.
[2025-05-12T05:02:06.396Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:07.139Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:02:07.140Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:07.140Z] [6oLQ-1747026120923 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:02:07.141Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:07.141Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:07.188Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:07.200Z] [6oLQ-1747026120923 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 59
[2025-05-12T05:02:07.200Z] [6oLQ-1747026120923 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 20 thoughts.
[2025-05-12T05:02:07.201Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:02:07.201Z] --- [6oLQ-1747026120923 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:02:07.201Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 34
[2025-05-12T05:02:07.291Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:02:07.291Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:02:07.291Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:02:07.585Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:02:07.586Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:02:17.693Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Kiểm tra lại danh sách lijhc của tôi","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:02:17.694Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694] Request received. UserInput: "Kiểm tra lại danh sách lijhc c...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:02:17.694Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:02:18.357Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 34
[2025-05-12T05:02:18.358Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:02:18.358Z] --- [6oLQ-1747026137694 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Kiểm tra lại danh sách lijhc của tôi", Lang: en ---
[2025-05-12T05:02:18.358Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:02:18.358Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:18.359Z] --- [6oLQ-1747026137694 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:18.359Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:18.359Z] [6oLQ-1747026137694 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 35
[2025-05-12T05:02:18.360Z] [GeminiService] Received history with 35 items before mapping (for stream).
[2025-05-12T05:02:18.360Z] [GeminiService] Mapped history (SDK Content[]) with 35 items (for stream).
[2025-05-12T05:02:18.360Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:18.360Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:18.360Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:18.361Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:18.361Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:18.361Z] [GeminiService Stream] Preparing stream request with 35 Content items.
[2025-05-12T05:02:18.361Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:19.920Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:02:19.920Z] [6oLQ-1747026137694 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:02:19.921Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:19.921Z] --- [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: daec12ae-d7a3-4567-91c4-2cc07ce5a969 ---
[2025-05-12T05:02:19.921Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:02:19.922Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:02:19.922Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:02:19.922Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:02:19.922Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:02:19.922Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:19.923Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:19.923Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:19.923Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:02:19.923Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:19.923Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:02:19.924Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:22.084Z] Model Finish Reason: STOP
[2025-05-12T05:02:22.085Z] Model requested function call: manageCalendar
[2025-05-12T05:02:22.085Z] Arguments: {"itemType":"conference","action":"list"}
[2025-05-12T05:02:22.085Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:02:22.085Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:02:22.085Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:02:22.086Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:02:22.086Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:02:22.086Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:02:22.087Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","action":"list"}, Auth: true
[2025-05-12T05:02:22.087Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:02:22.087Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: listing_calendar_items, Agent: ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: listing_calendar_items for ConferenceAgent
[2025-05-12T05:02:22.088Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:02:22.782Z] [CalendarService] [GetUserCalendarEvents] Success. Found 0 event(s) in calendar.
[2025-05-12T05:02:22.782Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: No conferences found in calendar.
[2025-05-12T05:02:22.782Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: list_success_empty_calendar, Agent: ConferenceAgent
[2025-05-12T05:02:22.783Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: list_success_empty_calendar for ConferenceAgent
[2025-05-12T05:02:22.783Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:02:22.785Z] --- [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-12T05:02:22.785Z] [6oLQ-1747026137694 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-12T05:02:22.785Z] --- [6oLQ-1747026137694 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:22.785Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:22.786Z] [6oLQ-1747026137694 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 37
[2025-05-12T05:02:22.786Z] [GeminiService] Received history with 37 items before mapping (for stream).
[2025-05-12T05:02:22.786Z] [GeminiService] Mapped history (SDK Content[]) with 37 items (for stream).
[2025-05-12T05:02:22.786Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:02:22.786Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:22.787Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:22.787Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:22.787Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:22.787Z] [GeminiService Stream] Preparing stream request with 37 Content items.
[2025-05-12T05:02:22.787Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:23.607Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:02:23.607Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:23.608Z] [6oLQ-1747026137694 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:02:23.608Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:23.608Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:23.624Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:23.682Z] [6oLQ-1747026137694 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 46
[2025-05-12T05:02:23.682Z] [6oLQ-1747026137694 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-12T05:02:23.683Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:02:23.683Z] --- [6oLQ-1747026137694 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:02:23.683Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 38
[2025-05-12T05:02:23.786Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:02:23.786Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:02:23.786Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:02:24.204Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:02:24.205Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:02:59.375Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"thêm lại vào lịch","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:02:59.375Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375] Request received. UserInput: "thêm lại vào lịch", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:02:59.376Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:02:59.516Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 38
[2025-05-12T05:02:59.516Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:02:59.516Z] --- [6oLQ-1747026179375 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "thêm lại vào lịch", Lang: en ---
[2025-05-12T05:02:59.519Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:02:59.525Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:59.534Z] --- [6oLQ-1747026179375 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:59.538Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:59.540Z] [6oLQ-1747026179375 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 39
[2025-05-12T05:02:59.543Z] [GeminiService] Received history with 39 items before mapping (for stream).
[2025-05-12T05:02:59.544Z] [GeminiService] Mapped history (SDK Content[]) with 39 items (for stream).
[2025-05-12T05:02:59.548Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:59.549Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:59.550Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:59.553Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:59.559Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:59.570Z] [GeminiService Stream] Preparing stream request with 39 Content items.
[2025-05-12T05:02:59.571Z]   - No valid next turn added, sending only history.
[2025-05-12T05:03:00.582Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:03:00.582Z] [6oLQ-1747026179375 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:03:00.583Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:00.584Z] --- [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: dca84f25-5789-48cd-af1f-6d0162c1f279 ---
[2025-05-12T05:03:00.584Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:03:00.584Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:03:00.585Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:03:00.585Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:03:00.585Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:03:00.585Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:03:00.585Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:03:00.586Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:03:00.586Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:03:00.586Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:03:00.586Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:03:00.586Z]   - No valid next turn added, sending only history.
[2025-05-12T05:03:01.510Z] Model Finish Reason: STOP
[2025-05-12T05:03:01.510Z] Model requested function call: manageCalendar
[2025-05-12T05:03:01.511Z] Arguments: {"itemType":"conference","action":"add","identifier":"INLG","identifierType":"acronym"}
[2025-05-12T05:03:01.512Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:03:01.512Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:03:01.512Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:03:01.513Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:03:01.514Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:03:01.514Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:03:01.514Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","action":"add","identifier":"INLG","identifierType":"acronym"}, Auth: true
[2025-05-12T05:03:01.515Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:03:01.515Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:03:01.515Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:03:01.516Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:03:01.516Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-12T05:03:01.516Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-12T05:03:01.517Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Attempting to find item ID.
[2025-05-12T05:03:01.517Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Constructed search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:03:01.517Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=1&page=1}
[2025-05-12T05:03:02.161Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T05:03:02.162Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T05:03:02.163Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T05:03:02.163Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:03:02.165Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T05:03:02.166Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Successfully found ID: ed852ee9-43c0-41b7-9525-6e73f0c50390. Details: {"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conf
[2025-05-12T05:03:02.167Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-12T05:03:02.167Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-12T05:03:02.168Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-12T05:03:02.168Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-12T05:03:02.169Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:03:02.770Z] [CalendarService] [GetUserCalendarEvents] Success. Found 0 event(s) in calendar.
[2025-05-12T05:03:02.770Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-12T05:03:02.772Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: preparing_calendar_api_call, Agent: ConferenceAgent
[2025-05-12T05:03:02.772Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: preparing_calendar_api_call for ConferenceAgent
[2025-05-12T05:03:02.772Z] [CalendarService] [addCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Executing action: PUT https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/add-event
[2025-05-12T05:03:02.990Z] [CalendarService] [addCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Action executed successfully.
[2025-05-12T05:03:02.990Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: API call for add successful.
[2025-05-12T05:03:02.991Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_update_success, Agent: ConferenceAgent
[2025-05-12T05:03:02.991Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_update_success for ConferenceAgent
[2025-05-12T05:03:02.991Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: Insufficient details to create calendar event for ed852ee9-43c0-41b7-9525-6e73f0c50390. Title or dates missing.
[2025-05-12T05:03:02.992Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:03:02.992Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:03:02.992Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:03:02.993Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:03:02.993Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:03:02.993Z] --- [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 14 ---
[2025-05-12T05:03:02.993Z] [6oLQ-1747026179375 Streaming] Appended 14 thoughts from ConferenceAgent. Total: 17
[2025-05-12T05:03:02.994Z] --- [6oLQ-1747026179375 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:03:02.994Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:02.994Z] [6oLQ-1747026179375 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 41
[2025-05-12T05:03:02.995Z] [GeminiService] Received history with 41 items before mapping (for stream).
[2025-05-12T05:03:02.996Z] [GeminiService] Mapped history (SDK Content[]) with 41 items (for stream).
[2025-05-12T05:03:02.996Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:03:02.996Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:03:02.997Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:03:02.997Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:03:02.997Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:03:02.998Z] [GeminiService Stream] Preparing stream request with 41 Content items.
[2025-05-12T05:03:02.998Z]   - No valid next turn added, sending only history.
[2025-05-12T05:03:03.755Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:03:03.755Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:03.756Z] [6oLQ-1747026179375 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:03:03.756Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:03.756Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:03:03.831Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:03:03.888Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:03:03.893Z] [6oLQ-1747026179375 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 157
[2025-05-12T05:03:03.894Z] [6oLQ-1747026179375 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 20 thoughts.
[2025-05-12T05:03:03.896Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:03:03.896Z] --- [6oLQ-1747026179375 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:03:03.897Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 42
[2025-05-12T05:03:03.998Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:03:03.999Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:03:03.999Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:03:04.298Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:03:04.299Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:04:24.628Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Kiểm tra lại danh sách lịch của tôi","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:04:24.628Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628] Request received. UserInput: "Kiểm tra lại danh sách lịch củ...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:04:24.628Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:04:24.791Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 42
[2025-05-12T05:04:24.791Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:04:24.792Z] --- [6oLQ-1747026264628 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Kiểm tra lại danh sách lịch của tôi", Lang: en ---
[2025-05-12T05:04:24.792Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:04:24.792Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:24.793Z] --- [6oLQ-1747026264628 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:04:24.793Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:24.793Z] [6oLQ-1747026264628 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 43
[2025-05-12T05:04:24.794Z] [GeminiService] Received history with 43 items before mapping (for stream).
[2025-05-12T05:04:24.794Z] [GeminiService] Mapped history (SDK Content[]) with 43 items (for stream).
[2025-05-12T05:04:24.794Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:04:24.794Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:04:24.794Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:04:24.795Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:04:24.795Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:04:24.795Z] [GeminiService Stream] Preparing stream request with 43 Content items.
[2025-05-12T05:04:24.795Z]   - No valid next turn added, sending only history.
[2025-05-12T05:04:26.051Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:04:26.052Z] [6oLQ-1747026264628 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:04:26.052Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:26.053Z] --- [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 34722809-6651-4af7-b47d-d6b3c9373c92 ---
[2025-05-12T05:04:26.053Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:04:26.053Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:04:26.053Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:04:26.053Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:04:26.054Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:04:26.054Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:04:26.054Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:04:26.054Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:04:26.057Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:04:26.060Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:04:26.060Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:04:26.061Z]   - No valid next turn added, sending only history.
[2025-05-12T05:04:26.984Z] Model Finish Reason: STOP
[2025-05-12T05:04:26.984Z] Model requested function call: manageCalendar
[2025-05-12T05:04:26.985Z] Arguments: {"itemType":"conference","action":"list"}
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","action":"list"}, Auth: true
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: listing_calendar_items, Agent: ConferenceAgent
[2025-05-12T05:04:26.988Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: listing_calendar_items for ConferenceAgent
[2025-05-12T05:04:26.988Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:04:27.836Z] [CalendarService] [GetUserCalendarEvents] Success. Found 10 event(s) in calendar.
[2025-05-12T05:04:27.837Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: Successfully listed 10 calendar conference(s).
[2025-05-12T05:04:27.837Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: list_success_calendar, Agent: ConferenceAgent
[2025-05-12T05:04:27.838Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: list_success_calendar for ConferenceAgent
[2025-05-12T05:04:27.846Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:04:27.847Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:04:27.848Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:04:27.848Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:04:27.849Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:04:27.850Z] --- [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-12T05:04:27.851Z] [6oLQ-1747026264628 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-12T05:04:27.852Z] --- [6oLQ-1747026264628 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:04:27.853Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:27.854Z] [6oLQ-1747026264628 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 45
[2025-05-12T05:04:27.855Z] [GeminiService] Received history with 45 items before mapping (for stream).
[2025-05-12T05:04:27.856Z] [GeminiService] Mapped history (SDK Content[]) with 45 items (for stream).
[2025-05-12T05:04:27.857Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:04:27.858Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:04:27.859Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:04:27.859Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:04:27.859Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:04:27.860Z] [GeminiService Stream] Preparing stream request with 45 Content items.
[2025-05-12T05:04:27.860Z]   - No valid next turn added, sending only history.
[2025-05-12T05:04:28.640Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:04:28.641Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:28.641Z] [6oLQ-1747026264628 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:04:28.642Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:28.642Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:28.725Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:28.817Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:28.919Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:29.035Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:29.132Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:29.133Z] [6oLQ-1747026264628 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 738
[2025-05-12T05:04:29.133Z] [6oLQ-1747026264628 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-12T05:04:29.134Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:04:29.134Z] --- [6oLQ-1747026264628 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:04:29.135Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 46
[2025-05-12T05:04:29.243Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:04:29.244Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:04:29.244Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:04:29.763Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:04:29.764Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:08:38.769Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Hello","isStreaming":false,"language":"en","conversationId":null}]
[2025-05-12T05:08:38.770Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770] Request received. UserInput: "Hello", Streaming: false, Language: en, PayloadConvId: N/A, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:08:38.770Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-12T05:08:38.929Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-12T05:08:38.930Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-12T05:08:38.931Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:08:39.213Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:08:39.214Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Emitted updated conversation list. Reason: new conversation from send_message, Count: 20
[2025-05-12T05:08:39.287Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Fetched current history. Count: 0
[2025-05-12T05:08:39.287Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Calling non-streaming intent handler.
[2025-05-12T05:08:39.289Z] --- [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB] Handling NON-STREAMING input: "Hello", Lang: en ---
[2025-05-12T05:08:39.289Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:08:39.290Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:39.290Z] --- [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Sending to Model (History size: 1) ---
[2025-05-12T05:08:39.290Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:39.291Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:08:39.291Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:08:39.291Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:08:39.291Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:08:39.292Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:08:39.292Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:08:39.292Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:08:39.292Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:08:39.292Z]   - No valid next turn added, sending only history.
[2025-05-12T05:08:40.127Z] Model Finish Reason: STOP
[2025-05-12T05:08:40.127Z] Model generated final text response: How can I help you today?
...
[2025-05-12T05:08:40.127Z] [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Received final_text.
[2025-05-12T05:08:40.128Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:40.128Z] [6oLQ-1747026518770 History Check - Final] Appended final HostAgent response. History size: 2
[2025-05-12T05:08:40.129Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result
[2025-05-12T05:08:40.130Z] --- [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB Lang: en] NON-STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:08:40.130Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-12T05:08:40.203Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Successfully updated history in DB.
[2025-05-12T05:08:40.203Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:08:40.204Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:08:40.484Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:08:40.484Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:08:45.496Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"who are you ?","isStreaming":false,"language":"en","conversationId":"682182563cc24e5f2bf99499"}]
[2025-05-12T05:08:45.496Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496] Request received. UserInput: "who are you ?", Streaming: false, Language: en, PayloadConvId: 682182563cc24e5f2bf99499, SocketDataConvId: 682182563cc24e5f2bf99499
[2025-05-12T05:08:45.496Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Using conversationId from payload.
[2025-05-12T05:08:45.648Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Fetched current history. Count: 2
[2025-05-12T05:08:45.649Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Calling non-streaming intent handler.
[2025-05-12T05:08:45.649Z] --- [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB] Handling NON-STREAMING input: "who are you ?", Lang: en ---
[2025-05-12T05:08:45.649Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:08:45.650Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:45.650Z] --- [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Sending to Model (History size: 3) ---
[2025-05-12T05:08:45.651Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:45.651Z] [GeminiService] Received history with 3 items before mapping.
[2025-05-12T05:08:45.651Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 3 items.
[2025-05-12T05:08:45.652Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:08:45.652Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:08:45.652Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:08:45.652Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:08:45.653Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:08:45.653Z] [GeminiService] Sending total 3 Content items to API.
[2025-05-12T05:08:45.653Z]   - No valid next turn added, sending only history.
[2025-05-12T05:08:47.707Z] Model Finish Reason: STOP
[2025-05-12T05:08:47.708Z] Model generated final text response: I am the HCMUS Orchestrator, an intelligent agent coordinator for the Global Conference & Journal Hub (GCJH). I route tasks to specialist agents and synthesize their responses for you.
...
[2025-05-12T05:08:47.708Z] [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Received final_text.
[2025-05-12T05:08:47.708Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:47.709Z] [6oLQ-1747026525496 History Check - Final] Appended final HostAgent response. History size: 4
[2025-05-12T05:08:47.709Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result
[2025-05-12T05:08:47.709Z] --- [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB Lang: en] NON-STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:08:47.710Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-12T05:08:47.818Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Successfully updated history in DB.
[2025-05-12T05:08:47.818Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:08:47.818Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:08:48.400Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:08:48.401Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Emitted updated conversation list. Reason: message saved, Count: 20
