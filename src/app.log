[2025-05-12T04:44:41.213Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-12T04:44:41.214Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:44:41.549Z] [MainLoader] Starting application loading process...
[2025-05-12T04:44:41.549Z] [DatabaseLoader] Attempting database connection...
[2025-05-12T04:44:41.550Z] [Database] Attempting MongoDB connection...
[2025-05-12T04:44:42.497Z] [Database] MongoDB Connected Successfully.
[2025-05-12T04:44:42.497Z] [DatabaseLoader] Database connection successful.
[2025-05-12T04:44:42.498Z] [MainLoader] Database loaded.
[2025-05-12T04:44:42.498Z] [MainLoader] Services will be managed by DI container.
[2025-05-12T04:44:42.499Z] [ExpressLoader] Configuring Express app...
[2025-05-12T04:44:42.505Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-12T04:44:42.508Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-12T04:44:42.509Z] [ExpressLoader] Registered Not Found handler.
[2025-05-12T04:44:42.509Z] [ExpressLoader] Registered Global Error handler.
[2025-05-12T04:44:42.510Z] [ExpressLoader] Express app configured successfully.
[2025-05-12T04:44:42.511Z] [MainLoader] Express loaded.
[2025-05-12T04:44:42.511Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-12T04:44:42.515Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-12T04:44:42.516Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-12T04:44:42.516Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-12T04:44:42.516Z] [MainLoader] Socket.IO loaded.
[2025-05-12T04:44:42.517Z] [JobsLoader] Scheduling background jobs...
[2025-05-12T04:44:42.552Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-12T04:44:42.552Z] [MainLoader] Jobs scheduled.
[2025-05-12T04:44:42.552Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-12T04:44:42.603Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-12T04:44:42.603Z] [MainLoader] All basic loaders completed successfully.
[2025-05-12T04:44:43.805Z] [socketAuth][6oLQmlM2bjPV-BeZAAAB] Authentication attempt. Has token: true
[2025-05-12T04:44:43.811Z] [socketAuth][6oLQmlM2bjPV-BeZAAAB] Token signature validated successfully.
[2025-05-12T04:44:43.814Z] [HistoryService] Initialized.
[2025-05-12T04:44:43.814Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] New connection. Socket ID: 6oLQmlM2bjPV-BeZAAAB. Initial socket.data.userId: null
[2025-05-12T04:44:43.814Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] Client connected, processing authentication. Has token: true
[2025-05-12T04:44:43.815Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] Attempting to fetch user info using token...
[2025-05-12T04:44:43.815Z] [API Client] Attempting to fetch user info.
[2025-05-12T04:44:43.816Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-12T04:44:44.489Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-12T04:44:44.490Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-12T04:44:44.490Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-12T04:44:44.492Z] [HistoryService] Initialized.
[2025-05-12T04:44:44.492Z] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-12T04:44:44.493Z] [INFO] Core event handlers successfully registered.
[2025-05-12T04:44:44.493Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:44.493Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-12T04:44:44.495Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-12T04:44:44.496Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:44:44.527Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-12T04:44:44.804Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:44:44.805Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-12T04:44:44.806Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:44.806Z] [SERVER GLOBAL][connection][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-12T04:44:47.454Z] [socketAuth][y1jq9hSlXclbMUi4AAAD] Authentication attempt. Has token: true
[2025-05-12T04:44:47.456Z] [socketAuth][y1jq9hSlXclbMUi4AAAD] Token signature validated successfully.
[2025-05-12T04:44:47.457Z] [HistoryService] Initialized.
[2025-05-12T04:44:47.457Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] New connection. Socket ID: y1jq9hSlXclbMUi4AAAD. Initial socket.data.userId: null
[2025-05-12T04:44:47.458Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] Client connected, processing authentication. Has token: true
[2025-05-12T04:44:47.458Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] Attempting to fetch user info using token...
[2025-05-12T04:44:47.459Z] [API Client] Attempting to fetch user info.
[2025-05-12T04:44:47.459Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-12T04:44:47.668Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-12T04:44:47.668Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-12T04:44:47.668Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-12T04:44:47.668Z] [HistoryService] Initialized.
[2025-05-12T04:44:47.669Z] [coreHandlers][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-12T04:44:47.669Z] [INFO] Core event handlers successfully registered.
[2025-05-12T04:44:47.669Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:47.669Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-12T04:44:47.670Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-12T04:44:47.670Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:44:47.674Z] [SERVER SOCKET y1jq9hSlXclbMUi4AAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-12T04:44:47.962Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:44:47.963Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-12T04:44:47.963Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T04:44:47.964Z] [SERVER GLOBAL][connection][y1jq9hSlXclbMUi4AAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-12T04:46:28.588Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tôi đang theo dõi các hội nghị nào","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-12T04:46:28.590Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589] Request received. UserInput: "tôi đang theo dõi các hội nghị...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-12T04:46:28.590Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-12T04:46:28.800Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-12T04:46:28.801Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-12T04:46:28.801Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:46:29.086Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:46:29.087Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: new conversation from send_message, Count: 20
[2025-05-12T04:46:29.159Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 0
[2025-05-12T04:46:29.160Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:46:29.161Z] --- [6oLQ-1747025188589 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "tôi đang theo dõi các hội nghị nào", Lang: en ---
[2025-05-12T04:46:29.162Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:46:29.163Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:29.164Z] --- [6oLQ-1747025188589 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:46:29.164Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:29.164Z] [6oLQ-1747025188589 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 1
[2025-05-12T04:46:29.166Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-12T04:46:29.166Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-12T04:46:29.166Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:46:29.167Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:46:29.167Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:46:29.167Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:46:29.167Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:46:29.167Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-12T04:46:29.168Z]   - No valid next turn added, sending only history.
[2025-05-12T04:46:30.239Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:46:30.239Z] [6oLQ-1747025188589 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:46:30.240Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:30.244Z] --- [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 27d74688-c79f-4ae3-9b0f-8c0063d326d5 ---
[2025-05-12T04:46:30.244Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:46:30.244Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:46:30.245Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:46:30.246Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:46:30.247Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:46:30.247Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:46:30.247Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:46:30.247Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:46:30.248Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:46:30.248Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:46:30.248Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:46:30.249Z]   - No valid next turn added, sending only history.
[2025-05-12T04:46:31.152Z] Model Finish Reason: STOP
[2025-05-12T04:46:31.152Z] Model requested function call: manageFollow
[2025-05-12T04:46:31.152Z] Arguments: {"action":"list","itemType":"conference"}
[2025-05-12T04:46:31.153Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:46:31.153Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243] ConferenceAgent requests function call: manageFollow
[2025-05-12T04:46:31.154Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Received request.
[2025-05-12T04:46:31.154Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:46:31.155Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:46:31.155Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Executing handler...
[2025-05-12T04:46:31.157Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB] Handler: ManageFollow, Args: {"action":"list","itemType":"conference"}, Auth: true
[2025-05-12T04:46:31.157Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:46:31.158Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:46:31.159Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication, Agent: ConferenceAgent
[2025-05-12T04:46:31.159Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication for ConferenceAgent
[2025-05-12T04:46:31.160Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: listing_followed_items, Agent: ConferenceAgent
[2025-05-12T04:46:31.160Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: listing_followed_items for ConferenceAgent
[2025-05-12T04:46:31.161Z] [FollowService] [GetFollowed conference] Fetching followed items: GET https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/followed
[2025-05-12T04:46:31.820Z] [FollowService] [GetFollowed conference] Success. Found 1 followed item(s).
[2025-05-12T04:46:31.821Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB] ManageFollow: Successfully listed 1 followed conference(s).
[2025-05-12T04:46:31.821Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: list_success, Agent: ConferenceAgent
[2025-05-12T04:46:31.822Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: list_success for ConferenceAgent
[2025-05-12T04:46:31.822Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Handler execution finished. Result indicates error: false
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:46:31.823Z] [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:46:31.824Z] --- [6oLQ-1747025188589-Sub-ConferenceAgent-1747025190243] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-12T04:46:31.825Z] [6oLQ-1747025188589 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-12T04:46:31.825Z] --- [6oLQ-1747025188589 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:46:31.827Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:31.827Z] [6oLQ-1747025188589 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 3
[2025-05-12T04:46:31.827Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-12T04:46:31.828Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-12T04:46:31.828Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:46:31.828Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:46:31.828Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:46:31.829Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:46:31.829Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:46:31.830Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-12T04:46:31.830Z]   - No valid next turn added, sending only history.
[2025-05-12T04:46:32.420Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:46:32.421Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:32.421Z] [6oLQ-1747025188589 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:46:32.422Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:46:32.422Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.518Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.585Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.679Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:46:32.694Z] [6oLQ-1747025188589 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 172
[2025-05-12T04:46:32.695Z] [6oLQ-1747025188589 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-12T04:46:32.696Z] [6oLQ-1747025188589 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:46:32.696Z] --- [6oLQ-1747025188589 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:46:32.697Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-12T04:46:32.799Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:46:32.799Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:46:32.800Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:46:33.084Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:46:33.085Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025188589][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:54:02.480Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Chi tiết về hội nghị trên mà tôi đã follow","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:54:02.480Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480] Request received. UserInput: "Chi tiết về hội nghị trên mà t...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:54:02.480Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:54:02.555Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 4
[2025-05-12T04:54:02.555Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:54:02.555Z] --- [6oLQ-1747025642480 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Chi tiết về hội nghị trên mà tôi đã follow", Lang: en ---
[2025-05-12T04:54:02.556Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:54:02.556Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:02.557Z] --- [6oLQ-1747025642480 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:54:02.557Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:02.557Z] [6oLQ-1747025642480 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 5
[2025-05-12T04:54:02.558Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-12T04:54:02.558Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-12T04:54:02.558Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:54:02.559Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:54:02.559Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:54:02.559Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:54:02.559Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:54:02.559Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-12T04:54:02.559Z]   - No valid next turn added, sending only history.
[2025-05-12T04:54:04.441Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:54:04.441Z] [6oLQ-1747025642480 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:54:04.442Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:04.442Z] --- [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 7449eb92-a44c-43f6-9f8d-f7fa26582494 ---
[2025-05-12T04:54:04.443Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:54:04.444Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:54:04.444Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:54:04.445Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:54:04.445Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:54:04.446Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:54:04.447Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:54:04.447Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:54:04.448Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:54:04.449Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:54:04.450Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:54:04.450Z]   - No valid next turn added, sending only history.
[2025-05-12T04:54:06.452Z] Model Finish Reason: STOP
[2025-05-12T04:54:06.452Z] Model requested function call: getConferences
[2025-05-12T04:54:06.452Z] Arguments: {"searchQuery":"mode=detail&acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:54:06.452Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:54:06.453Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442] ConferenceAgent requests function call: getConferences
[2025-05-12T04:54:06.453Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:54:06.454Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:54:06.455Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:54:06.455Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:54:06.456Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"mode=detail&acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:54:06.457Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:54:06.457Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:54:06.457Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:54:06.458Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:54:06.458Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:54:06.459Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:54:06.459Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?mode=detail&acronym=INLG&perPage=5&page=1}
[2025-05-12T04:54:07.157Z] [BackendService] [conference] API Success (200). Data length: 7490. Attempting parsing...
[2025-05-12T04:54:07.158Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","creatorId":null,"adminId":"077f9da9-5570-4b2e-80e3-35e875c8f8b2","createdAt":"2025-05-04T06:50:47.094Z","updated...
[2025-05-12T04:54:07.158Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:54:07.159Z] Transforming conference data with Markdown. Search query: mode=detail&acronym=INLG&perPage=5&page=1
[2025-05-12T04:54:07.164Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="mode=detail&acronym=INLG&perPage=5&page=1"
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:54:07.165Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:54:07.166Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:54:07.166Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:54:07.166Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:54:07.167Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:54:07.167Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:54:07.167Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:54:07.168Z] [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:54:07.169Z] --- [6oLQ-1747025642480-Sub-ConferenceAgent-1747025644442] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:54:07.169Z] [6oLQ-1747025642480 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:54:07.169Z] --- [6oLQ-1747025642480 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:54:07.170Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:07.171Z] [6oLQ-1747025642480 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 7
[2025-05-12T04:54:07.171Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-12T04:54:07.172Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-12T04:54:07.172Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:54:07.173Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:54:07.173Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:54:07.173Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:54:07.173Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:54:07.173Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-12T04:54:07.174Z]   - No valid next turn added, sending only history.
[2025-05-12T04:54:07.764Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:54:07.765Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:07.765Z] [6oLQ-1747025642480 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:54:07.765Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:54:07.766Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:07.825Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:07.931Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.142Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.298Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.562Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:08.767Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.024Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.301Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.581Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:09.866Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:10.143Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:10.425Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:10.690Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.002Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.261Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.555Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:11.823Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.094Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.404Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.659Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:12.911Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.177Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.454Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.697Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:13.983Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:14.244Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:14.479Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:14.776Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.044Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.311Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.590Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.684Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:54:15.697Z] [6oLQ-1747025642480 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 7127
[2025-05-12T04:54:15.698Z] [6oLQ-1747025642480 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-12T04:54:15.698Z] [6oLQ-1747025642480 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:54:15.699Z] --- [6oLQ-1747025642480 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:54:15.699Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-12T04:54:15.790Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:54:15.790Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:54:15.790Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:54:16.083Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:54:16.084Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025642480][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:58:31.111Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Hội nghị diễn ra khi nào","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:58:31.112Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112] Request received. UserInput: "Hội nghị diễn ra khi nào", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:58:31.112Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:58:31.256Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 8
[2025-05-12T04:58:31.256Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:58:31.256Z] --- [6oLQ-1747025911112 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Hội nghị diễn ra khi nào", Lang: en ---
[2025-05-12T04:58:31.257Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:58:31.257Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:31.258Z] --- [6oLQ-1747025911112 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:31.258Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:31.258Z] [6oLQ-1747025911112 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 9
[2025-05-12T04:58:31.259Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-12T04:58:31.259Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-12T04:58:31.259Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:31.259Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:31.260Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:31.260Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:31.260Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:31.260Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-12T04:58:31.261Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:33.281Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:58:33.281Z] [6oLQ-1747025911112 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:58:33.282Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:33.282Z] --- [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 74c446e0-5cd8-4bbd-be8d-1f73c97d1307 ---
[2025-05-12T04:58:33.282Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:58:33.282Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:58:33.283Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:58:33.283Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:58:33.283Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:58:33.284Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:33.284Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:33.284Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:33.284Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:58:33.284Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:33.285Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:58:33.285Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:34.240Z] Model Finish Reason: STOP
[2025-05-12T04:58:34.240Z] Model requested function call: getConferences
[2025-05-12T04:58:34.240Z] Arguments: {"searchQuery":"acronym=INLG&perPage=5&page=1&mode=detail"}
[2025-05-12T04:58:34.240Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:58:34.241Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282] ConferenceAgent requests function call: getConferences
[2025-05-12T04:58:34.241Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:58:34.241Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:58:34.242Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:58:34.243Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:58:34.243Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=INLG&perPage=5&page=1&mode=detail"}
[2025-05-12T04:58:34.243Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:34.244Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:34.245Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:58:34.245Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=5&page=1&mode=detail}
[2025-05-12T04:58:34.902Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:58:34.903Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:58:34.903Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:58:34.903Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=5&page=1&mode=detail
[2025-05-12T04:58:34.904Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:58:34.904Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=INLG&perPage=5&page=1&mode=detail"
[2025-05-12T04:58:34.904Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:34.904Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:34.905Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:58:34.905Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:34.905Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:34.906Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:58:34.907Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:58:34.907Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:58:34.908Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:58:34.909Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:58:34.909Z] [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:58:34.910Z] --- [6oLQ-1747025911112-Sub-ConferenceAgent-1747025913282] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:58:34.910Z] [6oLQ-1747025911112 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:58:34.910Z] --- [6oLQ-1747025911112 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:34.911Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:34.911Z] [6oLQ-1747025911112 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 11
[2025-05-12T04:58:34.911Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-12T04:58:34.911Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-12T04:58:34.912Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:58:34.912Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:34.912Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:34.912Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:34.913Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:34.913Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-12T04:58:34.913Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:35.637Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:58:35.638Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:35.638Z] [6oLQ-1747025911112 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:58:35.638Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:35.639Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:35.745Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:35.796Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:35.804Z] [6oLQ-1747025911112 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 114
[2025-05-12T04:58:35.805Z] [6oLQ-1747025911112 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-12T04:58:35.805Z] [6oLQ-1747025911112 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:58:35.806Z] --- [6oLQ-1747025911112 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:58:35.806Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-12T04:58:35.897Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:58:35.897Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:58:35.898Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:58:36.187Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:58:36.188Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025911112][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:58:49.014Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"cho tôi tới trang web","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:58:49.014Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014] Request received. UserInput: "cho tôi tới trang web", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:58:49.014Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:58:49.154Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 12
[2025-05-12T04:58:49.155Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:58:49.155Z] --- [6oLQ-1747025929014 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "cho tôi tới trang web", Lang: en ---
[2025-05-12T04:58:49.155Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:58:49.155Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:49.156Z] --- [6oLQ-1747025929014 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:49.157Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:49.157Z] [6oLQ-1747025929014 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 13
[2025-05-12T04:58:49.157Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-12T04:58:49.158Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-12T04:58:49.158Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:49.158Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:49.158Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:49.159Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:49.159Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:49.159Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-12T04:58:49.159Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:50.136Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:58:50.136Z] [6oLQ-1747025929014 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:58:50.137Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:50.137Z] --- [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 6afdc5b2-1924-42db-a7c7-d08018a15f09 ---
[2025-05-12T04:58:50.138Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:58:50.138Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:58:50.138Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:58:50.138Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:58:50.139Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:58:50.139Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:50.139Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:50.139Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:50.140Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:58:50.140Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:50.140Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:58:50.141Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:51.976Z] Model Finish Reason: STOP
[2025-05-12T04:58:51.976Z] Model requested function call: getConferences
[2025-05-12T04:58:51.976Z] Arguments: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137] ConferenceAgent requests function call: getConferences
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:58:51.977Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:58:51.978Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:58:51.978Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:58:51.978Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:58:51.979Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:51.980Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:58:51.980Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:58:51.980Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=5&page=1}
[2025-05-12T04:58:52.653Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:58:52.654Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:58:52.654Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:58:52.654Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=5&page=1
[2025-05-12T04:58:52.656Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:58:52.656Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=INLG&perPage=5&page=1"
[2025-05-12T04:58:52.657Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:52.657Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:58:52.658Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:58:52.658Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:52.658Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:58:52.659Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:58:52.659Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:52.659Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:58:52.660Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:58:52.661Z] [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:58:52.662Z] --- [6oLQ-1747025929014-Sub-ConferenceAgent-1747025930137] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:58:52.662Z] [6oLQ-1747025929014 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:58:52.663Z] --- [6oLQ-1747025929014 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:52.664Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:52.664Z] [6oLQ-1747025929014 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 15
[2025-05-12T04:58:52.665Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-12T04:58:52.665Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-12T04:58:52.666Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:58:52.666Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:52.667Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:52.667Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:52.668Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:52.669Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-12T04:58:52.669Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:53.617Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:58:53.618Z] [6oLQ-1747025929014 HostAgent Streaming T2 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:58:53.618Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:53.619Z] --- [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: NavigationAgent, Task: 33a496c8-7f2f-4b36-a135-829aced459f8 ---
[2025-05-12T04:58:53.619Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-12T04:58:53.619Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-12T04:58:53.620Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-12T04:58:53.620Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:58:53.620Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:58:53.620Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:58:53.621Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:53.621Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:53.621Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-12T04:58:53.621Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:53.621Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:58:53.621Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:54.255Z] Model Finish Reason: STOP
[2025-05-12T04:58:54.255Z] Model requested function call: navigation
[2025-05-12T04:58:54.256Z] Arguments: {"url":"https://2025.inlgmeeting.org/"}
[2025-05-12T04:58:54.256Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619] LLM result from NavigationAgent: Status requires_function_call
[2025-05-12T04:58:54.257Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619] NavigationAgent requests function call: navigation
[2025-05-12T04:58:54.257Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-12T04:58:54.257Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: NavigationAgent
[2025-05-12T04:58:54.258Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-12T04:58:54.258Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-12T04:58:54.259Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB] Handler: Navigation, Args: {"url":"https://2025.inlgmeeting.org/"}
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB] Navigation: Valid target URL: https://2025.inlgmeeting.org/
[2025-05-12T04:58:54.260Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-12T04:58:54.261Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-12T04:58:54.261Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-12T04:58:54.261Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: NavigationAgent
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-12T04:58:54.262Z] --- [6oLQ-1747025929014-Sub-NavigationAgent-1747025933619] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-12T04:58:54.262Z] [6oLQ-1747025929014 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-12T04:58:54.263Z] --- [6oLQ-1747025929014 HostAgent Streaming Turn 3 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:58:54.263Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:54.263Z] [6oLQ-1747025929014 History T3 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 17
[2025-05-12T04:58:54.263Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-12T04:58:54.263Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-12T04:58:54.263Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:58:54.264Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:58:54.264Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:58:54.264Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:58:54.264Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:58:54.264Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-12T04:58:54.264Z]   - No valid next turn added, sending only history.
[2025-05-12T04:58:54.968Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:58:54.968Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:54.969Z] [6oLQ-1747025929014 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:58:54.969Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:58:54.969Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:55.062Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:58:55.092Z] [6oLQ-1747025929014 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 27
[2025-05-12T04:58:55.093Z] [6oLQ-1747025929014 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 23 thoughts.
[2025-05-12T04:58:55.094Z] [6oLQ-1747025929014 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:58:55.094Z] --- [6oLQ-1747025929014 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:58:55.094Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 18
[2025-05-12T04:58:55.177Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:58:55.177Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:58:55.177Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:58:55.488Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:58:55.489Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025929014][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:59:01.020Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"mở map","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:59:01.021Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021] Request received. UserInput: "mở map", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:59:01.021Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:59:01.164Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 18
[2025-05-12T04:59:01.165Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:59:01.165Z] --- [6oLQ-1747025941021 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "mở map", Lang: en ---
[2025-05-12T04:59:01.165Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:59:01.166Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:01.166Z] --- [6oLQ-1747025941021 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:01.166Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:01.167Z] [6oLQ-1747025941021 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 19
[2025-05-12T04:59:01.167Z] [GeminiService] Received history with 19 items before mapping (for stream).
[2025-05-12T04:59:01.167Z] [GeminiService] Mapped history (SDK Content[]) with 19 items (for stream).
[2025-05-12T04:59:01.167Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:01.168Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:01.168Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:01.168Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:01.168Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:01.168Z] [GeminiService Stream] Preparing stream request with 19 Content items.
[2025-05-12T04:59:01.168Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:03.167Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:59:03.168Z] [6oLQ-1747025941021 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:59:03.168Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:03.169Z] --- [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: a2d3f89f-9ac9-4308-8b3c-0e6238d59fa2 ---
[2025-05-12T04:59:03.169Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:59:03.169Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:59:03.169Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:59:03.170Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:59:03.170Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:59:03.170Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:03.170Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:03.170Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:03.170Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:59:03.171Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:03.171Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:59:03.171Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:05.007Z] Model Finish Reason: STOP
[2025-05-12T04:59:05.008Z] Model requested function call: getConferences
[2025-05-12T04:59:05.008Z] Arguments: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:59:05.008Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:59:05.008Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168] ConferenceAgent requests function call: getConferences
[2025-05-12T04:59:05.009Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-12T04:59:05.009Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:59:05.009Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=INLG&perPage=5&page=1"}
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:59:05.010Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-12T04:59:05.011Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-12T04:59:05.012Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=5&page=1}
[2025-05-12T04:59:05.695Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:59:05.696Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:59:05.696Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:59:05.696Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=5&page=1
[2025-05-12T04:59:05.698Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:59:05.698Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=INLG&perPage=5&page=1"
[2025-05-12T04:59:05.698Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:59:05.698Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-12T04:59:05.699Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-12T04:59:05.700Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:59:05.700Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-12T04:59:05.700Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:59:05.701Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:59:05.702Z] [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:59:05.702Z] --- [6oLQ-1747025941021-Sub-ConferenceAgent-1747025943168] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-12T04:59:05.702Z] [6oLQ-1747025941021 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-12T04:59:05.702Z] --- [6oLQ-1747025941021 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:05.703Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:05.703Z] [6oLQ-1747025941021 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 21
[2025-05-12T04:59:05.703Z] [GeminiService] Received history with 21 items before mapping (for stream).
[2025-05-12T04:59:05.703Z] [GeminiService] Mapped history (SDK Content[]) with 21 items (for stream).
[2025-05-12T04:59:05.704Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:59:05.704Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:05.704Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:05.704Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:05.704Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:05.704Z] [GeminiService Stream] Preparing stream request with 21 Content items.
[2025-05-12T04:59:05.705Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:06.612Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:59:06.612Z] [6oLQ-1747025941021 HostAgent Streaming T2 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:59:06.613Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:06.613Z] --- [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: NavigationAgent, Task: ce8d11d5-e126-46d2-8adc-87a0774619f3 ---
[2025-05-12T04:59:06.613Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-12T04:59:06.614Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-12T04:59:06.614Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-12T04:59:06.614Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:59:06.615Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:59:06.615Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:06.615Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:06.615Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:06.615Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-12T04:59:06.616Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:06.616Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:59:06.616Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:07.314Z] Model Finish Reason: STOP
[2025-05-12T04:59:07.315Z] Model requested function call: openGoogleMap
[2025-05-12T04:59:07.315Z] Arguments: {"location":"Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam"}
[2025-05-12T04:59:07.315Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613] LLM result from NavigationAgent: Status requires_function_call
[2025-05-12T04:59:07.315Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613] NavigationAgent requests function call: openGoogleMap
[2025-05-12T04:59:07.316Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Received request.
[2025-05-12T04:59:07.317Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: NavigationAgent
[2025-05-12T04:59:07.317Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-12T04:59:07.318Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Executing handler...
[2025-05-12T04:59:07.319Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB] Handler: OpenGoogleMap, Args: {"location":"Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam"}
[2025-05-12T04:59:07.320Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_map_location, Agent: NavigationAgent
[2025-05-12T04:59:07.321Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_map_location for NavigationAgent
[2025-05-12T04:59:07.321Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB] OpenGoogleMap: Valid location string: Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam
[2025-05-12T04:59:07.324Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: map_action_prepared, Agent: NavigationAgent
[2025-05-12T04:59:07.325Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: map_action_prepared for NavigationAgent
[2025-05-12T04:59:07.325Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 6oLQmlM2bjPV-BeZAAAB Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Handler execution finished. Result indicates error: false
[2025-05-12T04:59:07.326Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: NavigationAgent
[2025-05-12T04:59:07.326Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-12T04:59:07.327Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-12T04:59:07.327Z] [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-12T04:59:07.327Z] --- [6oLQ-1747025941021-Sub-NavigationAgent-1747025946613] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-12T04:59:07.328Z] [6oLQ-1747025941021 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-12T04:59:07.328Z] --- [6oLQ-1747025941021 HostAgent Streaming Turn 3 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:07.329Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:07.329Z] [6oLQ-1747025941021 History T3 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 23
[2025-05-12T04:59:07.330Z] [GeminiService] Received history with 23 items before mapping (for stream).
[2025-05-12T04:59:07.330Z] [GeminiService] Mapped history (SDK Content[]) with 23 items (for stream).
[2025-05-12T04:59:07.330Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:59:07.330Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:07.331Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:07.331Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:07.331Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:07.332Z] [GeminiService Stream] Preparing stream request with 23 Content items.
[2025-05-12T04:59:07.332Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:08.051Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:59:08.052Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:08.052Z] [6oLQ-1747025941021 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:59:08.052Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:08.053Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:08.109Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:08.116Z] [6oLQ-1747025941021 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 89
[2025-05-12T04:59:08.116Z] [6oLQ-1747025941021 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 23 thoughts.
[2025-05-12T04:59:08.117Z] [6oLQ-1747025941021 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:59:08.117Z] --- [6oLQ-1747025941021 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:59:08.117Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 24
[2025-05-12T04:59:08.206Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:59:08.207Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:59:08.207Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:59:08.494Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:59:08.495Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025941021][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T04:59:53.391Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Thêm vào calendar","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T04:59:53.392Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392] Request received. UserInput: "Thêm vào calendar", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T04:59:53.392Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T04:59:53.539Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 24
[2025-05-12T04:59:53.539Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T04:59:53.539Z] --- [6oLQ-1747025993392 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Thêm vào calendar", Lang: en ---
[2025-05-12T04:59:53.539Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T04:59:53.540Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:53.540Z] --- [6oLQ-1747025993392 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:53.541Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:53.541Z] [6oLQ-1747025993392 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 25
[2025-05-12T04:59:53.541Z] [GeminiService] Received history with 25 items before mapping (for stream).
[2025-05-12T04:59:53.542Z] [GeminiService] Mapped history (SDK Content[]) with 25 items (for stream).
[2025-05-12T04:59:53.542Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:53.542Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:53.542Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:53.542Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:53.543Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:53.543Z] [GeminiService Stream] Preparing stream request with 25 Content items.
[2025-05-12T04:59:53.543Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:54.497Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T04:59:54.497Z] [6oLQ-1747025993392 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T04:59:54.498Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:54.498Z] --- [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 939bb367-941f-4520-bdfc-a4eb034dbf89 ---
[2025-05-12T04:59:54.499Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T04:59:54.499Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T04:59:54.499Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T04:59:54.500Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T04:59:54.500Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T04:59:54.500Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T04:59:54.500Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:54.500Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:54.501Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T04:59:54.501Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:54.501Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T04:59:54.501Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:55.435Z] Model Finish Reason: STOP
[2025-05-12T04:59:55.436Z] Model requested function call: manageCalendar
[2025-05-12T04:59:55.436Z] Arguments: {"itemType":"conference","identifier":"INLG","identifierType":"acronym","action":"add"}
[2025-05-12T04:59:55.436Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T04:59:55.437Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498] ConferenceAgent requests function call: manageCalendar
[2025-05-12T04:59:55.437Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T04:59:55.437Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T04:59:55.438Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T04:59:55.438Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T04:59:55.441Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","identifier":"INLG","identifierType":"acronym","action":"add"}, Auth: true
[2025-05-12T04:59:55.441Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T04:59:55.442Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T04:59:55.442Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T04:59:55.442Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T04:59:55.443Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-12T04:59:55.443Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-12T04:59:55.444Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Attempting to find item ID.
[2025-05-12T04:59:55.444Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Constructed search query: acronym=INLG&perPage=1&page=1
[2025-05-12T04:59:55.445Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=1&page=1}
[2025-05-12T04:59:56.148Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T04:59:56.148Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T04:59:56.149Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T04:59:56.149Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=1&page=1
[2025-05-12T04:59:56.150Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T04:59:56.150Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Successfully found ID: ed852ee9-43c0-41b7-9525-6e73f0c50390. Details: {"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conf
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-12T04:59:56.151Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-12T04:59:56.152Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T04:59:56.773Z] [CalendarService] [GetUserCalendarEvents] Success. Found 10 event(s) in calendar.
[2025-05-12T04:59:56.774Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-12T04:59:56.774Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-12T04:59:56.775Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-12T04:59:56.775Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-12T04:59:56.775Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: No API call executed for action 'add'. Current status: true
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T04:59:56.776Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T04:59:56.777Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T04:59:56.777Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T04:59:56.777Z] [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T04:59:56.778Z] --- [6oLQ-1747025993392-Sub-ConferenceAgent-1747025994498] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 12 ---
[2025-05-12T04:59:56.778Z] [6oLQ-1747025993392 Streaming] Appended 12 thoughts from ConferenceAgent. Total: 15
[2025-05-12T04:59:56.778Z] --- [6oLQ-1747025993392 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T04:59:56.779Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:56.779Z] [6oLQ-1747025993392 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 27
[2025-05-12T04:59:56.779Z] [GeminiService] Received history with 27 items before mapping (for stream).
[2025-05-12T04:59:56.779Z] [GeminiService] Mapped history (SDK Content[]) with 27 items (for stream).
[2025-05-12T04:59:56.779Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T04:59:56.780Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T04:59:56.780Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T04:59:56.780Z] Tools provided: ["routeToAgent"]
[2025-05-12T04:59:56.781Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T04:59:56.781Z] [GeminiService Stream] Preparing stream request with 27 Content items.
[2025-05-12T04:59:56.782Z]   - No valid next turn added, sending only history.
[2025-05-12T04:59:57.494Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T04:59:57.495Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:57.495Z] [6oLQ-1747025993392 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T04:59:57.495Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T04:59:57.496Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:57.539Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T04:59:57.552Z] [6oLQ-1747025993392 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 55
[2025-05-12T04:59:57.553Z] [6oLQ-1747025993392 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 18 thoughts.
[2025-05-12T04:59:57.554Z] [6oLQ-1747025993392 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T04:59:57.554Z] --- [6oLQ-1747025993392 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T04:59:57.554Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 28
[2025-05-12T04:59:57.650Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T04:59:57.650Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T04:59:57.651Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T04:59:57.934Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T04:59:57.934Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747025993392][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:01:46.535Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Là nó đã có sẵn trong lịch của tôi à ?","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:01:46.536Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536] Request received. UserInput: "Là nó đã có sẵn trong lịch của...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:01:46.536Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:01:46.692Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 28
[2025-05-12T05:01:46.692Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:01:46.692Z] --- [6oLQ-1747026106536 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Là nó đã có sẵn trong lịch của tôi à ?", Lang: en ---
[2025-05-12T05:01:46.693Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:01:46.693Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:46.693Z] --- [6oLQ-1747026106536 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:01:46.694Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:46.694Z] [6oLQ-1747026106536 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 29
[2025-05-12T05:01:46.694Z] [GeminiService] Received history with 29 items before mapping (for stream).
[2025-05-12T05:01:46.694Z] [GeminiService] Mapped history (SDK Content[]) with 29 items (for stream).
[2025-05-12T05:01:46.695Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:01:46.695Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:01:46.695Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:01:46.695Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:01:46.695Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:01:46.695Z] [GeminiService Stream] Preparing stream request with 29 Content items.
[2025-05-12T05:01:46.696Z]   - No valid next turn added, sending only history.
[2025-05-12T05:01:47.602Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:01:47.602Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:47.603Z] [6oLQ-1747026106536 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:01:47.603Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:01:47.603Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:01:47.685Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:01:47.705Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:01:47.715Z] [6oLQ-1747026106536 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 70
[2025-05-12T05:01:47.716Z] [6oLQ-1747026106536 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-12T05:01:47.717Z] [6oLQ-1747026106536 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:01:47.717Z] --- [6oLQ-1747026106536 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:01:47.717Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 30
[2025-05-12T05:01:47.826Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:01:47.827Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:01:47.827Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:01:48.119Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:01:48.119Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026106536][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:02:00.922Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Vậy xóa khỏi lịch đi","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:02:00.923Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923] Request received. UserInput: "Vậy xóa khỏi lịch đi", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:02:00.923Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:02:01.062Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 30
[2025-05-12T05:02:01.063Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:02:01.063Z] --- [6oLQ-1747026120923 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Vậy xóa khỏi lịch đi", Lang: en ---
[2025-05-12T05:02:01.063Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:02:01.064Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:01.064Z] --- [6oLQ-1747026120923 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:01.065Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:01.065Z] [6oLQ-1747026120923 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 31
[2025-05-12T05:02:01.065Z] [GeminiService] Received history with 31 items before mapping (for stream).
[2025-05-12T05:02:01.065Z] [GeminiService] Mapped history (SDK Content[]) with 31 items (for stream).
[2025-05-12T05:02:01.066Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:01.066Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:01.066Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:01.066Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:01.067Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:01.067Z] [GeminiService Stream] Preparing stream request with 31 Content items.
[2025-05-12T05:02:01.068Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:03.040Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:02:03.041Z] [6oLQ-1747026120923 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:02:03.041Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:03.042Z] --- [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 21ebdba4-07cb-40d9-849d-15f778f3ae22 ---
[2025-05-12T05:02:03.042Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:02:03.042Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:02:03.043Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:02:03.043Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:02:03.044Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:02:03.044Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:03.044Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:03.044Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:03.045Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:02:03.045Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:03.045Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:02:03.046Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:04.850Z] Model Finish Reason: STOP
[2025-05-12T05:02:04.851Z] Model requested function call: manageCalendar
[2025-05-12T05:02:04.851Z] Arguments: {"itemType":"conference","identifier":"INLG","action":"remove","identifierType":"acronym"}
[2025-05-12T05:02:04.851Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:02:04.851Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:02:04.852Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:02:04.852Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:02:04.852Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:02:04.853Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:02:04.853Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","identifier":"INLG","action":"remove","identifierType":"acronym"}, Auth: true
[2025-05-12T05:02:04.853Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:02:04.854Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:02:04.854Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:02:04.855Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:02:04.855Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-12T05:02:04.855Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-12T05:02:04.855Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Attempting to find item ID.
[2025-05-12T05:02:04.856Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Constructed search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:02:04.856Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=1&page=1}
[2025-05-12T05:02:05.531Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T05:02:05.532Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T05:02:05.532Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T05:02:05.532Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:02:05.534Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T05:02:05.534Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Successfully found ID: ed852ee9-43c0-41b7-9525-6e73f0c50390. Details: {"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conf
[2025-05-12T05:02:05.535Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-12T05:02:05.535Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-12T05:02:05.539Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-12T05:02:05.540Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-12T05:02:05.541Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:02:06.164Z] [CalendarService] [GetUserCalendarEvents] Success. Found 10 event(s) in calendar.
[2025-05-12T05:02:06.164Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-12T05:02:06.165Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-12T05:02:06.165Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-12T05:02:06.166Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-12T05:02:06.166Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-12T05:02:06.167Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-12T05:02:06.167Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: preparing_calendar_api_call, Agent: ConferenceAgent
[2025-05-12T05:02:06.167Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: preparing_calendar_api_call for ConferenceAgent
[2025-05-12T05:02:06.168Z] [CalendarService] [removeCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Executing action: PUT https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/remove-event
[2025-05-12T05:02:06.390Z] [CalendarService] [removeCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Action executed successfully.
[2025-05-12T05:02:06.390Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: API call for remove successful.
[2025-05-12T05:02:06.391Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_update_success, Agent: ConferenceAgent
[2025-05-12T05:02:06.391Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_update_success for ConferenceAgent
[2025-05-12T05:02:06.391Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:02:06.392Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:02:06.392Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:02:06.392Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:02:06.393Z] [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:02:06.393Z] --- [6oLQ-1747026120923-Sub-ConferenceAgent-1747026123042] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 14 ---
[2025-05-12T05:02:06.393Z] [6oLQ-1747026120923 Streaming] Appended 14 thoughts from ConferenceAgent. Total: 17
[2025-05-12T05:02:06.393Z] --- [6oLQ-1747026120923 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:06.394Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:06.394Z] [6oLQ-1747026120923 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 33
[2025-05-12T05:02:06.394Z] [GeminiService] Received history with 33 items before mapping (for stream).
[2025-05-12T05:02:06.394Z] [GeminiService] Mapped history (SDK Content[]) with 33 items (for stream).
[2025-05-12T05:02:06.394Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:02:06.395Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:06.395Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:06.395Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:06.395Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:06.395Z] [GeminiService Stream] Preparing stream request with 33 Content items.
[2025-05-12T05:02:06.396Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:07.139Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:02:07.140Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:07.140Z] [6oLQ-1747026120923 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:02:07.141Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:07.141Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:07.188Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:07.200Z] [6oLQ-1747026120923 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 59
[2025-05-12T05:02:07.200Z] [6oLQ-1747026120923 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 20 thoughts.
[2025-05-12T05:02:07.201Z] [6oLQ-1747026120923 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:02:07.201Z] --- [6oLQ-1747026120923 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:02:07.201Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 34
[2025-05-12T05:02:07.291Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:02:07.291Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:02:07.291Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:02:07.585Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:02:07.586Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026120923][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:02:17.693Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Kiểm tra lại danh sách lijhc của tôi","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:02:17.694Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694] Request received. UserInput: "Kiểm tra lại danh sách lijhc c...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:02:17.694Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:02:18.357Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 34
[2025-05-12T05:02:18.358Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:02:18.358Z] --- [6oLQ-1747026137694 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Kiểm tra lại danh sách lijhc của tôi", Lang: en ---
[2025-05-12T05:02:18.358Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:02:18.358Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:18.359Z] --- [6oLQ-1747026137694 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:18.359Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:18.359Z] [6oLQ-1747026137694 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 35
[2025-05-12T05:02:18.360Z] [GeminiService] Received history with 35 items before mapping (for stream).
[2025-05-12T05:02:18.360Z] [GeminiService] Mapped history (SDK Content[]) with 35 items (for stream).
[2025-05-12T05:02:18.360Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:18.360Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:18.360Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:18.361Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:18.361Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:18.361Z] [GeminiService Stream] Preparing stream request with 35 Content items.
[2025-05-12T05:02:18.361Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:19.920Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:02:19.920Z] [6oLQ-1747026137694 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:02:19.921Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:19.921Z] --- [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: daec12ae-d7a3-4567-91c4-2cc07ce5a969 ---
[2025-05-12T05:02:19.921Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:02:19.922Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:02:19.922Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:02:19.922Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:02:19.922Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:02:19.922Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:19.923Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:19.923Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:19.923Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:02:19.923Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:19.923Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:02:19.924Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:22.084Z] Model Finish Reason: STOP
[2025-05-12T05:02:22.085Z] Model requested function call: manageCalendar
[2025-05-12T05:02:22.085Z] Arguments: {"itemType":"conference","action":"list"}
[2025-05-12T05:02:22.085Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:02:22.085Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:02:22.085Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:02:22.086Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:02:22.086Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:02:22.086Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:02:22.087Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","action":"list"}, Auth: true
[2025-05-12T05:02:22.087Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:02:22.087Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: listing_calendar_items, Agent: ConferenceAgent
[2025-05-12T05:02:22.088Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: listing_calendar_items for ConferenceAgent
[2025-05-12T05:02:22.088Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:02:22.782Z] [CalendarService] [GetUserCalendarEvents] Success. Found 0 event(s) in calendar.
[2025-05-12T05:02:22.782Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: No conferences found in calendar.
[2025-05-12T05:02:22.782Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: list_success_empty_calendar, Agent: ConferenceAgent
[2025-05-12T05:02:22.783Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: list_success_empty_calendar for ConferenceAgent
[2025-05-12T05:02:22.783Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:02:22.784Z] [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:02:22.785Z] --- [6oLQ-1747026137694-Sub-ConferenceAgent-1747026139921] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-12T05:02:22.785Z] [6oLQ-1747026137694 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-12T05:02:22.785Z] --- [6oLQ-1747026137694 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:22.785Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:22.786Z] [6oLQ-1747026137694 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 37
[2025-05-12T05:02:22.786Z] [GeminiService] Received history with 37 items before mapping (for stream).
[2025-05-12T05:02:22.786Z] [GeminiService] Mapped history (SDK Content[]) with 37 items (for stream).
[2025-05-12T05:02:22.786Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:02:22.786Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:22.787Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:22.787Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:22.787Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:22.787Z] [GeminiService Stream] Preparing stream request with 37 Content items.
[2025-05-12T05:02:22.787Z]   - No valid next turn added, sending only history.
[2025-05-12T05:02:23.607Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:02:23.607Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:23.608Z] [6oLQ-1747026137694 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:02:23.608Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:23.608Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:23.624Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:02:23.682Z] [6oLQ-1747026137694 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 46
[2025-05-12T05:02:23.682Z] [6oLQ-1747026137694 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-12T05:02:23.683Z] [6oLQ-1747026137694 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:02:23.683Z] --- [6oLQ-1747026137694 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:02:23.683Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 38
[2025-05-12T05:02:23.786Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:02:23.786Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:02:23.786Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:02:24.204Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:02:24.205Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026137694][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:02:59.375Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"thêm lại vào lịch","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:02:59.375Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375] Request received. UserInput: "thêm lại vào lịch", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:02:59.376Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:02:59.516Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 38
[2025-05-12T05:02:59.516Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:02:59.516Z] --- [6oLQ-1747026179375 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "thêm lại vào lịch", Lang: en ---
[2025-05-12T05:02:59.519Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:02:59.525Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:59.534Z] --- [6oLQ-1747026179375 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:02:59.538Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:02:59.540Z] [6oLQ-1747026179375 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 39
[2025-05-12T05:02:59.543Z] [GeminiService] Received history with 39 items before mapping (for stream).
[2025-05-12T05:02:59.544Z] [GeminiService] Mapped history (SDK Content[]) with 39 items (for stream).
[2025-05-12T05:02:59.548Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:02:59.549Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:02:59.550Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:02:59.553Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:02:59.559Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:02:59.570Z] [GeminiService Stream] Preparing stream request with 39 Content items.
[2025-05-12T05:02:59.571Z]   - No valid next turn added, sending only history.
[2025-05-12T05:03:00.582Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:03:00.582Z] [6oLQ-1747026179375 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:03:00.583Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:00.584Z] --- [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: dca84f25-5789-48cd-af1f-6d0162c1f279 ---
[2025-05-12T05:03:00.584Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:03:00.584Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:03:00.585Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:03:00.585Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:03:00.585Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:03:00.585Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:03:00.585Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:03:00.586Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:03:00.586Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:03:00.586Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:03:00.586Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:03:00.586Z]   - No valid next turn added, sending only history.
[2025-05-12T05:03:01.510Z] Model Finish Reason: STOP
[2025-05-12T05:03:01.510Z] Model requested function call: manageCalendar
[2025-05-12T05:03:01.511Z] Arguments: {"itemType":"conference","action":"add","identifier":"INLG","identifierType":"acronym"}
[2025-05-12T05:03:01.512Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:03:01.512Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:03:01.512Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:03:01.513Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:03:01.514Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:03:01.514Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:03:01.514Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","action":"add","identifier":"INLG","identifierType":"acronym"}, Auth: true
[2025-05-12T05:03:01.515Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:03:01.515Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:03:01.515Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:03:01.516Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:03:01.516Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-12T05:03:01.516Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-12T05:03:01.517Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Attempting to find item ID.
[2025-05-12T05:03:01.517Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Constructed search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:03:01.517Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=INLG&perPage=1&page=1}
[2025-05-12T05:03:02.161Z] [BackendService] [conference] API Success (200). Data length: 1923. Attempting parsing...
[2025-05-12T05:03:02.162Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conference","acronym":"INLG","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Vietnam Institute for Advanced Study in Ma...
[2025-05-12T05:03:02.163Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-12T05:03:02.163Z] Transforming conference data with Markdown. Search query: acronym=INLG&perPage=1&page=1
[2025-05-12T05:03:02.165Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Natural Language Generation Conference
  - **Ac...
[2025-05-12T05:03:02.166Z] [FollowService] [FindID conference Ident:"INLG" Type:acronym] Successfully found ID: ed852ee9-43c0-41b7-9525-6e73f0c50390. Details: {"id":"ed852ee9-43c0-41b7-9525-6e73f0c50390","title":"International Natural Language Generation Conf
[2025-05-12T05:03:02.167Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-12T05:03:02.167Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-12T05:03:02.168Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-12T05:03:02.168Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-12T05:03:02.169Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:03:02.770Z] [CalendarService] [GetUserCalendarEvents] Success. Found 0 event(s) in calendar.
[2025-05-12T05:03:02.770Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-12T05:03:02.771Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-12T05:03:02.772Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: preparing_calendar_api_call, Agent: ConferenceAgent
[2025-05-12T05:03:02.772Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: preparing_calendar_api_call for ConferenceAgent
[2025-05-12T05:03:02.772Z] [CalendarService] [addCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Executing action: PUT https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/add-event
[2025-05-12T05:03:02.990Z] [CalendarService] [addCalendarEvent ID: ed852ee9-43c0-41b7-9525-6e73f0c50390] Action executed successfully.
[2025-05-12T05:03:02.990Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: API call for add successful.
[2025-05-12T05:03:02.991Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: calendar_update_success, Agent: ConferenceAgent
[2025-05-12T05:03:02.991Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: calendar_update_success for ConferenceAgent
[2025-05-12T05:03:02.991Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: Insufficient details to create calendar event for ed852ee9-43c0-41b7-9525-6e73f0c50390. Title or dates missing.
[2025-05-12T05:03:02.992Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:03:02.992Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:03:02.992Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:03:02.993Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:03:02.993Z] [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:03:02.993Z] --- [6oLQ-1747026179375-Sub-ConferenceAgent-1747026180584] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 14 ---
[2025-05-12T05:03:02.993Z] [6oLQ-1747026179375 Streaming] Appended 14 thoughts from ConferenceAgent. Total: 17
[2025-05-12T05:03:02.994Z] --- [6oLQ-1747026179375 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:03:02.994Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:02.994Z] [6oLQ-1747026179375 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 41
[2025-05-12T05:03:02.995Z] [GeminiService] Received history with 41 items before mapping (for stream).
[2025-05-12T05:03:02.996Z] [GeminiService] Mapped history (SDK Content[]) with 41 items (for stream).
[2025-05-12T05:03:02.996Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:03:02.996Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:03:02.997Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:03:02.997Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:03:02.997Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:03:02.998Z] [GeminiService Stream] Preparing stream request with 41 Content items.
[2025-05-12T05:03:02.998Z]   - No valid next turn added, sending only history.
[2025-05-12T05:03:03.755Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:03:03.755Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:03.756Z] [6oLQ-1747026179375 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:03:03.756Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:03:03.756Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:03:03.831Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:03:03.888Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:03:03.893Z] [6oLQ-1747026179375 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 157
[2025-05-12T05:03:03.894Z] [6oLQ-1747026179375 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 20 thoughts.
[2025-05-12T05:03:03.896Z] [6oLQ-1747026179375 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:03:03.896Z] --- [6oLQ-1747026179375 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:03:03.897Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 42
[2025-05-12T05:03:03.998Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:03:03.999Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:03:03.999Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:03:04.298Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:03:04.299Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026179375][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:04:24.628Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Kiểm tra lại danh sách lịch của tôi","isStreaming":true,"language":"en","conversationId":"68217d243cc24e5f2bf99474"}]
[2025-05-12T05:04:24.628Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628] Request received. UserInput: "Kiểm tra lại danh sách lịch củ...", Streaming: true, Language: en, PayloadConvId: 68217d243cc24e5f2bf99474, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:04:24.628Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Using conversationId from payload.
[2025-05-12T05:04:24.791Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Fetched current history. Count: 42
[2025-05-12T05:04:24.791Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Calling streaming intent handler.
[2025-05-12T05:04:24.792Z] --- [6oLQ-1747026264628 Socket 6oLQmlM2bjPV-BeZAAAB] Handling STREAMING input: "Kiểm tra lại danh sách lịch của tôi", Lang: en ---
[2025-05-12T05:04:24.792Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:04:24.792Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:24.793Z] --- [6oLQ-1747026264628 HostAgent Streaming Turn 1 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:04:24.793Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:24.793Z] [6oLQ-1747026264628 History T1 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 43
[2025-05-12T05:04:24.794Z] [GeminiService] Received history with 43 items before mapping (for stream).
[2025-05-12T05:04:24.794Z] [GeminiService] Mapped history (SDK Content[]) with 43 items (for stream).
[2025-05-12T05:04:24.794Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:04:24.794Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:04:24.794Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:04:24.795Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:04:24.795Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:04:24.795Z] [GeminiService Stream] Preparing stream request with 43 Content items.
[2025-05-12T05:04:24.795Z]   - No valid next turn added, sending only history.
[2025-05-12T05:04:26.051Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-12T05:04:26.052Z] [6oLQ-1747026264628 HostAgent Streaming T1 - 6oLQmlM2bjPV-BeZAAAB] Requests function: routeToAgent
[2025-05-12T05:04:26.052Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:26.053Z] --- [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 Socket 6oLQmlM2bjPV-BeZAAAB] Calling Sub Agent: ConferenceAgent, Task: 34722809-6651-4af7-b47d-d6b3c9373c92 ---
[2025-05-12T05:04:26.053Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-12T05:04:26.053Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-12T05:04:26.053Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-12T05:04:26.053Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:04:26.054Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:04:26.054Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:04:26.054Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:04:26.054Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:04:26.057Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-12T05:04:26.060Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:04:26.060Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:04:26.061Z]   - No valid next turn added, sending only history.
[2025-05-12T05:04:26.984Z] Model Finish Reason: STOP
[2025-05-12T05:04:26.984Z] Model requested function call: manageCalendar
[2025-05-12T05:04:26.985Z] Arguments: {"itemType":"conference","action":"list"}
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053] ConferenceAgent requests function call: manageCalendar
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-12T05:04:26.985Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB] Handler: ManageCalendar, Args: {"itemType":"conference","action":"list"}, Auth: true
[2025-05-12T05:04:26.986Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-12T05:04:26.987Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: listing_calendar_items, Agent: ConferenceAgent
[2025-05-12T05:04:26.988Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: listing_calendar_items for ConferenceAgent
[2025-05-12T05:04:26.988Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-12T05:04:27.836Z] [CalendarService] [GetUserCalendarEvents] Success. Found 10 event(s) in calendar.
[2025-05-12T05:04:27.837Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB] ManageCalendar: Successfully listed 10 calendar conference(s).
[2025-05-12T05:04:27.837Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: list_success_calendar, Agent: ConferenceAgent
[2025-05-12T05:04:27.838Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: list_success_calendar for ConferenceAgent
[2025-05-12T05:04:27.846Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 6oLQmlM2bjPV-BeZAAAB Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-12T05:04:27.847Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-12T05:04:27.848Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-12T05:04:27.848Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Thought Added - 6oLQmlM2bjPV-BeZAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-12T05:04:27.849Z] [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053 SubAgent Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-12T05:04:27.850Z] --- [6oLQ-1747026264628-Sub-ConferenceAgent-1747026266053] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-12T05:04:27.851Z] [6oLQ-1747026264628 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-12T05:04:27.852Z] --- [6oLQ-1747026264628 HostAgent Streaming Turn 2 Start - 6oLQmlM2bjPV-BeZAAAB] ---
[2025-05-12T05:04:27.853Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:27.854Z] [6oLQ-1747026264628 History T2 Send - 6oLQmlM2bjPV-BeZAAAB] Host History Size: 45
[2025-05-12T05:04:27.855Z] [GeminiService] Received history with 45 items before mapping (for stream).
[2025-05-12T05:04:27.856Z] [GeminiService] Mapped history (SDK Content[]) with 45 items (for stream).
[2025-05-12T05:04:27.857Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-12T05:04:27.858Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:04:27.859Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:04:27.859Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:04:27.859Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:04:27.860Z] [GeminiService Stream] Preparing stream request with 45 Content items.
[2025-05-12T05:04:27.860Z]   - No valid next turn added, sending only history.
[2025-05-12T05:04:28.640Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-12T05:04:28.641Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:28.641Z] [6oLQ-1747026264628 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Starting...
[2025-05-12T05:04:28.642Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-12T05:04:28.642Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:28.725Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:28.817Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:28.919Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:29.035Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:29.132Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-12T05:04:29.133Z] [6oLQ-1747026264628 Stream Processing - 6oLQmlM2bjPV-BeZAAAB] Finished. Length: 738
[2025-05-12T05:04:29.133Z] [6oLQ-1747026264628 6oLQmlM2bjPV-BeZAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-12T05:04:29.134Z] [6oLQ-1747026264628 Streaming Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-12T05:04:29.134Z] --- [6oLQ-1747026264628 6oLQmlM2bjPV-BeZAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:04:29.135Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Intent handler returned updated history. Attempting save. New size: 46
[2025-05-12T05:04:29.243Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Successfully updated history in DB.
[2025-05-12T05:04:29.244Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:04:29.244Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:04:29.763Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:04:29.764Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026264628][Conv:68217d243cc24e5f2bf99474] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:08:38.769Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Hello","isStreaming":false,"language":"en","conversationId":null}]
[2025-05-12T05:08:38.770Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770] Request received. UserInput: "Hello", Streaming: false, Language: en, PayloadConvId: N/A, SocketDataConvId: 68217d243cc24e5f2bf99474
[2025-05-12T05:08:38.770Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-12T05:08:38.929Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-12T05:08:38.930Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-12T05:08:38.931Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:08:39.213Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:08:39.214Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Emitted updated conversation list. Reason: new conversation from send_message, Count: 20
[2025-05-12T05:08:39.287Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Fetched current history. Count: 0
[2025-05-12T05:08:39.287Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Calling non-streaming intent handler.
[2025-05-12T05:08:39.289Z] --- [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB] Handling NON-STREAMING input: "Hello", Lang: en ---
[2025-05-12T05:08:39.289Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:08:39.290Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:39.290Z] --- [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Sending to Model (History size: 1) ---
[2025-05-12T05:08:39.290Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:39.291Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-12T05:08:39.291Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-12T05:08:39.291Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:08:39.291Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:08:39.292Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:08:39.292Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:08:39.292Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:08:39.292Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-12T05:08:39.292Z]   - No valid next turn added, sending only history.
[2025-05-12T05:08:40.127Z] Model Finish Reason: STOP
[2025-05-12T05:08:40.127Z] Model generated final text response: How can I help you today?
...
[2025-05-12T05:08:40.127Z] [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Received final_text.
[2025-05-12T05:08:40.128Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:40.128Z] [6oLQ-1747026518770 History Check - Final] Appended final HostAgent response. History size: 2
[2025-05-12T05:08:40.129Z] [6oLQ-1747026518770 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result
[2025-05-12T05:08:40.130Z] --- [6oLQ-1747026518770 Socket 6oLQmlM2bjPV-BeZAAAB Lang: en] NON-STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:08:40.130Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-12T05:08:40.203Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Successfully updated history in DB.
[2025-05-12T05:08:40.203Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:08:40.204Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:08:40.484Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:08:40.484Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026518770][Conv:682182563cc24e5f2bf99499] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:08:45.496Z] [SERVER SOCKET 6oLQmlM2bjPV-BeZAAAB - ON ANY] Event: send_message, Args: [{"userInput":"who are you ?","isStreaming":false,"language":"en","conversationId":"682182563cc24e5f2bf99499"}]
[2025-05-12T05:08:45.496Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496] Request received. UserInput: "who are you ?", Streaming: false, Language: en, PayloadConvId: 682182563cc24e5f2bf99499, SocketDataConvId: 682182563cc24e5f2bf99499
[2025-05-12T05:08:45.496Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Using conversationId from payload.
[2025-05-12T05:08:45.648Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Fetched current history. Count: 2
[2025-05-12T05:08:45.649Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Calling non-streaming intent handler.
[2025-05-12T05:08:45.649Z] --- [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB] Handling NON-STREAMING input: "who are you ?", Lang: en ---
[2025-05-12T05:08:45.649Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-12T05:08:45.650Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:45.650Z] --- [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Sending to Model (History size: 3) ---
[2025-05-12T05:08:45.651Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:45.651Z] [GeminiService] Received history with 3 items before mapping.
[2025-05-12T05:08:45.651Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 3 items.
[2025-05-12T05:08:45.652Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-12T05:08:45.652Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-12T05:08:45.652Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T05:08:45.652Z] Tools provided: ["routeToAgent"]
[2025-05-12T05:08:45.653Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-12T05:08:45.653Z] [GeminiService] Sending total 3 Content items to API.
[2025-05-12T05:08:45.653Z]   - No valid next turn added, sending only history.
[2025-05-12T05:08:47.707Z] Model Finish Reason: STOP
[2025-05-12T05:08:47.708Z] Model generated final text response: I am the HCMUS Orchestrator, an intelligent agent coordinator for the Global Conference & Journal Hub (GCJH). I route tasks to specialist agents and synthesize their responses for you.
...
[2025-05-12T05:08:47.708Z] [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB] HostAgent Turn 1: Received final_text.
[2025-05-12T05:08:47.708Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: status_update, Type: status
[2025-05-12T05:08:47.709Z] [6oLQ-1747026525496 History Check - Final] Appended final HostAgent response. History size: 4
[2025-05-12T05:08:47.709Z] [6oLQ-1747026525496 Socket Emit Sent - 6oLQmlM2bjPV-BeZAAAB] Event: chat_result, Type: result
[2025-05-12T05:08:47.709Z] --- [6oLQ-1747026525496 Socket 6oLQmlM2bjPV-BeZAAAB Lang: en] NON-STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-12T05:08:47.710Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-12T05:08:47.818Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Successfully updated history in DB.
[2025-05-12T05:08:47.818Z] [DEBUG] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-12T05:08:47.818Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:08:48.400Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:08:48.401Z] [INFO] [coreHandlers][6oLQmlM2bjPV-BeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6oLQ-1747026525496][Conv:682182563cc24e5f2bf99499] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-12T05:37:25.676Z] [SERVER GLOBAL][disconnect][Dwm3QKxpmAxi3AAyAAAB] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-12T05:37:25.823Z] [SERVER GLOBAL][disconnect][PNSKnoOarvx2rj5tAAAD] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-12T05:37:43.872Z] [socketAuth][mU91SyrEmTYSiWdwAAAF] Authentication attempt. Has token: true
[2025-05-12T05:37:43.875Z] [socketAuth][mU91SyrEmTYSiWdwAAAF] Token signature validated successfully.
[2025-05-12T05:37:43.876Z] [HistoryService] Initialized.
[2025-05-12T05:37:43.876Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF] New connection. Socket ID: mU91SyrEmTYSiWdwAAAF. Initial socket.data.userId: null
[2025-05-12T05:37:43.876Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF] Client connected, processing authentication. Has token: true
[2025-05-12T05:37:43.876Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF] Attempting to fetch user info using token...
[2025-05-12T05:37:43.876Z] [API Client] Attempting to fetch user info.
[2025-05-12T05:37:43.877Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-12T05:37:44.548Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-12T05:37:44.548Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-12T05:37:44.549Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-12T05:37:44.549Z] [HistoryService] Initialized.
[2025-05-12T05:37:44.549Z] [coreHandlers][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-12T05:37:44.550Z] [INFO] Core event handlers successfully registered.
[2025-05-12T05:37:44.550Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T05:37:44.550Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-12T05:37:44.551Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-12T05:37:44.551Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:37:44.580Z] [SERVER SOCKET mU91SyrEmTYSiWdwAAAF - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-12T05:37:44.826Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:37:44.827Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-12T05:37:44.827Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T05:37:44.827Z] [SERVER GLOBAL][connection][mU91SyrEmTYSiWdwAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-12T05:37:48.934Z] [socketAuth][o1TcrGctU2akFYnmAAAH] Authentication attempt. Has token: true
[2025-05-12T05:37:48.936Z] [socketAuth][o1TcrGctU2akFYnmAAAH] Token signature validated successfully.
[2025-05-12T05:37:48.937Z] [HistoryService] Initialized.
[2025-05-12T05:37:48.937Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH] New connection. Socket ID: o1TcrGctU2akFYnmAAAH. Initial socket.data.userId: null
[2025-05-12T05:37:48.938Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH] Client connected, processing authentication. Has token: true
[2025-05-12T05:37:48.938Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH] Attempting to fetch user info using token...
[2025-05-12T05:37:48.938Z] [API Client] Attempting to fetch user info.
[2025-05-12T05:37:48.938Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-12T05:37:49.144Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-12T05:37:49.144Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-12T05:37:49.144Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-12T05:37:49.145Z] [HistoryService] Initialized.
[2025-05-12T05:37:49.145Z] [coreHandlers][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-12T05:37:49.145Z] [INFO] Core event handlers successfully registered.
[2025-05-12T05:37:49.145Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T05:37:49.146Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-12T05:37:49.146Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-12T05:37:49.146Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-12T05:37:49.155Z] [SERVER SOCKET o1TcrGctU2akFYnmAAAH - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-12T05:37:49.399Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-12T05:37:49.400Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-12T05:37:49.400Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-12T05:37:49.400Z] [SERVER GLOBAL][connection][o1TcrGctU2akFYnmAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-12T06:25:43.333Z] [SERVER GLOBAL][disconnect][mU91SyrEmTYSiWdwAAAF] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-12T06:25:44.262Z] [SERVER GLOBAL][disconnect][o1TcrGctU2akFYnmAAAH] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-12T06:56:41.954Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-12T06:56:41.955Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-12T06:56:42.404Z] [MainLoader] Starting application loading process...
[2025-05-12T06:56:42.405Z] [DatabaseLoader] Attempting database connection...
[2025-05-12T06:56:42.406Z] [Database] Attempting MongoDB connection...
[2025-05-12T06:56:43.346Z] [Database] MongoDB Connected Successfully.
[2025-05-12T06:56:43.346Z] [DatabaseLoader] Database connection successful.
[2025-05-12T06:56:43.346Z] [MainLoader] Database loaded.
[2025-05-12T06:56:43.347Z] [MainLoader] Services will be managed by DI container.
[2025-05-12T06:56:43.347Z] [ExpressLoader] Configuring Express app...
[2025-05-12T06:56:43.352Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-12T06:56:43.355Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-12T06:56:43.355Z] [ExpressLoader] Registered Not Found handler.
[2025-05-12T06:56:43.355Z] [ExpressLoader] Registered Global Error handler.
[2025-05-12T06:56:43.356Z] [ExpressLoader] Express app configured successfully.
[2025-05-12T06:56:43.357Z] [MainLoader] Express loaded.
[2025-05-12T06:56:43.357Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-12T06:56:43.362Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-12T06:56:43.362Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-12T06:56:43.362Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-12T06:56:43.363Z] [MainLoader] Socket.IO loaded.
[2025-05-12T06:56:43.363Z] [JobsLoader] Scheduling background jobs...
[2025-05-12T06:56:43.398Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-12T06:56:43.398Z] [MainLoader] Jobs scheduled.
[2025-05-12T06:56:43.398Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-12T06:56:43.445Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-12T06:56:43.445Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T00:53:58.781Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T00:53:58.782Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T00:53:59.227Z] [MainLoader] Starting application loading process...
[2025-05-13T00:53:59.228Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T00:53:59.236Z] [Database] Attempting MongoDB connection...
[2025-05-13T00:54:00.177Z] [Database] MongoDB Connected Successfully.
[2025-05-13T00:54:00.178Z] [DatabaseLoader] Database connection successful.
[2025-05-13T00:54:00.178Z] [MainLoader] Database loaded.
[2025-05-13T00:54:00.178Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T00:54:00.178Z] [ExpressLoader] Configuring Express app...
[2025-05-13T00:54:00.184Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T00:54:00.186Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T00:54:00.187Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T00:54:00.187Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T00:54:00.187Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T00:54:00.188Z] [MainLoader] Express loaded.
[2025-05-13T00:54:00.188Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T00:54:00.193Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T00:54:00.194Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T00:54:00.194Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T00:54:00.194Z] [MainLoader] Socket.IO loaded.
[2025-05-13T00:54:00.195Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T00:54:00.318Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T00:54:00.319Z] [MainLoader] Jobs scheduled.
[2025-05-13T00:54:00.319Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T00:54:00.466Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T00:54:00.472Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T00:56:15.800Z] [socketAuth][Shsn2abtZr5Q0KINAAAB] Authentication attempt. Has token: true
[2025-05-13T00:56:15.807Z] [socketAuth][Shsn2abtZr5Q0KINAAAB] Token signature validated successfully.
[2025-05-13T00:56:15.812Z] [HistoryService] Initialized.
[2025-05-13T00:56:15.812Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB] New connection. Socket ID: Shsn2abtZr5Q0KINAAAB. Initial socket.data.userId: null
[2025-05-13T00:56:15.812Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T00:56:15.813Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB] Attempting to fetch user info using token...
[2025-05-13T00:56:15.814Z] [API Client] Attempting to fetch user info.
[2025-05-13T00:56:15.814Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T00:56:17.327Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T00:56:17.327Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T00:56:17.328Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T00:56:17.329Z] [HistoryService] Initialized.
[2025-05-13T00:56:17.330Z] [coreHandlers][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T00:56:17.330Z] [INFO] Core event handlers successfully registered.
[2025-05-13T00:56:17.330Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T00:56:17.331Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T00:56:17.332Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T00:56:17.333Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T00:56:17.387Z] [SERVER SOCKET Shsn2abtZr5Q0KINAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T00:56:17.646Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T00:56:17.647Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-13T00:56:17.648Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T00:56:17.648Z] [SERVER GLOBAL][connection][Shsn2abtZr5Q0KINAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T00:57:16.537Z] [SERVER GLOBAL][disconnect][Shsn2abtZr5Q0KINAAAB] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T01:20:31.423Z] [socketAuth][TJHWWCgnh0gV2F5UAAAD] Authentication attempt. Has token: true
[2025-05-13T01:20:31.428Z] [socketAuth][TJHWWCgnh0gV2F5UAAAD] Token signature validated successfully.
[2025-05-13T01:20:31.429Z] [HistoryService] Initialized.
[2025-05-13T01:20:31.429Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD] New connection. Socket ID: TJHWWCgnh0gV2F5UAAAD. Initial socket.data.userId: null
[2025-05-13T01:20:31.430Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD] Client connected, processing authentication. Has token: true
[2025-05-13T01:20:31.430Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD] Attempting to fetch user info using token...
[2025-05-13T01:20:31.430Z] [API Client] Attempting to fetch user info.
[2025-05-13T01:20:31.431Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T01:20:32.131Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T01:20:32.131Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T01:20:32.132Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T01:20:32.132Z] [HistoryService] Initialized.
[2025-05-13T01:20:32.132Z] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T01:20:32.132Z] [INFO] Core event handlers successfully registered.
[2025-05-13T01:20:32.132Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T01:20:32.132Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T01:20:32.133Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T01:20:32.133Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:20:32.195Z] [SERVER SOCKET TJHWWCgnh0gV2F5UAAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T01:20:32.382Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:20:32.383Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 20
[2025-05-13T01:20:32.384Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T01:20:32.385Z] [SERVER GLOBAL][connection][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T01:26:29.830Z] [SERVER SOCKET TJHWWCgnh0gV2F5UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"List some AI conferences in Asia.","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T01:26:29.832Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831] Request received. UserInput: "List some AI conferences in As...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T01:26:29.832Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T01:26:30.040Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T01:26:30.041Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T01:26:30.041Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:26:30.380Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:26:30.382Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Emitted updated conversation list. Reason: new conversation from send_message, Count: 20
[2025-05-13T01:26:30.463Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Fetched current history. Count: 0
[2025-05-13T01:26:30.464Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Calling streaming intent handler.
[2025-05-13T01:26:30.466Z] --- [TJHW-1747099589831 Socket TJHWWCgnh0gV2F5UAAAD] Handling STREAMING input: "List some AI conferences in Asia.", Lang: en ---
[2025-05-13T01:26:30.467Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T01:26:30.468Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:30.469Z] --- [TJHW-1747099589831 HostAgent Streaming Turn 1 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:26:30.469Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:30.469Z] [TJHW-1747099589831 History T1 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 1
[2025-05-13T01:26:30.472Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T01:26:30.472Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T01:26:30.472Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:26:30.473Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:26:30.473Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:26:30.473Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:26:30.473Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:26:30.474Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T01:26:30.474Z]   - No valid next turn added, sending only history.
[2025-05-13T01:26:31.618Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T01:26:31.618Z] [TJHW-1747099589831 HostAgent Streaming T1 - TJHWWCgnh0gV2F5UAAAD] Requests function: routeToAgent
[2025-05-13T01:26:31.619Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:31.622Z] --- [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 Socket TJHWWCgnh0gV2F5UAAAD] Calling Sub Agent: ConferenceAgent, Task: a55a2ee4-3363-4e34-a727-63f834a0d101 ---
[2025-05-13T01:26:31.622Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T01:26:31.623Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T01:26:31.623Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T01:26:31.624Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T01:26:31.625Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T01:26:31.625Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:26:31.625Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:26:31.625Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:26:31.626Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T01:26:31.626Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:26:31.626Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T01:26:31.627Z]   - No valid next turn added, sending only history.
[2025-05-13T01:26:33.558Z] Model Finish Reason: STOP
[2025-05-13T01:26:33.558Z] Model requested function call: getConferences
[2025-05-13T01:26:33.558Z] Arguments: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T01:26:33.559Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T01:26:33.559Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622] ConferenceAgent requests function call: getConferences
[2025-05-13T01:26:33.560Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T01:26:33.560Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T01:26:33.561Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T01:26:33.561Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T01:26:33.562Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T01:26:33.563Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:26:33.563Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:26:33.563Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T01:26:33.564Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:26:33.564Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:26:33.564Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T01:26:33.566Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=AI&continent=Asia&perPage=5&page=1}
[2025-05-13T01:26:34.340Z] [BackendService] [conference] API Success (200). Data length: 10310. Attempting parsing...
[2025-05-13T01:26:34.341Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"287aa165-fdd4-41aa-9860-10d161bf15cc","title":"International Symposium on Search Based Software Engineering","acronym":"SSBSE","location":{"cityStateProvince":"Seoul","country":"South Korea","address":"Seoul, South Korea","continen...
[2025-05-13T01:26:34.341Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T01:26:34.343Z] Transforming conference data with Markdown. Search query: topics=AI&continent=Asia&perPage=5&page=1
[2025-05-13T01:26:34.356Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 5
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Symposium on Search Based Software Engineering
...
[2025-05-13T01:26:34.357Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=AI&continent=Asia&perPage=5&page=1"
[2025-05-13T01:26:34.357Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:26:34.357Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:26:34.358Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T01:26:34.358Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:26:34.358Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:26:34.359Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T01:26:34.359Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:26:34.359Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:26:34.360Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T01:26:34.360Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T01:26:34.360Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T01:26:34.360Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T01:26:34.361Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T01:26:34.361Z] [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T01:26:34.361Z] --- [TJHW-1747099589831-Sub-ConferenceAgent-1747099591622] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T01:26:34.362Z] [TJHW-1747099589831 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T01:26:34.362Z] --- [TJHW-1747099589831 HostAgent Streaming Turn 2 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:26:34.362Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:34.362Z] [TJHW-1747099589831 History T2 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 3
[2025-05-13T01:26:34.362Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T01:26:34.363Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T01:26:34.363Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T01:26:34.363Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:26:34.363Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:26:34.363Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:26:34.363Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:26:34.364Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T01:26:34.364Z]   - No valid next turn added, sending only history.
[2025-05-13T01:26:35.054Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T01:26:35.055Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:35.056Z] [TJHW-1747099589831 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Starting...
[2025-05-13T01:26:35.056Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:35.057Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:35.107Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:35.224Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:35.385Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:35.514Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:35.722Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:35.733Z] [TJHW-1747099589831 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Finished. Length: 365
[2025-05-13T01:26:35.734Z] [TJHW-1747099589831 TJHWWCgnh0gV2F5UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T01:26:35.735Z] [TJHW-1747099589831 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T01:26:35.735Z] --- [TJHW-1747099589831 TJHWWCgnh0gV2F5UAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T01:26:35.735Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T01:26:35.829Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Successfully updated history in DB.
[2025-05-13T01:26:35.829Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T01:26:35.830Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:26:36.104Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:26:36.105Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099589831][Conv:68229fc53ab2b800805a80ba] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-13T01:26:49.711Z] [SERVER SOCKET TJHWWCgnh0gV2F5UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"IC3K tổ chức ở đâu","isStreaming":true,"language":"en","conversationId":"68229fc53ab2b800805a80ba"}]
[2025-05-13T01:26:49.712Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712] Request received. UserInput: "IC3K tổ chức ở đâu", Streaming: true, Language: en, PayloadConvId: 68229fc53ab2b800805a80ba, SocketDataConvId: 68229fc53ab2b800805a80ba
[2025-05-13T01:26:49.712Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Using conversationId from payload.
[2025-05-13T01:26:49.773Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Fetched current history. Count: 4
[2025-05-13T01:26:49.774Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Calling streaming intent handler.
[2025-05-13T01:26:49.774Z] --- [TJHW-1747099609712 Socket TJHWWCgnh0gV2F5UAAAD] Handling STREAMING input: "IC3K tổ chức ở đâu", Lang: en ---
[2025-05-13T01:26:49.775Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T01:26:49.776Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:49.777Z] --- [TJHW-1747099609712 HostAgent Streaming Turn 1 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:26:49.778Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:49.779Z] [TJHW-1747099609712 History T1 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 5
[2025-05-13T01:26:49.780Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T01:26:49.780Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T01:26:49.780Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:26:49.780Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:26:49.780Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:26:49.781Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:26:49.784Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:26:49.784Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T01:26:49.785Z]   - No valid next turn added, sending only history.
[2025-05-13T01:26:50.702Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T01:26:50.703Z] [TJHW-1747099609712 HostAgent Streaming T1 - TJHWWCgnh0gV2F5UAAAD] Requests function: routeToAgent
[2025-05-13T01:26:50.704Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:50.704Z] --- [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 Socket TJHWWCgnh0gV2F5UAAAD] Calling Sub Agent: ConferenceAgent, Task: 25925353-cb84-4ed4-bffa-7498be653338 ---
[2025-05-13T01:26:50.704Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T01:26:50.705Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T01:26:50.707Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T01:26:50.708Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T01:26:50.709Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T01:26:50.709Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:26:50.710Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:26:50.711Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:26:50.711Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T01:26:50.712Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:26:50.712Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T01:26:50.712Z]   - No valid next turn added, sending only history.
[2025-05-13T01:26:52.599Z] Model Finish Reason: STOP
[2025-05-13T01:26:52.599Z] Model requested function call: getConferences
[2025-05-13T01:26:52.599Z] Arguments: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:26:52.599Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T01:26:52.600Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704] ConferenceAgent requests function call: getConferences
[2025-05-13T01:26:52.600Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T01:26:52.600Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T01:26:52.601Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T01:26:52.601Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T01:26:52.601Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:26:52.601Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:26:52.602Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:26:52.602Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T01:26:52.602Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:26:52.602Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:26:52.603Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T01:26:52.603Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=IC3K&perPage=5&page=1}
[2025-05-13T01:26:53.309Z] [BackendService] [conference] API Success (200). Data length: 983. Attempting parsing...
[2025-05-13T01:26:53.310Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"6ebe9334-c7b0-447c-adee-2f856c564bf3","title":"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management","acronym":"IC3K","location":{"cityStateProvince":"","country":"","address":"Avail...
[2025-05-13T01:26:53.310Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T01:26:53.310Z] Transforming conference data with Markdown. Search query: acronym=IC3K&perPage=5&page=1
[2025-05-13T01:26:53.313Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Joint Conference on Knowledge Discovery, Knowle...
[2025-05-13T01:26:53.313Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=IC3K&perPage=5&page=1"
[2025-05-13T01:26:53.313Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:26:53.313Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:26:53.314Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T01:26:53.314Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:26:53.314Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:26:53.315Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T01:26:53.315Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:26:53.315Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:26:53.316Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T01:26:53.316Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T01:26:53.316Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T01:26:53.316Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T01:26:53.317Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T01:26:53.317Z] [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T01:26:53.317Z] --- [TJHW-1747099609712-Sub-ConferenceAgent-1747099610704] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T01:26:53.317Z] [TJHW-1747099609712 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T01:26:53.317Z] --- [TJHW-1747099609712 HostAgent Streaming Turn 2 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:26:53.318Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:53.318Z] [TJHW-1747099609712 History T2 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 7
[2025-05-13T01:26:53.318Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T01:26:53.318Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T01:26:53.319Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T01:26:53.319Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:26:53.319Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:26:53.319Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:26:53.320Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:26:53.320Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T01:26:53.320Z]   - No valid next turn added, sending only history.
[2025-05-13T01:26:53.961Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T01:26:53.962Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:53.963Z] [TJHW-1747099609712 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Starting...
[2025-05-13T01:26:53.963Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:26:53.963Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:54.111Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:26:54.121Z] [TJHW-1747099609712 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Finished. Length: 66
[2025-05-13T01:26:54.121Z] [TJHW-1747099609712 TJHWWCgnh0gV2F5UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T01:26:54.122Z] [TJHW-1747099609712 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T01:26:54.122Z] --- [TJHW-1747099609712 TJHWWCgnh0gV2F5UAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T01:26:54.122Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T01:26:54.197Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Successfully updated history in DB.
[2025-05-13T01:26:54.198Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T01:26:54.198Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:26:54.455Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:26:54.456Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099609712][Conv:68229fc53ab2b800805a80ba] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-13T01:27:07.297Z] [SERVER SOCKET TJHWWCgnh0gV2F5UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Hình thức","isStreaming":true,"language":"en","conversationId":"68229fc53ab2b800805a80ba"}]
[2025-05-13T01:27:07.298Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298] Request received. UserInput: "Hình thức", Streaming: true, Language: en, PayloadConvId: 68229fc53ab2b800805a80ba, SocketDataConvId: 68229fc53ab2b800805a80ba
[2025-05-13T01:27:07.298Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Using conversationId from payload.
[2025-05-13T01:27:07.360Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Fetched current history. Count: 8
[2025-05-13T01:27:07.361Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Calling streaming intent handler.
[2025-05-13T01:27:07.361Z] --- [TJHW-1747099627298 Socket TJHWWCgnh0gV2F5UAAAD] Handling STREAMING input: "Hình thức", Lang: en ---
[2025-05-13T01:27:07.361Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T01:27:07.362Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:07.362Z] --- [TJHW-1747099627298 HostAgent Streaming Turn 1 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:27:07.363Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:07.363Z] [TJHW-1747099627298 History T1 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 9
[2025-05-13T01:27:07.363Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T01:27:07.363Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T01:27:07.364Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:27:07.364Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:07.364Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:07.364Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:27:07.365Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:07.365Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T01:27:07.365Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:08.378Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T01:27:08.378Z] [TJHW-1747099627298 HostAgent Streaming T1 - TJHWWCgnh0gV2F5UAAAD] Requests function: routeToAgent
[2025-05-13T01:27:08.380Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:08.380Z] --- [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 Socket TJHWWCgnh0gV2F5UAAAD] Calling Sub Agent: ConferenceAgent, Task: 36d13276-c2ed-41d2-bc0e-e8594574b8ce ---
[2025-05-13T01:27:08.380Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T01:27:08.381Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T01:27:08.381Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T01:27:08.382Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T01:27:08.382Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T01:27:08.382Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:27:08.383Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:08.383Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:08.383Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T01:27:08.384Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:08.384Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T01:27:08.384Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:09.172Z] Model Finish Reason: STOP
[2025-05-13T01:27:09.173Z] Model requested function call: getConferences
[2025-05-13T01:27:09.173Z] Arguments: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:27:09.173Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T01:27:09.173Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380] ConferenceAgent requests function call: getConferences
[2025-05-13T01:27:09.176Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T01:27:09.176Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T01:27:09.177Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T01:27:09.178Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T01:27:09.178Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:27:09.178Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:27:09.179Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:27:09.179Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T01:27:09.180Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:27:09.180Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:27:09.181Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T01:27:09.181Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=IC3K&perPage=5&page=1}
[2025-05-13T01:27:09.827Z] [BackendService] [conference] API Success (200). Data length: 983. Attempting parsing...
[2025-05-13T01:27:09.828Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"6ebe9334-c7b0-447c-adee-2f856c564bf3","title":"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management","acronym":"IC3K","location":{"cityStateProvince":"","country":"","address":"Avail...
[2025-05-13T01:27:09.828Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T01:27:09.828Z] Transforming conference data with Markdown. Search query: acronym=IC3K&perPage=5&page=1
[2025-05-13T01:27:09.830Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Joint Conference on Knowledge Discovery, Knowle...
[2025-05-13T01:27:09.831Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=IC3K&perPage=5&page=1"
[2025-05-13T01:27:09.831Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:27:09.831Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:27:09.832Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T01:27:09.832Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:27:09.833Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:27:09.833Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T01:27:09.833Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:27:09.833Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:27:09.834Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T01:27:09.834Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T01:27:09.834Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T01:27:09.834Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T01:27:09.835Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T01:27:09.835Z] [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T01:27:09.836Z] --- [TJHW-1747099627298-Sub-ConferenceAgent-1747099628380] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T01:27:09.836Z] [TJHW-1747099627298 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T01:27:09.836Z] --- [TJHW-1747099627298 HostAgent Streaming Turn 2 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:27:09.837Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:09.837Z] [TJHW-1747099627298 History T2 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 11
[2025-05-13T01:27:09.837Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T01:27:09.837Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T01:27:09.837Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T01:27:09.838Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:09.838Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:09.838Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:27:09.838Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:09.839Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T01:27:09.840Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:10.508Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T01:27:10.509Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:10.509Z] [TJHW-1747099627298 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Starting...
[2025-05-13T01:27:10.510Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:10.510Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:10.584Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:10.597Z] [TJHW-1747099627298 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Finished. Length: 61
[2025-05-13T01:27:10.597Z] [TJHW-1747099627298 TJHWWCgnh0gV2F5UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T01:27:10.598Z] [TJHW-1747099627298 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T01:27:10.598Z] --- [TJHW-1747099627298 TJHWWCgnh0gV2F5UAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T01:27:10.599Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T01:27:10.676Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Successfully updated history in DB.
[2025-05-13T01:27:10.676Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T01:27:10.676Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:27:10.938Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:27:10.939Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099627298][Conv:68229fc53ab2b800805a80ba] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-13T01:27:17.285Z] [SERVER SOCKET TJHWWCgnh0gV2F5UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"CHủ đề","isStreaming":true,"language":"en","conversationId":"68229fc53ab2b800805a80ba"}]
[2025-05-13T01:27:17.285Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285] Request received. UserInput: "CHủ đề", Streaming: true, Language: en, PayloadConvId: 68229fc53ab2b800805a80ba, SocketDataConvId: 68229fc53ab2b800805a80ba
[2025-05-13T01:27:17.286Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Using conversationId from payload.
[2025-05-13T01:27:17.355Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Fetched current history. Count: 12
[2025-05-13T01:27:17.355Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Calling streaming intent handler.
[2025-05-13T01:27:17.355Z] --- [TJHW-1747099637285 Socket TJHWWCgnh0gV2F5UAAAD] Handling STREAMING input: "CHủ đề", Lang: en ---
[2025-05-13T01:27:17.355Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T01:27:17.356Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:17.356Z] --- [TJHW-1747099637285 HostAgent Streaming Turn 1 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:27:17.357Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:17.358Z] [TJHW-1747099637285 History T1 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 13
[2025-05-13T01:27:17.358Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T01:27:17.359Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T01:27:17.359Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:27:17.359Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:17.360Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:17.360Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:27:17.360Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:17.360Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T01:27:17.361Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:18.315Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T01:27:18.315Z] [TJHW-1747099637285 HostAgent Streaming T1 - TJHWWCgnh0gV2F5UAAAD] Requests function: routeToAgent
[2025-05-13T01:27:18.316Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:18.319Z] --- [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 Socket TJHWWCgnh0gV2F5UAAAD] Calling Sub Agent: ConferenceAgent, Task: 6b1cb1ff-b600-4107-b446-1657c0510156 ---
[2025-05-13T01:27:18.320Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T01:27:18.321Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T01:27:18.322Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T01:27:18.323Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T01:27:18.327Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T01:27:18.329Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:27:18.329Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:18.330Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:18.331Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T01:27:18.332Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:18.332Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T01:27:18.333Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:19.177Z] Model Finish Reason: STOP
[2025-05-13T01:27:19.178Z] Model requested function call: getConferences
[2025-05-13T01:27:19.178Z] Arguments: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:27:19.178Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T01:27:19.178Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319] ConferenceAgent requests function call: getConferences
[2025-05-13T01:27:19.179Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T01:27:19.179Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T01:27:19.179Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T01:27:19.180Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T01:27:19.180Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:27:19.180Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:27:19.180Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:27:19.181Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T01:27:19.181Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:27:19.181Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:27:19.182Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T01:27:19.182Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=IC3K&perPage=5&page=1}
[2025-05-13T01:27:19.872Z] [BackendService] [conference] API Success (200). Data length: 983. Attempting parsing...
[2025-05-13T01:27:19.873Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"6ebe9334-c7b0-447c-adee-2f856c564bf3","title":"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management","acronym":"IC3K","location":{"cityStateProvince":"","country":"","address":"Avail...
[2025-05-13T01:27:19.873Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T01:27:19.874Z] Transforming conference data with Markdown. Search query: acronym=IC3K&perPage=5&page=1
[2025-05-13T01:27:19.877Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Joint Conference on Knowledge Discovery, Knowle...
[2025-05-13T01:27:19.877Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=IC3K&perPage=5&page=1"
[2025-05-13T01:27:19.878Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:27:19.878Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:27:19.878Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T01:27:19.879Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:27:19.879Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:27:19.879Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T01:27:19.879Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:27:19.879Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:27:19.880Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T01:27:19.880Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T01:27:19.880Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T01:27:19.880Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T01:27:19.881Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T01:27:19.881Z] [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T01:27:19.881Z] --- [TJHW-1747099637285-Sub-ConferenceAgent-1747099638319] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T01:27:19.882Z] [TJHW-1747099637285 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T01:27:19.882Z] --- [TJHW-1747099637285 HostAgent Streaming Turn 2 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:27:19.882Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:19.882Z] [TJHW-1747099637285 History T2 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 15
[2025-05-13T01:27:19.882Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T01:27:19.883Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T01:27:19.883Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T01:27:19.883Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:19.883Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:19.883Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:27:19.883Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:19.884Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T01:27:19.884Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:20.638Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T01:27:20.639Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:20.639Z] [TJHW-1747099637285 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Starting...
[2025-05-13T01:27:20.639Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:20.641Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:20.695Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:20.735Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:20.749Z] [TJHW-1747099637285 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Finished. Length: 109
[2025-05-13T01:27:20.750Z] [TJHW-1747099637285 TJHWWCgnh0gV2F5UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T01:27:20.751Z] [TJHW-1747099637285 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T01:27:20.751Z] --- [TJHW-1747099637285 TJHWWCgnh0gV2F5UAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T01:27:20.751Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Intent handler returned updated history. Attempting save. New size: 16
[2025-05-13T01:27:20.828Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Successfully updated history in DB.
[2025-05-13T01:27:20.828Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T01:27:20.828Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:27:21.080Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:27:21.081Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099637285][Conv:68229fc53ab2b800805a80ba] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-13T01:27:29.209Z] [SERVER SOCKET TJHWWCgnh0gV2F5UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Call for papers","isStreaming":true,"language":"en","conversationId":"68229fc53ab2b800805a80ba"}]
[2025-05-13T01:27:29.209Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209] Request received. UserInput: "Call for papers", Streaming: true, Language: en, PayloadConvId: 68229fc53ab2b800805a80ba, SocketDataConvId: 68229fc53ab2b800805a80ba
[2025-05-13T01:27:29.210Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Using conversationId from payload.
[2025-05-13T01:27:29.271Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Fetched current history. Count: 16
[2025-05-13T01:27:29.272Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Calling streaming intent handler.
[2025-05-13T01:27:29.272Z] --- [TJHW-1747099649209 Socket TJHWWCgnh0gV2F5UAAAD] Handling STREAMING input: "Call for papers", Lang: en ---
[2025-05-13T01:27:29.272Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T01:27:29.273Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:29.274Z] --- [TJHW-1747099649209 HostAgent Streaming Turn 1 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:27:29.274Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:29.275Z] [TJHW-1747099649209 History T1 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 17
[2025-05-13T01:27:29.275Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T01:27:29.275Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T01:27:29.276Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:27:29.276Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:29.276Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:29.277Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:27:29.277Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:29.277Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T01:27:29.277Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:30.089Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T01:27:30.089Z] [TJHW-1747099649209 HostAgent Streaming T1 - TJHWWCgnh0gV2F5UAAAD] Requests function: routeToAgent
[2025-05-13T01:27:30.090Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:30.091Z] --- [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 Socket TJHWWCgnh0gV2F5UAAAD] Calling Sub Agent: ConferenceAgent, Task: 6847e840-220d-473f-b275-a3b94f42e115 ---
[2025-05-13T01:27:30.091Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T01:27:30.092Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T01:27:30.092Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T01:27:30.092Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T01:27:30.093Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T01:27:30.093Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T01:27:30.093Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:30.093Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:30.094Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T01:27:30.094Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:30.094Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T01:27:30.094Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:30.852Z] Model Finish Reason: STOP
[2025-05-13T01:27:30.853Z] Model requested function call: getConferences
[2025-05-13T01:27:30.853Z] Arguments: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:27:30.853Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T01:27:30.853Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091] ConferenceAgent requests function call: getConferences
[2025-05-13T01:27:30.853Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T01:27:30.854Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T01:27:30.854Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T01:27:30.854Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T01:27:30.855Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=IC3K&perPage=5&page=1"}
[2025-05-13T01:27:30.855Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:27:30.855Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T01:27:30.855Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T01:27:30.856Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:27:30.856Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T01:27:30.857Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T01:27:30.858Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=IC3K&perPage=5&page=1}
[2025-05-13T01:27:31.531Z] [BackendService] [conference] API Success (200). Data length: 983. Attempting parsing...
[2025-05-13T01:27:31.531Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"6ebe9334-c7b0-447c-adee-2f856c564bf3","title":"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management","acronym":"IC3K","location":{"cityStateProvince":"","country":"","address":"Avail...
[2025-05-13T01:27:31.531Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T01:27:31.531Z] Transforming conference data with Markdown. Search query: acronym=IC3K&perPage=5&page=1
[2025-05-13T01:27:31.534Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Joint Conference on Knowledge Discovery, Knowle...
[2025-05-13T01:27:31.534Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=IC3K&perPage=5&page=1"
[2025-05-13T01:27:31.535Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:27:31.535Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T01:27:31.536Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T01:27:31.536Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:27:31.536Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T01:27:31.536Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T01:27:31.537Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:27:31.537Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T01:27:31.537Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T01:27:31.537Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 TJHWWCgnh0gV2F5UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T01:27:31.538Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T01:27:31.538Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T01:27:31.538Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Thought Added - TJHWWCgnh0gV2F5UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T01:27:31.539Z] [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091 SubAgent Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T01:27:31.539Z] --- [TJHW-1747099649209-Sub-ConferenceAgent-1747099650091] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T01:27:31.539Z] [TJHW-1747099649209 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T01:27:31.540Z] --- [TJHW-1747099649209 HostAgent Streaming Turn 2 Start - TJHWWCgnh0gV2F5UAAAD] ---
[2025-05-13T01:27:31.541Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:31.541Z] [TJHW-1747099649209 History T2 Send - TJHWWCgnh0gV2F5UAAAD] Host History Size: 19
[2025-05-13T01:27:31.542Z] [GeminiService] Received history with 19 items before mapping (for stream).
[2025-05-13T01:27:31.542Z] [GeminiService] Mapped history (SDK Content[]) with 19 items (for stream).
[2025-05-13T01:27:31.542Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T01:27:31.542Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T01:27:31.542Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T01:27:31.542Z] Tools provided: ["routeToAgent"]
[2025-05-13T01:27:31.543Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T01:27:31.543Z] [GeminiService Stream] Preparing stream request with 19 Content items.
[2025-05-13T01:27:31.543Z]   - No valid next turn added, sending only history.
[2025-05-13T01:27:32.131Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T01:27:32.132Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:32.133Z] [TJHW-1747099649209 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Starting...
[2025-05-13T01:27:32.133Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T01:27:32.133Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:32.231Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:32.326Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:32.433Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T01:27:32.441Z] [TJHW-1747099649209 Stream Processing - TJHWWCgnh0gV2F5UAAAD] Finished. Length: 213
[2025-05-13T01:27:32.442Z] [TJHW-1747099649209 TJHWWCgnh0gV2F5UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T01:27:32.443Z] [TJHW-1747099649209 Streaming Emit Sent - TJHWWCgnh0gV2F5UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T01:27:32.443Z] --- [TJHW-1747099649209 TJHWWCgnh0gV2F5UAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T01:27:32.444Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Intent handler returned updated history. Attempting save. New size: 20
[2025-05-13T01:27:32.521Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Successfully updated history in DB.
[2025-05-13T01:27:32.521Z] [DEBUG] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T01:27:32.522Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T01:27:32.781Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 20 conversations.
[2025-05-13T01:27:32.782Z] [INFO] [coreHandlers][TJHWWCgnh0gV2F5UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:TJHW-1747099649209][Conv:68229fc53ab2b800805a80ba] Emitted updated conversation list. Reason: message saved, Count: 20
[2025-05-13T01:40:05.883Z] [SERVER GLOBAL][disconnect][TJHWWCgnh0gV2F5UAAAD] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: 68229fc53ab2b800805a80ba
[2025-05-13T02:05:13.750Z] [socketAuth][X0Uux6p0AziGICJoAAAF] Authentication attempt. Has token: true
[2025-05-13T02:05:13.754Z] [socketAuth][X0Uux6p0AziGICJoAAAF] Token signature validated successfully.
[2025-05-13T02:05:13.755Z] [HistoryService] Initialized.
[2025-05-13T02:05:13.755Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF] New connection. Socket ID: X0Uux6p0AziGICJoAAAF. Initial socket.data.userId: null
[2025-05-13T02:05:13.755Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF] Client connected, processing authentication. Has token: true
[2025-05-13T02:05:13.756Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF] Attempting to fetch user info using token...
[2025-05-13T02:05:13.756Z] [API Client] Attempting to fetch user info.
[2025-05-13T02:05:13.756Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T02:05:14.439Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T02:05:14.440Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T02:05:14.440Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T02:05:14.440Z] [HistoryService] Initialized.
[2025-05-13T02:05:14.440Z] [coreHandlers][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T02:05:14.440Z] [INFO] Core event handlers successfully registered.
[2025-05-13T02:05:14.441Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T02:05:14.441Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T02:05:14.441Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T02:05:14.441Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:05:14.681Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T02:05:14.682Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T02:05:14.682Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T02:05:14.682Z] [SERVER GLOBAL][connection][X0Uux6p0AziGICJoAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T02:05:14.687Z] [SERVER SOCKET X0Uux6p0AziGICJoAAAF - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T02:08:51.607Z] [SERVER GLOBAL][disconnect][X0Uux6p0AziGICJoAAAF] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T02:08:55.174Z] [socketAuth][iMKO9E-ypIEYbt8aAAAH] Authentication attempt. Has token: true
[2025-05-13T02:08:55.214Z] [socketAuth][iMKO9E-ypIEYbt8aAAAH] Token signature validated successfully.
[2025-05-13T02:08:55.215Z] [HistoryService] Initialized.
[2025-05-13T02:08:55.215Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH] New connection. Socket ID: iMKO9E-ypIEYbt8aAAAH. Initial socket.data.userId: null
[2025-05-13T02:08:55.215Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH] Client connected, processing authentication. Has token: true
[2025-05-13T02:08:55.216Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH] Attempting to fetch user info using token...
[2025-05-13T02:08:55.216Z] [API Client] Attempting to fetch user info.
[2025-05-13T02:08:55.216Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T02:08:55.902Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T02:08:55.903Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T02:08:55.903Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T02:08:55.903Z] [HistoryService] Initialized.
[2025-05-13T02:08:55.903Z] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T02:08:55.904Z] [INFO] Core event handlers successfully registered.
[2025-05-13T02:08:55.904Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T02:08:55.905Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T02:08:55.905Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T02:08:55.905Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:08:56.136Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T02:08:56.137Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T02:08:56.137Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T02:08:56.138Z] [SERVER GLOBAL][connection][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T02:08:56.236Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T02:28:10.566Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Send feedback to the admin.","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T02:28:10.567Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566] Request received. UserInput: "Send feedback to the admin.", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T02:28:10.567Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T02:28:11.068Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T02:28:11.070Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T02:28:11.070Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:28:11.303Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T02:28:11.304Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T02:28:11.555Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Fetched current history. Count: 0
[2025-05-13T02:28:11.555Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Calling streaming intent handler.
[2025-05-13T02:28:11.558Z] --- [iMKO-1747103290566 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Send feedback to the admin.", Lang: en ---
[2025-05-13T02:28:11.559Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:28:11.578Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:11.579Z] --- [iMKO-1747103290566 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:28:11.579Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:11.580Z] [iMKO-1747103290566 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 1
[2025-05-13T02:28:11.583Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T02:28:11.584Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T02:28:11.584Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:28:11.584Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:28:11.584Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:28:11.585Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:28:11.585Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:28:11.586Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T02:28:11.586Z]   - No valid next turn added, sending only history.
[2025-05-13T02:28:13.393Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:28:13.394Z] [iMKO-1747103290566 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:28:13.394Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:13.396Z] --- [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: AdminContactAgent, Task: 8f6c3cb9-d283-4a9e-95f7-9a5810d938a8 ---
[2025-05-13T02:28:13.396Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: en
[2025-05-13T02:28:13.397Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T02:28:13.397Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T02:28:13.397Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:28:13.398Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:28:13.399Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:28:13.399Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:28:13.399Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:28:13.400Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T02:28:13.400Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:28:13.400Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:28:13.400Z]   - No valid next turn added, sending only history.
[2025-05-13T02:28:15.330Z] Model Finish Reason: STOP
[2025-05-13T02:28:15.331Z] Model requested function call: sendEmailToAdmin
[2025-05-13T02:28:15.331Z] Arguments: {"requestType":"contact","message":"The website is great!","subject":"Website Feedback"}
[2025-05-13T02:28:15.332Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T02:28:15.332Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T02:28:15.332Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T02:28:15.333Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T02:28:15.333Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T02:28:15.334Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T02:28:15.339Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 iMKO9E-ypIEYbt8aAAAH] Handler: SendEmailToAdmin (Confirmation Step), Args: {"requestType":"contact","message":"The website is great!","subject":"Website Feedback"}, Auth: true
[2025-05-13T02:28:15.340Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T02:28:15.340Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T02:28:15.341Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Preparing confirmation request ID: fda9539e-516b-4b81-b5af-aaa96018f7d7
[2025-05-13T02:28:15.342Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T02:28:15.342Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T02:28:15.342Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Staging confirmation fda9539e-516b-4b81-b5af-aaa96018f7d7. Awaiting frontend response. (Requires external state management)
[2025-05-13T02:28:15.343Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T02:28:15.343Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T02:28:15.343Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T02:28:15.344Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T02:28:15.344Z] [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T02:28:15.345Z] --- [iMKO-1747103290566-Sub-AdminContactAgent-1747103293396] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:28:15.345Z] [iMKO-1747103290566 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T02:28:15.346Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Staging email confirmation action. Confirmation ID: fda9539e-516b-4b81-b5af-aaa96018f7d7
[2025-05-13T02:28:15.348Z] [iMKO-1747103290566 iMKO9E-ypIEYbt8aAAAH] Staging email confirmation ID: fda9539e-516b-4b81-b5af-aaa96018f7d7 with timeout 60000ms
[2025-05-13T02:28:15.348Z] [iMKO-1747103290566 iMKO9E-ypIEYbt8aAAAH] Confirmation fda9539e-516b-4b81-b5af-aaa96018f7d7 stored. Status: pending.
[2025-05-13T02:28:15.349Z] --- [iMKO-1747103290566 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:28:15.350Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:15.350Z] [iMKO-1747103290566 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 3
[2025-05-13T02:28:15.350Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T02:28:15.351Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T02:28:15.351Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:28:15.351Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:28:15.351Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:28:15.352Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:28:15.352Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:28:15.352Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T02:28:15.352Z]   - No valid next turn added, sending only history.
[2025-05-13T02:28:15.823Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:28:15.824Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:15.824Z] [iMKO-1747103290566 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:28:15.824Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:15.825Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:15.931Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:15.995Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:16.062Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:16.069Z] [iMKO-1747103290566 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 193
[2025-05-13T02:28:16.069Z] [iMKO-1747103290566 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T02:28:16.070Z] [iMKO-1747103290566 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:28:16.070Z] --- [iMKO-1747103290566 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:28:16.070Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T02:28:16.153Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Successfully updated history in DB.
[2025-05-13T02:28:16.153Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:28:16.154Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:28:16.396Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T02:28:16.397Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103290566][Conv:6822ae3a3ab2b800805a80cf] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T02:28:35.867Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: user_confirm_email, Args: [{"confirmationId":"fda9539e-516b-4b81-b5af-aaa96018f7d7"}]
[2025-05-13T02:28:35.870Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Confirm:fda9539e-516b-4b81-b5af-aaa96018f7d7] Request received.
[2025-05-13T02:28:35.873Z] [iMKO-1747103290566 iMKO9E-ypIEYbt8aAAAH] User confirmed email ID: fda9539e-516b-4b81-b5af-aaa96018f7d7. Proceeding to send.
[2025-05-13T02:28:35.875Z] Attempting to send email to admin. Type: contact, Subject: "Website Feedback", Token Present: true
[2025-05-13T02:28:35.875Z] SIMULATING Email Send:
To: Admin
Subject: [CONTACT] Website Feedback
Body:

            Request Type: contact
            From: User: Authenticated (token present)
            Subject: Website Feedback
            --------------------
            Message:
            The website is great!
            --------------------
            Sent via Chatbot Function Call
        

[2025-05-13T02:28:36.077Z] [iMKO-1747103290566 iMKO9E-ypIEYbt8aAAAH] Email fda9539e-516b-4b81-b5af-aaa96018f7d7 sent successfully.
[2025-05-13T02:28:36.078Z] [User Confirm iMKO9E-ypIEYbt8aAAAH] Cleaned up entry fda9539e-516b-4b81-b5af-aaa96018f7d7 after processing (Status: confirmed).
[2025-05-13T02:28:49.128Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Điều chỉnh tin nhắn","isStreaming":true,"language":"en","conversationId":"6822ae3a3ab2b800805a80cf"}]
[2025-05-13T02:28:49.129Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128] Request received. UserInput: "Điều chỉnh tin nhắn", Streaming: true, Language: en, PayloadConvId: 6822ae3a3ab2b800805a80cf, SocketDataConvId: 6822ae3a3ab2b800805a80cf
[2025-05-13T02:28:49.129Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Using conversationId from payload.
[2025-05-13T02:28:49.219Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Fetched current history. Count: 4
[2025-05-13T02:28:49.219Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Calling streaming intent handler.
[2025-05-13T02:28:49.220Z] --- [iMKO-1747103329128 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Điều chỉnh tin nhắn", Lang: en ---
[2025-05-13T02:28:49.220Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:28:49.220Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:49.221Z] --- [iMKO-1747103329128 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:28:49.221Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:49.221Z] [iMKO-1747103329128 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 5
[2025-05-13T02:28:49.221Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T02:28:49.221Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T02:28:49.222Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:28:49.222Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:28:49.222Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:28:49.222Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:28:49.222Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:28:49.223Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T02:28:49.223Z]   - No valid next turn added, sending only history.
[2025-05-13T02:28:50.910Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:28:50.911Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:50.912Z] [iMKO-1747103329128 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:28:50.912Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:50.913Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:51.035Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:51.143Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:51.191Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:28:51.200Z] [iMKO-1747103329128 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 150
[2025-05-13T02:28:51.200Z] [iMKO-1747103329128 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T02:28:51.201Z] [iMKO-1747103329128 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:28:51.201Z] --- [iMKO-1747103329128 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:28:51.201Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T02:28:51.301Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Successfully updated history in DB.
[2025-05-13T02:28:51.302Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:28:51.302Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:28:51.536Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T02:28:51.537Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103329128][Conv:6822ae3a3ab2b800805a80cf] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T02:28:59.198Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Awful website","isStreaming":true,"language":"en","conversationId":"6822ae3a3ab2b800805a80cf"}]
[2025-05-13T02:28:59.198Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198] Request received. UserInput: "Awful website", Streaming: true, Language: en, PayloadConvId: 6822ae3a3ab2b800805a80cf, SocketDataConvId: 6822ae3a3ab2b800805a80cf
[2025-05-13T02:28:59.198Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Using conversationId from payload.
[2025-05-13T02:28:59.262Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Fetched current history. Count: 6
[2025-05-13T02:28:59.265Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Calling streaming intent handler.
[2025-05-13T02:28:59.265Z] --- [iMKO-1747103339198 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Awful website", Lang: en ---
[2025-05-13T02:28:59.265Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:28:59.266Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:59.266Z] --- [iMKO-1747103339198 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:28:59.266Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:28:59.267Z] [iMKO-1747103339198 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 7
[2025-05-13T02:28:59.267Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T02:28:59.267Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T02:28:59.267Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:28:59.267Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:28:59.268Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:28:59.268Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:28:59.268Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:28:59.268Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T02:28:59.268Z]   - No valid next turn added, sending only history.
[2025-05-13T02:29:01.064Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:29:01.064Z] [iMKO-1747103339198 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:29:01.065Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:01.065Z] --- [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: AdminContactAgent, Task: 713f9fe6-f852-4668-b7e9-542eb46e64f8 ---
[2025-05-13T02:29:01.065Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: en
[2025-05-13T02:29:01.066Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T02:29:01.066Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T02:29:01.066Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:29:01.066Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:29:01.067Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:29:01.067Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:29:01.067Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:29:01.067Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T02:29:01.067Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:29:01.068Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:29:01.068Z]   - No valid next turn added, sending only history.
[2025-05-13T02:29:02.883Z] Model Finish Reason: STOP
[2025-05-13T02:29:02.883Z] Model requested function call: sendEmailToAdmin
[2025-05-13T02:29:02.884Z] Arguments: {"requestType":"contact","subject":"Website Feedback","message":"The website is fantastic!"}
[2025-05-13T02:29:02.884Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T02:29:02.884Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T02:29:02.884Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T02:29:02.884Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T02:29:02.885Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T02:29:02.885Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T02:29:02.886Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 iMKO9E-ypIEYbt8aAAAH] Handler: SendEmailToAdmin (Confirmation Step), Args: {"requestType":"contact","subject":"Website Feedback","message":"The website is fantastic!"}, Auth: true
[2025-05-13T02:29:02.886Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T02:29:02.886Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T02:29:02.887Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Preparing confirmation request ID: d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38
[2025-05-13T02:29:02.887Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T02:29:02.887Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T02:29:02.887Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Staging confirmation d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38. Awaiting frontend response. (Requires external state management)
[2025-05-13T02:29:02.888Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T02:29:02.888Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T02:29:02.888Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T02:29:02.888Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T02:29:02.889Z] [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T02:29:02.889Z] --- [iMKO-1747103339198-Sub-AdminContactAgent-1747103341065] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:29:02.889Z] [iMKO-1747103339198 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T02:29:02.889Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Staging email confirmation action. Confirmation ID: d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38
[2025-05-13T02:29:02.889Z] [iMKO-1747103339198 iMKO9E-ypIEYbt8aAAAH] Staging email confirmation ID: d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38 with timeout 60000ms
[2025-05-13T02:29:02.890Z] [iMKO-1747103339198 iMKO9E-ypIEYbt8aAAAH] Confirmation d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38 stored. Status: pending.
[2025-05-13T02:29:02.890Z] --- [iMKO-1747103339198 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:29:02.890Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:02.891Z] [iMKO-1747103339198 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 9
[2025-05-13T02:29:02.892Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T02:29:02.893Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T02:29:02.893Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:29:02.894Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:29:02.894Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:29:02.894Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:29:02.894Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:29:02.895Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T02:29:02.895Z]   - No valid next turn added, sending only history.
[2025-05-13T02:29:03.500Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:29:03.500Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:03.501Z] [iMKO-1747103339198 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:29:03.501Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:03.501Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:29:03.562Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:29:03.623Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:29:03.673Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:29:03.675Z] [iMKO-1747103339198 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 193
[2025-05-13T02:29:03.676Z] [iMKO-1747103339198 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T02:29:03.677Z] [iMKO-1747103339198 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:29:03.677Z] --- [iMKO-1747103339198 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:29:03.677Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T02:29:03.747Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Successfully updated history in DB.
[2025-05-13T02:29:03.747Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:29:03.747Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:29:04.040Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T02:29:04.041Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103339198][Conv:6822ae3a3ab2b800805a80cf] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T02:29:10.080Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: user_confirm_email, Args: [{"confirmationId":"d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38"}]
[2025-05-13T02:29:10.081Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Confirm:d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38] Request received.
[2025-05-13T02:29:10.081Z] [iMKO-1747103339198 iMKO9E-ypIEYbt8aAAAH] User confirmed email ID: d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38. Proceeding to send.
[2025-05-13T02:29:10.081Z] Attempting to send email to admin. Type: contact, Subject: "Website Feedback", Token Present: true
[2025-05-13T02:29:10.082Z] SIMULATING Email Send:
To: Admin
Subject: [CONTACT] Website Feedback
Body:

            Request Type: contact
            From: User: Authenticated (token present)
            Subject: Website Feedback
            --------------------
            Message:
            The website is fantastic!
            --------------------
            Sent via Chatbot Function Call
        

[2025-05-13T02:29:10.290Z] [iMKO-1747103339198 iMKO9E-ypIEYbt8aAAAH] Email d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38 sent successfully.
[2025-05-13T02:29:10.292Z] [User Confirm iMKO9E-ypIEYbt8aAAAH] Cleaned up entry d1dbafeb-6f71-48ab-9ff5-e7ed3c336a38 after processing (Status: confirmed).
[2025-05-13T02:29:24.380Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Add \"Conference AAAI\" to my calendar.","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T02:29:24.381Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381] Request received. UserInput: "Add "Conference AAAI" to my ca...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: 6822ae3a3ab2b800805a80cf
[2025-05-13T02:29:24.381Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T02:29:24.501Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T02:29:24.501Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T02:29:24.502Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:29:24.742Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 13 conversations.
[2025-05-13T02:29:24.743Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Emitted updated conversation list. Reason: new conversation from send_message, Count: 13
[2025-05-13T02:29:24.803Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Fetched current history. Count: 0
[2025-05-13T02:29:24.803Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Calling streaming intent handler.
[2025-05-13T02:29:24.803Z] --- [iMKO-1747103364381 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Add "Conference AAAI" to my calendar.", Lang: en ---
[2025-05-13T02:29:24.803Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:29:24.804Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:24.804Z] --- [iMKO-1747103364381 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:29:24.804Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:24.804Z] [iMKO-1747103364381 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 1
[2025-05-13T02:29:24.805Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T02:29:24.805Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T02:29:24.805Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:29:24.805Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:29:24.805Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:29:24.806Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:29:24.806Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:29:24.806Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T02:29:24.806Z]   - No valid next turn added, sending only history.
[2025-05-13T02:29:25.620Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:29:25.621Z] [iMKO-1747103364381 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:29:25.621Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:25.622Z] --- [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 77475c1d-f339-4345-b3b1-c1d569dac208 ---
[2025-05-13T02:29:25.622Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:29:25.622Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:29:25.622Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:29:25.622Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:29:25.623Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:29:25.623Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:29:25.623Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:29:25.624Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:29:25.624Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:29:25.624Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:29:25.624Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:29:25.625Z]   - No valid next turn added, sending only history.
[2025-05-13T02:29:27.394Z] Model Finish Reason: STOP
[2025-05-13T02:29:27.395Z] Model requested function call: manageCalendar
[2025-05-13T02:29:27.395Z] Arguments: {"identifierType":"acronym","itemType":"conference","action":"add","identifier":"AAAI"}
[2025-05-13T02:29:27.395Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:29:27.395Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622] ConferenceAgent requests function call: manageCalendar
[2025-05-13T02:29:27.395Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Received request.
[2025-05-13T02:29:27.396Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:29:27.396Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:29:27.396Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Executing handler...
[2025-05-13T02:29:27.412Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 iMKO9E-ypIEYbt8aAAAH] Handler: ManageCalendar, Args: {"identifierType":"acronym","itemType":"conference","action":"add","identifier":"AAAI"}, Auth: true
[2025-05-13T02:29:27.413Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_calendar_args, Agent: ConferenceAgent
[2025-05-13T02:29:27.413Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_calendar_args for ConferenceAgent
[2025-05-13T02:29:27.414Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: checking_authentication_calendar, Agent: ConferenceAgent
[2025-05-13T02:29:27.414Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: checking_authentication_calendar for ConferenceAgent
[2025-05-13T02:29:27.414Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: finding_calendar_item_id, Agent: ConferenceAgent
[2025-05-13T02:29:27.415Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: finding_calendar_item_id for ConferenceAgent
[2025-05-13T02:29:27.417Z] [FollowService] [FindID conference Ident:"AAAI" Type:acronym] Attempting to find item ID.
[2025-05-13T02:29:27.419Z] [FollowService] [FindID conference Ident:"AAAI" Type:acronym] Constructed search query: acronym=AAAI&perPage=1&page=1
[2025-05-13T02:29:27.419Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=AAAI&perPage=1&page=1}
[2025-05-13T02:29:28.110Z] [BackendService] [conference] API Success (200). Data length: 1304. Attempting parsing...
[2025-05-13T02:29:28.110Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Association for Artificial Intelligence","acronym":"AAAI","location":{"cityStateProvince":"Philadelphia, Pennsylvania","country":"United States","ad...
[2025-05-13T02:29:28.111Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:29:28.111Z] Transforming conference data with Markdown. Search query: acronym=AAAI&perPage=1&page=1
[2025-05-13T02:29:28.117Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** National Conference of the American Association for Artificia...
[2025-05-13T02:29:28.117Z] [FollowService] [FindID conference Ident:"AAAI" Type:acronym] Successfully found ID: 1c4468db-5d99-4253-9794-5e205ef37e97. Details: {"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Associatio
[2025-05-13T02:29:28.118Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: calendar_item_id_found, Agent: ConferenceAgent
[2025-05-13T02:29:28.118Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: calendar_item_id_found for ConferenceAgent
[2025-05-13T02:29:28.119Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: checking_calendar_status, Agent: ConferenceAgent
[2025-05-13T02:29:28.119Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: checking_calendar_status for ConferenceAgent
[2025-05-13T02:29:28.120Z] [CalendarService] [GetUserCalendarEvents] Fetching calendar events: GET https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/events
[2025-05-13T02:29:28.761Z] [CalendarService] [GetUserCalendarEvents] Success. Found 22 event(s) in calendar.
[2025-05-13T02:29:28.762Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: calendar_status_checked, Agent: ConferenceAgent
[2025-05-13T02:29:28.762Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: calendar_status_checked for ConferenceAgent
[2025-05-13T02:29:28.763Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: determining_calendar_action, Agent: ConferenceAgent
[2025-05-13T02:29:28.763Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: determining_calendar_action for ConferenceAgent
[2025-05-13T02:29:28.763Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: calendar_action_determined, Agent: ConferenceAgent
[2025-05-13T02:29:28.764Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: calendar_action_determined for ConferenceAgent
[2025-05-13T02:29:28.764Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: preparing_calendar_api_call, Agent: ConferenceAgent
[2025-05-13T02:29:28.764Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: preparing_calendar_api_call for ConferenceAgent
[2025-05-13T02:29:28.771Z] [CalendarService] [addCalendarEvent ID: 1c4468db-5d99-4253-9794-5e205ef37e97] Executing action: PUT https://confhub.westus3.cloudapp.azure.com/api/v1/calendar/add-event
[2025-05-13T02:29:29.028Z] [CalendarService] [addCalendarEvent ID: 1c4468db-5d99-4253-9794-5e205ef37e97] Action executed successfully.
[2025-05-13T02:29:29.029Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 iMKO9E-ypIEYbt8aAAAH] ManageCalendar: API call for add successful.
[2025-05-13T02:29:29.029Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: calendar_update_success, Agent: ConferenceAgent
[2025-05-13T02:29:29.030Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: calendar_update_success for ConferenceAgent
[2025-05-13T02:29:29.030Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 iMKO9E-ypIEYbt8aAAAH] ManageCalendar: Insufficient details to create calendar event for 1c4468db-5d99-4253-9794-5e205ef37e97. Title or dates missing.
[2025-05-13T02:29:29.031Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:manageCalendar] Handler execution finished. Result indicates error: false
[2025-05-13T02:29:29.031Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:29:29.031Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:29:29.032Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:29:29.032Z] [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:29:29.032Z] --- [iMKO-1747103364381-Sub-ConferenceAgent-1747103365622] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 14 ---
[2025-05-13T02:29:29.032Z] [iMKO-1747103364381 Streaming] Appended 14 thoughts from ConferenceAgent. Total: 17
[2025-05-13T02:29:29.033Z] --- [iMKO-1747103364381 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:29:29.033Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:29.033Z] [iMKO-1747103364381 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 3
[2025-05-13T02:29:29.033Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T02:29:29.033Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T02:29:29.034Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:29:29.034Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:29:29.034Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:29:29.034Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:29:29.034Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:29:29.035Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T02:29:29.035Z]   - No valid next turn added, sending only history.
[2025-05-13T02:29:29.644Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:29:29.645Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:29.645Z] [iMKO-1747103364381 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:29:29.645Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:29:29.646Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:29:29.710Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:29:29.716Z] [iMKO-1747103364381 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 53
[2025-05-13T02:29:29.716Z] [iMKO-1747103364381 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 20 thoughts.
[2025-05-13T02:29:29.717Z] [iMKO-1747103364381 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:29:29.717Z] --- [iMKO-1747103364381 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:29:29.717Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T02:29:29.787Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Successfully updated history in DB.
[2025-05-13T02:29:29.787Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:29:29.787Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:29:30.029Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 13 conversations.
[2025-05-13T02:29:30.030Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103364381][Conv:6822ae843ab2b800805a80dc] Emitted updated conversation list. Reason: message saved, Count: 13
[2025-05-13T02:30:39.389Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"List some AI conferences in Asia.","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T02:30:39.389Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389] Request received. UserInput: "List some AI conferences in As...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: 6822ae843ab2b800805a80dc
[2025-05-13T02:30:39.389Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T02:30:39.514Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T02:30:39.515Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T02:30:39.515Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:30:39.774Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:30:39.775Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: new conversation from send_message, Count: 14
[2025-05-13T02:30:39.833Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 0
[2025-05-13T02:30:39.833Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:30:39.834Z] --- [iMKO-1747103439389 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "List some AI conferences in Asia.", Lang: en ---
[2025-05-13T02:30:39.834Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:30:39.835Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:39.835Z] --- [iMKO-1747103439389 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:30:39.835Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:39.836Z] [iMKO-1747103439389 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 1
[2025-05-13T02:30:39.836Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T02:30:39.836Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T02:30:39.836Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:30:39.836Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:30:39.837Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:30:39.837Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:30:39.837Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:30:39.837Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T02:30:39.837Z]   - No valid next turn added, sending only history.
[2025-05-13T02:30:41.569Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:30:41.571Z] [iMKO-1747103439389 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:30:41.572Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:41.572Z] --- [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 1f04302e-49d7-4aca-94de-52dfda51b5a3 ---
[2025-05-13T02:30:41.573Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:30:41.573Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:30:41.573Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:30:41.573Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:30:41.574Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:30:41.574Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:30:41.574Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:30:41.574Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:30:41.575Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:30:41.575Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:30:41.575Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:30:41.575Z]   - No valid next turn added, sending only history.
[2025-05-13T02:30:43.259Z] Model Finish Reason: STOP
[2025-05-13T02:30:43.260Z] Model requested function call: getConferences
[2025-05-13T02:30:43.260Z] Arguments: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T02:30:43.260Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:30:43.260Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572] ConferenceAgent requests function call: getConferences
[2025-05-13T02:30:43.261Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:30:43.261Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:30:43.261Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:30:43.262Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:30:43.262Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T02:30:43.262Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:30:43.262Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:30:43.263Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:30:43.263Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:30:43.263Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:30:43.263Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:30:43.263Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=AI&continent=Asia&perPage=5&page=1}
[2025-05-13T02:30:44.030Z] [BackendService] [conference] API Success (200). Data length: 10310. Attempting parsing...
[2025-05-13T02:30:44.031Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"287aa165-fdd4-41aa-9860-10d161bf15cc","title":"International Symposium on Search Based Software Engineering","acronym":"SSBSE","location":{"cityStateProvince":"Seoul","country":"South Korea","address":"Seoul, South Korea","continen...
[2025-05-13T02:30:44.031Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:30:44.032Z] Transforming conference data with Markdown. Search query: topics=AI&continent=Asia&perPage=5&page=1
[2025-05-13T02:30:44.039Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 5
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Symposium on Search Based Software Engineering
...
[2025-05-13T02:30:44.040Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=AI&continent=Asia&perPage=5&page=1"
[2025-05-13T02:30:44.040Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:30:44.040Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:30:44.041Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:30:44.041Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:30:44.041Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:30:44.042Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:30:44.042Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:30:44.043Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:30:44.043Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:30:44.044Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:30:44.044Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:30:44.044Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:30:44.044Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:30:44.045Z] [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:30:44.045Z] --- [iMKO-1747103439389-Sub-ConferenceAgent-1747103441572] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:30:44.046Z] [iMKO-1747103439389 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:30:44.049Z] --- [iMKO-1747103439389 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:30:44.049Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:44.049Z] [iMKO-1747103439389 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 3
[2025-05-13T02:30:44.049Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T02:30:44.050Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T02:30:44.051Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:30:44.051Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:30:44.051Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:30:44.051Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:30:44.052Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:30:44.052Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T02:30:44.054Z]   - No valid next turn added, sending only history.
[2025-05-13T02:30:44.662Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:30:44.663Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:44.663Z] [iMKO-1747103439389 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:30:44.663Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:44.664Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:44.767Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:44.866Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:45.015Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:45.148Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:45.392Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:45.498Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:45.503Z] [iMKO-1747103439389 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 662
[2025-05-13T02:30:45.503Z] [iMKO-1747103439389 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:30:45.504Z] [iMKO-1747103439389 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:30:45.504Z] --- [iMKO-1747103439389 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:30:45.504Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T02:30:45.582Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:30:45.583Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:30:45.583Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:30:45.920Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:30:45.921Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103439389][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:30:52.682Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Find Big Data conferences this year (2025).","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:30:52.682Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682] Request received. UserInput: "Find Big Data conferences this...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:30:52.682Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:30:52.740Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 4
[2025-05-13T02:30:52.741Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:30:52.741Z] --- [iMKO-1747103452682 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Find Big Data conferences this year (2025).", Lang: en ---
[2025-05-13T02:30:52.741Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:30:52.741Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:52.742Z] --- [iMKO-1747103452682 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:30:52.742Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:52.742Z] [iMKO-1747103452682 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 5
[2025-05-13T02:30:52.742Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T02:30:52.742Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T02:30:52.742Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:30:52.742Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:30:52.743Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:30:52.743Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:30:52.743Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:30:52.743Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T02:30:52.743Z]   - No valid next turn added, sending only history.
[2025-05-13T02:30:54.533Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:30:54.533Z] [iMKO-1747103452682 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:30:54.534Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:54.534Z] --- [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 4fc467e8-e13e-4437-bf7b-7981fccf65de ---
[2025-05-13T02:30:54.534Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:30:54.535Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:30:54.536Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:30:54.536Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:30:54.536Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:30:54.537Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:30:54.537Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:30:54.538Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:30:54.538Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:30:54.538Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:30:54.538Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:30:54.539Z]   - No valid next turn added, sending only history.
[2025-05-13T02:30:55.470Z] Model Finish Reason: STOP
[2025-05-13T02:30:55.470Z] Model requested function call: getConferences
[2025-05-13T02:30:55.470Z] Arguments: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T02:30:55.471Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:30:55.471Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534] ConferenceAgent requests function call: getConferences
[2025-05-13T02:30:55.471Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:30:55.471Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:30:55.472Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:30:55.472Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:30:55.472Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T02:30:55.472Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:30:55.472Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:30:55.473Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:30:55.473Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:30:55.473Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:30:55.473Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:30:55.473Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1}
[2025-05-13T02:30:56.225Z] [BackendService] [conference] API Success (200). Data length: 8009. Attempting parsing...
[2025-05-13T02:30:56.225Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T02:30:56.226Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:30:56.226Z] Transforming conference data with Markdown. Search query: topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1
[2025-05-13T02:30:56.231Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 37
- **Total page:** 8
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T02:30:56.231Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"
[2025-05-13T02:30:56.231Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:30:56.231Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:30:56.232Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:30:56.232Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:30:56.233Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:30:56.233Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:30:56.233Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:30:56.234Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:30:56.234Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:30:56.235Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:30:56.235Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:30:56.235Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:30:56.235Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:30:56.236Z] [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:30:56.236Z] --- [iMKO-1747103452682-Sub-ConferenceAgent-1747103454534] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:30:56.236Z] [iMKO-1747103452682 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:30:56.236Z] --- [iMKO-1747103452682 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:30:56.237Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:56.237Z] [iMKO-1747103452682 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 7
[2025-05-13T02:30:56.237Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T02:30:56.237Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T02:30:56.237Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:30:56.238Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:30:56.238Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:30:56.238Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:30:56.238Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:30:56.238Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T02:30:56.239Z]   - No valid next turn added, sending only history.
[2025-05-13T02:30:56.836Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:30:56.836Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:56.836Z] [iMKO-1747103452682 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:30:56.837Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:30:56.838Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:56.902Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:57.015Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:57.163Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:57.339Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:57.528Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:57.690Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:30:57.703Z] [iMKO-1747103452682 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 614
[2025-05-13T02:30:57.704Z] [iMKO-1747103452682 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:30:57.704Z] [iMKO-1747103452682 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:30:57.704Z] --- [iMKO-1747103452682 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:30:57.705Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T02:30:57.771Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:30:57.771Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:30:57.771Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:30:58.033Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:30:58.034Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103452682][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:31:03.620Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"I want to know about blockchain conferences in Europe.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:31:03.621Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621] Request received. UserInput: "I want to know about blockchai...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:31:03.621Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:31:03.734Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 8
[2025-05-13T02:31:03.735Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:31:03.735Z] --- [iMKO-1747103463621 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "I want to know about blockchain conferences in Europe.", Lang: en ---
[2025-05-13T02:31:03.735Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:31:03.736Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:03.736Z] --- [iMKO-1747103463621 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:03.736Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:03.736Z] [iMKO-1747103463621 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 9
[2025-05-13T02:31:03.737Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T02:31:03.737Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T02:31:03.737Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:03.737Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:03.737Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:03.737Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:03.738Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:03.738Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T02:31:03.738Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:05.708Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:31:05.708Z] [iMKO-1747103463621 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:31:05.709Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:05.709Z] --- [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 42e1d7bd-f37a-4ffc-af1d-b1dc714848ea ---
[2025-05-13T02:31:05.709Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:31:05.710Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:31:05.710Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:31:05.710Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:31:05.710Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:31:05.710Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:05.711Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:05.711Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:05.711Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:31:05.711Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:05.711Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:31:05.711Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:06.754Z] Model Finish Reason: STOP
[2025-05-13T02:31:06.755Z] Model requested function call: getConferences
[2025-05-13T02:31:06.755Z] Arguments: {"searchQuery":"topics=blockchain&continent=Europe&perPage=5&page=1"}
[2025-05-13T02:31:06.755Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:31:06.756Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709] ConferenceAgent requests function call: getConferences
[2025-05-13T02:31:06.756Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:31:06.756Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:31:06.757Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:31:06.757Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:31:06.757Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=blockchain&continent=Europe&perPage=5&page=1"}
[2025-05-13T02:31:06.758Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:06.758Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:06.758Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:31:06.758Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:06.758Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:06.759Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:31:06.759Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=blockchain&continent=Europe&perPage=5&page=1}
[2025-05-13T02:31:07.498Z] [BackendService] [conference] API Success (200). Data length: 10062. Attempting parsing...
[2025-05-13T02:31:07.498Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T02:31:07.499Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:31:07.499Z] Transforming conference data with Markdown. Search query: topics=blockchain&continent=Europe&perPage=5&page=1
[2025-05-13T02:31:07.525Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 17
- **Total page:** 4
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T02:31:07.526Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=blockchain&continent=Europe&perPage=5&page=1"
[2025-05-13T02:31:07.526Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:07.527Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:07.527Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:31:07.527Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:07.527Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:07.528Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:31:07.528Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:07.528Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:07.528Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:31:07.529Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:31:07.529Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:31:07.529Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:31:07.530Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:31:07.530Z] [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:31:07.530Z] --- [iMKO-1747103463621-Sub-ConferenceAgent-1747103465709] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:31:07.530Z] [iMKO-1747103463621 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:31:07.531Z] --- [iMKO-1747103463621 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:07.531Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:07.531Z] [iMKO-1747103463621 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 11
[2025-05-13T02:31:07.531Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T02:31:07.531Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T02:31:07.534Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:31:07.535Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:07.535Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:07.535Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:07.535Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:07.536Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T02:31:07.536Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:08.338Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:31:08.338Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:08.338Z] [iMKO-1747103463621 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:31:08.339Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:08.339Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:08.419Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:08.487Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:08.663Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:08.826Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:09.028Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:09.188Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:09.197Z] [iMKO-1747103463621 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 619
[2025-05-13T02:31:09.198Z] [iMKO-1747103463621 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:31:09.198Z] [iMKO-1747103463621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:31:09.199Z] --- [iMKO-1747103463621 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:31:09.200Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T02:31:09.274Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:31:09.275Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:31:09.275Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:31:09.536Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:31:09.537Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103463621][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:31:19.842Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Liệt kê cho tôi một vài hội nghị về lĩnh vực AI tổ chức tại châu Á.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:31:19.843Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843] Request received. UserInput: "Liệt kê cho tôi một vài hội ng...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:31:19.843Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:31:19.959Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 12
[2025-05-13T02:31:19.960Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:31:19.960Z] --- [iMKO-1747103479843 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Liệt kê cho tôi một vài hội nghị về lĩnh vực AI tổ chức tại châu Á.", Lang: en ---
[2025-05-13T02:31:19.960Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:31:19.960Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:19.961Z] --- [iMKO-1747103479843 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:19.961Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:19.961Z] [iMKO-1747103479843 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 13
[2025-05-13T02:31:19.961Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T02:31:19.962Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T02:31:19.962Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:19.962Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:19.962Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:19.962Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:19.962Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:19.962Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T02:31:19.963Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:21.961Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:31:21.961Z] [iMKO-1747103479843 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:31:21.962Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:21.962Z] --- [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 893a24ee-a7a3-4b7c-b909-937a0e5760a2 ---
[2025-05-13T02:31:21.962Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:31:21.963Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:31:21.965Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:31:21.966Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:31:21.966Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:31:21.967Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:21.967Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:21.968Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:21.968Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:31:21.968Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:21.968Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:31:21.969Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:23.743Z] Model Finish Reason: STOP
[2025-05-13T02:31:23.743Z] Model requested function call: getConferences
[2025-05-13T02:31:23.744Z] Arguments: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T02:31:23.744Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:31:23.744Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962] ConferenceAgent requests function call: getConferences
[2025-05-13T02:31:23.744Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:31:23.745Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:31:23.745Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:31:23.745Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:31:23.746Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T02:31:23.746Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:23.746Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:23.746Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:31:23.746Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:23.747Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:23.747Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:31:23.747Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=AI&continent=Asia&perPage=5&page=1}
[2025-05-13T02:31:24.534Z] [BackendService] [conference] API Success (200). Data length: 10310. Attempting parsing...
[2025-05-13T02:31:24.534Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"287aa165-fdd4-41aa-9860-10d161bf15cc","title":"International Symposium on Search Based Software Engineering","acronym":"SSBSE","location":{"cityStateProvince":"Seoul","country":"South Korea","address":"Seoul, South Korea","continen...
[2025-05-13T02:31:24.535Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:31:24.535Z] Transforming conference data with Markdown. Search query: topics=AI&continent=Asia&perPage=5&page=1
[2025-05-13T02:31:24.540Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 5
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Symposium on Search Based Software Engineering
...
[2025-05-13T02:31:24.540Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=AI&continent=Asia&perPage=5&page=1"
[2025-05-13T02:31:24.540Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:24.540Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:24.541Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:31:24.541Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:24.541Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:24.542Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:31:24.542Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:24.542Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:24.542Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:31:24.543Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:31:24.543Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:31:24.543Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:31:24.543Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:31:24.544Z] [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:31:24.544Z] --- [iMKO-1747103479843-Sub-ConferenceAgent-1747103481962] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:31:24.544Z] [iMKO-1747103479843 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:31:24.544Z] --- [iMKO-1747103479843 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:24.545Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:24.545Z] [iMKO-1747103479843 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 15
[2025-05-13T02:31:24.545Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T02:31:24.545Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T02:31:24.545Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:31:24.546Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:24.546Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:24.546Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:24.546Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:24.546Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T02:31:24.546Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:25.370Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:31:25.371Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:25.371Z] [iMKO-1747103479843 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:31:25.372Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:25.372Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:25.443Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:25.506Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:25.643Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:25.770Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:25.957Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:26.123Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:26.130Z] [iMKO-1747103479843 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 662
[2025-05-13T02:31:26.131Z] [iMKO-1747103479843 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:31:26.131Z] [iMKO-1747103479843 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:31:26.132Z] --- [iMKO-1747103479843 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:31:26.132Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 16
[2025-05-13T02:31:26.206Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:31:26.207Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:31:26.207Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:31:26.456Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:31:26.456Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103479843][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:31:32.621Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Tìm các hội nghị về Big Data trong năm nay (2025).","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:31:32.621Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621] Request received. UserInput: "Tìm các hội nghị về Big Data t...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:31:32.621Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:31:32.738Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 16
[2025-05-13T02:31:32.739Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:31:32.739Z] --- [iMKO-1747103492621 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Tìm các hội nghị về Big Data trong năm nay (2025).", Lang: en ---
[2025-05-13T02:31:32.739Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:31:32.739Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:32.740Z] --- [iMKO-1747103492621 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:32.740Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:32.740Z] [iMKO-1747103492621 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 17
[2025-05-13T02:31:32.740Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T02:31:32.740Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T02:31:32.740Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:32.741Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:32.741Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:32.741Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:32.741Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:32.741Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T02:31:32.741Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:34.819Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:31:34.819Z] [iMKO-1747103492621 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:31:34.820Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:34.820Z] --- [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: f36ea133-0cb2-4504-8b06-6a47eb7c66a5 ---
[2025-05-13T02:31:34.820Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:31:34.820Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:31:34.821Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:31:34.821Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:31:34.821Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:31:34.821Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:34.821Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:34.822Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:34.822Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:31:34.822Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:34.822Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:31:34.822Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:36.747Z] Model Finish Reason: STOP
[2025-05-13T02:31:36.747Z] Model requested function call: getConferences
[2025-05-13T02:31:36.747Z] Arguments: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T02:31:36.748Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:31:36.748Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820] ConferenceAgent requests function call: getConferences
[2025-05-13T02:31:36.748Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:31:36.748Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:31:36.749Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:31:36.750Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:31:36.750Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T02:31:36.750Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:36.750Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:36.750Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:31:36.751Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:36.751Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:36.751Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:31:36.751Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1}
[2025-05-13T02:31:37.495Z] [BackendService] [conference] API Success (200). Data length: 8009. Attempting parsing...
[2025-05-13T02:31:37.496Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T02:31:37.496Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:31:37.496Z] Transforming conference data with Markdown. Search query: topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1
[2025-05-13T02:31:37.518Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 37
- **Total page:** 8
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T02:31:37.519Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"
[2025-05-13T02:31:37.519Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:37.519Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:37.520Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:31:37.520Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:37.520Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:37.520Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:31:37.521Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:37.521Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:37.521Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:31:37.522Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:31:37.522Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:31:37.522Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:31:37.522Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:31:37.523Z] [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:31:37.523Z] --- [iMKO-1747103492621-Sub-ConferenceAgent-1747103494820] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:31:37.523Z] [iMKO-1747103492621 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:31:37.523Z] --- [iMKO-1747103492621 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:37.523Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:37.524Z] [iMKO-1747103492621 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 19
[2025-05-13T02:31:37.524Z] [GeminiService] Received history with 19 items before mapping (for stream).
[2025-05-13T02:31:37.524Z] [GeminiService] Mapped history (SDK Content[]) with 19 items (for stream).
[2025-05-13T02:31:37.524Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:31:37.524Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:37.525Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:37.525Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:37.525Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:37.525Z] [GeminiService Stream] Preparing stream request with 19 Content items.
[2025-05-13T02:31:37.525Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:38.379Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:31:38.379Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:38.380Z] [iMKO-1747103492621 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:31:38.380Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:38.381Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:38.467Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:38.558Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:38.661Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:38.792Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:38.990Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:39.189Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:39.197Z] [iMKO-1747103492621 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 614
[2025-05-13T02:31:39.197Z] [iMKO-1747103492621 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:31:39.198Z] [iMKO-1747103492621 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:31:39.199Z] --- [iMKO-1747103492621 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:31:39.199Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 20
[2025-05-13T02:31:39.278Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:31:39.279Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:31:39.279Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:31:39.536Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:31:39.537Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103492621][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:31:46.820Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Tôi muốn biết về các hội nghị blockchain tại châu Âu.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:31:46.821Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820] Request received. UserInput: "Tôi muốn biết về các hội nghị ...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:31:46.821Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:31:46.999Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 20
[2025-05-13T02:31:46.999Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:31:47.000Z] --- [iMKO-1747103506820 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Tôi muốn biết về các hội nghị blockchain tại châu Âu.", Lang: en ---
[2025-05-13T02:31:47.000Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:31:47.000Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:47.000Z] --- [iMKO-1747103506820 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:47.001Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:47.001Z] [iMKO-1747103506820 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 21
[2025-05-13T02:31:47.001Z] [GeminiService] Received history with 21 items before mapping (for stream).
[2025-05-13T02:31:47.001Z] [GeminiService] Mapped history (SDK Content[]) with 21 items (for stream).
[2025-05-13T02:31:47.002Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:47.002Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:47.002Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:47.002Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:47.002Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:47.002Z] [GeminiService Stream] Preparing stream request with 21 Content items.
[2025-05-13T02:31:47.003Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:49.132Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:31:49.132Z] [iMKO-1747103506820 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:31:49.133Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:49.133Z] --- [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 31fd1abd-6b4b-48d5-b073-06206a60e327 ---
[2025-05-13T02:31:49.134Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:31:49.134Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:31:49.134Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:31:49.134Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:31:49.134Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:31:49.135Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:31:49.135Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:49.135Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:49.136Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:31:49.136Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:49.136Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:31:49.136Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:50.982Z] Model Finish Reason: STOP
[2025-05-13T02:31:50.982Z] Model requested function call: getConferences
[2025-05-13T02:31:50.983Z] Arguments: {"searchQuery":"topics=blockchain&continent=Europe&perPage=5&page=1"}
[2025-05-13T02:31:50.983Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:31:50.983Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133] ConferenceAgent requests function call: getConferences
[2025-05-13T02:31:50.983Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:31:50.984Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:31:50.984Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:31:50.985Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:31:50.985Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=blockchain&continent=Europe&perPage=5&page=1"}
[2025-05-13T02:31:50.985Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:50.985Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:31:50.985Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:31:50.985Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:50.986Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:31:50.986Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:31:50.986Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=blockchain&continent=Europe&perPage=5&page=1}
[2025-05-13T02:31:51.725Z] [BackendService] [conference] API Success (200). Data length: 10062. Attempting parsing...
[2025-05-13T02:31:51.726Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T02:31:51.726Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:31:51.726Z] Transforming conference data with Markdown. Search query: topics=blockchain&continent=Europe&perPage=5&page=1
[2025-05-13T02:31:51.735Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 17
- **Total page:** 4
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T02:31:51.735Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=blockchain&continent=Europe&perPage=5&page=1"
[2025-05-13T02:31:51.735Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:51.735Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:31:51.736Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:31:51.736Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:51.736Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:31:51.737Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:31:51.737Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:51.737Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:31:51.737Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:31:51.738Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:31:51.738Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:31:51.738Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:31:51.738Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:31:51.739Z] [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:31:51.739Z] --- [iMKO-1747103506820-Sub-ConferenceAgent-1747103509133] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:31:51.739Z] [iMKO-1747103506820 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:31:51.739Z] --- [iMKO-1747103506820 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:31:51.739Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:51.740Z] [iMKO-1747103506820 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 23
[2025-05-13T02:31:51.740Z] [GeminiService] Received history with 23 items before mapping (for stream).
[2025-05-13T02:31:51.740Z] [GeminiService] Mapped history (SDK Content[]) with 23 items (for stream).
[2025-05-13T02:31:51.740Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:31:51.740Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:31:51.740Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:31:51.740Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:31:51.741Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:31:51.741Z] [GeminiService Stream] Preparing stream request with 23 Content items.
[2025-05-13T02:31:51.741Z]   - No valid next turn added, sending only history.
[2025-05-13T02:31:52.782Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:31:52.783Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:52.783Z] [iMKO-1747103506820 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:31:52.783Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:31:52.783Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:52.839Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:52.899Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:53.038Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:53.160Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:53.365Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:53.499Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:31:53.506Z] [iMKO-1747103506820 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 619
[2025-05-13T02:31:53.507Z] [iMKO-1747103506820 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:31:53.507Z] [iMKO-1747103506820 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:31:53.508Z] --- [iMKO-1747103506820 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:31:53.508Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 24
[2025-05-13T02:31:53.590Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:31:53.590Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:31:53.591Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:31:53.833Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:31:53.834Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103506820][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:32:01.410Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"我是会议信息查询聊天机器人助手。您可以提问或选择下面的建议开始：","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:32:01.410Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410] Request received. UserInput: "我是会议信息查询聊天机器人助手。您可以提问或选择下面的建议开...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:32:01.410Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:32:01.592Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 24
[2025-05-13T02:32:01.593Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:32:01.593Z] --- [iMKO-1747103521410 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "我是会议信息查询聊天机器人助手。您可以提问或选择下面的建议开始：", Lang: en ---
[2025-05-13T02:32:01.593Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:32:01.593Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:01.594Z] --- [iMKO-1747103521410 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:01.594Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:01.594Z] [iMKO-1747103521410 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 25
[2025-05-13T02:32:01.595Z] [GeminiService] Received history with 25 items before mapping (for stream).
[2025-05-13T02:32:01.595Z] [GeminiService] Mapped history (SDK Content[]) with 25 items (for stream).
[2025-05-13T02:32:01.596Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:01.596Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:01.597Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:01.598Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:01.598Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:01.598Z] [GeminiService Stream] Preparing stream request with 25 Content items.
[2025-05-13T02:32:01.598Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:03.596Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:32:03.596Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:03.597Z] [iMKO-1747103521410 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:32:03.597Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:03.597Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:03.731Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:03.835Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:03.879Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:03.887Z] [iMKO-1747103521410 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 193
[2025-05-13T02:32:03.887Z] [iMKO-1747103521410 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T02:32:03.888Z] [iMKO-1747103521410 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:32:03.888Z] --- [iMKO-1747103521410 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:32:03.888Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 26
[2025-05-13T02:32:03.970Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:32:03.970Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:32:03.970Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:32:04.228Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:32:04.229Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103521410][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:32:18.047Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"列出亚洲的一些人工智能会议。","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:32:18.048Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047] Request received. UserInput: "列出亚洲的一些人工智能会议。", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:32:18.048Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:32:18.220Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 26
[2025-05-13T02:32:18.221Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:32:18.221Z] --- [iMKO-1747103538047 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "列出亚洲的一些人工智能会议。", Lang: en ---
[2025-05-13T02:32:18.221Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:32:18.222Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:18.222Z] --- [iMKO-1747103538047 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:18.222Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:18.223Z] [iMKO-1747103538047 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 27
[2025-05-13T02:32:18.224Z] [GeminiService] Received history with 27 items before mapping (for stream).
[2025-05-13T02:32:18.225Z] [GeminiService] Mapped history (SDK Content[]) with 27 items (for stream).
[2025-05-13T02:32:18.226Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:18.227Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:18.227Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:18.227Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:18.228Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:18.228Z] [GeminiService Stream] Preparing stream request with 27 Content items.
[2025-05-13T02:32:18.229Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:20.488Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:32:20.488Z] [iMKO-1747103538047 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:32:20.489Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:20.489Z] --- [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: bd02ba9a-6c1a-4045-a3ef-ccd9ae11be7a ---
[2025-05-13T02:32:20.489Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:32:20.490Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:32:20.490Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:32:20.490Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:32:20.490Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:32:20.490Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:20.491Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:20.491Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:20.491Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:32:20.491Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:20.491Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:32:20.491Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:21.278Z] Model Finish Reason: STOP
[2025-05-13T02:32:21.278Z] Model requested function call: getConferences
[2025-05-13T02:32:21.278Z] Arguments: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T02:32:21.279Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:32:21.279Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489] ConferenceAgent requests function call: getConferences
[2025-05-13T02:32:21.279Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:32:21.279Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:32:21.280Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:32:21.280Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:32:21.280Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=AI&continent=Asia&perPage=5&page=1"}
[2025-05-13T02:32:21.280Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:32:21.280Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:32:21.280Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:32:21.281Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:32:21.281Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:32:21.281Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:32:21.281Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=AI&continent=Asia&perPage=5&page=1}
[2025-05-13T02:32:22.026Z] [BackendService] [conference] API Success (200). Data length: 10310. Attempting parsing...
[2025-05-13T02:32:22.027Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"287aa165-fdd4-41aa-9860-10d161bf15cc","title":"International Symposium on Search Based Software Engineering","acronym":"SSBSE","location":{"cityStateProvince":"Seoul","country":"South Korea","address":"Seoul, South Korea","continen...
[2025-05-13T02:32:22.027Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:32:22.027Z] Transforming conference data with Markdown. Search query: topics=AI&continent=Asia&perPage=5&page=1
[2025-05-13T02:32:22.036Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 5
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Symposium on Search Based Software Engineering
...
[2025-05-13T02:32:22.036Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=AI&continent=Asia&perPage=5&page=1"
[2025-05-13T02:32:22.036Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:32:22.036Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:32:22.037Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:32:22.037Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:32:22.037Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:32:22.038Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:32:22.038Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:32:22.038Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:32:22.038Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:32:22.039Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:32:22.039Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:32:22.039Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:32:22.039Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:32:22.040Z] [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:32:22.040Z] --- [iMKO-1747103538047-Sub-ConferenceAgent-1747103540489] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:32:22.040Z] [iMKO-1747103538047 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:32:22.040Z] --- [iMKO-1747103538047 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:22.041Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:22.041Z] [iMKO-1747103538047 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 29
[2025-05-13T02:32:22.041Z] [GeminiService] Received history with 29 items before mapping (for stream).
[2025-05-13T02:32:22.041Z] [GeminiService] Mapped history (SDK Content[]) with 29 items (for stream).
[2025-05-13T02:32:22.041Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:32:22.042Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:22.042Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:22.042Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:22.042Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:22.042Z] [GeminiService Stream] Preparing stream request with 29 Content items.
[2025-05-13T02:32:22.043Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:23.128Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:32:23.128Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:23.129Z] [iMKO-1747103538047 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:32:23.129Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:23.129Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.187Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.256Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.394Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.525Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.705Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.867Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:23.872Z] [iMKO-1747103538047 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 662
[2025-05-13T02:32:23.872Z] [iMKO-1747103538047 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:32:23.873Z] [iMKO-1747103538047 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:32:23.873Z] --- [iMKO-1747103538047 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:32:23.874Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 30
[2025-05-13T02:32:23.950Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:32:23.951Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:32:23.951Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:32:24.191Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:32:24.192Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103538047][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:32:29.897Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"查找今年的大数据会议 (2025)。","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:32:29.898Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898] Request received. UserInput: "查找今年的大数据会议 (2025)。", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:32:29.898Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:32:30.088Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 30
[2025-05-13T02:32:30.088Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:32:30.088Z] --- [iMKO-1747103549898 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "查找今年的大数据会议 (2025)。", Lang: en ---
[2025-05-13T02:32:30.089Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:32:30.089Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:30.089Z] --- [iMKO-1747103549898 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:30.090Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:30.090Z] [iMKO-1747103549898 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 31
[2025-05-13T02:32:30.090Z] [GeminiService] Received history with 31 items before mapping (for stream).
[2025-05-13T02:32:30.090Z] [GeminiService] Mapped history (SDK Content[]) with 31 items (for stream).
[2025-05-13T02:32:30.090Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:30.090Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:30.091Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:30.091Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:30.091Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:30.091Z] [GeminiService Stream] Preparing stream request with 31 Content items.
[2025-05-13T02:32:30.091Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:32.438Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:32:32.439Z] [iMKO-1747103549898 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:32:32.439Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:32.439Z] --- [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 4d4df6f3-5032-4368-987e-f1991ad0a309 ---
[2025-05-13T02:32:32.440Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:32:32.440Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:32:32.440Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:32:32.441Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:32:32.441Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:32:32.441Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:32.441Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:32.441Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:32.441Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:32:32.442Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:32.442Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:32:32.442Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:34.245Z] Model Finish Reason: STOP
[2025-05-13T02:32:34.246Z] Model requested function call: getConferences
[2025-05-13T02:32:34.246Z] Arguments: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T02:32:34.246Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:32:34.246Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439] ConferenceAgent requests function call: getConferences
[2025-05-13T02:32:34.246Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:32:34.247Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:32:34.247Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:32:34.248Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:32:34.248Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T02:32:34.248Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:32:34.249Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:32:34.249Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:32:34.250Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:32:34.251Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:32:34.251Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:32:34.251Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1}
[2025-05-13T02:32:34.984Z] [BackendService] [conference] API Success (200). Data length: 8009. Attempting parsing...
[2025-05-13T02:32:34.985Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T02:32:34.985Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:32:34.985Z] Transforming conference data with Markdown. Search query: topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1
[2025-05-13T02:32:34.990Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 37
- **Total page:** 8
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T02:32:34.990Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"
[2025-05-13T02:32:34.991Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:32:34.991Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:32:34.991Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:32:34.992Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:32:34.992Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:32:34.992Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:32:34.992Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:32:34.993Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:32:34.993Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:32:34.993Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:32:34.993Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:32:34.994Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:32:34.994Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:32:34.994Z] [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:32:34.994Z] --- [iMKO-1747103549898-Sub-ConferenceAgent-1747103552439] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:32:34.995Z] [iMKO-1747103549898 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:32:34.995Z] --- [iMKO-1747103549898 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:34.995Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:34.995Z] [iMKO-1747103549898 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 33
[2025-05-13T02:32:34.996Z] [GeminiService] Received history with 33 items before mapping (for stream).
[2025-05-13T02:32:34.996Z] [GeminiService] Mapped history (SDK Content[]) with 33 items (for stream).
[2025-05-13T02:32:34.996Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:32:34.996Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:34.996Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:34.996Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:34.997Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:34.997Z] [GeminiService Stream] Preparing stream request with 33 Content items.
[2025-05-13T02:32:34.997Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:36.094Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:32:36.094Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:36.095Z] [iMKO-1747103549898 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:32:36.095Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:36.095Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.156Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.225Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.349Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.483Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.675Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.843Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:36.846Z] [iMKO-1747103549898 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 614
[2025-05-13T02:32:36.847Z] [iMKO-1747103549898 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:32:36.847Z] [iMKO-1747103549898 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:32:36.848Z] --- [iMKO-1747103549898 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:32:36.848Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 34
[2025-05-13T02:32:36.933Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:32:36.933Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:32:36.934Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:32:37.175Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:32:37.175Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103549898][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:32:44.980Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"我想了解欧洲的区块链会议。","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:32:44.980Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980] Request received. UserInput: "我想了解欧洲的区块链会议。", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:32:44.980Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:32:45.161Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 34
[2025-05-13T02:32:45.161Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:32:45.162Z] --- [iMKO-1747103564980 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "我想了解欧洲的区块链会议。", Lang: en ---
[2025-05-13T02:32:45.162Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:32:45.162Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:45.163Z] --- [iMKO-1747103564980 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:45.163Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:45.163Z] [iMKO-1747103564980 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 35
[2025-05-13T02:32:45.163Z] [GeminiService] Received history with 35 items before mapping (for stream).
[2025-05-13T02:32:45.164Z] [GeminiService] Mapped history (SDK Content[]) with 35 items (for stream).
[2025-05-13T02:32:45.164Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:45.164Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:45.164Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:45.164Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:45.164Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:45.165Z] [GeminiService Stream] Preparing stream request with 35 Content items.
[2025-05-13T02:32:45.165Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:47.576Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:32:47.576Z] [iMKO-1747103564980 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:32:47.576Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:47.577Z] --- [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: eaab78bb-d18f-4cd5-ab0b-0b0fe8dba1af ---
[2025-05-13T02:32:47.577Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:32:47.577Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:32:47.577Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:32:47.578Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:32:47.578Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:32:47.578Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:32:47.579Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:47.579Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:47.579Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:32:47.579Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:47.580Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:32:47.580Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:49.350Z] Model Finish Reason: STOP
[2025-05-13T02:32:49.350Z] Model requested function call: getConferences
[2025-05-13T02:32:49.350Z] Arguments: {"searchQuery":"topics=blockchain&continent=Europe&perPage=5&page=1"}
[2025-05-13T02:32:49.351Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:32:49.351Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577] ConferenceAgent requests function call: getConferences
[2025-05-13T02:32:49.351Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:32:49.351Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:32:49.352Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:32:49.352Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:32:49.352Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=blockchain&continent=Europe&perPage=5&page=1"}
[2025-05-13T02:32:49.352Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:32:49.353Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:32:49.353Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:32:49.353Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:32:49.353Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:32:49.354Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:32:49.354Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=blockchain&continent=Europe&perPage=5&page=1}
[2025-05-13T02:32:50.091Z] [BackendService] [conference] API Success (200). Data length: 10062. Attempting parsing...
[2025-05-13T02:32:50.091Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T02:32:50.092Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:32:50.092Z] Transforming conference data with Markdown. Search query: topics=blockchain&continent=Europe&perPage=5&page=1
[2025-05-13T02:32:50.101Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 17
- **Total page:** 4
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T02:32:50.101Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=blockchain&continent=Europe&perPage=5&page=1"
[2025-05-13T02:32:50.101Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:32:50.101Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:32:50.102Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:32:50.102Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:32:50.102Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:32:50.103Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:32:50.103Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:32:50.103Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:32:50.103Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:32:50.104Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:32:50.104Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:32:50.104Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:32:50.104Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:32:50.105Z] [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:32:50.105Z] --- [iMKO-1747103564980-Sub-ConferenceAgent-1747103567577] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:32:50.105Z] [iMKO-1747103564980 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:32:50.105Z] --- [iMKO-1747103564980 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:32:50.106Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:50.106Z] [iMKO-1747103564980 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 37
[2025-05-13T02:32:50.106Z] [GeminiService] Received history with 37 items before mapping (for stream).
[2025-05-13T02:32:50.106Z] [GeminiService] Mapped history (SDK Content[]) with 37 items (for stream).
[2025-05-13T02:32:50.106Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:32:50.106Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:32:50.106Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:32:50.107Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:32:50.107Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:32:50.107Z] [GeminiService Stream] Preparing stream request with 37 Content items.
[2025-05-13T02:32:50.107Z]   - No valid next turn added, sending only history.
[2025-05-13T02:32:51.358Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:32:51.359Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:51.359Z] [iMKO-1747103564980 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:32:51.359Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:32:51.360Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:51.423Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:51.495Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:51.622Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:51.776Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:51.975Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:52.114Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:32:52.119Z] [iMKO-1747103564980 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 619
[2025-05-13T02:32:52.119Z] [iMKO-1747103564980 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:32:52.120Z] [iMKO-1747103564980 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:32:52.120Z] --- [iMKO-1747103564980 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:32:52.121Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 38
[2025-05-13T02:32:52.215Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:32:52.215Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:32:52.216Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:32:52.469Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:32:52.470Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103564980][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:33:09.689Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Go to the website for the \"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:33:09.689Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689] Request received. UserInput: "Go to the website for the "Int...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:33:09.690Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:33:09.874Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 38
[2025-05-13T02:33:09.875Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:33:09.875Z] --- [iMKO-1747103589689 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Go to the website for the "International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management".", Lang: en ---
[2025-05-13T02:33:09.875Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:33:09.876Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:09.876Z] --- [iMKO-1747103589689 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:33:09.877Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:09.877Z] [iMKO-1747103589689 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 39
[2025-05-13T02:33:09.877Z] [GeminiService] Received history with 39 items before mapping (for stream).
[2025-05-13T02:33:09.877Z] [GeminiService] Mapped history (SDK Content[]) with 39 items (for stream).
[2025-05-13T02:33:09.878Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:33:09.878Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:09.878Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:09.878Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:33:09.878Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:09.879Z] [GeminiService Stream] Preparing stream request with 39 Content items.
[2025-05-13T02:33:09.879Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:12.244Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:33:12.245Z] [iMKO-1747103589689 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:33:12.245Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:12.246Z] --- [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: da991bcc-5530-4aa1-81b4-940cb1d003b0 ---
[2025-05-13T02:33:12.246Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:33:12.247Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:33:12.247Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:33:12.248Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:33:12.248Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:33:12.248Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:33:12.249Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:12.249Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:12.249Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:33:12.250Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:12.250Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:33:12.250Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:13.217Z] Model Finish Reason: STOP
[2025-05-13T02:33:13.217Z] Model requested function call: getConferences
[2025-05-13T02:33:13.217Z] Arguments: {"searchQuery":"title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1"}
[2025-05-13T02:33:13.218Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:33:13.218Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246] ConferenceAgent requests function call: getConferences
[2025-05-13T02:33:13.218Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:33:13.218Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:33:13.219Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:33:13.219Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:33:13.219Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1"}
[2025-05-13T02:33:13.219Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:33:13.219Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:33:13.220Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:33:13.220Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:33:13.220Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:33:13.220Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:33:13.221Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1}
[2025-05-13T02:33:13.901Z] [BackendService] [conference] API Success (200). Data length: 983. Attempting parsing...
[2025-05-13T02:33:13.902Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"6ebe9334-c7b0-447c-adee-2f856c564bf3","title":"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management","acronym":"IC3K","location":{"cityStateProvince":"","country":"","address":"Avail...
[2025-05-13T02:33:13.902Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:33:13.902Z] Transforming conference data with Markdown. Search query: title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1
[2025-05-13T02:33:13.904Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Joint Conference on Knowledge Discovery, Knowle...
[2025-05-13T02:33:13.904Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1"
[2025-05-13T02:33:13.904Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:33:13.905Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:33:13.905Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:33:13.905Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:33:13.906Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:33:13.906Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:33:13.906Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:33:13.906Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:33:13.906Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:33:13.907Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:33:13.907Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:33:13.907Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:33:13.907Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:33:13.907Z] [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:33:13.907Z] --- [iMKO-1747103589689-Sub-ConferenceAgent-1747103592246] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:33:13.908Z] [iMKO-1747103589689 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:33:13.908Z] --- [iMKO-1747103589689 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:33:13.908Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:13.908Z] [iMKO-1747103589689 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 41
[2025-05-13T02:33:13.909Z] [GeminiService] Received history with 41 items before mapping (for stream).
[2025-05-13T02:33:13.909Z] [GeminiService] Mapped history (SDK Content[]) with 41 items (for stream).
[2025-05-13T02:33:13.909Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:33:13.909Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:13.909Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:13.909Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:33:13.910Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:13.910Z] [GeminiService Stream] Preparing stream request with 41 Content items.
[2025-05-13T02:33:13.910Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:15.217Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:33:15.218Z] [iMKO-1747103589689 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:33:15.218Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:15.219Z] --- [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: c5b3f9b7-00a8-4f8c-838c-f7ec811e56a3 ---
[2025-05-13T02:33:15.219Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:33:15.219Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:33:15.219Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:33:15.220Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:33:15.220Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:33:15.220Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:33:15.220Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:15.220Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:15.221Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:33:15.221Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:15.221Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:33:15.221Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:15.963Z] Model Finish Reason: STOP
[2025-05-13T02:33:15.963Z] Model requested function call: navigation
[2025-05-13T02:33:15.964Z] Arguments: {"url":"https://ic3k.scitevents.org/"}
[2025-05-13T02:33:15.964Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:33:15.964Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219] NavigationAgent requests function call: navigation
[2025-05-13T02:33:15.965Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T02:33:15.965Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:33:15.966Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:33:15.966Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T02:33:15.967Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 iMKO9E-ypIEYbt8aAAAH] Handler: Navigation, Args: {"url":"https://ic3k.scitevents.org/"}
[2025-05-13T02:33:15.967Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T02:33:15.968Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T02:33:15.968Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 iMKO9E-ypIEYbt8aAAAH] Navigation: Valid target URL: https://ic3k.scitevents.org/
[2025-05-13T02:33:15.968Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T02:33:15.969Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T02:33:15.969Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T02:33:15.969Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:33:15.969Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:33:15.969Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:33:15.970Z] [iMKO-1747103589689-Sub-NavigationAgent-1747103595219 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:33:15.970Z] --- [iMKO-1747103589689-Sub-NavigationAgent-1747103595219] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:33:15.970Z] [iMKO-1747103589689 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:33:15.970Z] --- [iMKO-1747103589689 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:33:15.970Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:15.971Z] [iMKO-1747103589689 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 43
[2025-05-13T02:33:15.971Z] [GeminiService] Received history with 43 items before mapping (for stream).
[2025-05-13T02:33:15.971Z] [GeminiService] Mapped history (SDK Content[]) with 43 items (for stream).
[2025-05-13T02:33:15.971Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:33:15.972Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:15.972Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:15.972Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:33:15.972Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:15.972Z] [GeminiService Stream] Preparing stream request with 43 Content items.
[2025-05-13T02:33:15.972Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:17.121Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:33:17.122Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:17.122Z] [iMKO-1747103589689 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:33:17.123Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:17.123Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:33:17.192Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:33:17.245Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:33:17.249Z] [iMKO-1747103589689 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 143
[2025-05-13T02:33:17.249Z] [iMKO-1747103589689 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:33:17.250Z] [iMKO-1747103589689 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:33:17.250Z] --- [iMKO-1747103589689 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:33:17.250Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 44
[2025-05-13T02:33:17.339Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:33:17.340Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:33:17.340Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:33:17.595Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:33:17.596Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103589689][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:33:29.594Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Direct me to the official site of \"AAAI\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:33:29.594Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594] Request received. UserInput: "Direct me to the official site...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:33:29.595Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:33:29.772Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 44
[2025-05-13T02:33:29.772Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:33:29.772Z] --- [iMKO-1747103609594 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Direct me to the official site of "AAAI".", Lang: en ---
[2025-05-13T02:33:29.772Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:33:29.773Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:29.773Z] --- [iMKO-1747103609594 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:33:29.773Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:29.774Z] [iMKO-1747103609594 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 45
[2025-05-13T02:33:29.774Z] [GeminiService] Received history with 45 items before mapping (for stream).
[2025-05-13T02:33:29.774Z] [GeminiService] Mapped history (SDK Content[]) with 45 items (for stream).
[2025-05-13T02:33:29.774Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:33:29.774Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:29.774Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:29.775Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:33:29.775Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:29.775Z] [GeminiService Stream] Preparing stream request with 45 Content items.
[2025-05-13T02:33:29.775Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:31.145Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:33:31.145Z] [iMKO-1747103609594 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:33:31.146Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:31.146Z] --- [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 910f0ad3-50b0-4ad5-8642-c06109becd7e ---
[2025-05-13T02:33:31.146Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:33:31.147Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:33:31.147Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:33:31.147Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:33:31.148Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:33:31.148Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:33:31.148Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:31.148Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:31.149Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:33:31.149Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:31.149Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:33:31.154Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:32.083Z] Model Finish Reason: STOP
[2025-05-13T02:33:32.083Z] Model requested function call: getConferences
[2025-05-13T02:33:32.083Z] Arguments: {"searchQuery":"acronym=AAAI&perPage=5&page=1&mode=detail"}
[2025-05-13T02:33:32.083Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:33:32.083Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146] ConferenceAgent requests function call: getConferences
[2025-05-13T02:33:32.084Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:33:32.084Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:33:32.084Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:33:32.085Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:33:32.085Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=AAAI&perPage=5&page=1&mode=detail"}
[2025-05-13T02:33:32.085Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:33:32.085Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:33:32.086Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:33:32.086Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:33:32.086Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:33:32.086Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:33:32.086Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=AAAI&perPage=5&page=1&mode=detail}
[2025-05-13T02:33:32.755Z] [BackendService] [conference] API Success (200). Data length: 1304. Attempting parsing...
[2025-05-13T02:33:32.755Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Association for Artificial Intelligence","acronym":"AAAI","location":{"cityStateProvince":"Philadelphia, Pennsylvania","country":"United States","ad...
[2025-05-13T02:33:32.756Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:33:32.756Z] Transforming conference data with Markdown. Search query: acronym=AAAI&perPage=5&page=1&mode=detail
[2025-05-13T02:33:32.756Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** National Conference of the American Association for Artificia...
[2025-05-13T02:33:32.757Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=AAAI&perPage=5&page=1&mode=detail"
[2025-05-13T02:33:32.757Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:33:32.757Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:33:32.757Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:33:32.758Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:33:32.758Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:33:32.758Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:33:32.758Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:33:32.758Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:33:32.759Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:33:32.759Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:33:32.759Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:33:32.759Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:33:32.759Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:33:32.760Z] [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:33:32.760Z] --- [iMKO-1747103609594-Sub-ConferenceAgent-1747103611146] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:33:32.760Z] [iMKO-1747103609594 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:33:32.760Z] --- [iMKO-1747103609594 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:33:32.760Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:32.760Z] [iMKO-1747103609594 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 47
[2025-05-13T02:33:32.761Z] [GeminiService] Received history with 47 items before mapping (for stream).
[2025-05-13T02:33:32.761Z] [GeminiService] Mapped history (SDK Content[]) with 47 items (for stream).
[2025-05-13T02:33:32.761Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:33:32.761Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:33:32.761Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:33:32.762Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:33:32.762Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:33:32.762Z] [GeminiService Stream] Preparing stream request with 47 Content items.
[2025-05-13T02:33:32.762Z]   - No valid next turn added, sending only history.
[2025-05-13T02:33:33.930Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:33:33.931Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:33.932Z] [iMKO-1747103609594 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:33:33.932Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:33:33.932Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:33:34.078Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:33:34.127Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:33:34.132Z] [iMKO-1747103609594 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 79
[2025-05-13T02:33:34.133Z] [iMKO-1747103609594 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:33:34.133Z] [iMKO-1747103609594 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:33:34.134Z] --- [iMKO-1747103609594 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:33:34.134Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 48
[2025-05-13T02:33:34.231Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:33:34.232Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:33:34.232Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:33:34.483Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:33:34.484Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103609594][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:34:09.905Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"find again","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:34:09.906Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906] Request received. UserInput: "find again", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:34:09.906Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:34:10.098Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 48
[2025-05-13T02:34:10.099Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:34:10.099Z] --- [iMKO-1747103649906 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "find again", Lang: en ---
[2025-05-13T02:34:10.099Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:34:10.099Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:10.100Z] --- [iMKO-1747103649906 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:10.100Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:10.100Z] [iMKO-1747103649906 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 49
[2025-05-13T02:34:10.100Z] [GeminiService] Received history with 49 items before mapping (for stream).
[2025-05-13T02:34:10.101Z] [GeminiService] Mapped history (SDK Content[]) with 49 items (for stream).
[2025-05-13T02:34:10.101Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:10.101Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:10.101Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:10.101Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:10.102Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:10.102Z] [GeminiService Stream] Preparing stream request with 49 Content items.
[2025-05-13T02:34:10.102Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:12.457Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:34:12.457Z] [iMKO-1747103649906 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:34:12.457Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:12.458Z] --- [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: b822a211-7a10-4120-9815-327a688ecff9 ---
[2025-05-13T02:34:12.458Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:34:12.458Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:34:12.459Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:34:12.459Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:34:12.459Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:34:12.459Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:12.459Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:12.459Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:12.459Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:34:12.460Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:12.460Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:34:12.460Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:13.284Z] Model Finish Reason: STOP
[2025-05-13T02:34:13.284Z] Model requested function call: getConferences
[2025-05-13T02:34:13.284Z] Arguments: {"searchQuery":"acronym=AAAI&perPage=5&page=1"}
[2025-05-13T02:34:13.285Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:34:13.285Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458] ConferenceAgent requests function call: getConferences
[2025-05-13T02:34:13.285Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:34:13.285Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:34:13.286Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:34:13.286Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:34:13.286Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=AAAI&perPage=5&page=1"}
[2025-05-13T02:34:13.287Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:34:13.287Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:34:13.287Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:34:13.287Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:34:13.287Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:34:13.288Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:34:13.288Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=AAAI&perPage=5&page=1}
[2025-05-13T02:34:13.969Z] [BackendService] [conference] API Success (200). Data length: 1304. Attempting parsing...
[2025-05-13T02:34:13.970Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Association for Artificial Intelligence","acronym":"AAAI","location":{"cityStateProvince":"Philadelphia, Pennsylvania","country":"United States","ad...
[2025-05-13T02:34:13.970Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:34:13.970Z] Transforming conference data with Markdown. Search query: acronym=AAAI&perPage=5&page=1
[2025-05-13T02:34:13.971Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** National Conference of the American Association for Artificia...
[2025-05-13T02:34:13.972Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=AAAI&perPage=5&page=1"
[2025-05-13T02:34:13.972Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:34:13.972Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:34:13.973Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:34:13.973Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:34:13.973Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:34:13.973Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:34:13.974Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:34:13.974Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:34:13.974Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:34:13.974Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:34:13.974Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:34:13.974Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:34:13.975Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:34:13.975Z] [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:34:13.975Z] --- [iMKO-1747103649906-Sub-ConferenceAgent-1747103652458] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:34:13.975Z] [iMKO-1747103649906 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:34:13.975Z] --- [iMKO-1747103649906 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:13.976Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:13.976Z] [iMKO-1747103649906 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:34:13.976Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:34:13.976Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:34:13.976Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:34:13.976Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:13.977Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:13.978Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:13.978Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:13.978Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:34:13.978Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:15.378Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:34:15.378Z] [iMKO-1747103649906 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:34:15.379Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:15.379Z] --- [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: ff66f66b-9867-48bf-b686-be4ecac1d6d9 ---
[2025-05-13T02:34:15.380Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:34:15.380Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:34:15.380Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:34:15.380Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:34:15.380Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:34:15.381Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:15.381Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:15.381Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:15.381Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:34:15.381Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:15.381Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:34:15.381Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:16.221Z] Model Finish Reason: STOP
[2025-05-13T02:34:16.222Z] Model requested function call: navigation
[2025-05-13T02:34:16.222Z] Arguments: {"url":"https://aaai.org/conference/aaai/aaai-25/"}
[2025-05-13T02:34:16.222Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:34:16.222Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379] NavigationAgent requests function call: navigation
[2025-05-13T02:34:16.222Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T02:34:16.223Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:34:16.224Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:34:16.224Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T02:34:16.225Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 iMKO9E-ypIEYbt8aAAAH] Handler: Navigation, Args: {"url":"https://aaai.org/conference/aaai/aaai-25/"}
[2025-05-13T02:34:16.225Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T02:34:16.228Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T02:34:16.228Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 iMKO9E-ypIEYbt8aAAAH] Navigation: Valid target URL: https://aaai.org/conference/aaai/aaai-25/
[2025-05-13T02:34:16.229Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T02:34:16.229Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T02:34:16.230Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T02:34:16.230Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:34:16.231Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:34:16.231Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:34:16.232Z] [iMKO-1747103649906-Sub-NavigationAgent-1747103655379 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:34:16.232Z] --- [iMKO-1747103649906-Sub-NavigationAgent-1747103655379] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:34:16.232Z] [iMKO-1747103649906 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:34:16.233Z] --- [iMKO-1747103649906 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:16.233Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:16.233Z] [iMKO-1747103649906 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:34:16.234Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:34:16.234Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:34:16.234Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:34:16.234Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:16.234Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:16.235Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:16.235Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:16.235Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:34:16.235Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:17.367Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:34:17.367Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:17.368Z] [iMKO-1747103649906 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:34:17.368Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:17.368Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:17.412Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:17.416Z] [iMKO-1747103649906 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 55
[2025-05-13T02:34:17.417Z] [iMKO-1747103649906 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:34:17.417Z] [iMKO-1747103649906 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:34:17.418Z] --- [iMKO-1747103649906 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:34:17.418Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:34:17.509Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:34:17.509Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:34:17.509Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:34:17.802Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:34:17.803Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103649906][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:34:31.888Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Open the website for \"RAID 2025\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:34:31.889Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889] Request received. UserInput: "Open the website for "RAID 202...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:34:31.889Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:34:32.068Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:34:32.069Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:34:32.069Z] --- [iMKO-1747103671889 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Open the website for "RAID 2025".", Lang: en ---
[2025-05-13T02:34:32.069Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:34:32.070Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:32.070Z] --- [iMKO-1747103671889 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:32.070Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:32.070Z] [iMKO-1747103671889 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:34:32.070Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:34:32.071Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:34:32.071Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:32.071Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:32.071Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:32.072Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:32.072Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:32.072Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:34:32.072Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:34.533Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:34:34.533Z] [iMKO-1747103671889 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:34:34.534Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:34.534Z] --- [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 25d9e706-a598-46b4-af09-a64881a9ffe3 ---
[2025-05-13T02:34:34.534Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:34:34.534Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:34:34.535Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:34:34.535Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:34:34.535Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:34:34.535Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:34.536Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:34.536Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:34.536Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:34:34.536Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:34.536Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:34:34.536Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:35.320Z] Model Finish Reason: STOP
[2025-05-13T02:34:35.320Z] Model requested function call: getConferences
[2025-05-13T02:34:35.321Z] Arguments: {"searchQuery":"title=RAID+2025&perPage=5&page=1"}
[2025-05-13T02:34:35.321Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:34:35.321Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534] ConferenceAgent requests function call: getConferences
[2025-05-13T02:34:35.321Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:34:35.321Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:34:35.322Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:34:35.322Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:34:35.322Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=RAID+2025&perPage=5&page=1"}
[2025-05-13T02:34:35.323Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:34:35.323Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:34:35.323Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:34:35.323Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:34:35.323Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:34:35.324Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:34:35.324Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=RAID+2025&perPage=5&page=1}
[2025-05-13T02:34:36.010Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T02:34:36.011Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T02:34:36.011Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:34:36.011Z] Transforming conference data with Markdown. Search query: title=RAID+2025&perPage=5&page=1
[2025-05-13T02:34:36.012Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T02:34:36.012Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=RAID+2025&perPage=5&page=1"
[2025-05-13T02:34:36.012Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:34:36.012Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:34:36.013Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:34:36.013Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:34:36.014Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:34:36.014Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:34:36.014Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:34:36.015Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:34:36.015Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:34:36.015Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:34:36.015Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:34:36.016Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:34:36.018Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:34:36.018Z] [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:34:36.018Z] --- [iMKO-1747103671889-Sub-ConferenceAgent-1747103674534] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:34:36.019Z] [iMKO-1747103671889 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:34:36.019Z] --- [iMKO-1747103671889 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:36.019Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:36.020Z] [iMKO-1747103671889 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:34:36.020Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:34:36.020Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:34:36.020Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:34:36.020Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:36.021Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:36.021Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:36.021Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:36.021Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:34:36.021Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:37.138Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:34:37.139Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:37.139Z] [iMKO-1747103671889 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:34:37.139Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:37.140Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:37.221Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:37.303Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:37.308Z] [iMKO-1747103671889 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 110
[2025-05-13T02:34:37.308Z] [iMKO-1747103671889 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:34:37.309Z] [iMKO-1747103671889 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:34:37.310Z] --- [iMKO-1747103671889 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:34:37.310Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:34:37.395Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:34:37.396Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:34:37.396Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:34:37.647Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:34:37.648Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103671889][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:34:53.734Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"RAID is acronym","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:34:53.734Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734] Request received. UserInput: "RAID is acronym", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:34:53.734Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:34:53.916Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:34:53.916Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:34:53.916Z] --- [iMKO-1747103693734 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "RAID is acronym", Lang: en ---
[2025-05-13T02:34:53.916Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:34:53.917Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:53.917Z] --- [iMKO-1747103693734 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:53.917Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:53.917Z] [iMKO-1747103693734 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:34:53.917Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:34:53.917Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:34:53.918Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:53.918Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:53.918Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:53.918Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:53.918Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:53.918Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:34:53.918Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:55.315Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:34:55.316Z] [iMKO-1747103693734 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:34:55.316Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:55.316Z] --- [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 1e87f020-4c32-4021-b7d3-00ed7fdcc12b ---
[2025-05-13T02:34:55.316Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:34:55.317Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:34:55.317Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:34:55.317Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:34:55.317Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:34:55.318Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:34:55.318Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:55.318Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:55.319Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:34:55.319Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:55.319Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:34:55.320Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:57.053Z] Model Finish Reason: STOP
[2025-05-13T02:34:57.053Z] Model requested function call: getConferences
[2025-05-13T02:34:57.054Z] Arguments: {"searchQuery":"title=RAID&perPage=5&page=1"}
[2025-05-13T02:34:57.054Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:34:57.054Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316] ConferenceAgent requests function call: getConferences
[2025-05-13T02:34:57.054Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:34:57.055Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:34:57.055Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:34:57.055Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=RAID&perPage=5&page=1"}
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:34:57.056Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:34:57.057Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=RAID&perPage=5&page=1}
[2025-05-13T02:34:57.796Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T02:34:57.796Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T02:34:57.797Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:34:57.797Z] Transforming conference data with Markdown. Search query: title=RAID&perPage=5&page=1
[2025-05-13T02:34:57.797Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T02:34:57.797Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=RAID&perPage=5&page=1"
[2025-05-13T02:34:57.797Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:34:57.798Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:34:57.798Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:34:57.799Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:34:57.799Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:34:57.799Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:34:57.799Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:34:57.799Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:34:57.800Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:34:57.800Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:34:57.800Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:34:57.800Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:34:57.800Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:34:57.801Z] [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:34:57.801Z] --- [iMKO-1747103693734-Sub-ConferenceAgent-1747103695316] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:34:57.801Z] [iMKO-1747103693734 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:34:57.801Z] --- [iMKO-1747103693734 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:34:57.802Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:57.802Z] [iMKO-1747103693734 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:34:57.802Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:34:57.803Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:34:57.803Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:34:57.803Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:34:57.803Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:34:57.804Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:34:57.804Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:34:57.804Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:34:57.804Z]   - No valid next turn added, sending only history.
[2025-05-13T02:34:58.945Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:34:58.946Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:58.946Z] [iMKO-1747103693734 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:34:58.946Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:34:58.946Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:59.022Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:34:59.028Z] [iMKO-1747103693734 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 77
[2025-05-13T02:34:59.028Z] [iMKO-1747103693734 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:34:59.028Z] [iMKO-1747103693734 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:34:59.029Z] --- [iMKO-1747103693734 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:34:59.029Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:34:59.156Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:34:59.157Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:34:59.157Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:34:59.416Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:34:59.417Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103693734][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:35:25.783Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"RAID is acronym not title","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:35:25.784Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784] Request received. UserInput: "RAID is acronym not title", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:35:25.785Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:35:25.966Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:35:25.967Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:35:25.968Z] --- [iMKO-1747103725784 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "RAID is acronym not title", Lang: en ---
[2025-05-13T02:35:25.969Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:35:25.969Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:25.970Z] --- [iMKO-1747103725784 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:35:25.970Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:25.970Z] [iMKO-1747103725784 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:35:25.970Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:35:25.971Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:35:25.971Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:35:25.971Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:25.971Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:25.972Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:35:25.972Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:25.972Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:35:25.972Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:27.247Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:35:27.247Z] [iMKO-1747103725784 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:35:27.248Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:27.248Z] --- [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 7d566e12-29e9-4c0c-9dc5-6b7fda1f3c4c ---
[2025-05-13T02:35:27.249Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:35:27.249Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:35:27.249Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:35:27.249Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:35:27.249Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:35:27.249Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:35:27.250Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:27.250Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:27.250Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:35:27.250Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:27.250Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:35:27.251Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:28.055Z] Model Finish Reason: STOP
[2025-05-13T02:35:28.056Z] Model requested function call: getConferences
[2025-05-13T02:35:28.056Z] Arguments: {"searchQuery":"acronym=RAID&perPage=5&page=1"}
[2025-05-13T02:35:28.056Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:35:28.056Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248] ConferenceAgent requests function call: getConferences
[2025-05-13T02:35:28.056Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:35:28.057Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:35:28.057Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:35:28.057Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:35:28.058Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=RAID&perPage=5&page=1"}
[2025-05-13T02:35:28.058Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:35:28.058Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:35:28.058Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:35:28.058Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:35:28.059Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:35:28.059Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:35:28.059Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=RAID&perPage=5&page=1}
[2025-05-13T02:35:28.733Z] [BackendService] [conference] API Success (200). Data length: 1572. Attempting parsing...
[2025-05-13T02:35:28.733Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"15165896-05b4-47f8-89a1-7576939f34d2","title":"The International Symposium on Research in Attacks, Intrusions and Defenses","acronym":"RAID","location":{"cityStateProvince":"Gold Coast","country":"Australia","address":"Gold Coast, ...
[2025-05-13T02:35:28.733Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:35:28.734Z] Transforming conference data with Markdown. Search query: acronym=RAID&perPage=5&page=1
[2025-05-13T02:35:28.737Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** The International Symposium on Research in Attacks, Intrusion...
[2025-05-13T02:35:28.737Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=RAID&perPage=5&page=1"
[2025-05-13T02:35:28.737Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:35:28.737Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:35:28.738Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:35:28.738Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:35:28.738Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:35:28.738Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:35:28.739Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:35:28.739Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:35:28.739Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:35:28.739Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:35:28.739Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:35:28.742Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:35:28.742Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:35:28.743Z] [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:35:28.743Z] --- [iMKO-1747103725784-Sub-ConferenceAgent-1747103727248] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:35:28.743Z] [iMKO-1747103725784 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:35:28.744Z] --- [iMKO-1747103725784 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:35:28.744Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:28.745Z] [iMKO-1747103725784 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:35:28.746Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:35:28.746Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:35:28.747Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:35:28.755Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:28.757Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:28.758Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:35:28.758Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:28.759Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:35:28.759Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:29.918Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:35:29.931Z] [iMKO-1747103725784 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:35:29.931Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:29.932Z] --- [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: 0704f879-afd6-4ef3-ab4b-3982bc66efd3 ---
[2025-05-13T02:35:29.932Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:35:29.932Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:35:29.939Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:35:29.940Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:35:29.940Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:35:29.940Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:35:29.940Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:29.941Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:29.941Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:35:29.941Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:29.941Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:35:29.941Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:30.550Z] Model Finish Reason: STOP
[2025-05-13T02:35:30.551Z] Model requested function call: navigation
[2025-05-13T02:35:30.551Z] Arguments: {"url":"https://raid2025.github.io/"}
[2025-05-13T02:35:30.552Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:35:30.552Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932] NavigationAgent requests function call: navigation
[2025-05-13T02:35:30.552Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T02:35:30.553Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:35:30.553Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:35:30.554Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T02:35:30.554Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 iMKO9E-ypIEYbt8aAAAH] Handler: Navigation, Args: {"url":"https://raid2025.github.io/"}
[2025-05-13T02:35:30.554Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T02:35:30.555Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T02:35:30.555Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 iMKO9E-ypIEYbt8aAAAH] Navigation: Valid target URL: https://raid2025.github.io/
[2025-05-13T02:35:30.564Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T02:35:30.565Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T02:35:30.566Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T02:35:30.569Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:35:30.570Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:35:30.570Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:35:30.571Z] [iMKO-1747103725784-Sub-NavigationAgent-1747103729932 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:35:30.571Z] --- [iMKO-1747103725784-Sub-NavigationAgent-1747103729932] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:35:30.572Z] [iMKO-1747103725784 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:35:30.572Z] --- [iMKO-1747103725784 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:35:30.572Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:30.572Z] [iMKO-1747103725784 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:35:30.573Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:35:30.573Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:35:30.573Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:35:30.573Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:30.573Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:30.574Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:35:30.574Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:30.574Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:35:30.574Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:31.562Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:35:31.562Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:31.563Z] [iMKO-1747103725784 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:35:31.563Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:31.563Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:35:31.617Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:35:31.671Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:35:31.674Z] [iMKO-1747103725784 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 118
[2025-05-13T02:35:31.674Z] [iMKO-1747103725784 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:35:31.675Z] [iMKO-1747103725784 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:35:31.675Z] --- [iMKO-1747103725784 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:35:31.675Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:35:31.764Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:35:31.765Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:35:31.765Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:35:32.021Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:35:32.023Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103725784][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:35:45.280Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Truy cập trang web của hội nghị \"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:35:45.280Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280] Request received. UserInput: "Truy cập trang web của hội ngh...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:35:45.280Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:35:45.471Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:35:45.471Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:35:45.471Z] --- [iMKO-1747103745280 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Truy cập trang web của hội nghị "International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management".", Lang: en ---
[2025-05-13T02:35:45.471Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:35:45.472Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:45.472Z] --- [iMKO-1747103745280 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:35:45.472Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:45.473Z] [iMKO-1747103745280 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:35:45.473Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:35:45.473Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:35:45.473Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:35:45.473Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:45.473Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:45.474Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:35:45.474Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:45.474Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:35:45.474Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:47.597Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:35:47.597Z] [iMKO-1747103745280 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:35:47.598Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:47.598Z] --- [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 1d42f48c-4cae-47fd-88bc-d5557e47adda ---
[2025-05-13T02:35:47.598Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:35:47.599Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:35:47.599Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:35:47.599Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:35:47.600Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:35:47.600Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:35:47.600Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:47.600Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:47.601Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:35:47.601Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:47.601Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:35:47.601Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:48.452Z] Model Finish Reason: STOP
[2025-05-13T02:35:48.452Z] Model requested function call: getConferences
[2025-05-13T02:35:48.453Z] Arguments: {"searchQuery":"title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1"}
[2025-05-13T02:35:48.453Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:35:48.453Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598] ConferenceAgent requests function call: getConferences
[2025-05-13T02:35:48.453Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:35:48.453Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:35:48.454Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:35:48.454Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:35:48.454Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1"}
[2025-05-13T02:35:48.454Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:35:48.455Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:35:48.455Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:35:48.455Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:35:48.455Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:35:48.455Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:35:48.456Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1}
[2025-05-13T02:35:49.161Z] [BackendService] [conference] API Success (200). Data length: 983. Attempting parsing...
[2025-05-13T02:35:49.161Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"6ebe9334-c7b0-447c-adee-2f856c564bf3","title":"International Joint Conference on Knowledge Discovery, Knowledge Engineering and Knowledge Management","acronym":"IC3K","location":{"cityStateProvince":"","country":"","address":"Avail...
[2025-05-13T02:35:49.161Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:35:49.161Z] Transforming conference data with Markdown. Search query: title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1
[2025-05-13T02:35:49.164Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Joint Conference on Knowledge Discovery, Knowle...
[2025-05-13T02:35:49.164Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=International+Joint+Conference+on+Knowledge+Discovery,+Knowledge+Engineering+and+Knowledge+Management&perPage=5&page=1"
[2025-05-13T02:35:49.164Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:35:49.164Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:35:49.165Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:35:49.165Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:35:49.166Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:35:49.167Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:35:49.168Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:35:49.168Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:35:49.169Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:35:49.169Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:35:49.169Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:35:49.169Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:35:49.170Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:35:49.170Z] [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:35:49.170Z] --- [iMKO-1747103745280-Sub-ConferenceAgent-1747103747598] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:35:49.171Z] [iMKO-1747103745280 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:35:49.171Z] --- [iMKO-1747103745280 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:35:49.174Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:49.174Z] [iMKO-1747103745280 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:35:49.175Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:35:49.175Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:35:49.175Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:35:49.175Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:49.175Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:49.176Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:35:49.176Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:49.176Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:35:49.177Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:50.286Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:35:50.287Z] [iMKO-1747103745280 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:35:50.287Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:50.287Z] --- [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: c776cd5c-ba8d-4342-bf38-cdbb45dfa6d4 ---
[2025-05-13T02:35:50.288Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:35:50.288Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:35:50.288Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:35:50.289Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:35:50.289Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:35:50.289Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:35:50.289Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:50.289Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:50.290Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:35:50.290Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:50.290Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:35:50.290Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:51.031Z] Model Finish Reason: STOP
[2025-05-13T02:35:51.031Z] Model requested function call: navigation
[2025-05-13T02:35:51.031Z] Arguments: {"url":"https://ic3k.scitevents.org/"}
[2025-05-13T02:35:51.032Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:35:51.032Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287] NavigationAgent requests function call: navigation
[2025-05-13T02:35:51.032Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T02:35:51.033Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:35:51.033Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:35:51.034Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T02:35:51.034Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 iMKO9E-ypIEYbt8aAAAH] Handler: Navigation, Args: {"url":"https://ic3k.scitevents.org/"}
[2025-05-13T02:35:51.034Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T02:35:51.035Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T02:35:51.035Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 iMKO9E-ypIEYbt8aAAAH] Navigation: Valid target URL: https://ic3k.scitevents.org/
[2025-05-13T02:35:51.036Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T02:35:51.036Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T02:35:51.036Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T02:35:51.036Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:35:51.036Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:35:51.037Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:35:51.037Z] [iMKO-1747103745280-Sub-NavigationAgent-1747103750287 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:35:51.037Z] --- [iMKO-1747103745280-Sub-NavigationAgent-1747103750287] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:35:51.037Z] [iMKO-1747103745280 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:35:51.037Z] --- [iMKO-1747103745280 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:35:51.038Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:51.038Z] [iMKO-1747103745280 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:35:51.038Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:35:51.038Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:35:51.038Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:35:51.038Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:35:51.039Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:35:51.039Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:35:51.039Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:35:51.039Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:35:51.039Z]   - No valid next turn added, sending only history.
[2025-05-13T02:35:51.962Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:35:51.962Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:51.962Z] [iMKO-1747103745280 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:35:51.963Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:35:51.963Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:35:52.025Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:35:52.072Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:35:52.083Z] [iMKO-1747103745280 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 143
[2025-05-13T02:35:52.083Z] [iMKO-1747103745280 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:35:52.084Z] [iMKO-1747103745280 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:35:52.085Z] --- [iMKO-1747103745280 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:35:52.085Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:35:52.174Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:35:52.175Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:35:52.175Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:35:52.424Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:35:52.425Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103745280][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:36:02.677Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Chuyển hướng tôi đến trang web chính thức của \"AAAI\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:36:02.677Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677] Request received. UserInput: "Chuyển hướng tôi đến trang web...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:36:02.677Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:36:02.795Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:36:02.795Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:36:02.796Z] --- [iMKO-1747103762677 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Chuyển hướng tôi đến trang web chính thức của "AAAI".", Lang: en ---
[2025-05-13T02:36:02.796Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:36:02.797Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:02.797Z] --- [iMKO-1747103762677 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:02.797Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:02.797Z] [iMKO-1747103762677 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:36:02.798Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:36:02.798Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:36:02.798Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:02.798Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:02.798Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:02.799Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:02.799Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:02.799Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:36:02.799Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:03.779Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:36:03.780Z] [iMKO-1747103762677 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:36:03.780Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:03.781Z] --- [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 3004cc0e-da88-4846-99d3-2cd5a7a0d9f6 ---
[2025-05-13T02:36:03.781Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:36:03.781Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:36:03.781Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:36:03.781Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:36:03.782Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:36:03.782Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:03.782Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:03.782Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:03.782Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:36:03.783Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:03.783Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:36:03.784Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:04.564Z] Model Finish Reason: STOP
[2025-05-13T02:36:04.564Z] Model requested function call: getConferences
[2025-05-13T02:36:04.564Z] Arguments: {"searchQuery":"acronym=AAAI&perPage=5&page=1&mode=detail"}
[2025-05-13T02:36:04.565Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:36:04.565Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781] ConferenceAgent requests function call: getConferences
[2025-05-13T02:36:04.565Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:36:04.565Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:36:04.566Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:36:04.566Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:36:04.566Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=AAAI&perPage=5&page=1&mode=detail"}
[2025-05-13T02:36:04.566Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:36:04.567Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:36:04.567Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:36:04.567Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:36:04.567Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:36:04.568Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:36:04.568Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=AAAI&perPage=5&page=1&mode=detail}
[2025-05-13T02:36:05.254Z] [BackendService] [conference] API Success (200). Data length: 1304. Attempting parsing...
[2025-05-13T02:36:05.254Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Association for Artificial Intelligence","acronym":"AAAI","location":{"cityStateProvince":"Philadelphia, Pennsylvania","country":"United States","ad...
[2025-05-13T02:36:05.254Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:36:05.254Z] Transforming conference data with Markdown. Search query: acronym=AAAI&perPage=5&page=1&mode=detail
[2025-05-13T02:36:05.255Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** National Conference of the American Association for Artificia...
[2025-05-13T02:36:05.255Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=AAAI&perPage=5&page=1&mode=detail"
[2025-05-13T02:36:05.255Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:36:05.255Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:36:05.256Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:36:05.256Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:36:05.256Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:36:05.257Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:36:05.257Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:36:05.257Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:36:05.257Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:36:05.257Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:36:05.258Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:36:05.258Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:36:05.258Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:36:05.258Z] [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:36:05.258Z] --- [iMKO-1747103762677-Sub-ConferenceAgent-1747103763781] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:36:05.259Z] [iMKO-1747103762677 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:36:05.259Z] --- [iMKO-1747103762677 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:05.259Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:05.259Z] [iMKO-1747103762677 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:36:05.259Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:36:05.260Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:36:05.260Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:36:05.260Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:05.260Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:05.260Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:05.260Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:05.261Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:36:05.261Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:05.998Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:36:05.998Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:05.998Z] [iMKO-1747103762677 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:36:05.999Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:05.999Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:06.059Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:06.072Z] [iMKO-1747103762677 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 79
[2025-05-13T02:36:06.072Z] [iMKO-1747103762677 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:36:06.073Z] [iMKO-1747103762677 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:36:06.073Z] --- [iMKO-1747103762677 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:36:06.073Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:36:06.166Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:36:06.166Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:36:06.166Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:36:06.410Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:36:06.411Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103762677][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:36:22.442Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"find agan","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:36:22.443Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443] Request received. UserInput: "find agan", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:36:22.443Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:36:22.559Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:36:22.559Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:36:22.560Z] --- [iMKO-1747103782443 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "find agan", Lang: en ---
[2025-05-13T02:36:22.560Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:36:22.560Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:22.560Z] --- [iMKO-1747103782443 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:22.561Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:22.561Z] [iMKO-1747103782443 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:36:22.561Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:36:22.561Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:36:22.562Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:22.562Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:22.562Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:22.562Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:22.563Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:22.563Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:36:22.563Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:23.553Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:36:23.553Z] [iMKO-1747103782443 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:36:23.554Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:23.554Z] --- [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 89bcd9b0-b88f-464c-958c-339483814628 ---
[2025-05-13T02:36:23.554Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:36:23.555Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:36:23.555Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:36:23.555Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:36:23.555Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:36:23.556Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:23.556Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:23.556Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:23.556Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:36:23.556Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:23.556Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:36:23.556Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:24.589Z] Model Finish Reason: STOP
[2025-05-13T02:36:24.589Z] Model requested function call: getConferences
[2025-05-13T02:36:24.590Z] Arguments: {"searchQuery":"acronym=AAAI&perPage=5&page=1"}
[2025-05-13T02:36:24.590Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:36:24.590Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554] ConferenceAgent requests function call: getConferences
[2025-05-13T02:36:24.590Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:36:24.590Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:36:24.591Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:36:24.591Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:36:24.591Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=AAAI&perPage=5&page=1"}
[2025-05-13T02:36:24.591Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:36:24.592Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:36:24.592Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:36:24.592Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:36:24.592Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:36:24.592Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:36:24.593Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=AAAI&perPage=5&page=1}
[2025-05-13T02:36:25.295Z] [BackendService] [conference] API Success (200). Data length: 1304. Attempting parsing...
[2025-05-13T02:36:25.295Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Association for Artificial Intelligence","acronym":"AAAI","location":{"cityStateProvince":"Philadelphia, Pennsylvania","country":"United States","ad...
[2025-05-13T02:36:25.296Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:36:25.296Z] Transforming conference data with Markdown. Search query: acronym=AAAI&perPage=5&page=1
[2025-05-13T02:36:25.297Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** National Conference of the American Association for Artificia...
[2025-05-13T02:36:25.297Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=AAAI&perPage=5&page=1"
[2025-05-13T02:36:25.297Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:36:25.298Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:36:25.298Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:36:25.298Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:36:25.299Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:36:25.299Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:36:25.299Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:36:25.299Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:36:25.299Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:36:25.300Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:36:25.300Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:36:25.300Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:36:25.300Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:36:25.301Z] [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:36:25.301Z] --- [iMKO-1747103782443-Sub-ConferenceAgent-1747103783554] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:36:25.302Z] [iMKO-1747103782443 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:36:25.302Z] --- [iMKO-1747103782443 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:25.303Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:25.303Z] [iMKO-1747103782443 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:36:25.303Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:36:25.304Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:36:25.304Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:36:25.304Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:25.304Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:25.305Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:25.306Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:25.306Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:36:25.306Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:26.303Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:36:26.303Z] [iMKO-1747103782443 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:36:26.304Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:26.304Z] --- [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: 99edda26-e162-447e-abba-c8b5a17f5b64 ---
[2025-05-13T02:36:26.304Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:36:26.305Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:36:26.305Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:36:26.305Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:36:26.305Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:36:26.305Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:26.305Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:26.306Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:26.306Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:36:26.306Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:26.306Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:36:26.306Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:27.131Z] Model Finish Reason: STOP
[2025-05-13T02:36:27.132Z] Model requested function call: navigation
[2025-05-13T02:36:27.132Z] Arguments: {"url":"https://aaai.org/conference/aaai/aaai-25/"}
[2025-05-13T02:36:27.132Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:36:27.132Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304] NavigationAgent requests function call: navigation
[2025-05-13T02:36:27.133Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T02:36:27.133Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:36:27.133Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:36:27.134Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T02:36:27.134Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 iMKO9E-ypIEYbt8aAAAH] Handler: Navigation, Args: {"url":"https://aaai.org/conference/aaai/aaai-25/"}
[2025-05-13T02:36:27.134Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T02:36:27.135Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T02:36:27.135Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 iMKO9E-ypIEYbt8aAAAH] Navigation: Valid target URL: https://aaai.org/conference/aaai/aaai-25/
[2025-05-13T02:36:27.136Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T02:36:27.136Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T02:36:27.136Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T02:36:27.136Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:36:27.137Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:36:27.137Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:36:27.137Z] [iMKO-1747103782443-Sub-NavigationAgent-1747103786304 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:36:27.137Z] --- [iMKO-1747103782443-Sub-NavigationAgent-1747103786304] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:36:27.138Z] [iMKO-1747103782443 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:36:27.138Z] --- [iMKO-1747103782443 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:27.138Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:27.138Z] [iMKO-1747103782443 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:36:27.138Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:36:27.139Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:36:27.139Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:36:27.139Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:27.139Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:27.140Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:27.140Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:27.140Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:36:27.140Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:27.896Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:36:27.897Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:27.897Z] [iMKO-1747103782443 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:36:27.897Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:27.897Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:27.952Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:27.955Z] [iMKO-1747103782443 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 55
[2025-05-13T02:36:27.955Z] [iMKO-1747103782443 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:36:27.955Z] [iMKO-1747103782443 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:36:27.956Z] --- [iMKO-1747103782443 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:36:27.956Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:36:28.044Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:36:28.044Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:36:28.044Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:36:28.309Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:36:28.310Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103782443][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:36:47.891Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Mở trang web cho \"RAID 2025\". (raid is acronym)","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:36:47.892Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892] Request received. UserInput: "Mở trang web cho "RAID 2025". ...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:36:47.892Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:36:48.010Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:36:48.010Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:36:48.011Z] --- [iMKO-1747103807892 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Mở trang web cho "RAID 2025". (raid is acronym)", Lang: en ---
[2025-05-13T02:36:48.011Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:36:48.011Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:48.012Z] --- [iMKO-1747103807892 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:48.012Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:48.012Z] [iMKO-1747103807892 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:36:48.012Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:36:48.012Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:36:48.013Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:48.013Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:48.013Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:48.013Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:48.013Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:48.013Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:36:48.014Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:49.063Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:36:49.064Z] [iMKO-1747103807892 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:36:49.064Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:49.065Z] --- [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: d07bd979-2c62-4eaf-a1b2-4fe8130a4634 ---
[2025-05-13T02:36:49.065Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:36:49.066Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:36:49.066Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:36:49.066Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:36:49.067Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:36:49.067Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:49.067Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:49.067Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:49.067Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:36:49.068Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:49.068Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:36:49.069Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:49.821Z] Model Finish Reason: STOP
[2025-05-13T02:36:49.821Z] Model requested function call: getConferences
[2025-05-13T02:36:49.821Z] Arguments: {"searchQuery":"acronym=RAID&perPage=5&page=1"}
[2025-05-13T02:36:49.821Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:36:49.821Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065] ConferenceAgent requests function call: getConferences
[2025-05-13T02:36:49.822Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:36:49.822Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:36:49.822Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:36:49.822Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:36:49.823Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=RAID&perPage=5&page=1"}
[2025-05-13T02:36:49.823Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:36:49.823Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:36:49.823Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:36:49.823Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:36:49.824Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:36:49.824Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:36:49.824Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=RAID&perPage=5&page=1}
[2025-05-13T02:36:50.545Z] [BackendService] [conference] API Success (200). Data length: 1572. Attempting parsing...
[2025-05-13T02:36:50.546Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"15165896-05b4-47f8-89a1-7576939f34d2","title":"The International Symposium on Research in Attacks, Intrusions and Defenses","acronym":"RAID","location":{"cityStateProvince":"Gold Coast","country":"Australia","address":"Gold Coast, ...
[2025-05-13T02:36:50.546Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:36:50.546Z] Transforming conference data with Markdown. Search query: acronym=RAID&perPage=5&page=1
[2025-05-13T02:36:50.548Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** The International Symposium on Research in Attacks, Intrusion...
[2025-05-13T02:36:50.548Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=RAID&perPage=5&page=1"
[2025-05-13T02:36:50.549Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:36:50.549Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:36:50.549Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:36:50.550Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:36:50.550Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:36:50.550Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:36:50.551Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:36:50.551Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:36:50.552Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:36:50.552Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:36:50.552Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:36:50.552Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:36:50.552Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:36:50.553Z] [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:36:50.553Z] --- [iMKO-1747103807892-Sub-ConferenceAgent-1747103809065] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:36:50.553Z] [iMKO-1747103807892 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:36:50.553Z] --- [iMKO-1747103807892 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:50.553Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:50.554Z] [iMKO-1747103807892 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:36:50.554Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:36:50.554Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:36:50.554Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:36:50.554Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:50.555Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:50.555Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:50.555Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:50.555Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:36:50.555Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:51.471Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:36:51.471Z] [iMKO-1747103807892 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:36:51.472Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:51.472Z] --- [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: 0d5e0028-a069-410e-b07b-4aa0d226179d ---
[2025-05-13T02:36:51.473Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:36:51.473Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:36:51.473Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:36:51.473Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:36:51.474Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:36:51.474Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:36:51.474Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:51.474Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:51.474Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:36:51.475Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:51.475Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:36:51.475Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:52.100Z] Model Finish Reason: STOP
[2025-05-13T02:36:52.100Z] Model requested function call: navigation
[2025-05-13T02:36:52.101Z] Arguments: {"url":"https://raid2025.github.io/"}
[2025-05-13T02:36:52.101Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:36:52.101Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472] NavigationAgent requests function call: navigation
[2025-05-13T02:36:52.101Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T02:36:52.102Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:36:52.102Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:36:52.103Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T02:36:52.103Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 iMKO9E-ypIEYbt8aAAAH] Handler: Navigation, Args: {"url":"https://raid2025.github.io/"}
[2025-05-13T02:36:52.103Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T02:36:52.104Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T02:36:52.104Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 iMKO9E-ypIEYbt8aAAAH] Navigation: Valid target URL: https://raid2025.github.io/
[2025-05-13T02:36:52.104Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T02:36:52.105Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T02:36:52.106Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T02:36:52.106Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:36:52.106Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:36:52.107Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:36:52.107Z] [iMKO-1747103807892-Sub-NavigationAgent-1747103811472 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:36:52.107Z] --- [iMKO-1747103807892-Sub-NavigationAgent-1747103811472] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:36:52.108Z] [iMKO-1747103807892 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:36:52.108Z] --- [iMKO-1747103807892 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:36:52.108Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:52.109Z] [iMKO-1747103807892 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:36:52.109Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:36:52.109Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:36:52.109Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:36:52.109Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:36:52.110Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:36:52.110Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:36:52.110Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:36:52.110Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:36:52.110Z]   - No valid next turn added, sending only history.
[2025-05-13T02:36:52.858Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:36:52.859Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:52.859Z] [iMKO-1747103807892 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:36:52.859Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:36:52.860Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:52.921Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:52.955Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:36:52.956Z] [iMKO-1747103807892 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 118
[2025-05-13T02:36:52.956Z] [iMKO-1747103807892 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:36:52.956Z] [iMKO-1747103807892 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:36:52.957Z] --- [iMKO-1747103807892 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:36:52.957Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:36:53.039Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:36:53.039Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:36:53.039Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:36:53.280Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:36:53.281Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103807892][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:37:03.491Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Show me the location of \"SERA\" on Google Maps.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:37:03.491Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491] Request received. UserInput: "Show me the location of "SERA"...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:37:03.491Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:37:03.611Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:37:03.611Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:37:03.611Z] --- [iMKO-1747103823491 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Show me the location of "SERA" on Google Maps.", Lang: en ---
[2025-05-13T02:37:03.611Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:37:03.612Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:03.612Z] --- [iMKO-1747103823491 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:37:03.612Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:03.612Z] [iMKO-1747103823491 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:37:03.613Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:37:03.613Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:37:03.613Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:37:03.613Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:37:03.613Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:37:03.614Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:37:03.614Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:37:03.614Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:37:03.614Z]   - No valid next turn added, sending only history.
[2025-05-13T02:37:05.412Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:37:05.412Z] [iMKO-1747103823491 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:37:05.412Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:05.413Z] --- [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 306c651a-3d3f-4644-9dc2-e7a7740480e5 ---
[2025-05-13T02:37:05.413Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:37:05.413Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:37:05.413Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:37:05.414Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:37:05.414Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:37:05.414Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:37:05.414Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:37:05.414Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:37:05.414Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:37:05.415Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:37:05.415Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:37:05.415Z]   - No valid next turn added, sending only history.
[2025-05-13T02:37:06.258Z] Model Finish Reason: STOP
[2025-05-13T02:37:06.258Z] Model requested function call: getConferences
[2025-05-13T02:37:06.258Z] Arguments: {"searchQuery":"acronym=SERA&perPage=5&page=1"}
[2025-05-13T02:37:06.259Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:37:06.259Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413] ConferenceAgent requests function call: getConferences
[2025-05-13T02:37:06.259Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:37:06.259Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:37:06.259Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:37:06.260Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:37:06.260Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=SERA&perPage=5&page=1"}
[2025-05-13T02:37:06.260Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:37:06.260Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:37:06.260Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:37:06.261Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:37:06.261Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:37:06.261Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:37:06.261Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=SERA&perPage=5&page=1}
[2025-05-13T02:37:06.942Z] [BackendService] [conference] API Success (200). Data length: 1018. Attempting parsing...
[2025-05-13T02:37:06.943Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"cde9721f-22e7-459b-990f-bc077b67ff9f","title":"ACIS Conference on Software Engineering Research, Management and Applications","acronym":"SERA","location":{"cityStateProvince":"Las Vegas, Nevada","country":"United States","address":...
[2025-05-13T02:37:06.943Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:37:06.943Z] Transforming conference data with Markdown. Search query: acronym=SERA&perPage=5&page=1
[2025-05-13T02:37:06.945Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACIS Conference on Software Engineering Research, Management ...
[2025-05-13T02:37:06.945Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=SERA&perPage=5&page=1"
[2025-05-13T02:37:06.946Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:37:06.946Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:37:06.946Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:37:06.947Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:37:06.947Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:37:06.947Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:37:06.947Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:37:06.947Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:37:06.947Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:37:06.948Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:37:06.948Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:37:06.948Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:37:06.948Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:37:06.948Z] [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:37:06.949Z] --- [iMKO-1747103823491-Sub-ConferenceAgent-1747103825413] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:37:06.949Z] [iMKO-1747103823491 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:37:06.949Z] --- [iMKO-1747103823491 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:37:06.949Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:06.949Z] [iMKO-1747103823491 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:37:06.950Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:37:06.950Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:37:06.950Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:37:06.950Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:37:06.950Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:37:06.950Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:37:06.951Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:37:06.951Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:37:06.951Z]   - No valid next turn added, sending only history.
[2025-05-13T02:37:07.823Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:37:07.824Z] [iMKO-1747103823491 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:37:07.824Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:07.825Z] --- [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: 05bac860-d1a1-45fe-be03-36ce55b80d19 ---
[2025-05-13T02:37:07.825Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:37:07.825Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:37:07.825Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:37:07.825Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:37:07.826Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:37:07.826Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:37:07.826Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:37:07.826Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:37:07.826Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:37:07.826Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:37:07.827Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:37:07.827Z]   - No valid next turn added, sending only history.
[2025-05-13T02:37:08.601Z] Model Finish Reason: STOP
[2025-05-13T02:37:08.601Z] Model requested function call: openGoogleMap
[2025-05-13T02:37:08.601Z] Arguments: {"location":"UNLV Campus, Las Vegas, Nevada, USA"}
[2025-05-13T02:37:08.601Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:37:08.602Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825] NavigationAgent requests function call: openGoogleMap
[2025-05-13T02:37:08.602Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Received request.
[2025-05-13T02:37:08.602Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:37:08.603Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:37:08.603Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Executing handler...
[2025-05-13T02:37:08.607Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 iMKO9E-ypIEYbt8aAAAH] Handler: OpenGoogleMap, Args: {"location":"UNLV Campus, Las Vegas, Nevada, USA"}
[2025-05-13T02:37:08.607Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_map_location, Agent: NavigationAgent
[2025-05-13T02:37:08.608Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_map_location for NavigationAgent
[2025-05-13T02:37:08.608Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 iMKO9E-ypIEYbt8aAAAH] OpenGoogleMap: Valid location string: UNLV Campus, Las Vegas, Nevada, USA
[2025-05-13T02:37:08.608Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: map_action_prepared, Agent: NavigationAgent
[2025-05-13T02:37:08.608Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: map_action_prepared for NavigationAgent
[2025-05-13T02:37:08.609Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Handler execution finished. Result indicates error: false
[2025-05-13T02:37:08.609Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:37:08.609Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:37:08.610Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:37:08.610Z] [iMKO-1747103823491-Sub-NavigationAgent-1747103827825 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:37:08.610Z] --- [iMKO-1747103823491-Sub-NavigationAgent-1747103827825] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:37:08.610Z] [iMKO-1747103823491 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:37:08.610Z] --- [iMKO-1747103823491 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:37:08.611Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:08.611Z] [iMKO-1747103823491 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:37:08.611Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:37:08.611Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:37:08.611Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:37:08.611Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:37:08.612Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:37:08.612Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:37:08.612Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:37:08.612Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:37:08.612Z]   - No valid next turn added, sending only history.
[2025-05-13T02:37:09.226Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:37:09.227Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:09.227Z] [iMKO-1747103823491 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:37:09.227Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:37:09.228Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:37:09.315Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:37:09.433Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:37:09.457Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:37:09.462Z] [iMKO-1747103823491 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 183
[2025-05-13T02:37:09.462Z] [iMKO-1747103823491 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:37:09.463Z] [iMKO-1747103823491 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:37:09.463Z] --- [iMKO-1747103823491 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:37:09.463Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:37:09.553Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:37:09.553Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:37:09.554Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:37:09.794Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:37:09.795Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103823491][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:37:47.932Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:37:47.961Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822aecf3ab2b800805a80e3"}
[2025-05-13T02:37:47.962Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822aecf3ab2b800805a80e3] Request received.
[2025-05-13T02:37:48.079Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822aecf3ab2b800805a80e3] Sent history. Set as active conversation. Message Count: 19
[2025-05-13T02:38:04.861Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Where is the venue for \"ACM International Symposium on Computer Architecture\" located?","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:38:04.862Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861] Request received. UserInput: "Where is the venue for "ACM In...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:38:04.862Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:38:04.978Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:38:04.979Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:38:04.979Z] --- [iMKO-1747103884861 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Where is the venue for "ACM International Symposium on Computer Architecture" located?", Lang: en ---
[2025-05-13T02:38:04.979Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:38:04.980Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:04.980Z] --- [iMKO-1747103884861 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:04.980Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:04.981Z] [iMKO-1747103884861 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:38:04.981Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:38:04.981Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:38:04.981Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:04.981Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:04.981Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:04.982Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:04.982Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:04.982Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:38:04.982Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:05.841Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:38:05.842Z] [iMKO-1747103884861 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:38:05.842Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:05.843Z] --- [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 683b8e5b-e4a7-4522-99e9-f144fa932820 ---
[2025-05-13T02:38:05.844Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:38:05.844Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:38:05.845Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:38:05.845Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:38:05.845Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:38:05.846Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:05.846Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:05.846Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:05.846Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:38:05.846Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:05.847Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:38:05.847Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:07.781Z] Model Finish Reason: STOP
[2025-05-13T02:38:07.781Z] Model requested function call: getConferences
[2025-05-13T02:38:07.781Z] Arguments: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T02:38:07.782Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:38:07.782Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843] ConferenceAgent requests function call: getConferences
[2025-05-13T02:38:07.782Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:38:07.783Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:38:07.784Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:38:07.784Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:38:07.785Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T02:38:07.785Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:07.785Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:07.786Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:38:07.786Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:07.786Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:07.786Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:38:07.786Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1}
[2025-05-13T02:38:08.506Z] [BackendService] [conference] API Success (200). Data length: 1905. Attempting parsing...
[2025-05-13T02:38:08.507Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"00d654a0-f73f-4efb-b785-7c8847e00b05","title":"ACM International Symposium on Computer Architecture","acronym":"ISCA","location":{"cityStateProvince":"Tokyo","country":"Japan","address":"Waseda University, Shinjuku, Tokyo, Japan","...
[2025-05-13T02:38:08.507Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:38:08.507Z] Transforming conference data with Markdown. Search query: title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1
[2025-05-13T02:38:08.510Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACM International Symposium on Computer Architecture
  - **Ac...
[2025-05-13T02:38:08.511Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"
[2025-05-13T02:38:08.511Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:08.511Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:08.512Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:38:08.513Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:08.513Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:08.513Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:38:08.513Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:08.513Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:08.514Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:38:08.514Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:38:08.514Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:38:08.514Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:38:08.514Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:38:08.514Z] [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:38:08.515Z] --- [iMKO-1747103884861-Sub-ConferenceAgent-1747103885843] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:38:08.515Z] [iMKO-1747103884861 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:38:08.515Z] --- [iMKO-1747103884861 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:08.515Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:08.516Z] [iMKO-1747103884861 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:38:08.516Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:38:08.516Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:38:08.516Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:38:08.516Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:08.517Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:08.517Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:08.517Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:08.517Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:38:08.517Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:09.097Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:38:09.098Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:09.098Z] [iMKO-1747103884861 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:38:09.098Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:09.098Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:09.228Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:09.274Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:09.281Z] [iMKO-1747103884861 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 123
[2025-05-13T02:38:09.282Z] [iMKO-1747103884861 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:38:09.282Z] [iMKO-1747103884861 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:38:09.282Z] --- [iMKO-1747103884861 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:38:09.283Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:38:09.362Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:38:09.362Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:38:09.362Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:38:09.613Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:38:09.614Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103884861][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:38:18.040Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Open the map for \"SIGIR\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:38:18.041Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041] Request received. UserInput: "Open the map for "SIGIR".", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:38:18.041Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:38:18.162Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:38:18.162Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:38:18.162Z] --- [iMKO-1747103898041 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Open the map for "SIGIR".", Lang: en ---
[2025-05-13T02:38:18.163Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:38:18.163Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:18.163Z] --- [iMKO-1747103898041 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:18.164Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:18.164Z] [iMKO-1747103898041 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:38:18.164Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:38:18.164Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:38:18.164Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:18.165Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:18.165Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:18.165Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:18.165Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:18.165Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:38:18.166Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:19.067Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:38:19.067Z] [iMKO-1747103898041 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:38:19.068Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:19.068Z] --- [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: cb73d885-30a0-4d89-8ada-d5e8a786f7cf ---
[2025-05-13T02:38:19.068Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:38:19.068Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:38:19.069Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:38:19.069Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:38:19.069Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:38:19.069Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:19.069Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:19.069Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:19.070Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:38:19.070Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:19.070Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:38:19.070Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:20.874Z] Model Finish Reason: STOP
[2025-05-13T02:38:20.875Z] Model requested function call: getConferences
[2025-05-13T02:38:20.875Z] Arguments: {"searchQuery":"acronym=SIGIR&perPage=5&page=1"}
[2025-05-13T02:38:20.875Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:38:20.876Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068] ConferenceAgent requests function call: getConferences
[2025-05-13T02:38:20.876Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:38:20.877Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:38:20.878Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:38:20.878Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:38:20.878Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=SIGIR&perPage=5&page=1"}
[2025-05-13T02:38:20.878Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:20.878Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:20.879Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:38:20.879Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:20.879Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:20.880Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:38:20.880Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=SIGIR&perPage=5&page=1}
[2025-05-13T02:38:21.571Z] [BackendService] [conference] API Success (200). Data length: 3462. Attempting parsing...
[2025-05-13T02:38:21.571Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"019c737b-b833-46db-a257-45183c71d1e8","title":"ACM International Conference on Research and Development in Information Retrieval","acronym":"SIGIR","location":{"cityStateProvince":"Padua","country":"Italy","address":"Padua, Italy",...
[2025-05-13T02:38:21.572Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:38:21.572Z] Transforming conference data with Markdown. Search query: acronym=SIGIR&perPage=5&page=1
[2025-05-13T02:38:21.574Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACM International Conference on Research and Development in I...
[2025-05-13T02:38:21.574Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=SIGIR&perPage=5&page=1"
[2025-05-13T02:38:21.575Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:21.575Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:21.576Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:38:21.577Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:21.577Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:21.578Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:38:21.578Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:21.578Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:21.578Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:38:21.579Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:38:21.579Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:38:21.579Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:38:21.579Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:38:21.579Z] [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:38:21.580Z] --- [iMKO-1747103898041-Sub-ConferenceAgent-1747103899068] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:38:21.580Z] [iMKO-1747103898041 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:38:21.580Z] --- [iMKO-1747103898041 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:21.580Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:21.581Z] [iMKO-1747103898041 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:38:21.581Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:38:21.581Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:38:21.581Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:38:21.581Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:21.582Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:21.582Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:21.582Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:21.582Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:38:21.582Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:22.346Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:38:22.346Z] [iMKO-1747103898041 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:38:22.347Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:22.347Z] --- [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: b8d74013-a091-478b-b5ac-3d3d6b7cf20f ---
[2025-05-13T02:38:22.347Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:38:22.347Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:38:22.348Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:38:22.348Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:38:22.348Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:38:22.348Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:22.348Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:22.348Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:22.349Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:38:22.349Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:22.349Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:38:22.349Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:23.081Z] Model Finish Reason: STOP
[2025-05-13T02:38:23.081Z] Model requested function call: openGoogleMap
[2025-05-13T02:38:23.082Z] Arguments: {"location":"Padua, Italy"}
[2025-05-13T02:38:23.082Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:38:23.082Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347] NavigationAgent requests function call: openGoogleMap
[2025-05-13T02:38:23.082Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Received request.
[2025-05-13T02:38:23.082Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:38:23.083Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:38:23.083Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Executing handler...
[2025-05-13T02:38:23.083Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 iMKO9E-ypIEYbt8aAAAH] Handler: OpenGoogleMap, Args: {"location":"Padua, Italy"}
[2025-05-13T02:38:23.084Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_map_location, Agent: NavigationAgent
[2025-05-13T02:38:23.084Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_map_location for NavigationAgent
[2025-05-13T02:38:23.084Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 iMKO9E-ypIEYbt8aAAAH] OpenGoogleMap: Valid location string: Padua, Italy
[2025-05-13T02:38:23.085Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: map_action_prepared, Agent: NavigationAgent
[2025-05-13T02:38:23.085Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: map_action_prepared for NavigationAgent
[2025-05-13T02:38:23.085Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Handler execution finished. Result indicates error: false
[2025-05-13T02:38:23.086Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:38:23.086Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:38:23.086Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:38:23.086Z] [iMKO-1747103898041-Sub-NavigationAgent-1747103902347 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:38:23.087Z] --- [iMKO-1747103898041-Sub-NavigationAgent-1747103902347] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:38:23.087Z] [iMKO-1747103898041 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:38:23.087Z] --- [iMKO-1747103898041 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:23.087Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:23.088Z] [iMKO-1747103898041 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:38:23.088Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:38:23.088Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:38:23.088Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:38:23.088Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:23.088Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:23.088Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:23.089Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:23.089Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:38:23.089Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:23.744Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:38:23.745Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:23.745Z] [iMKO-1747103898041 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:38:23.746Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:23.746Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:23.826Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:23.877Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:23.879Z] [iMKO-1747103898041 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 165
[2025-05-13T02:38:23.879Z] [iMKO-1747103898041 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:38:23.879Z] [iMKO-1747103898041 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:38:23.880Z] --- [iMKO-1747103898041 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:38:23.880Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:38:23.965Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:38:23.965Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:38:23.965Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:38:24.206Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:38:24.207Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103898041][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:38:34.087Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Hiển thị địa điểm của \"SERA\" trên Google Maps.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:38:34.088Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088] Request received. UserInput: "Hiển thị địa điểm của "SERA" t...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:38:34.088Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:38:34.213Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:38:34.213Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:38:34.214Z] --- [iMKO-1747103914088 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Hiển thị địa điểm của "SERA" trên Google Maps.", Lang: en ---
[2025-05-13T02:38:34.214Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:38:34.214Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:34.214Z] --- [iMKO-1747103914088 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:34.215Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:34.215Z] [iMKO-1747103914088 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:38:34.215Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:38:34.215Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:38:34.215Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:34.216Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:34.216Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:34.216Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:34.216Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:34.216Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:38:34.216Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:36.195Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:38:36.196Z] [iMKO-1747103914088 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:38:36.196Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:36.197Z] --- [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 506e147e-058a-4fa5-b0ae-23062a3c9710 ---
[2025-05-13T02:38:36.197Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:38:36.197Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:38:36.197Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:38:36.197Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:38:36.197Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:38:36.198Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:36.198Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:36.198Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:36.198Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:38:36.198Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:36.198Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:38:36.198Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:38.069Z] Model Finish Reason: STOP
[2025-05-13T02:38:38.069Z] Model requested function call: getConferences
[2025-05-13T02:38:38.069Z] Arguments: {"searchQuery":"acronym=SERA&perPage=5&page=1"}
[2025-05-13T02:38:38.069Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:38:38.069Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197] ConferenceAgent requests function call: getConferences
[2025-05-13T02:38:38.070Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:38:38.070Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:38:38.070Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:38:38.071Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:38:38.071Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=SERA&perPage=5&page=1"}
[2025-05-13T02:38:38.071Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:38.071Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:38.071Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:38:38.072Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:38.072Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:38.072Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:38:38.072Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=SERA&perPage=5&page=1}
[2025-05-13T02:38:38.739Z] [BackendService] [conference] API Success (200). Data length: 1018. Attempting parsing...
[2025-05-13T02:38:38.739Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"cde9721f-22e7-459b-990f-bc077b67ff9f","title":"ACIS Conference on Software Engineering Research, Management and Applications","acronym":"SERA","location":{"cityStateProvince":"Las Vegas, Nevada","country":"United States","address":...
[2025-05-13T02:38:38.740Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:38:38.740Z] Transforming conference data with Markdown. Search query: acronym=SERA&perPage=5&page=1
[2025-05-13T02:38:38.743Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACIS Conference on Software Engineering Research, Management ...
[2025-05-13T02:38:38.743Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=SERA&perPage=5&page=1"
[2025-05-13T02:38:38.743Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:38.744Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:38.745Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:38:38.745Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:38.745Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:38.746Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:38:38.746Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:38.746Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:38.746Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:38:38.747Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:38:38.747Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:38:38.747Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:38:38.748Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:38:38.748Z] [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:38:38.748Z] --- [iMKO-1747103914088-Sub-ConferenceAgent-1747103916197] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:38:38.748Z] [iMKO-1747103914088 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:38:38.748Z] --- [iMKO-1747103914088 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:38.749Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:38.749Z] [iMKO-1747103914088 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:38:38.749Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:38:38.749Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:38:38.749Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:38:38.750Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:38.750Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:38.750Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:38.750Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:38.750Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:38:38.750Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:39.661Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:38:39.662Z] [iMKO-1747103914088 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:38:39.662Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:39.662Z] --- [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: 118a09af-6561-4bc6-9755-7c4aaf653040 ---
[2025-05-13T02:38:39.663Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:38:39.663Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:38:39.663Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:38:39.663Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:38:39.663Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:38:39.664Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:39.664Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:39.664Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:39.664Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:38:39.664Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:39.664Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:38:39.665Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:40.306Z] Model Finish Reason: STOP
[2025-05-13T02:38:40.307Z] Model requested function call: openGoogleMap
[2025-05-13T02:38:40.307Z] Arguments: {"location":"UNLV Campus, Las Vegas, Nevada, USA"}
[2025-05-13T02:38:40.307Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:38:40.309Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662] NavigationAgent requests function call: openGoogleMap
[2025-05-13T02:38:40.309Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Received request.
[2025-05-13T02:38:40.310Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:38:40.311Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:38:40.315Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Executing handler...
[2025-05-13T02:38:40.316Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 iMKO9E-ypIEYbt8aAAAH] Handler: OpenGoogleMap, Args: {"location":"UNLV Campus, Las Vegas, Nevada, USA"}
[2025-05-13T02:38:40.317Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_map_location, Agent: NavigationAgent
[2025-05-13T02:38:40.319Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_map_location for NavigationAgent
[2025-05-13T02:38:40.319Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 iMKO9E-ypIEYbt8aAAAH] OpenGoogleMap: Valid location string: UNLV Campus, Las Vegas, Nevada, USA
[2025-05-13T02:38:40.320Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: map_action_prepared, Agent: NavigationAgent
[2025-05-13T02:38:40.321Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: map_action_prepared for NavigationAgent
[2025-05-13T02:38:40.322Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Handler execution finished. Result indicates error: false
[2025-05-13T02:38:40.323Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:38:40.327Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:38:40.328Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:38:40.329Z] [iMKO-1747103914088-Sub-NavigationAgent-1747103919662 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:38:40.330Z] --- [iMKO-1747103914088-Sub-NavigationAgent-1747103919662] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:38:40.330Z] [iMKO-1747103914088 Streaming] Appended 6 thoughts from NavigationAgent. Total: 20
[2025-05-13T02:38:40.330Z] --- [iMKO-1747103914088 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:40.330Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:40.331Z] [iMKO-1747103914088 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:38:40.331Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:38:40.331Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:38:40.332Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:38:40.333Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:40.334Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:40.335Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:40.335Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:40.336Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:38:40.337Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:41.085Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:38:41.086Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:41.086Z] [iMKO-1747103914088 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:38:41.086Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:41.087Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:41.113Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:41.178Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:41.207Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:41.214Z] [iMKO-1747103914088 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 183
[2025-05-13T02:38:41.214Z] [iMKO-1747103914088 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 23 thoughts.
[2025-05-13T02:38:41.215Z] [iMKO-1747103914088 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:38:41.215Z] --- [iMKO-1747103914088 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:38:41.215Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 56
[2025-05-13T02:38:41.306Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:38:41.307Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:38:41.307Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:38:41.555Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:38:41.556Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103914088][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:38:48.778Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Địa điểm tổ chức \"ACM International Symposium on Computer Architecture\" ở đâu?","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:38:48.778Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778] Request received. UserInput: "Địa điểm tổ chức "ACM Internat...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:38:48.778Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:38:48.904Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:38:48.904Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:38:48.904Z] --- [iMKO-1747103928778 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Địa điểm tổ chức "ACM International Symposium on Computer Architecture" ở đâu?", Lang: en ---
[2025-05-13T02:38:48.904Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:38:48.905Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:48.905Z] --- [iMKO-1747103928778 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:48.905Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:48.905Z] [iMKO-1747103928778 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:38:48.905Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:38:48.906Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:38:48.906Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:48.906Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:48.906Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:48.906Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:48.906Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:48.906Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:38:48.907Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:49.850Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:38:49.851Z] [iMKO-1747103928778 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:38:49.851Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:49.851Z] --- [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 084f1437-6797-48b3-8a7d-c71c734fbd9f ---
[2025-05-13T02:38:49.852Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:38:49.852Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:38:49.852Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:38:49.852Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:38:49.852Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:38:49.853Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:38:49.853Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:49.853Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:49.853Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:38:49.853Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:49.854Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:38:49.854Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:50.678Z] Model Finish Reason: STOP
[2025-05-13T02:38:50.679Z] Model requested function call: getConferences
[2025-05-13T02:38:50.679Z] Arguments: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T02:38:50.679Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:38:50.679Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851] ConferenceAgent requests function call: getConferences
[2025-05-13T02:38:50.679Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:38:50.679Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:38:50.680Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:38:50.680Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:38:50.680Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T02:38:50.680Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:50.681Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:38:50.681Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:38:50.681Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:50.681Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:38:50.681Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:38:50.682Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1}
[2025-05-13T02:38:51.353Z] [BackendService] [conference] API Success (200). Data length: 1905. Attempting parsing...
[2025-05-13T02:38:51.354Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"00d654a0-f73f-4efb-b785-7c8847e00b05","title":"ACM International Symposium on Computer Architecture","acronym":"ISCA","location":{"cityStateProvince":"Tokyo","country":"Japan","address":"Waseda University, Shinjuku, Tokyo, Japan","...
[2025-05-13T02:38:51.354Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:38:51.354Z] Transforming conference data with Markdown. Search query: title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1
[2025-05-13T02:38:51.356Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACM International Symposium on Computer Architecture
  - **Ac...
[2025-05-13T02:38:51.356Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"
[2025-05-13T02:38:51.356Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:51.356Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:38:51.357Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:38:51.358Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:51.358Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:38:51.359Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:38:51.359Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:51.359Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:38:51.360Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:38:51.360Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:38:51.361Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:38:51.361Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:38:51.361Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:38:51.361Z] [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:38:51.362Z] --- [iMKO-1747103928778-Sub-ConferenceAgent-1747103929851] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:38:51.362Z] [iMKO-1747103928778 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:38:51.362Z] --- [iMKO-1747103928778 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:38:51.362Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:51.362Z] [iMKO-1747103928778 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:38:51.363Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:38:51.363Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:38:51.363Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:38:51.363Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:38:51.363Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:38:51.363Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:38:51.364Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:38:51.364Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:38:51.364Z]   - No valid next turn added, sending only history.
[2025-05-13T02:38:52.065Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:38:52.065Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:52.065Z] [iMKO-1747103928778 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:38:52.066Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:38:52.066Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:52.138Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:52.187Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:38:52.188Z] [iMKO-1747103928778 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 123
[2025-05-13T02:38:52.188Z] [iMKO-1747103928778 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T02:38:52.189Z] [iMKO-1747103928778 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:38:52.189Z] --- [iMKO-1747103928778 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:38:52.189Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:38:52.272Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:38:52.272Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:38:52.272Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:38:52.579Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:38:52.580Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103928778][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:39:04.184Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Mở bản đồ cho \"SIGIR\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:39:04.185Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185] Request received. UserInput: "Mở bản đồ cho "SIGIR".", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:39:04.185Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:39:04.321Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:39:04.321Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:39:04.321Z] --- [iMKO-1747103944185 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Mở bản đồ cho "SIGIR".", Lang: en ---
[2025-05-13T02:39:04.321Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:39:04.322Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:04.322Z] --- [iMKO-1747103944185 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:39:04.322Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:04.322Z] [iMKO-1747103944185 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:39:04.323Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:39:04.323Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:39:04.323Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:39:04.323Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:39:04.323Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:39:04.324Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:39:04.324Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:39:04.324Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:39:04.324Z]   - No valid next turn added, sending only history.
[2025-05-13T02:39:06.185Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:39:06.185Z] [iMKO-1747103944185 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:39:06.185Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:06.186Z] --- [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: fd154974-2298-4034-8058-6b1e239b362b ---
[2025-05-13T02:39:06.186Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:39:06.186Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:39:06.186Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:39:06.186Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:39:06.187Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:39:06.187Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:39:06.187Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:39:06.187Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:39:06.187Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:39:06.187Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:39:06.188Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:39:06.188Z]   - No valid next turn added, sending only history.
[2025-05-13T02:39:07.029Z] Model Finish Reason: STOP
[2025-05-13T02:39:07.030Z] Model requested function call: getConferences
[2025-05-13T02:39:07.030Z] Arguments: {"searchQuery":"acronym=SIGIR&perPage=5&page=1"}
[2025-05-13T02:39:07.030Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:39:07.030Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186] ConferenceAgent requests function call: getConferences
[2025-05-13T02:39:07.031Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T02:39:07.031Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:39:07.032Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:39:07.032Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T02:39:07.033Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=SIGIR&perPage=5&page=1"}
[2025-05-13T02:39:07.033Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:39:07.034Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:39:07.034Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:39:07.034Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:39:07.034Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T02:39:07.034Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T02:39:07.035Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=SIGIR&perPage=5&page=1}
[2025-05-13T02:39:07.739Z] [BackendService] [conference] API Success (200). Data length: 3462. Attempting parsing...
[2025-05-13T02:39:07.739Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"019c737b-b833-46db-a257-45183c71d1e8","title":"ACM International Conference on Research and Development in Information Retrieval","acronym":"SIGIR","location":{"cityStateProvince":"Padua","country":"Italy","address":"Padua, Italy",...
[2025-05-13T02:39:07.740Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T02:39:07.740Z] Transforming conference data with Markdown. Search query: acronym=SIGIR&perPage=5&page=1
[2025-05-13T02:39:07.741Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACM International Conference on Research and Development in I...
[2025-05-13T02:39:07.741Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=SIGIR&perPage=5&page=1"
[2025-05-13T02:39:07.742Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:39:07.742Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T02:39:07.742Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T02:39:07.743Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:39:07.743Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: data_found, Agent: ConferenceAgent
[2025-05-13T02:39:07.743Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T02:39:07.743Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:39:07.743Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T02:39:07.744Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T02:39:07.744Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T02:39:07.744Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:39:07.745Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:39:07.745Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:39:07.745Z] [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:39:07.745Z] --- [iMKO-1747103944185-Sub-ConferenceAgent-1747103946186] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T02:39:07.746Z] [iMKO-1747103944185 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T02:39:07.746Z] --- [iMKO-1747103944185 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:39:07.746Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:07.746Z] [iMKO-1747103944185 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:39:07.748Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:39:07.749Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:39:07.750Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:39:07.750Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:39:07.751Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:39:07.751Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:39:07.751Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:39:07.751Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:39:07.752Z]   - No valid next turn added, sending only history.
[2025-05-13T02:39:08.550Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:39:08.551Z] [iMKO-1747103944185 HostAgent Streaming T2 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:39:08.551Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:08.551Z] --- [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: 1b83a156-028a-44b6-81c0-68f26d470114 ---
[2025-05-13T02:39:08.552Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:39:08.552Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:39:08.552Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:39:08.553Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:39:08.553Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:39:08.553Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:39:08.553Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:39:08.553Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:39:08.553Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:39:08.554Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:39:08.554Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:39:08.554Z]   - No valid next turn added, sending only history.
[2025-05-13T02:39:08.844Z] Error in generateTurn: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent: [429 Too Many Requests] You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [{"@type":"type.googleapis.com/google.rpc.QuotaFailure","violations":[{"quotaMetric":"generativelanguage.googleapis.com/generate_content_free_tier_requests","quotaId":"GenerateRequestsPerMinutePerProjectPerModel-FreeTier","quotaDimensions":{"location":"global","model":"gemini-2.0-flash"},"quotaValue":"15"}]},{"@type":"type.googleapis.com/google.rpc.Help","links":[{"description":"Learn more about Gemini API quotas","url":"https://ai.google.dev/gemini-api/docs/rate-limits"}]},{"@type":"type.googleapis.com/google.rpc.RetryInfo","retryDelay":"30s"}], Stack: Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent: [429 Too Many Requests] You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [{"@type":"type.googleapis.com/google.rpc.QuotaFailure","violations":[{"quotaMetric":"generativelanguage.googleapis.com/generate_content_free_tier_requests","quotaId":"GenerateRequestsPerMinutePerProjectPerModel-FreeTier","quotaDimensions":{"location":"global","model":"gemini-2.0-flash"},"quotaValue":"15"}]},{"@type":"type.googleapis.com/google.rpc.Help","links":[{"description":"Learn more about Gemini API quotas","url":"https://ai.google.dev/gemini-api/docs/rate-limits"}]},{"@type":"type.googleapis.com/google.rpc.RetryInfo","retryDelay":"30s"}]
    at handleResponseNotOk (D:\NEW-SERVER-TS\node_modules\@google\generative-ai\dist\index.js:434:11)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at makeRequest (D:\NEW-SERVER-TS\node_modules\@google\generative-ai\dist\index.js:403:9)
    at generateContent (D:\NEW-SERVER-TS\node_modules\@google\generative-ai\dist\index.js:867:22)
    at Gemini.generateTurn (D:\NEW-SERVER-TS\src\chatbot\gemini\gemini.ts:138:51)
    at callSubAgent (D:\NEW-SERVER-TS\src\chatbot\handlers\intentHandler.ts:145:60)
    at handleStreaming (D:\NEW-SERVER-TS\src\chatbot\handlers\intentHandler.ts:637:69)
    at Socket.<anonymous> (D:\NEW-SERVER-TS\src\socket\handlers\core.handlers.ts:347:34)
[2025-05-13T02:39:08.844Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551] LLM result from NavigationAgent: Status error
[2025-05-13T02:39:08.845Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_llm_error, Agent: NavigationAgent
[2025-05-13T02:39:08.845Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_llm_error for NavigationAgent
[2025-05-13T02:39:08.845Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:39:08.845Z] [iMKO-1747103944185-Sub-NavigationAgent-1747103948551 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:39:08.846Z] --- [iMKO-1747103944185-Sub-NavigationAgent-1747103948551] Sub Agent NavigationAgent finished. Status: error, Thoughts collected: 3 ---
[2025-05-13T02:39:08.846Z] [iMKO-1747103944185 Streaming] Appended 3 thoughts from NavigationAgent. Total: 17
[2025-05-13T02:39:08.846Z] --- [iMKO-1747103944185 HostAgent Streaming Turn 3 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:39:08.846Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:08.847Z] [iMKO-1747103944185 History T3 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 55
[2025-05-13T02:39:08.847Z] [GeminiService] Received history with 55 items before mapping (for stream).
[2025-05-13T02:39:08.848Z] [GeminiService] Mapped history (SDK Content[]) with 55 items (for stream).
[2025-05-13T02:39:08.848Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:39:08.848Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:39:08.849Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:39:08.849Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:39:08.849Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:39:08.850Z] [GeminiService Stream] Preparing stream request with 55 Content items.
[2025-05-13T02:39:08.853Z]   - No valid next turn added, sending only history.
[2025-05-13T02:39:09.185Z] [GeminiService Stream] Error initiating stream: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:streamGenerateContent?alt=sse: [429 Too Many Requests] You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [{"@type":"type.googleapis.com/google.rpc.QuotaFailure","violations":[{"quotaMetric":"generativelanguage.googleapis.com/generate_content_free_tier_requests","quotaId":"GenerateRequestsPerMinutePerProjectPerModel-FreeTier","quotaDimensions":{"location":"global","model":"gemini-2.0-flash"},"quotaValue":"15"}]},{"@type":"type.googleapis.com/google.rpc.Help","links":[{"description":"Learn more about Gemini API quotas","url":"https://ai.google.dev/gemini-api/docs/rate-limits"}]},{"@type":"type.googleapis.com/google.rpc.RetryInfo","retryDelay":"29s"}], Stack: Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:streamGenerateContent?alt=sse: [429 Too Many Requests] You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [{"@type":"type.googleapis.com/google.rpc.QuotaFailure","violations":[{"quotaMetric":"generativelanguage.googleapis.com/generate_content_free_tier_requests","quotaId":"GenerateRequestsPerMinutePerProjectPerModel-FreeTier","quotaDimensions":{"location":"global","model":"gemini-2.0-flash"},"quotaValue":"15"}]},{"@type":"type.googleapis.com/google.rpc.Help","links":[{"description":"Learn more about Gemini API quotas","url":"https://ai.google.dev/gemini-api/docs/rate-limits"}]},{"@type":"type.googleapis.com/google.rpc.RetryInfo","retryDelay":"29s"}]
    at handleResponseNotOk (D:\NEW-SERVER-TS\node_modules\@google\generative-ai\dist\index.js:434:11)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at makeRequest (D:\NEW-SERVER-TS\node_modules\@google\generative-ai\dist\index.js:403:9)
    at generateContentStream (D:\NEW-SERVER-TS\node_modules\@google\generative-ai\dist\index.js:862:22)
    at Gemini.generateStream (D:\NEW-SERVER-TS\src\chatbot\gemini\gemini.ts:296:34)
    at handleStreaming (D:\NEW-SERVER-TS\src\chatbot\handlers\intentHandler.ts:597:40)
    at Socket.<anonymous> (D:\NEW-SERVER-TS\src\socket\handlers\core.handlers.ts:347:34)
[2025-05-13T02:39:09.185Z] [iMKO-1747103944185 Streaming Error T3 - iMKO9E-ypIEYbt8aAAAH] HostAgent model error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:streamGenerateContent?alt=sse: [429 Too Many Requests] You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [{"@type":"type.googleapis.com/google.rpc.QuotaFailure","violations":[{"quotaMetric":"generativelanguage.googleapis.com/generate_content_free_tier_requests","quotaId":"GenerateRequestsPerMinutePerProjectPerModel-FreeTier","quotaDimensions":{"location":"global","model":"gemini-2.0-flash"},"quotaValue":"15"}]},{"@type":"type.googleapis.com/google.rpc.Help","links":[{"description":"Learn more about Gemini API quotas","url":"https://ai.google.dev/gemini-api/docs/rate-limits"}]},{"@type":"type.googleapis.com/google.rpc.RetryInfo","retryDelay":"29s"}]
[2025-05-13T02:39:09.185Z] [iMKO-1747103944185 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_error with 18 thoughts.
[2025-05-13T02:39:09.186Z] [iMKO-1747103944185 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_error, Type: error, Agent: N/A
[2025-05-13T02:39:09.186Z] --- [iMKO-1747103944185 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:39:09.186Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 55
[2025-05-13T02:39:09.271Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:39:09.271Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:39:09.271Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:39:09.622Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:39:09.623Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103944185][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:39:45.179Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Mở bản đồ cho \"SIGIR\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:39:45.180Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180] Request received. UserInput: "Mở bản đồ cho "SIGIR".", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:39:45.180Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:39:45.323Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:39:45.323Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:39:45.323Z] --- [iMKO-1747103985180 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Mở bản đồ cho "SIGIR".", Lang: en ---
[2025-05-13T02:39:45.323Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:39:45.324Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:45.324Z] --- [iMKO-1747103985180 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:39:45.324Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:45.324Z] [iMKO-1747103985180 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:39:45.325Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:39:45.325Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:39:45.325Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:39:45.325Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:39:45.325Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:39:45.325Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:39:45.325Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:39:45.326Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:39:45.326Z]   - No valid next turn added, sending only history.
[2025-05-13T02:39:46.183Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:39:46.184Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:46.184Z] [iMKO-1747103985180 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:39:46.184Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:39:46.184Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:39:46.271Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:39:46.318Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:39:46.329Z] [iMKO-1747103985180 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 92
[2025-05-13T02:39:46.330Z] [iMKO-1747103985180 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T02:39:46.331Z] [iMKO-1747103985180 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:39:46.331Z] --- [iMKO-1747103985180 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:39:46.331Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 52
[2025-05-13T02:39:46.416Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:39:46.416Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:39:46.416Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:39:46.664Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:39:46.665Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747103985180][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:40:06.473Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"Mở bản đồ cho \"SIGIR\".","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:40:06.473Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473] Request received. UserInput: "Mở bản đồ cho "SIGIR".", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:40:06.474Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:40:06.593Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:40:06.593Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:40:06.593Z] --- [iMKO-1747104006473 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "Mở bản đồ cho "SIGIR".", Lang: en ---
[2025-05-13T02:40:06.593Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:40:06.594Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:06.594Z] --- [iMKO-1747104006473 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:40:06.595Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:06.595Z] [iMKO-1747104006473 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:40:06.595Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:40:06.595Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:40:06.595Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:40:06.596Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:06.596Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:06.596Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:40:06.597Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:06.597Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:40:06.597Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:08.493Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:40:08.493Z] [iMKO-1747104006473 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:40:08.493Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:08.494Z] --- [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: NavigationAgent, Task: f9f22bfc-d679-43f5-a218-f689bc46b206 ---
[2025-05-13T02:40:08.494Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: en
[2025-05-13T02:40:08.494Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T02:40:08.495Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T02:40:08.495Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:40:08.495Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:40:08.495Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:40:08.496Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:08.496Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:08.496Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T02:40:08.496Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:08.496Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:40:08.496Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:10.252Z] Model Finish Reason: STOP
[2025-05-13T02:40:10.253Z] Model requested function call: openGoogleMap
[2025-05-13T02:40:10.253Z] Arguments: {"location":"Padua, Italy"}
[2025-05-13T02:40:10.253Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T02:40:10.253Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494] NavigationAgent requests function call: openGoogleMap
[2025-05-13T02:40:10.253Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Received request.
[2025-05-13T02:40:10.253Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T02:40:10.254Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T02:40:10.255Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Executing handler...
[2025-05-13T02:40:10.255Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 iMKO9E-ypIEYbt8aAAAH] Handler: OpenGoogleMap, Args: {"location":"Padua, Italy"}
[2025-05-13T02:40:10.255Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_map_location, Agent: NavigationAgent
[2025-05-13T02:40:10.256Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_map_location for NavigationAgent
[2025-05-13T02:40:10.257Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 iMKO9E-ypIEYbt8aAAAH] OpenGoogleMap: Valid location string: Padua, Italy
[2025-05-13T02:40:10.257Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: map_action_prepared, Agent: NavigationAgent
[2025-05-13T02:40:10.257Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: map_action_prepared for NavigationAgent
[2025-05-13T02:40:10.257Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 iMKO9E-ypIEYbt8aAAAH Agent:NavigationAgent FuncRegistry Func:openGoogleMap] Handler execution finished. Result indicates error: false
[2025-05-13T02:40:10.258Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T02:40:10.258Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T02:40:10.258Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T02:40:10.258Z] [iMKO-1747104006473-Sub-NavigationAgent-1747104008494 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T02:40:10.259Z] --- [iMKO-1747104006473-Sub-NavigationAgent-1747104008494] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:40:10.259Z] [iMKO-1747104006473 Streaming] Appended 6 thoughts from NavigationAgent. Total: 9
[2025-05-13T02:40:10.259Z] --- [iMKO-1747104006473 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:40:10.259Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:10.260Z] [iMKO-1747104006473 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:40:10.260Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:40:10.260Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:40:10.260Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:40:10.261Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:10.261Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:10.262Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:40:10.263Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:10.263Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:40:10.263Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:10.974Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:40:10.975Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:10.975Z] [iMKO-1747104006473 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:40:10.976Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:10.976Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:11.034Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:11.105Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:11.140Z] [iMKO-1747104006473 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 165
[2025-05-13T02:40:11.141Z] [iMKO-1747104006473 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T02:40:11.142Z] [iMKO-1747104006473 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:40:11.142Z] --- [iMKO-1747104006473 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:40:11.142Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:40:11.224Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:40:11.224Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:40:11.225Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:40:11.478Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:40:11.479Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104006473][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:40:21.168Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"How can I contact the administrator?","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:40:21.169Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169] Request received. UserInput: "How can I contact the administ...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:40:21.169Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:40:21.294Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:40:21.295Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:40:21.295Z] --- [iMKO-1747104021169 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "How can I contact the administrator?", Lang: en ---
[2025-05-13T02:40:21.295Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:40:21.296Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:21.296Z] --- [iMKO-1747104021169 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:40:21.296Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:21.296Z] [iMKO-1747104021169 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:40:21.297Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:40:21.298Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:40:21.298Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:40:21.298Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:21.298Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:21.299Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:40:21.299Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:21.299Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:40:21.299Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:23.337Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:40:23.338Z] [iMKO-1747104021169 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:40:23.339Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:23.340Z] --- [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: AdminContactAgent, Task: 33d7b346-ba15-4e62-bbd9-c327551a49d4 ---
[2025-05-13T02:40:23.340Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: en
[2025-05-13T02:40:23.340Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T02:40:23.341Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T02:40:23.342Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:40:23.342Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:40:23.342Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:40:23.342Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:23.342Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:23.343Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T02:40:23.343Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:23.343Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:40:23.343Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:25.153Z] Model Finish Reason: STOP
[2025-05-13T02:40:25.154Z] Model requested function call: sendEmailToAdmin
[2025-05-13T02:40:25.154Z] Arguments: {"subject":"Need help with my account","message":"Please help me with my account.","requestType":"contact"}
[2025-05-13T02:40:25.154Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T02:40:25.154Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T02:40:25.155Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T02:40:25.155Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T02:40:25.156Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T02:40:25.156Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T02:40:25.157Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 iMKO9E-ypIEYbt8aAAAH] Handler: SendEmailToAdmin (Confirmation Step), Args: {"subject":"Need help with my account","message":"Please help me with my account.","requestType":"contact"}, Auth: true
[2025-05-13T02:40:25.157Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T02:40:25.158Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T02:40:25.159Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Preparing confirmation request ID: b620f2c7-2897-4a50-b54d-a807dac08cae
[2025-05-13T02:40:25.159Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T02:40:25.159Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T02:40:25.159Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Staging confirmation b620f2c7-2897-4a50-b54d-a807dac08cae. Awaiting frontend response. (Requires external state management)
[2025-05-13T02:40:25.160Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T02:40:25.160Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T02:40:25.160Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T02:40:25.161Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T02:40:25.161Z] [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T02:40:25.162Z] --- [iMKO-1747104021169-Sub-AdminContactAgent-1747104023340] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:40:25.162Z] [iMKO-1747104021169 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T02:40:25.162Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Staging email confirmation action. Confirmation ID: b620f2c7-2897-4a50-b54d-a807dac08cae
[2025-05-13T02:40:25.163Z] [iMKO-1747104021169 iMKO9E-ypIEYbt8aAAAH] Staging email confirmation ID: b620f2c7-2897-4a50-b54d-a807dac08cae with timeout 60000ms
[2025-05-13T02:40:25.163Z] [iMKO-1747104021169 iMKO9E-ypIEYbt8aAAAH] Confirmation b620f2c7-2897-4a50-b54d-a807dac08cae stored. Status: pending.
[2025-05-13T02:40:25.163Z] --- [iMKO-1747104021169 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:40:25.163Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:25.164Z] [iMKO-1747104021169 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:40:25.164Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:40:25.164Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:40:25.164Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:40:25.164Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:25.164Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:25.165Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:40:25.165Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:25.165Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:40:25.165Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:25.851Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:40:25.851Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:25.851Z] [iMKO-1747104021169 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:40:25.852Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:25.852Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:25.923Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:26.011Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:26.044Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:40:26.049Z] [iMKO-1747104021169 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 178
[2025-05-13T02:40:26.049Z] [iMKO-1747104021169 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T02:40:26.050Z] [iMKO-1747104021169 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:40:26.051Z] --- [iMKO-1747104021169 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:40:26.051Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:40:26.131Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:40:26.131Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:40:26.132Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:40:26.380Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:40:26.381Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104021169][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:40:31.878Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: user_cancel_email, Args: [{"confirmationId":"b620f2c7-2897-4a50-b54d-a807dac08cae"}]
[2025-05-13T02:40:31.881Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Cancel:b620f2c7-2897-4a50-b54d-a807dac08cae] Request received.
[2025-05-13T02:40:31.882Z] [iMKO-1747104021169 iMKO9E-ypIEYbt8aAAAH] User cancelled email ID: b620f2c7-2897-4a50-b54d-a807dac08cae.
[2025-05-13T02:40:31.882Z] [User Cancel iMKO9E-ypIEYbt8aAAAH] Cleaned up cancelled entry b620f2c7-2897-4a50-b54d-a807dac08cae.
[2025-05-13T02:40:58.552Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"I want to report a problem.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:40:58.552Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552] Request received. UserInput: "I want to report a problem.", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:40:58.553Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:40:58.672Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:40:58.673Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:40:58.673Z] --- [iMKO-1747104058552 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "I want to report a problem.", Lang: en ---
[2025-05-13T02:40:58.673Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:40:58.673Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:58.674Z] --- [iMKO-1747104058552 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:40:58.674Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:58.674Z] [iMKO-1747104058552 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:40:58.674Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:40:58.674Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:40:58.675Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:40:58.675Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:58.675Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:58.675Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:40:58.676Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:58.676Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:40:58.676Z]   - No valid next turn added, sending only history.
[2025-05-13T02:40:59.618Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:40:59.618Z] [iMKO-1747104058552 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:40:59.619Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:40:59.619Z] --- [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: AdminContactAgent, Task: ad459350-2b8c-46a6-a295-f3243337380b ---
[2025-05-13T02:40:59.619Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: en
[2025-05-13T02:40:59.619Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T02:40:59.620Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T02:40:59.620Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:40:59.620Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:40:59.620Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:40:59.620Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:40:59.620Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:40:59.621Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T02:40:59.621Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:40:59.621Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:40:59.621Z]   - No valid next turn added, sending only history.
[2025-05-13T02:41:01.454Z] Model Finish Reason: STOP
[2025-05-13T02:41:01.455Z] Model requested function call: sendEmailToAdmin
[2025-05-13T02:41:01.455Z] Arguments: {"message":"I want to report a problem.","subject":"Problem report","requestType":"report"}
[2025-05-13T02:41:01.455Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T02:41:01.455Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T02:41:01.455Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T02:41:01.456Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T02:41:01.456Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T02:41:01.456Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T02:41:01.456Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 iMKO9E-ypIEYbt8aAAAH] Handler: SendEmailToAdmin (Confirmation Step), Args: {"message":"I want to report a problem.","subject":"Problem report","requestType":"report"}, Auth: true
[2025-05-13T02:41:01.457Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T02:41:01.457Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T02:41:01.457Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Preparing confirmation request ID: f9809c77-ea85-467a-9de5-61ff60e44a56
[2025-05-13T02:41:01.458Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T02:41:01.458Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T02:41:01.459Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 iMKO9E-ypIEYbt8aAAAH] SendEmailToAdmin: Staging confirmation f9809c77-ea85-467a-9de5-61ff60e44a56. Awaiting frontend response. (Requires external state management)
[2025-05-13T02:41:01.460Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 iMKO9E-ypIEYbt8aAAAH Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T02:41:01.460Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T02:41:01.461Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T02:41:01.461Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T02:41:01.462Z] [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T02:41:01.462Z] --- [iMKO-1747104058552-Sub-AdminContactAgent-1747104059619] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T02:41:01.462Z] [iMKO-1747104058552 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T02:41:01.462Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Staging email confirmation action. Confirmation ID: f9809c77-ea85-467a-9de5-61ff60e44a56
[2025-05-13T02:41:01.462Z] [iMKO-1747104058552 iMKO9E-ypIEYbt8aAAAH] Staging email confirmation ID: f9809c77-ea85-467a-9de5-61ff60e44a56 with timeout 60000ms
[2025-05-13T02:41:01.463Z] [iMKO-1747104058552 iMKO9E-ypIEYbt8aAAAH] Confirmation f9809c77-ea85-467a-9de5-61ff60e44a56 stored. Status: pending.
[2025-05-13T02:41:01.463Z] --- [iMKO-1747104058552 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:41:01.463Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:01.463Z] [iMKO-1747104058552 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:41:01.463Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:41:01.464Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:41:01.464Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:41:01.464Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:41:01.464Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:41:01.465Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:41:01.465Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:41:01.465Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:41:01.465Z]   - No valid next turn added, sending only history.
[2025-05-13T02:41:02.183Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:41:02.184Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:02.184Z] [iMKO-1747104058552 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:41:02.185Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:02.185Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:02.268Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:02.343Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:02.395Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:02.397Z] [iMKO-1747104058552 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 202
[2025-05-13T02:41:02.398Z] [iMKO-1747104058552 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T02:41:02.398Z] [iMKO-1747104058552 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:41:02.398Z] --- [iMKO-1747104058552 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:41:02.399Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:41:02.487Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:41:02.488Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:41:02.488Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:41:02.743Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:41:02.745Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104058552][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:41:10.714Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: user_cancel_email, Args: [{"confirmationId":"f9809c77-ea85-467a-9de5-61ff60e44a56"}]
[2025-05-13T02:41:10.714Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Cancel:f9809c77-ea85-467a-9de5-61ff60e44a56] Request received.
[2025-05-13T02:41:10.715Z] [iMKO-1747104058552 iMKO9E-ypIEYbt8aAAAH] User cancelled email ID: f9809c77-ea85-467a-9de5-61ff60e44a56.
[2025-05-13T02:41:10.716Z] [User Cancel iMKO9E-ypIEYbt8aAAAH] Cleaned up cancelled entry f9809c77-ea85-467a-9de5-61ff60e44a56.
[2025-05-13T02:41:19.920Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"List the conferences I am following.","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:41:19.920Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920] Request received. UserInput: "List the conferences I am foll...", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:41:19.920Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:41:20.038Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:41:20.038Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:41:20.039Z] --- [iMKO-1747104079920 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "List the conferences I am following.", Lang: en ---
[2025-05-13T02:41:20.039Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:41:20.039Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:20.040Z] --- [iMKO-1747104079920 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:41:20.040Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:20.040Z] [iMKO-1747104079920 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:41:20.044Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:41:20.045Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:41:20.046Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:41:20.046Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:41:20.046Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:41:20.047Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:41:20.047Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:41:20.047Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:41:20.047Z]   - No valid next turn added, sending only history.
[2025-05-13T02:41:21.038Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T02:41:21.038Z] [iMKO-1747104079920 HostAgent Streaming T1 - iMKO9E-ypIEYbt8aAAAH] Requests function: routeToAgent
[2025-05-13T02:41:21.039Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:21.039Z] --- [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 Socket iMKO9E-ypIEYbt8aAAAH] Calling Sub Agent: ConferenceAgent, Task: 5d7d8941-110c-43bc-b425-77c96fe339b9 ---
[2025-05-13T02:41:21.039Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T02:41:21.039Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T02:41:21.040Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T02:41:21.040Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T02:41:21.040Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T02:41:21.040Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:41:21.041Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:41:21.041Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:41:21.041Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T02:41:21.042Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:41:21.042Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T02:41:21.043Z]   - No valid next turn added, sending only history.
[2025-05-13T02:41:22.800Z] Model Finish Reason: STOP
[2025-05-13T02:41:22.800Z] Model requested function call: manageFollow
[2025-05-13T02:41:22.801Z] Arguments: {"action":"list","itemType":"conference"}
[2025-05-13T02:41:22.801Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T02:41:22.801Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039] ConferenceAgent requests function call: manageFollow
[2025-05-13T02:41:22.801Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:manageFollow] Received request.
[2025-05-13T02:41:22.801Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T02:41:22.802Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T02:41:22.802Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:manageFollow] Executing handler...
[2025-05-13T02:41:22.820Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 iMKO9E-ypIEYbt8aAAAH] Handler: ManageFollow, Args: {"action":"list","itemType":"conference"}, Auth: true
[2025-05-13T02:41:22.820Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T02:41:22.821Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T02:41:22.821Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: checking_authentication, Agent: ConferenceAgent
[2025-05-13T02:41:22.821Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: checking_authentication for ConferenceAgent
[2025-05-13T02:41:22.822Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: listing_followed_items, Agent: ConferenceAgent
[2025-05-13T02:41:22.822Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: listing_followed_items for ConferenceAgent
[2025-05-13T02:41:22.823Z] [FollowService] [GetFollowed conference] Fetching followed items: GET https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/followed
[2025-05-13T02:41:23.506Z] [FollowService] [GetFollowed conference] Success. Found 2 followed item(s).
[2025-05-13T02:41:23.511Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 iMKO9E-ypIEYbt8aAAAH] ManageFollow: Successfully listed 2 followed conference(s).
[2025-05-13T02:41:23.511Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: list_success, Agent: ConferenceAgent
[2025-05-13T02:41:23.511Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: list_success for ConferenceAgent
[2025-05-13T02:41:23.512Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 iMKO9E-ypIEYbt8aAAAH Agent:ConferenceAgent FuncRegistry Func:manageFollow] Handler execution finished. Result indicates error: false
[2025-05-13T02:41:23.512Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T02:41:23.512Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T02:41:23.513Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Thought Added - iMKO9E-ypIEYbt8aAAAH] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T02:41:23.513Z] [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039 SubAgent Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T02:41:23.513Z] --- [iMKO-1747104079920-Sub-ConferenceAgent-1747104081039] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-13T02:41:23.514Z] [iMKO-1747104079920 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-13T02:41:23.514Z] --- [iMKO-1747104079920 HostAgent Streaming Turn 2 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:41:23.514Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:23.514Z] [iMKO-1747104079920 History T2 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 53
[2025-05-13T02:41:23.514Z] [GeminiService] Received history with 53 items before mapping (for stream).
[2025-05-13T02:41:23.514Z] [GeminiService] Mapped history (SDK Content[]) with 53 items (for stream).
[2025-05-13T02:41:23.515Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T02:41:23.515Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:41:23.515Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:41:23.515Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:41:23.515Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:41:23.516Z] [GeminiService Stream] Preparing stream request with 53 Content items.
[2025-05-13T02:41:23.516Z]   - No valid next turn added, sending only history.
[2025-05-13T02:41:24.257Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:41:24.258Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:24.258Z] [iMKO-1747104079920 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:41:24.259Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:24.259Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:24.338Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:24.404Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:24.533Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:24.641Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:24.699Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:24.707Z] [iMKO-1747104079920 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 322
[2025-05-13T02:41:24.708Z] [iMKO-1747104079920 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 14 thoughts.
[2025-05-13T02:41:24.709Z] [iMKO-1747104079920 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:41:24.709Z] --- [iMKO-1747104079920 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:41:24.710Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 54
[2025-05-13T02:41:24.794Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:41:24.794Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:41:24.794Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:41:25.055Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:41:25.055Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104079920][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T02:41:37.859Z] [SERVER SOCKET iMKO9E-ypIEYbt8aAAAH - ON ANY] Event: send_message, Args: [{"userInput":"How to follow a conference?","isStreaming":true,"language":"en","conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T02:41:37.860Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860] Request received. UserInput: "How to follow a conference?", Streaming: true, Language: en, PayloadConvId: 6822aecf3ab2b800805a80e3, SocketDataConvId: 6822aecf3ab2b800805a80e3
[2025-05-13T02:41:37.860Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Using conversationId from payload.
[2025-05-13T02:41:37.976Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Fetched current history. Count: 50
[2025-05-13T02:41:37.976Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Calling streaming intent handler.
[2025-05-13T02:41:37.976Z] --- [iMKO-1747104097860 Socket iMKO9E-ypIEYbt8aAAAH] Handling STREAMING input: "How to follow a conference?", Lang: en ---
[2025-05-13T02:41:37.976Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T02:41:37.977Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:37.977Z] --- [iMKO-1747104097860 HostAgent Streaming Turn 1 Start - iMKO9E-ypIEYbt8aAAAH] ---
[2025-05-13T02:41:37.978Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:37.978Z] [iMKO-1747104097860 History T1 Send - iMKO9E-ypIEYbt8aAAAH] Host History Size: 51
[2025-05-13T02:41:37.978Z] [GeminiService] Received history with 51 items before mapping (for stream).
[2025-05-13T02:41:37.978Z] [GeminiService] Mapped history (SDK Content[]) with 51 items (for stream).
[2025-05-13T02:41:37.978Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T02:41:37.978Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T02:41:37.978Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T02:41:37.979Z] Tools provided: ["routeToAgent"]
[2025-05-13T02:41:37.979Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T02:41:37.979Z] [GeminiService Stream] Preparing stream request with 51 Content items.
[2025-05-13T02:41:37.979Z]   - No valid next turn added, sending only history.
[2025-05-13T02:41:39.738Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T02:41:39.738Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:39.738Z] [iMKO-1747104097860 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Starting...
[2025-05-13T02:41:39.739Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T02:41:39.739Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:39.846Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T02:41:39.852Z] [iMKO-1747104097860 Stream Processing - iMKO9E-ypIEYbt8aAAAH] Finished. Length: 68
[2025-05-13T02:41:39.853Z] [iMKO-1747104097860 iMKO9E-ypIEYbt8aAAAH] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T02:41:39.853Z] [iMKO-1747104097860 Streaming Emit Sent - iMKO9E-ypIEYbt8aAAAH] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T02:41:39.854Z] --- [iMKO-1747104097860 iMKO9E-ypIEYbt8aAAAH Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T02:41:39.854Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Intent handler returned updated history. Attempting save. New size: 52
[2025-05-13T02:41:39.945Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Successfully updated history in DB.
[2025-05-13T02:41:39.945Z] [DEBUG] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T02:41:39.945Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T02:41:40.216Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T02:41:40.217Z] [INFO] [coreHandlers][iMKO9E-ypIEYbt8aAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:iMKO-1747104097860][Conv:6822aecf3ab2b800805a80e3] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:05:49.075Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:05:49.075Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:05:49.516Z] [MainLoader] Starting application loading process...
[2025-05-13T03:05:49.517Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:05:49.517Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:05:50.389Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:05:50.390Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:05:50.390Z] [MainLoader] Database loaded.
[2025-05-13T03:05:50.390Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:05:50.391Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:05:50.399Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:05:50.403Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:05:50.403Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:05:50.403Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:05:50.403Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:05:50.405Z] [MainLoader] Express loaded.
[2025-05-13T03:05:50.405Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:05:50.412Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:05:50.413Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:05:50.413Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:05:50.413Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:05:50.414Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:05:50.453Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:05:50.453Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:05:50.453Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:05:50.500Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:05:50.501Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:05:53.841Z] [socketAuth][6g52KtGeT8U0H8NSAAAB] Authentication attempt. Has token: true
[2025-05-13T03:05:53.845Z] [socketAuth][6g52KtGeT8U0H8NSAAAB] Token signature validated successfully.
[2025-05-13T03:05:53.848Z] [HistoryService] Initialized.
[2025-05-13T03:05:53.848Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB] New connection. Socket ID: 6g52KtGeT8U0H8NSAAAB. Initial socket.data.userId: null
[2025-05-13T03:05:53.848Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:05:53.849Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB] Attempting to fetch user info using token...
[2025-05-13T03:05:53.849Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:05:53.849Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:05:54.545Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:05:54.546Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:05:54.546Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:05:54.547Z] [HistoryService] Initialized.
[2025-05-13T03:05:54.548Z] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:05:54.548Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:05:54.548Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:05:54.548Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:05:54.550Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:05:54.550Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:05:54.855Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:05:54.857Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:05:54.857Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:05:54.857Z] [SERVER GLOBAL][connection][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:05:54.874Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822aecf3ab2b800805a80e3"}]
[2025-05-13T03:05:54.876Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822aecf3ab2b800805a80e3] Request received.
[2025-05-13T03:05:54.954Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822aecf3ab2b800805a80e3] Successfully processed deletion.
[2025-05-13T03:05:54.956Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822aecf3ab2b800805a80e3
[2025-05-13T03:05:54.956Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:05:55.031Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:05:55.053Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 13 conversations.
[2025-05-13T03:05:55.054Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822aecf3ab2b800805a80e3, Count: 13
[2025-05-13T03:06:00.199Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"How to follow a conference?","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T03:06:00.201Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201] Request received. UserInput: "How to follow a conference?", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T03:06:00.201Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T03:06:00.385Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T03:06:00.386Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T03:06:00.386Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:06:00.657Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:06:00.658Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Emitted updated conversation list. Reason: new conversation from send_message, Count: 14
[2025-05-13T03:06:00.729Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Fetched current history. Count: 0
[2025-05-13T03:06:00.730Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Calling streaming intent handler.
[2025-05-13T03:06:00.731Z] --- [6g52-1747105560201 Socket 6g52KtGeT8U0H8NSAAAB] Handling STREAMING input: "How to follow a conference?", Lang: en ---
[2025-05-13T03:06:00.732Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:06:00.733Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:00.734Z] --- [6g52-1747105560201 HostAgent Streaming Turn 1 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:06:00.734Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:00.734Z] [6g52-1747105560201 History T1 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 1
[2025-05-13T03:06:00.736Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T03:06:00.736Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T03:06:00.737Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:06:00.737Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:06:00.737Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:06:00.737Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:06:00.738Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:06:00.738Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T03:06:00.738Z]   - No valid next turn added, sending only history.
[2025-05-13T03:06:02.579Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:06:02.580Z] [6g52-1747105560201 HostAgent Streaming T1 - 6g52KtGeT8U0H8NSAAAB] Requests function: routeToAgent
[2025-05-13T03:06:02.580Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:02.582Z] --- [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 Socket 6g52KtGeT8U0H8NSAAAB] Calling Sub Agent: WebsiteInfoAgent, Task: 2267facc-3f8f-4306-90ef-4ea1794979df ---
[2025-05-13T03:06:02.582Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: en
[2025-05-13T03:06:02.583Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T03:06:02.583Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T03:06:02.584Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:06:02.584Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:06:02.584Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:06:02.585Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:06:02.585Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:06:02.585Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T03:06:02.585Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:06:02.585Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:06:02.586Z]   - No valid next turn added, sending only history.
[2025-05-13T03:06:03.298Z] Model Finish Reason: STOP
[2025-05-13T03:06:03.299Z] Model requested function call: getWebsiteInfo
[2025-05-13T03:06:03.299Z] Arguments: {}
[2025-05-13T03:06:03.299Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T03:06:03.299Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T03:06:03.300Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T03:06:03.301Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T03:06:03.301Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T03:06:03.302Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T03:06:03.302Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 6g52KtGeT8U0H8NSAAAB] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T03:06:03.303Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T03:06:03.303Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T03:06:03.303Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T03:06:03.304Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T03:06:03.304Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T03:06:03.304Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 6g52KtGeT8U0H8NSAAAB] API result: Success=true
[2025-05-13T03:06:03.304Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T03:06:03.305Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T03:06:03.305Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T03:06:03.306Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T03:06:03.306Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T03:06:03.306Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T03:06:03.307Z] [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T03:06:03.307Z] --- [6g52-1747105560201-Sub-WebsiteInfoAgent-1747105562582] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T03:06:03.307Z] [6g52-1747105560201 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T03:06:03.308Z] --- [6g52-1747105560201 HostAgent Streaming Turn 2 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:06:03.308Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:03.309Z] [6g52-1747105560201 History T2 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 3
[2025-05-13T03:06:03.310Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T03:06:03.310Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T03:06:03.311Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:06:03.311Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:06:03.311Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:06:03.311Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:06:03.312Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:06:03.312Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T03:06:03.312Z]   - No valid next turn added, sending only history.
[2025-05-13T03:06:03.937Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:06:03.938Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:03.938Z] [6g52-1747105560201 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Starting...
[2025-05-13T03:06:03.939Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:03.939Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:06:04.084Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:06:04.194Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:06:04.199Z] [6g52-1747105560201 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Finished. Length: 173
[2025-05-13T03:06:04.199Z] [6g52-1747105560201 6g52KtGeT8U0H8NSAAAB] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T03:06:04.200Z] [6g52-1747105560201 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:06:04.200Z] --- [6g52-1747105560201 6g52KtGeT8U0H8NSAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:06:04.200Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T03:06:04.296Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Successfully updated history in DB.
[2025-05-13T03:06:04.296Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:06:04.297Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:06:04.581Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:06:04.581Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105560201][Conv:6822b718907f5740059d0f6f] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:06:39.043Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"trang web có các tính năng gì","isStreaming":true,"language":"en","conversationId":"6822b718907f5740059d0f6f"}]
[2025-05-13T03:06:39.043Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043] Request received. UserInput: "trang web có các tính năng gì", Streaming: true, Language: en, PayloadConvId: 6822b718907f5740059d0f6f, SocketDataConvId: 6822b718907f5740059d0f6f
[2025-05-13T03:06:39.043Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Using conversationId from payload.
[2025-05-13T03:06:39.177Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Fetched current history. Count: 4
[2025-05-13T03:06:39.178Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Calling streaming intent handler.
[2025-05-13T03:06:39.178Z] --- [6g52-1747105599043 Socket 6g52KtGeT8U0H8NSAAAB] Handling STREAMING input: "trang web có các tính năng gì", Lang: en ---
[2025-05-13T03:06:39.178Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:06:39.179Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:39.179Z] --- [6g52-1747105599043 HostAgent Streaming Turn 1 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:06:39.180Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:39.180Z] [6g52-1747105599043 History T1 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 5
[2025-05-13T03:06:39.181Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T03:06:39.182Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T03:06:39.182Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:06:39.183Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:06:39.183Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:06:39.184Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:06:39.185Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:06:39.186Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T03:06:39.189Z]   - No valid next turn added, sending only history.
[2025-05-13T03:06:39.934Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:06:39.935Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:39.936Z] [6g52-1747105599043 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Starting...
[2025-05-13T03:06:39.936Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:06:39.937Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:06:40.055Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:06:40.060Z] [6g52-1747105599043 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Finished. Length: 71
[2025-05-13T03:06:40.061Z] [6g52-1747105599043 6g52KtGeT8U0H8NSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T03:06:40.061Z] [6g52-1747105599043 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:06:40.062Z] --- [6g52-1747105599043 6g52KtGeT8U0H8NSAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:06:40.062Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T03:06:40.155Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Successfully updated history in DB.
[2025-05-13T03:06:40.155Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:06:40.155Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:06:40.413Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:06:40.414Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105599043][Conv:6822b718907f5740059d0f6f] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:07:03.356Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"các chức năng của trang wbe GCJH này","isStreaming":true,"language":"en","conversationId":"6822b718907f5740059d0f6f"}]
[2025-05-13T03:07:03.357Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357] Request received. UserInput: "các chức năng của trang wbe GC...", Streaming: true, Language: en, PayloadConvId: 6822b718907f5740059d0f6f, SocketDataConvId: 6822b718907f5740059d0f6f
[2025-05-13T03:07:03.357Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Using conversationId from payload.
[2025-05-13T03:07:03.492Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Fetched current history. Count: 6
[2025-05-13T03:07:03.493Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Calling streaming intent handler.
[2025-05-13T03:07:03.493Z] --- [6g52-1747105623357 Socket 6g52KtGeT8U0H8NSAAAB] Handling STREAMING input: "các chức năng của trang wbe GCJH này", Lang: en ---
[2025-05-13T03:07:03.493Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:07:03.494Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:03.494Z] --- [6g52-1747105623357 HostAgent Streaming Turn 1 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:07:03.495Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:03.495Z] [6g52-1747105623357 History T1 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 7
[2025-05-13T03:07:03.495Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T03:07:03.497Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T03:07:03.574Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:07:03.574Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:07:03.575Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:07:03.575Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:07:03.575Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:07:03.575Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T03:07:03.575Z]   - No valid next turn added, sending only history.
[2025-05-13T03:07:04.321Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:07:04.322Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:04.322Z] [6g52-1747105623357 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Starting...
[2025-05-13T03:07:04.323Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:04.323Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:04.426Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:04.432Z] [6g52-1747105623357 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Finished. Length: 79
[2025-05-13T03:07:04.432Z] [6g52-1747105623357 6g52KtGeT8U0H8NSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T03:07:04.433Z] [6g52-1747105623357 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:07:04.433Z] --- [6g52-1747105623357 6g52KtGeT8U0H8NSAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:07:04.433Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T03:07:04.514Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Successfully updated history in DB.
[2025-05-13T03:07:04.514Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:07:04.515Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:07:04.773Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:07:04.774Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105623357][Conv:6822b718907f5740059d0f6f] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:07:28.285Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822b718907f5740059d0f6f"}]
[2025-05-13T03:07:28.286Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b718907f5740059d0f6f] Request received.
[2025-05-13T03:07:28.357Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b718907f5740059d0f6f] Successfully processed deletion.
[2025-05-13T03:07:28.358Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b718907f5740059d0f6f] Deleted conversation was active. Clearing active ID.
[2025-05-13T03:07:28.358Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822b718907f5740059d0f6f
[2025-05-13T03:07:28.358Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:07:28.638Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 13 conversations.
[2025-05-13T03:07:28.639Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822b718907f5740059d0f6f, Count: 13
[2025-05-13T03:07:41.361Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Cho tôi thông tin về các tính năng của trang web này","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T03:07:41.361Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361] Request received. UserInput: "Cho tôi thông tin về các tính ...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T03:07:41.362Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T03:07:41.494Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T03:07:41.495Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T03:07:41.495Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:07:41.753Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:07:41.754Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Emitted updated conversation list. Reason: new conversation from send_message, Count: 14
[2025-05-13T03:07:41.828Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Fetched current history. Count: 0
[2025-05-13T03:07:41.828Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Calling streaming intent handler.
[2025-05-13T03:07:41.828Z] --- [6g52-1747105661361 Socket 6g52KtGeT8U0H8NSAAAB] Handling STREAMING input: "Cho tôi thông tin về các tính năng của trang web này", Lang: en ---
[2025-05-13T03:07:41.828Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:07:41.829Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:41.829Z] --- [6g52-1747105661361 HostAgent Streaming Turn 1 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:07:41.830Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:41.830Z] [6g52-1747105661361 History T1 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 1
[2025-05-13T03:07:41.830Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T03:07:41.830Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T03:07:41.831Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:07:41.831Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:07:41.831Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:07:41.831Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:07:41.832Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:07:41.832Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T03:07:41.832Z]   - No valid next turn added, sending only history.
[2025-05-13T03:07:42.699Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:07:42.700Z] [6g52-1747105661361 HostAgent Streaming T1 - 6g52KtGeT8U0H8NSAAAB] Requests function: routeToAgent
[2025-05-13T03:07:42.701Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:42.702Z] --- [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 Socket 6g52KtGeT8U0H8NSAAAB] Calling Sub Agent: WebsiteInfoAgent, Task: ea85e545-5264-42e4-b532-8b9b84921ff0 ---
[2025-05-13T03:07:42.703Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: en
[2025-05-13T03:07:42.703Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T03:07:42.703Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T03:07:42.704Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:07:42.704Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:07:42.704Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:07:42.704Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:07:42.705Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:07:42.705Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T03:07:42.705Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:07:42.705Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:07:42.705Z]   - No valid next turn added, sending only history.
[2025-05-13T03:07:43.382Z] Model Finish Reason: STOP
[2025-05-13T03:07:43.383Z] Model requested function call: getWebsiteInfo
[2025-05-13T03:07:43.383Z] Arguments: {}
[2025-05-13T03:07:43.383Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T03:07:43.383Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T03:07:43.384Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T03:07:43.385Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T03:07:43.386Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T03:07:43.386Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T03:07:43.387Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 6g52KtGeT8U0H8NSAAAB] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T03:07:43.387Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T03:07:43.388Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T03:07:43.389Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T03:07:43.390Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T03:07:43.391Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T03:07:43.392Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 6g52KtGeT8U0H8NSAAAB] API result: Success=true
[2025-05-13T03:07:43.393Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T03:07:43.394Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T03:07:43.394Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T03:07:43.395Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T03:07:43.396Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T03:07:43.397Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T03:07:43.398Z] [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T03:07:43.399Z] --- [6g52-1747105661361-Sub-WebsiteInfoAgent-1747105662702] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T03:07:43.399Z] [6g52-1747105661361 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T03:07:43.399Z] --- [6g52-1747105661361 HostAgent Streaming Turn 2 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:07:43.400Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:43.400Z] [6g52-1747105661361 History T2 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 3
[2025-05-13T03:07:43.404Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T03:07:43.404Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T03:07:43.405Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:07:43.405Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:07:43.405Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:07:43.406Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:07:43.406Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:07:43.407Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T03:07:43.407Z]   - No valid next turn added, sending only history.
[2025-05-13T03:07:44.111Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:07:44.111Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:44.111Z] [6g52-1747105661361 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Starting...
[2025-05-13T03:07:44.112Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:44.112Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:44.260Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:44.333Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:44.506Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:44.681Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:07:44.687Z] [6g52-1747105661361 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Finished. Length: 441
[2025-05-13T03:07:44.687Z] [6g52-1747105661361 6g52KtGeT8U0H8NSAAAB] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T03:07:44.688Z] [6g52-1747105661361 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:07:44.688Z] --- [6g52-1747105661361 6g52KtGeT8U0H8NSAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:07:44.689Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T03:07:44.764Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Successfully updated history in DB.
[2025-05-13T03:07:44.765Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:07:44.765Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:07:45.025Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:07:45.026Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105661361][Conv:6822b77d907f5740059d0f7e] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:07:58.379Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"details about AI feature","isStreaming":true,"language":"en","conversationId":"6822b77d907f5740059d0f7e"}]
[2025-05-13T03:07:58.380Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380] Request received. UserInput: "details about AI feature", Streaming: true, Language: en, PayloadConvId: 6822b77d907f5740059d0f7e, SocketDataConvId: 6822b77d907f5740059d0f7e
[2025-05-13T03:07:58.380Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Using conversationId from payload.
[2025-05-13T03:07:58.508Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Fetched current history. Count: 4
[2025-05-13T03:07:58.508Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Calling streaming intent handler.
[2025-05-13T03:07:58.508Z] --- [6g52-1747105678380 Socket 6g52KtGeT8U0H8NSAAAB] Handling STREAMING input: "details about AI feature", Lang: en ---
[2025-05-13T03:07:58.508Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:07:58.509Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:58.509Z] --- [6g52-1747105678380 HostAgent Streaming Turn 1 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:07:58.509Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:58.510Z] [6g52-1747105678380 History T1 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 5
[2025-05-13T03:07:58.510Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T03:07:58.510Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T03:07:58.510Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:07:58.511Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:07:58.511Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:07:58.511Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:07:58.511Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:07:58.512Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T03:07:58.512Z]   - No valid next turn added, sending only history.
[2025-05-13T03:07:59.420Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:07:59.421Z] [6g52-1747105678380 HostAgent Streaming T1 - 6g52KtGeT8U0H8NSAAAB] Requests function: routeToAgent
[2025-05-13T03:07:59.421Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:07:59.422Z] --- [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 Socket 6g52KtGeT8U0H8NSAAAB] Calling Sub Agent: WebsiteInfoAgent, Task: edf19113-30f4-43b8-a4cc-cf5694676f25 ---
[2025-05-13T03:07:59.422Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: en
[2025-05-13T03:07:59.422Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T03:07:59.422Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T03:07:59.423Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:07:59.423Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:07:59.423Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:07:59.423Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:07:59.424Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:07:59.424Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T03:07:59.424Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:07:59.424Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:07:59.424Z]   - No valid next turn added, sending only history.
[2025-05-13T03:08:00.175Z] Model Finish Reason: STOP
[2025-05-13T03:08:00.175Z] Model requested function call: getWebsiteInfo
[2025-05-13T03:08:00.175Z] Arguments: {}
[2025-05-13T03:08:00.175Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T03:08:00.176Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T03:08:00.176Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T03:08:00.176Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T03:08:00.177Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T03:08:00.177Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T03:08:00.177Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 6g52KtGeT8U0H8NSAAAB] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T03:08:00.178Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T03:08:00.178Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T03:08:00.178Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T03:08:00.178Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T03:08:00.179Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T03:08:00.179Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 6g52KtGeT8U0H8NSAAAB] API result: Success=true
[2025-05-13T03:08:00.179Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T03:08:00.179Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T03:08:00.180Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 6g52KtGeT8U0H8NSAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T03:08:00.180Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T03:08:00.180Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T03:08:00.180Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Thought Added - 6g52KtGeT8U0H8NSAAAB] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T03:08:00.181Z] [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422 SubAgent Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T03:08:00.181Z] --- [6g52-1747105678380-Sub-WebsiteInfoAgent-1747105679422] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T03:08:00.181Z] [6g52-1747105678380 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T03:08:00.181Z] --- [6g52-1747105678380 HostAgent Streaming Turn 2 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:08:00.182Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:08:00.182Z] [6g52-1747105678380 History T2 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 7
[2025-05-13T03:08:00.182Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T03:08:00.182Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T03:08:00.182Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:08:00.184Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:08:00.184Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:08:00.185Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:08:00.185Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:08:00.186Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T03:08:00.186Z]   - No valid next turn added, sending only history.
[2025-05-13T03:08:00.971Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:08:00.972Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:08:00.972Z] [6g52-1747105678380 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Starting...
[2025-05-13T03:08:00.973Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:08:00.973Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:08:01.030Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:08:01.112Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:08:01.257Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:08:01.323Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:08:01.326Z] [6g52-1747105678380 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Finished. Length: 481
[2025-05-13T03:08:01.326Z] [6g52-1747105678380 6g52KtGeT8U0H8NSAAAB] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T03:08:01.327Z] [6g52-1747105678380 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:08:01.327Z] --- [6g52-1747105678380 6g52KtGeT8U0H8NSAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:08:01.327Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T03:08:01.414Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Successfully updated history in DB.
[2025-05-13T03:08:01.415Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:08:01.415Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:08:01.676Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:08:01.677Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105678380][Conv:6822b77d907f5740059d0f7e] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:09:01.374Z] [SERVER SOCKET 6g52KtGeT8U0H8NSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"who are you /","isStreaming":true,"language":"en","conversationId":"6822b77d907f5740059d0f7e"}]
[2025-05-13T03:09:01.374Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374] Request received. UserInput: "who are you /", Streaming: true, Language: en, PayloadConvId: 6822b77d907f5740059d0f7e, SocketDataConvId: 6822b77d907f5740059d0f7e
[2025-05-13T03:09:01.375Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Using conversationId from payload.
[2025-05-13T03:09:01.512Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Fetched current history. Count: 8
[2025-05-13T03:09:01.512Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Calling streaming intent handler.
[2025-05-13T03:09:01.513Z] --- [6g52-1747105741374 Socket 6g52KtGeT8U0H8NSAAAB] Handling STREAMING input: "who are you /", Lang: en ---
[2025-05-13T03:09:01.513Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:09:01.514Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:09:01.514Z] --- [6g52-1747105741374 HostAgent Streaming Turn 1 Start - 6g52KtGeT8U0H8NSAAAB] ---
[2025-05-13T03:09:01.514Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:09:01.514Z] [6g52-1747105741374 History T1 Send - 6g52KtGeT8U0H8NSAAAB] Host History Size: 9
[2025-05-13T03:09:01.515Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T03:09:01.515Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T03:09:01.515Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:09:01.515Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:09:01.515Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:09:01.516Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:09:01.516Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:09:01.516Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T03:09:01.516Z]   - No valid next turn added, sending only history.
[2025-05-13T03:09:03.476Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:09:03.477Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:09:03.477Z] [6g52-1747105741374 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Starting...
[2025-05-13T03:09:03.478Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:09:03.478Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:09:03.545Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:09:03.623Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:09:03.724Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:09:03.732Z] [6g52-1747105741374 Stream Processing - 6g52KtGeT8U0H8NSAAAB] Finished. Length: 280
[2025-05-13T03:09:03.732Z] [6g52-1747105741374 6g52KtGeT8U0H8NSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T03:09:03.732Z] [6g52-1747105741374 Streaming Emit Sent - 6g52KtGeT8U0H8NSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:09:03.733Z] --- [6g52-1747105741374 6g52KtGeT8U0H8NSAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:09:03.733Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T03:09:03.815Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Successfully updated history in DB.
[2025-05-13T03:09:03.815Z] [DEBUG] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:09:03.816Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:09:04.117Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:09:04.118Z] [INFO] [coreHandlers][6g52KtGeT8U0H8NSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:6g52-1747105741374][Conv:6822b77d907f5740059d0f7e] Emitted updated conversation list. Reason: message saved, Count: 14
[2025-05-13T03:15:32.259Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:15:32.260Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:15:32.694Z] [MainLoader] Starting application loading process...
[2025-05-13T03:15:32.696Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:15:32.698Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:15:33.580Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:15:33.581Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:15:33.581Z] [MainLoader] Database loaded.
[2025-05-13T03:15:33.581Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:15:33.582Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:15:33.588Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:15:33.592Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:15:33.592Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:15:33.593Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:15:33.593Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:15:33.594Z] [MainLoader] Express loaded.
[2025-05-13T03:15:33.595Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:15:33.599Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:15:33.600Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:15:33.600Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:15:33.601Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:15:33.601Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:15:33.643Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:15:33.643Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:15:33.643Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:15:33.686Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:15:33.686Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:15:35.826Z] [socketAuth][axYufFPX71PTuF84AAAB] Authentication attempt. Has token: true
[2025-05-13T03:15:35.830Z] [socketAuth][axYufFPX71PTuF84AAAB] Token signature validated successfully.
[2025-05-13T03:15:35.833Z] [HistoryService] Initialized.
[2025-05-13T03:15:35.833Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB] New connection. Socket ID: axYufFPX71PTuF84AAAB. Initial socket.data.userId: null
[2025-05-13T03:15:35.834Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:15:35.834Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB] Attempting to fetch user info using token...
[2025-05-13T03:15:35.834Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:15:35.835Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:15:36.572Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:15:36.572Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:15:36.573Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:15:36.574Z] [HistoryService] Initialized.
[2025-05-13T03:15:36.574Z] [coreHandlers][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:15:36.575Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:15:36.575Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:15:36.575Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:15:36.577Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:15:36.577Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:15:36.615Z] [SERVER SOCKET axYufFPX71PTuF84AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:15:36.969Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:15:36.970Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:15:36.971Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:15:36.971Z] [SERVER GLOBAL][connection][axYufFPX71PTuF84AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:21:43.749Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:21:43.749Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:21:44.202Z] [MainLoader] Starting application loading process...
[2025-05-13T03:21:44.204Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:21:44.205Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:21:45.135Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:21:45.136Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:21:45.136Z] [MainLoader] Database loaded.
[2025-05-13T03:21:45.136Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:21:45.137Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:21:45.143Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:21:45.146Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:21:45.146Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:21:45.146Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:21:45.147Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:21:45.148Z] [MainLoader] Express loaded.
[2025-05-13T03:21:45.149Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:21:45.154Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:21:45.154Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:21:45.154Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:21:45.155Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:21:45.155Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:21:45.206Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:21:45.206Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:21:45.206Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:21:45.265Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:21:45.266Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:21:45.822Z] [socketAuth][cURB0chjhXEQdnKGAAAB] Authentication attempt. Has token: true
[2025-05-13T03:21:45.827Z] [socketAuth][cURB0chjhXEQdnKGAAAB] Token signature validated successfully.
[2025-05-13T03:21:45.830Z] [HistoryService] Initialized.
[2025-05-13T03:21:45.830Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB] New connection. Socket ID: cURB0chjhXEQdnKGAAAB. Initial socket.data.userId: null
[2025-05-13T03:21:45.830Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:21:45.831Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB] Attempting to fetch user info using token...
[2025-05-13T03:21:45.832Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:21:45.832Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:21:46.529Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:21:46.530Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:21:46.530Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:21:46.532Z] [HistoryService] Initialized.
[2025-05-13T03:21:46.532Z] [coreHandlers][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:21:46.532Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:21:46.533Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:21:46.533Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:21:46.534Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:21:46.535Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:21:46.573Z] [SERVER SOCKET cURB0chjhXEQdnKGAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:21:46.825Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:21:46.827Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:21:46.827Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:21:46.828Z] [SERVER GLOBAL][connection][cURB0chjhXEQdnKGAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:26:50.089Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:26:50.090Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:26:50.561Z] [MainLoader] Starting application loading process...
[2025-05-13T03:26:50.563Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:26:50.564Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:26:51.404Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:26:51.405Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:26:51.405Z] [MainLoader] Database loaded.
[2025-05-13T03:26:51.405Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:26:51.406Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:26:51.411Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:26:51.415Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:26:51.416Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:26:51.416Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:26:51.416Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:26:51.417Z] [MainLoader] Express loaded.
[2025-05-13T03:26:51.418Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:26:51.423Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:26:51.424Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:26:51.424Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:26:51.425Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:26:51.425Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:26:51.465Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:26:51.465Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:26:51.466Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:26:51.506Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:26:51.506Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:26:53.821Z] [socketAuth][4OMg4yXP3BZxQo-FAAAB] Authentication attempt. Has token: true
[2025-05-13T03:26:53.826Z] [socketAuth][4OMg4yXP3BZxQo-FAAAB] Token signature validated successfully.
[2025-05-13T03:26:53.829Z] [HistoryService] Initialized.
[2025-05-13T03:26:53.829Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB] New connection. Socket ID: 4OMg4yXP3BZxQo-FAAAB. Initial socket.data.userId: null
[2025-05-13T03:26:53.830Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:26:53.830Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB] Attempting to fetch user info using token...
[2025-05-13T03:26:53.831Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:26:53.831Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:26:54.539Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:26:54.539Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:26:54.539Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:26:54.541Z] [HistoryService] Initialized.
[2025-05-13T03:26:54.541Z] [coreHandlers][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:26:54.542Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:26:54.542Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:26:54.542Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:26:54.543Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:26:54.544Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:26:54.585Z] [SERVER SOCKET 4OMg4yXP3BZxQo-FAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:26:54.835Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:26:54.836Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:26:54.837Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:26:54.837Z] [SERVER GLOBAL][connection][4OMg4yXP3BZxQo-FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:31:22.440Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:31:22.441Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:31:22.966Z] [MainLoader] Starting application loading process...
[2025-05-13T03:31:22.967Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:31:22.971Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:31:23.882Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:31:23.883Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:31:23.883Z] [MainLoader] Database loaded.
[2025-05-13T03:31:23.883Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:31:23.884Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:31:23.892Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:31:23.895Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:31:23.895Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:31:23.896Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:31:23.896Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:31:23.897Z] [MainLoader] Express loaded.
[2025-05-13T03:31:23.898Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:31:23.905Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:31:23.905Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:31:23.906Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:31:23.906Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:31:23.906Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:31:23.958Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:31:23.958Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:31:23.959Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:31:24.016Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:31:24.016Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:31:26.823Z] [socketAuth][JIZIDoT2kX_lTwqnAAAB] Authentication attempt. Has token: true
[2025-05-13T03:31:26.830Z] [socketAuth][JIZIDoT2kX_lTwqnAAAB] Token signature validated successfully.
[2025-05-13T03:31:26.833Z] [HistoryService] Initialized.
[2025-05-13T03:31:26.833Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB] New connection. Socket ID: JIZIDoT2kX_lTwqnAAAB. Initial socket.data.userId: null
[2025-05-13T03:31:26.834Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:31:26.834Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB] Attempting to fetch user info using token...
[2025-05-13T03:31:26.835Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:31:26.835Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:31:27.554Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:31:27.555Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:31:27.555Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:31:27.557Z] [HistoryService] Initialized.
[2025-05-13T03:31:27.558Z] [coreHandlers][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:31:27.558Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:31:27.558Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:31:27.558Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:31:27.560Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:31:27.560Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:31:27.610Z] [SERVER SOCKET JIZIDoT2kX_lTwqnAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:31:27.887Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:31:27.889Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:31:27.889Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:31:27.889Z] [SERVER GLOBAL][connection][JIZIDoT2kX_lTwqnAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:32:01.233Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:32:01.235Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:32:01.846Z] [MainLoader] Starting application loading process...
[2025-05-13T03:32:01.848Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:32:01.851Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:32:02.662Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:32:02.662Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:32:02.663Z] [MainLoader] Database loaded.
[2025-05-13T03:32:02.663Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:32:02.664Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:32:02.671Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:32:02.673Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:32:02.674Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:32:02.674Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:32:02.674Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:32:02.676Z] [MainLoader] Express loaded.
[2025-05-13T03:32:02.676Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:32:02.682Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:32:02.683Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:32:02.683Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:32:02.684Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:32:02.684Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:32:02.731Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:32:02.732Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:32:02.732Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:32:02.804Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:32:02.804Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:32:04.836Z] [socketAuth][qiua26mlo7pWQnWRAAAB] Authentication attempt. Has token: true
[2025-05-13T03:32:04.843Z] [socketAuth][qiua26mlo7pWQnWRAAAB] Token signature validated successfully.
[2025-05-13T03:32:04.846Z] [HistoryService] Initialized.
[2025-05-13T03:32:04.847Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB] New connection. Socket ID: qiua26mlo7pWQnWRAAAB. Initial socket.data.userId: null
[2025-05-13T03:32:04.848Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:32:04.848Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB] Attempting to fetch user info using token...
[2025-05-13T03:32:04.850Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:32:04.851Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:32:05.013Z] [Database] MongoDB disconnected.
[2025-05-13T03:32:05.536Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:32:05.536Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:32:05.536Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:32:05.538Z] [HistoryService] Initialized.
[2025-05-13T03:32:05.539Z] [coreHandlers][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:32:05.539Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:32:05.539Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:32:05.539Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:32:05.541Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:32:05.541Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:32:05.575Z] [SERVER SOCKET qiua26mlo7pWQnWRAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:32:12.668Z] [SERVER SOCKET qiua26mlo7pWQnWRAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822ae843ab2b800805a80dc"}]
[2025-05-13T03:32:12.672Z] [INFO] [coreHandlers][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822ae843ab2b800805a80dc"}
[2025-05-13T03:32:12.673Z] [INFO] [coreHandlers][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Request received.
[2025-05-13T03:32:21.123Z] [INFO] [coreHandlers][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T03:32:21.392Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:32:21.394Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:32:21.394Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:32:21.395Z] [SERVER GLOBAL][connection][qiua26mlo7pWQnWRAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:32:22.373Z] [SERVER GLOBAL][disconnect][qiua26mlo7pWQnWRAAAB] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: 6822ae843ab2b800805a80dc
[2025-05-13T03:32:24.422Z] [socketAuth][1igbPV3P42oHs3XBAAAD] Authentication attempt. Has token: true
[2025-05-13T03:32:24.426Z] [socketAuth][1igbPV3P42oHs3XBAAAD] Token signature validated successfully.
[2025-05-13T03:32:24.427Z] [HistoryService] Initialized.
[2025-05-13T03:32:24.427Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD] New connection. Socket ID: 1igbPV3P42oHs3XBAAAD. Initial socket.data.userId: null
[2025-05-13T03:32:24.428Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD] Client connected, processing authentication. Has token: true
[2025-05-13T03:32:24.428Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD] Attempting to fetch user info using token...
[2025-05-13T03:32:24.428Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:32:24.429Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:32:25.114Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:32:25.115Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:32:25.115Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:32:25.116Z] [HistoryService] Initialized.
[2025-05-13T03:32:25.116Z] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:32:25.116Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:32:25.117Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:32:25.117Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:32:25.118Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:32:25.118Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:32:25.123Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:32:25.159Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822ae843ab2b800805a80dc"}]
[2025-05-13T03:32:25.171Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822ae843ab2b800805a80dc"}
[2025-05-13T03:32:25.172Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Request received.
[2025-05-13T03:32:26.071Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T03:32:26.177Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 14 conversations.
[2025-05-13T03:32:26.178Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 14
[2025-05-13T03:32:26.178Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:32:26.179Z] [SERVER GLOBAL][connection][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:32:50.569Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822ae843ab2b800805a80dc"}]
[2025-05-13T03:32:50.578Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822ae843ab2b800805a80dc"}
[2025-05-13T03:32:50.578Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Request received.
[2025-05-13T03:32:50.653Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T03:32:53.817Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822ae843ab2b800805a80dc"}]
[2025-05-13T03:32:53.818Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Request received.
[2025-05-13T03:32:53.894Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Successfully processed deletion.
[2025-05-13T03:32:53.894Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae843ab2b800805a80dc] Deleted conversation was active. Clearing active ID.
[2025-05-13T03:32:53.895Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822ae843ab2b800805a80dc
[2025-05-13T03:32:53.895Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:32:54.188Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 13 conversations.
[2025-05-13T03:32:54.189Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822ae843ab2b800805a80dc, Count: 13
[2025-05-13T03:32:54.602Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822b77d907f5740059d0f7e"}]
[2025-05-13T03:32:54.636Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822b77d907f5740059d0f7e"}
[2025-05-13T03:32:54.637Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b77d907f5740059d0f7e] Request received.
[2025-05-13T03:32:54.717Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b77d907f5740059d0f7e] Sent history. Set as active conversation. Message Count: 6
[2025-05-13T03:32:57.173Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822b77d907f5740059d0f7e"}]
[2025-05-13T03:32:57.174Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b77d907f5740059d0f7e] Request received.
[2025-05-13T03:32:57.250Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b77d907f5740059d0f7e] Successfully processed deletion.
[2025-05-13T03:32:57.251Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822b77d907f5740059d0f7e] Deleted conversation was active. Clearing active ID.
[2025-05-13T03:32:57.252Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822b77d907f5740059d0f7e
[2025-05-13T03:32:57.252Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:32:57.569Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T03:32:57.570Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822b77d907f5740059d0f7e, Count: 12
[2025-05-13T03:32:59.705Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822ae3a3ab2b800805a80cf"}]
[2025-05-13T03:32:59.706Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae3a3ab2b800805a80cf] Request received.
[2025-05-13T03:32:59.782Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ae3a3ab2b800805a80cf] Successfully processed deletion.
[2025-05-13T03:32:59.783Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822ae3a3ab2b800805a80cf
[2025-05-13T03:32:59.783Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:00.068Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T03:33:00.069Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822ae3a3ab2b800805a80cf, Count: 11
[2025-05-13T03:33:01.214Z] [Database] MongoDB disconnected.
[2025-05-13T03:33:03.789Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"681f2cc98ac65f3d51bf0c3b"}]
[2025-05-13T03:33:03.790Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f2cc98ac65f3d51bf0c3b] Request received.
[2025-05-13T03:33:04.463Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f2cc98ac65f3d51bf0c3b] Successfully processed deletion.
[2025-05-13T03:33:04.464Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 681f2cc98ac65f3d51bf0c3b
[2025-05-13T03:33:04.465Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:04.664Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T03:33:04.665Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 681f2cc98ac65f3d51bf0c3b, Count: 10
[2025-05-13T03:33:07.603Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"681f2b068ac65f3d51bf0c24"}]
[2025-05-13T03:33:07.604Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f2b068ac65f3d51bf0c24] Request received.
[2025-05-13T03:33:07.675Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f2b068ac65f3d51bf0c24] Successfully processed deletion.
[2025-05-13T03:33:07.675Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 681f2b068ac65f3d51bf0c24
[2025-05-13T03:33:07.676Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:07.880Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:33:07.881Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 681f2b068ac65f3d51bf0c24, Count: 9
[2025-05-13T03:33:10.359Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"681f28908ac65f3d51bf0c18"}]
[2025-05-13T03:33:10.360Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f28908ac65f3d51bf0c18] Request received.
[2025-05-13T03:33:10.433Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f28908ac65f3d51bf0c18] Successfully processed deletion.
[2025-05-13T03:33:10.434Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 681f28908ac65f3d51bf0c18
[2025-05-13T03:33:10.434Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:10.645Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 8 conversations.
[2025-05-13T03:33:10.646Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 681f28908ac65f3d51bf0c18, Count: 8
[2025-05-13T03:33:14.260Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Who developed this website?","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T03:33:14.261Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261] Request received. UserInput: "Who developed this website?", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T03:33:14.262Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T03:33:14.449Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T03:33:14.450Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T03:33:14.451Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:14.653Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:33:14.654Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Emitted updated conversation list. Reason: new conversation from send_message, Count: 9
[2025-05-13T03:33:14.719Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Fetched current history. Count: 0
[2025-05-13T03:33:14.719Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Calling streaming intent handler.
[2025-05-13T03:33:14.720Z] --- [1igb-1747107194261 Socket 1igbPV3P42oHs3XBAAAD] Handling STREAMING input: "Who developed this website?", Lang: en ---
[2025-05-13T03:33:14.721Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T03:33:14.722Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:14.722Z] --- [1igb-1747107194261 HostAgent Streaming Turn 1 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:33:14.722Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:14.722Z] [1igb-1747107194261 History T1 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 1
[2025-05-13T03:33:14.724Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T03:33:14.724Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T03:33:14.724Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:33:14.725Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:33:14.725Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:33:14.725Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:33:14.726Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:33:14.726Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T03:33:14.726Z]   - No valid next turn added, sending only history.
[2025-05-13T03:33:16.549Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:33:16.549Z] [1igb-1747107194261 HostAgent Streaming T1 - 1igbPV3P42oHs3XBAAAD] Requests function: routeToAgent
[2025-05-13T03:33:16.550Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:16.552Z] --- [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 Socket 1igbPV3P42oHs3XBAAAD] Calling Sub Agent: WebsiteInfoAgent, Task: 62e2426b-7dae-4c4f-8ed2-2110af2250e1 ---
[2025-05-13T03:33:16.552Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: en
[2025-05-13T03:33:16.553Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T03:33:16.553Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T03:33:16.554Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:33:16.554Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:33:16.555Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:33:16.555Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:33:16.555Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:33:16.556Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T03:33:16.556Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:33:16.556Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:33:16.556Z]   - No valid next turn added, sending only history.
[2025-05-13T03:33:17.370Z] Model Finish Reason: STOP
[2025-05-13T03:33:17.370Z] Model requested function call: getWebsiteInfo
[2025-05-13T03:33:17.371Z] Arguments: {}
[2025-05-13T03:33:17.371Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T03:33:17.373Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T03:33:17.375Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 1igbPV3P42oHs3XBAAAD Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T03:33:17.377Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T03:33:17.384Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T03:33:17.386Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 1igbPV3P42oHs3XBAAAD Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T03:33:17.388Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 1igbPV3P42oHs3XBAAAD] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T03:33:17.391Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T03:33:17.391Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T03:33:17.393Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T03:33:17.393Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T03:33:17.397Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T03:33:17.398Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 1igbPV3P42oHs3XBAAAD] API result: Success=true
[2025-05-13T03:33:17.398Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T03:33:17.399Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T03:33:17.399Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 1igbPV3P42oHs3XBAAAD Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T03:33:17.399Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T03:33:17.399Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T03:33:17.400Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T03:33:17.400Z] [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T03:33:17.401Z] --- [1igb-1747107194261-Sub-WebsiteInfoAgent-1747107196552] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T03:33:17.401Z] [1igb-1747107194261 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T03:33:17.401Z] --- [1igb-1747107194261 HostAgent Streaming Turn 2 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:33:17.402Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:17.402Z] [1igb-1747107194261 History T2 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 3
[2025-05-13T03:33:17.403Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T03:33:17.403Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T03:33:17.403Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:33:17.403Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:33:17.403Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:33:17.404Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:33:17.404Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:33:17.404Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T03:33:17.404Z]   - No valid next turn added, sending only history.
[2025-05-13T03:33:18.138Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:33:18.139Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:18.140Z] [1igb-1747107194261 Stream Processing - 1igbPV3P42oHs3XBAAAD] Starting...
[2025-05-13T03:33:18.140Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:18.141Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:18.256Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:18.335Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:18.417Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:18.425Z] [1igb-1747107194261 Stream Processing - 1igbPV3P42oHs3XBAAAD] Finished. Length: 267
[2025-05-13T03:33:18.425Z] [1igb-1747107194261 1igbPV3P42oHs3XBAAAD] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T03:33:18.426Z] [1igb-1747107194261 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:33:18.426Z] --- [1igb-1747107194261 1igbPV3P42oHs3XBAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:33:18.426Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T03:33:18.539Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Successfully updated history in DB.
[2025-05-13T03:33:18.540Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:33:18.540Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:18.775Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:33:18.776Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107194261][Conv:6822bd7ac7d7891bd8295939] Emitted updated conversation list. Reason: message saved, Count: 9
[2025-05-13T03:33:37.413Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: send_message, Args: [{"userInput":"who are you ?","isStreaming":true,"language":"vi","conversationId":"6822bd7ac7d7891bd8295939"}]
[2025-05-13T03:33:37.414Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414] Request received. UserInput: "who are you ?", Streaming: true, Language: vi, PayloadConvId: 6822bd7ac7d7891bd8295939, SocketDataConvId: 6822bd7ac7d7891bd8295939
[2025-05-13T03:33:37.414Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Using conversationId from payload.
[2025-05-13T03:33:37.546Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Fetched current history. Count: 4
[2025-05-13T03:33:37.547Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Calling streaming intent handler.
[2025-05-13T03:33:37.547Z] --- [1igb-1747107217414 Socket 1igbPV3P42oHs3XBAAAD] Handling STREAMING input: "who are you ?", Lang: vi ---
[2025-05-13T03:33:37.547Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T03:33:37.548Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:37.548Z] --- [1igb-1747107217414 HostAgent Streaming Turn 1 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:33:37.549Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:37.549Z] [1igb-1747107217414 History T1 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 5
[2025-05-13T03:33:37.549Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T03:33:37.549Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T03:33:37.550Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:33:37.550Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:33:37.550Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:33:37.550Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:33:37.550Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:33:37.552Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T03:33:37.552Z]   - No valid next turn added, sending only history.
[2025-05-13T03:33:39.327Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:33:39.329Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:39.329Z] [1igb-1747107217414 Stream Processing - 1igbPV3P42oHs3XBAAAD] Starting...
[2025-05-13T03:33:39.330Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:33:39.330Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:39.505Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:39.590Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:39.692Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:39.738Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:33:39.746Z] [1igb-1747107217414 Stream Processing - 1igbPV3P42oHs3XBAAAD] Finished. Length: 301
[2025-05-13T03:33:39.747Z] [1igb-1747107217414 1igbPV3P42oHs3XBAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T03:33:39.748Z] [1igb-1747107217414 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:33:39.748Z] --- [1igb-1747107217414 1igbPV3P42oHs3XBAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:33:39.748Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T03:33:39.826Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Successfully updated history in DB.
[2025-05-13T03:33:39.826Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:33:39.826Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:33:40.022Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:33:40.023Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107217414][Conv:6822bd7ac7d7891bd8295939] Emitted updated conversation list. Reason: message saved, Count: 9
[2025-05-13T03:34:12.685Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"vi","conversationId":"6822bd7ac7d7891bd8295939"}]
[2025-05-13T03:34:12.686Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822bd7ac7d7891bd8295939, SocketDataConvId: 6822bd7ac7d7891bd8295939
[2025-05-13T03:34:12.686Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Using conversationId from payload.
[2025-05-13T03:34:12.815Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Fetched current history. Count: 6
[2025-05-13T03:34:12.815Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Calling streaming intent handler.
[2025-05-13T03:34:12.816Z] --- [1igb-1747107252686 Socket 1igbPV3P42oHs3XBAAAD] Handling STREAMING input: "find conference in Vietnam", Lang: vi ---
[2025-05-13T03:34:12.816Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T03:34:12.816Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:12.817Z] --- [1igb-1747107252686 HostAgent Streaming Turn 1 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:34:12.817Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:12.817Z] [1igb-1747107252686 History T1 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 7
[2025-05-13T03:34:12.817Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T03:34:12.818Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T03:34:12.818Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:34:12.818Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:34:12.818Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:34:12.819Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:34:12.819Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:34:12.819Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T03:34:12.819Z]   - No valid next turn added, sending only history.
[2025-05-13T03:34:14.697Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:34:14.698Z] [1igb-1747107252686 HostAgent Streaming T1 - 1igbPV3P42oHs3XBAAAD] Requests function: routeToAgent
[2025-05-13T03:34:14.698Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:14.699Z] --- [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 Socket 1igbPV3P42oHs3XBAAAD] Calling Sub Agent: ConferenceAgent, Task: e65dcbcf-c254-4f09-afe7-14e7a7a13221 ---
[2025-05-13T03:34:14.699Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T03:34:14.699Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T03:34:14.700Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T03:34:14.700Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:34:14.700Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:34:14.700Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:34:14.701Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:34:14.701Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:34:14.701Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T03:34:14.701Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:34:14.701Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:34:14.702Z]   - No valid next turn added, sending only history.
[2025-05-13T03:34:16.511Z] Model Finish Reason: STOP
[2025-05-13T03:34:16.512Z] Model requested function call: getConferences
[2025-05-13T03:34:16.512Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T03:34:16.512Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T03:34:16.513Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699] ConferenceAgent requests function call: getConferences
[2025-05-13T03:34:16.513Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T03:34:16.513Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T03:34:16.514Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T03:34:16.514Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T03:34:16.515Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T03:34:16.515Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T03:34:16.516Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T03:34:16.516Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T03:34:16.517Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T03:34:16.518Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T03:34:16.518Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T03:34:16.520Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T03:34:17.241Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T03:34:17.242Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T03:34:17.243Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T03:34:17.244Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T03:34:17.251Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T03:34:17.251Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T03:34:17.252Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T03:34:17.252Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T03:34:17.253Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T03:34:17.253Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T03:34:17.253Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T03:34:17.254Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T03:34:17.254Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T03:34:17.254Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T03:34:17.254Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T03:34:17.255Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 1igbPV3P42oHs3XBAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T03:34:17.255Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T03:34:17.256Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T03:34:17.256Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T03:34:17.256Z] [1igb-1747107252686-Sub-ConferenceAgent-1747107254699 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T03:34:17.256Z] --- [1igb-1747107252686-Sub-ConferenceAgent-1747107254699] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T03:34:17.257Z] [1igb-1747107252686 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T03:34:17.257Z] --- [1igb-1747107252686 HostAgent Streaming Turn 2 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:34:17.257Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:17.257Z] [1igb-1747107252686 History T2 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 9
[2025-05-13T03:34:17.258Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T03:34:17.258Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T03:34:17.259Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:34:17.260Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:34:17.260Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:34:17.261Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:34:17.261Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:34:17.261Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T03:34:17.261Z]   - No valid next turn added, sending only history.
[2025-05-13T03:34:17.962Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:34:17.963Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:17.963Z] [1igb-1747107252686 Stream Processing - 1igbPV3P42oHs3XBAAAD] Starting...
[2025-05-13T03:34:17.963Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:17.964Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:18.086Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:18.183Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:18.346Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:18.484Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:18.766Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:19.001Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:19.024Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:19.028Z] [1igb-1747107252686 Stream Processing - 1igbPV3P42oHs3XBAAAD] Finished. Length: 533
[2025-05-13T03:34:19.029Z] [1igb-1747107252686 1igbPV3P42oHs3XBAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T03:34:19.030Z] [1igb-1747107252686 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:34:19.030Z] --- [1igb-1747107252686 1igbPV3P42oHs3XBAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:34:19.031Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T03:34:19.112Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Successfully updated history in DB.
[2025-05-13T03:34:19.112Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:34:19.112Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:34:19.328Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:34:19.329Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107252686][Conv:6822bd7ac7d7891bd8295939] Emitted updated conversation list. Reason: message saved, Count: 9
[2025-05-13T03:34:32.627Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: send_message, Args: [{"userInput":"details about last conference","isStreaming":true,"language":"vi","conversationId":"6822bd7ac7d7891bd8295939"}]
[2025-05-13T03:34:32.627Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627] Request received. UserInput: "details about last conference", Streaming: true, Language: vi, PayloadConvId: 6822bd7ac7d7891bd8295939, SocketDataConvId: 6822bd7ac7d7891bd8295939
[2025-05-13T03:34:32.627Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Using conversationId from payload.
[2025-05-13T03:34:32.761Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Fetched current history. Count: 10
[2025-05-13T03:34:32.761Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Calling streaming intent handler.
[2025-05-13T03:34:32.761Z] --- [1igb-1747107272627 Socket 1igbPV3P42oHs3XBAAAD] Handling STREAMING input: "details about last conference", Lang: vi ---
[2025-05-13T03:34:32.762Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T03:34:32.762Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:32.762Z] --- [1igb-1747107272627 HostAgent Streaming Turn 1 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:34:32.763Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:32.763Z] [1igb-1747107272627 History T1 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 11
[2025-05-13T03:34:32.763Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T03:34:32.763Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T03:34:32.763Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:34:32.763Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:34:32.764Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:34:32.764Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:34:32.764Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:34:32.764Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T03:34:32.764Z]   - No valid next turn added, sending only history.
[2025-05-13T03:34:34.829Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:34:34.829Z] [1igb-1747107272627 HostAgent Streaming T1 - 1igbPV3P42oHs3XBAAAD] Requests function: routeToAgent
[2025-05-13T03:34:34.830Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:34.830Z] --- [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 Socket 1igbPV3P42oHs3XBAAAD] Calling Sub Agent: ConferenceAgent, Task: da3ae981-ab71-4c17-bd1b-93e2d238ed1c ---
[2025-05-13T03:34:34.831Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T03:34:34.832Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T03:34:34.833Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T03:34:34.834Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:34:34.835Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:34:34.835Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:34:34.836Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:34:34.837Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:34:34.837Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T03:34:34.837Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:34:34.837Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:34:34.838Z]   - No valid next turn added, sending only history.
[2025-05-13T03:34:36.580Z] Model Finish Reason: STOP
[2025-05-13T03:34:36.581Z] Model requested function call: getConferences
[2025-05-13T03:34:36.581Z] Arguments: {"searchQuery":"mode=detail&acronym=HNDH&perPage=5&page=1"}
[2025-05-13T03:34:36.581Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T03:34:36.581Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830] ConferenceAgent requests function call: getConferences
[2025-05-13T03:34:36.581Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T03:34:36.582Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T03:34:36.582Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T03:34:36.583Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T03:34:36.583Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"mode=detail&acronym=HNDH&perPage=5&page=1"}
[2025-05-13T03:34:36.583Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T03:34:36.583Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T03:34:36.584Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T03:34:36.584Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T03:34:36.584Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T03:34:36.585Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T03:34:36.585Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?mode=detail&acronym=HNDH&perPage=5&page=1}
[2025-05-13T03:34:37.248Z] [BackendService] [conference] API Success (200). Data length: 927. Attempting parsing...
[2025-05-13T03:34:37.249Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"5b1908b0-81fe-4e54-90a1-1bafaf2b6817","title":"Hội nghị diên hồng","acronym":"HNDH","creatorId":"fc4d5aa2-2d6c-4c24-8093-8e162afd9689","adminId":null,"createdAt":"2025-05-11T11:16:05.163Z","updatedAt":"2025-05-12T06:53:56.496Z","st...
[2025-05-13T03:34:37.249Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T03:34:37.250Z] Transforming conference data with Markdown. Search query: mode=detail&acronym=HNDH&perPage=5&page=1
[2025-05-13T03:34:37.252Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** Hội nghị diên hồng
  - **Acronym:** HNDH
  - **Ranks:** N/A
 ...
[2025-05-13T03:34:37.253Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="mode=detail&acronym=HNDH&perPage=5&page=1"
[2025-05-13T03:34:37.253Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T03:34:37.253Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T03:34:37.254Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T03:34:37.254Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T03:34:37.254Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T03:34:37.255Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T03:34:37.255Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T03:34:37.255Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T03:34:37.255Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T03:34:37.256Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 1igbPV3P42oHs3XBAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T03:34:37.256Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T03:34:37.256Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T03:34:37.257Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T03:34:37.257Z] [1igb-1747107272627-Sub-ConferenceAgent-1747107274830 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T03:34:37.262Z] --- [1igb-1747107272627-Sub-ConferenceAgent-1747107274830] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T03:34:37.265Z] [1igb-1747107272627 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T03:34:37.266Z] --- [1igb-1747107272627 HostAgent Streaming Turn 2 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:34:37.266Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:37.266Z] [1igb-1747107272627 History T2 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 13
[2025-05-13T03:34:37.266Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T03:34:37.267Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T03:34:37.267Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:34:37.267Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:34:37.269Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:34:37.269Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:34:37.270Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:34:37.270Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T03:34:37.270Z]   - No valid next turn added, sending only history.
[2025-05-13T03:34:38.072Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:34:38.073Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:38.073Z] [1igb-1747107272627 Stream Processing - 1igbPV3P42oHs3XBAAAD] Starting...
[2025-05-13T03:34:38.074Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:34:38.075Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:38.224Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:38.255Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:38.481Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:38.637Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:34:38.644Z] [1igb-1747107272627 Stream Processing - 1igbPV3P42oHs3XBAAAD] Finished. Length: 282
[2025-05-13T03:34:38.644Z] [1igb-1747107272627 1igbPV3P42oHs3XBAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T03:34:38.645Z] [1igb-1747107272627 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:34:38.645Z] --- [1igb-1747107272627 1igbPV3P42oHs3XBAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:34:38.645Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T03:34:38.734Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Successfully updated history in DB.
[2025-05-13T03:34:38.734Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:34:38.734Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:34:38.966Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:34:38.967Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107272627][Conv:6822bd7ac7d7891bd8295939] Emitted updated conversation list. Reason: message saved, Count: 9
[2025-05-13T03:35:14.742Z] [SERVER SOCKET 1igbPV3P42oHs3XBAAAD - ON ANY] Event: send_message, Args: [{"userInput":"open website","isStreaming":true,"language":"vi","conversationId":"6822bd7ac7d7891bd8295939"}]
[2025-05-13T03:35:14.742Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742] Request received. UserInput: "open website", Streaming: true, Language: vi, PayloadConvId: 6822bd7ac7d7891bd8295939, SocketDataConvId: 6822bd7ac7d7891bd8295939
[2025-05-13T03:35:14.742Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Using conversationId from payload.
[2025-05-13T03:35:14.877Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Fetched current history. Count: 14
[2025-05-13T03:35:14.878Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Calling streaming intent handler.
[2025-05-13T03:35:14.878Z] --- [1igb-1747107314742 Socket 1igbPV3P42oHs3XBAAAD] Handling STREAMING input: "open website", Lang: vi ---
[2025-05-13T03:35:14.879Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T03:35:14.880Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:35:14.881Z] --- [1igb-1747107314742 HostAgent Streaming Turn 1 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:35:14.882Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:35:14.886Z] [1igb-1747107314742 History T1 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 15
[2025-05-13T03:35:14.887Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T03:35:14.887Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T03:35:14.888Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:35:14.888Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:35:14.888Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:35:14.888Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:35:14.889Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:35:14.889Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T03:35:14.889Z]   - No valid next turn added, sending only history.
[2025-05-13T03:35:16.248Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T03:35:16.248Z] [1igb-1747107314742 HostAgent Streaming T1 - 1igbPV3P42oHs3XBAAAD] Requests function: routeToAgent
[2025-05-13T03:35:16.249Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:35:16.249Z] --- [1igb-1747107314742-Sub-NavigationAgent-1747107316249 Socket 1igbPV3P42oHs3XBAAAD] Calling Sub Agent: NavigationAgent, Task: 75eee522-fef6-4373-8b6f-b605324ccac3 ---
[2025-05-13T03:35:16.251Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: vi
[2025-05-13T03:35:16.252Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T03:35:16.252Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T03:35:16.252Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T03:35:16.252Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T03:35:16.253Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T03:35:16.253Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:35:16.253Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:35:16.254Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T03:35:16.254Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:35:16.254Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T03:35:16.254Z]   - No valid next turn added, sending only history.
[2025-05-13T03:35:17.957Z] Model Finish Reason: STOP
[2025-05-13T03:35:17.957Z] Model requested function call: navigation
[2025-05-13T03:35:17.958Z] Arguments: {"url":"https://youtube.com"}
[2025-05-13T03:35:17.958Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T03:35:17.958Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249] NavigationAgent requests function call: navigation
[2025-05-13T03:35:17.958Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 1igbPV3P42oHs3XBAAAD Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T03:35:17.959Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T03:35:17.959Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T03:35:17.960Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 1igbPV3P42oHs3XBAAAD Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T03:35:17.960Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 1igbPV3P42oHs3XBAAAD] Handler: Navigation, Args: {"url":"https://youtube.com"}
[2025-05-13T03:35:17.961Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T03:35:17.961Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T03:35:17.962Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 1igbPV3P42oHs3XBAAAD] Navigation: Valid target URL: https://youtube.com
[2025-05-13T03:35:17.962Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T03:35:17.962Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T03:35:17.962Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 1igbPV3P42oHs3XBAAAD Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T03:35:17.963Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T03:35:17.963Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T03:35:17.963Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Thought Added - 1igbPV3P42oHs3XBAAAD] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T03:35:17.964Z] [1igb-1747107314742-Sub-NavigationAgent-1747107316249 SubAgent Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T03:35:17.964Z] --- [1igb-1747107314742-Sub-NavigationAgent-1747107316249] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T03:35:17.964Z] [1igb-1747107314742 Streaming] Appended 6 thoughts from NavigationAgent. Total: 9
[2025-05-13T03:35:17.965Z] --- [1igb-1747107314742 HostAgent Streaming Turn 2 Start - 1igbPV3P42oHs3XBAAAD] ---
[2025-05-13T03:35:17.965Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:35:17.966Z] [1igb-1747107314742 History T2 Send - 1igbPV3P42oHs3XBAAAD] Host History Size: 17
[2025-05-13T03:35:17.967Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T03:35:17.967Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T03:35:17.968Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T03:35:17.968Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T03:35:17.969Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:35:17.969Z] Tools provided: ["routeToAgent"]
[2025-05-13T03:35:17.969Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T03:35:17.969Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T03:35:17.970Z]   - No valid next turn added, sending only history.
[2025-05-13T03:35:18.684Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T03:35:18.685Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:35:18.686Z] [1igb-1747107314742 Stream Processing - 1igbPV3P42oHs3XBAAAD] Starting...
[2025-05-13T03:35:18.686Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T03:35:18.687Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:35:18.856Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T03:35:18.860Z] [1igb-1747107314742 Stream Processing - 1igbPV3P42oHs3XBAAAD] Finished. Length: 39
[2025-05-13T03:35:18.860Z] [1igb-1747107314742 1igbPV3P42oHs3XBAAAD] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T03:35:18.861Z] [1igb-1747107314742 Streaming Emit Sent - 1igbPV3P42oHs3XBAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T03:35:18.861Z] --- [1igb-1747107314742 1igbPV3P42oHs3XBAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T03:35:18.862Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Intent handler returned updated history. Attempting save. New size: 18
[2025-05-13T03:35:18.960Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Successfully updated history in DB.
[2025-05-13T03:35:18.961Z] [DEBUG] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T03:35:18.961Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:35:19.170Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:35:19.171Z] [INFO] [coreHandlers][1igbPV3P42oHs3XBAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:1igb-1747107314742][Conv:6822bd7ac7d7891bd8295939] Emitted updated conversation list. Reason: message saved, Count: 9
[2025-05-13T03:43:27.342Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:43:27.342Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:43:27.668Z] [MainLoader] Starting application loading process...
[2025-05-13T03:43:27.669Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:43:27.671Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:43:28.649Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:43:28.650Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:43:28.650Z] [MainLoader] Database loaded.
[2025-05-13T03:43:28.650Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:43:28.651Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:43:28.656Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:43:28.659Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:43:28.660Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:43:28.660Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:43:28.660Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:43:28.661Z] [MainLoader] Express loaded.
[2025-05-13T03:43:28.662Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:43:28.666Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:43:28.667Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:43:28.667Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:43:28.668Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:43:28.668Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:43:28.707Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:43:28.707Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:43:28.707Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:43:28.752Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:43:28.752Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:43:30.814Z] [socketAuth][6ij6ya0mEIU7UltzAAAB] Authentication attempt. Has token: true
[2025-05-13T03:43:30.818Z] [socketAuth][6ij6ya0mEIU7UltzAAAB] Token signature validated successfully.
[2025-05-13T03:43:30.821Z] [HistoryService] Initialized.
[2025-05-13T03:43:30.821Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB] New connection. Socket ID: 6ij6ya0mEIU7UltzAAAB. Initial socket.data.userId: null
[2025-05-13T03:43:30.822Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:43:30.822Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB] Attempting to fetch user info using token...
[2025-05-13T03:43:30.823Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:43:30.823Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:43:31.528Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:43:31.528Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:43:31.529Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:43:31.531Z] [HistoryService] Initialized.
[2025-05-13T03:43:31.531Z] [coreHandlers][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:43:31.531Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:43:31.531Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:43:31.532Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:43:31.533Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:43:31.534Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:43:31.578Z] [SERVER SOCKET 6ij6ya0mEIU7UltzAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:43:31.792Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:43:31.793Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:43:31.794Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:43:31.794Z] [SERVER GLOBAL][connection][6ij6ya0mEIU7UltzAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:46:14.949Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:46:14.950Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:46:15.291Z] [MainLoader] Starting application loading process...
[2025-05-13T03:46:15.292Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:46:15.292Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:46:16.130Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:46:16.130Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:46:16.131Z] [MainLoader] Database loaded.
[2025-05-13T03:46:16.131Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:46:16.131Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:46:16.137Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:46:16.140Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:46:16.141Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:46:16.141Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:46:16.141Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:46:16.142Z] [MainLoader] Express loaded.
[2025-05-13T03:46:16.143Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:46:16.149Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:46:16.149Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:46:16.150Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:46:16.150Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:46:16.150Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:46:16.204Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:46:16.213Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:46:16.214Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:46:16.293Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:46:16.295Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:46:19.817Z] [socketAuth][9WKw7rGveoLYbJewAAAB] Authentication attempt. Has token: true
[2025-05-13T03:46:19.822Z] [socketAuth][9WKw7rGveoLYbJewAAAB] Token signature validated successfully.
[2025-05-13T03:46:19.825Z] [HistoryService] Initialized.
[2025-05-13T03:46:19.825Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB] New connection. Socket ID: 9WKw7rGveoLYbJewAAAB. Initial socket.data.userId: null
[2025-05-13T03:46:19.825Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:46:19.825Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB] Attempting to fetch user info using token...
[2025-05-13T03:46:19.826Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:46:19.827Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:46:20.527Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:46:20.527Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:46:20.527Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:46:20.529Z] [HistoryService] Initialized.
[2025-05-13T03:46:20.529Z] [coreHandlers][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:46:20.529Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:46:20.530Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:46:20.530Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:46:20.531Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:46:20.532Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:46:20.568Z] [SERVER SOCKET 9WKw7rGveoLYbJewAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:46:20.775Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:46:20.776Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:46:20.776Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:46:20.777Z] [SERVER GLOBAL][connection][9WKw7rGveoLYbJewAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:46:30.449Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:46:30.450Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:46:30.781Z] [MainLoader] Starting application loading process...
[2025-05-13T03:46:30.782Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:46:30.784Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:46:31.656Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:46:31.656Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:46:31.657Z] [MainLoader] Database loaded.
[2025-05-13T03:46:31.657Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:46:31.658Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:46:31.664Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:46:31.667Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:46:31.667Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:46:31.668Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:46:31.668Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:46:31.670Z] [MainLoader] Express loaded.
[2025-05-13T03:46:31.670Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:46:31.676Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:46:31.676Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:46:31.677Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:46:31.677Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:46:31.677Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:46:31.728Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:46:31.729Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:46:31.729Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:46:31.775Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:46:31.775Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:46:36.832Z] [socketAuth][luNhvfIrU6HyM4tOAAAB] Authentication attempt. Has token: true
[2025-05-13T03:46:36.838Z] [socketAuth][luNhvfIrU6HyM4tOAAAB] Token signature validated successfully.
[2025-05-13T03:46:36.840Z] [HistoryService] Initialized.
[2025-05-13T03:46:36.841Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB] New connection. Socket ID: luNhvfIrU6HyM4tOAAAB. Initial socket.data.userId: null
[2025-05-13T03:46:36.841Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:46:36.841Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB] Attempting to fetch user info using token...
[2025-05-13T03:46:36.842Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:46:36.842Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:46:37.547Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:46:37.547Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:46:37.548Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:46:37.549Z] [HistoryService] Initialized.
[2025-05-13T03:46:37.550Z] [coreHandlers][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:46:37.550Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:46:37.550Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:46:37.550Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:46:37.552Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:46:37.552Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:46:37.591Z] [SERVER SOCKET luNhvfIrU6HyM4tOAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:46:37.818Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:46:37.819Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:46:37.819Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:46:37.820Z] [SERVER GLOBAL][connection][luNhvfIrU6HyM4tOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:47:40.073Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:47:40.075Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:47:40.513Z] [MainLoader] Starting application loading process...
[2025-05-13T03:47:40.515Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:47:40.516Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:47:41.529Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:47:41.529Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:47:41.529Z] [MainLoader] Database loaded.
[2025-05-13T03:47:41.530Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:47:41.530Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:47:41.536Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:47:41.540Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:47:41.540Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:47:41.541Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:47:41.541Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:47:41.542Z] [MainLoader] Express loaded.
[2025-05-13T03:47:41.543Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:47:41.548Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:47:41.548Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:47:41.549Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:47:41.549Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:47:41.549Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:47:41.622Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:47:41.625Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:47:41.626Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:47:41.698Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:47:41.699Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:47:41.885Z] [socketAuth][I-9MBmHazOxQGczgAAAB] Authentication attempt. Has token: true
[2025-05-13T03:47:41.891Z] [socketAuth][I-9MBmHazOxQGczgAAAB] Token signature validated successfully.
[2025-05-13T03:47:41.894Z] [HistoryService] Initialized.
[2025-05-13T03:47:41.895Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB] New connection. Socket ID: I-9MBmHazOxQGczgAAAB. Initial socket.data.userId: null
[2025-05-13T03:47:41.895Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:47:41.895Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB] Attempting to fetch user info using token...
[2025-05-13T03:47:41.896Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:47:41.897Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:47:42.609Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:47:42.609Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:47:42.610Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:47:42.612Z] [HistoryService] Initialized.
[2025-05-13T03:47:42.613Z] [coreHandlers][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:47:42.615Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:47:42.615Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:47:42.615Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:47:42.616Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:47:42.617Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:47:42.674Z] [SERVER SOCKET I-9MBmHazOxQGczgAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:47:42.882Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:47:42.884Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:47:42.884Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:47:42.884Z] [SERVER GLOBAL][connection][I-9MBmHazOxQGczgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:48:31.991Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:48:31.993Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:48:32.680Z] [MainLoader] Starting application loading process...
[2025-05-13T03:48:32.684Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:48:32.686Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:48:33.646Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:48:33.647Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:48:33.647Z] [MainLoader] Database loaded.
[2025-05-13T03:48:33.647Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:48:33.648Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:48:33.657Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:48:33.661Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:48:33.662Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:48:33.662Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:48:33.662Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:48:33.663Z] [MainLoader] Express loaded.
[2025-05-13T03:48:33.664Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:48:33.669Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:48:33.671Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:48:33.672Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:48:33.672Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:48:33.673Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:48:33.744Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:48:33.746Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:48:33.747Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:48:33.835Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:48:33.841Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:48:33.946Z] [socketAuth][SdJyu9RfB7n-hUYgAAAB] Authentication attempt. Has token: true
[2025-05-13T03:48:33.952Z] [socketAuth][SdJyu9RfB7n-hUYgAAAB] Token signature validated successfully.
[2025-05-13T03:48:33.959Z] [HistoryService] Initialized.
[2025-05-13T03:48:33.960Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB] New connection. Socket ID: SdJyu9RfB7n-hUYgAAAB. Initial socket.data.userId: null
[2025-05-13T03:48:33.960Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:48:33.960Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB] Attempting to fetch user info using token...
[2025-05-13T03:48:33.961Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:48:33.962Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:48:34.696Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:48:34.697Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:48:34.697Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:48:34.699Z] [HistoryService] Initialized.
[2025-05-13T03:48:34.699Z] [coreHandlers][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:48:34.699Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:48:34.699Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:48:34.700Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:48:34.701Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:48:34.702Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:48:34.763Z] [SERVER SOCKET SdJyu9RfB7n-hUYgAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:48:34.962Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:48:34.963Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:48:34.964Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:48:34.964Z] [SERVER GLOBAL][connection][SdJyu9RfB7n-hUYgAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:49:07.670Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:49:07.671Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:49:08.414Z] [MainLoader] Starting application loading process...
[2025-05-13T03:49:08.415Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:49:08.417Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:49:09.235Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:49:09.236Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:49:09.236Z] [MainLoader] Database loaded.
[2025-05-13T03:49:09.236Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:49:09.237Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:49:09.242Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:49:09.245Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:49:09.246Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:49:09.246Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:49:09.246Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:49:09.247Z] [MainLoader] Express loaded.
[2025-05-13T03:49:09.248Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:49:09.252Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:49:09.253Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:49:09.253Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:49:09.254Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:49:09.254Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:49:09.297Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:49:09.298Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:49:09.298Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:49:09.341Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:49:09.341Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:49:09.434Z] [socketAuth][_GxsI0VXGnhVwVGcAAAB] Authentication attempt. Has token: true
[2025-05-13T03:49:09.439Z] [socketAuth][_GxsI0VXGnhVwVGcAAAB] Token signature validated successfully.
[2025-05-13T03:49:09.441Z] [HistoryService] Initialized.
[2025-05-13T03:49:09.442Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB] New connection. Socket ID: _GxsI0VXGnhVwVGcAAAB. Initial socket.data.userId: null
[2025-05-13T03:49:09.442Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:49:09.442Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB] Attempting to fetch user info using token...
[2025-05-13T03:49:09.443Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:49:09.443Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:49:10.147Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:49:10.147Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:49:10.147Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:49:10.149Z] [HistoryService] Initialized.
[2025-05-13T03:49:10.149Z] [coreHandlers][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:49:10.150Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:49:10.150Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:49:10.150Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:49:10.152Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:49:10.152Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:49:10.194Z] [SERVER SOCKET _GxsI0VXGnhVwVGcAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:49:10.396Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:49:10.397Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:49:10.397Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:49:10.398Z] [SERVER GLOBAL][connection][_GxsI0VXGnhVwVGcAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:50:03.959Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:50:03.960Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:50:04.509Z] [MainLoader] Starting application loading process...
[2025-05-13T03:50:04.512Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:50:04.513Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:50:05.469Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:50:05.469Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:50:05.470Z] [MainLoader] Database loaded.
[2025-05-13T03:50:05.470Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:50:05.471Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:50:05.476Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:50:05.479Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:50:05.479Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:50:05.480Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:50:05.480Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:50:05.481Z] [MainLoader] Express loaded.
[2025-05-13T03:50:05.481Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:50:05.486Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:50:05.486Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:50:05.486Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:50:05.487Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:50:05.487Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:50:05.524Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:50:05.525Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:50:05.525Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:50:05.568Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:50:05.568Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:50:05.638Z] [socketAuth][DuIBUO6C7g7ArDQtAAAB] Authentication attempt. Has token: true
[2025-05-13T03:50:05.643Z] [socketAuth][DuIBUO6C7g7ArDQtAAAB] Token signature validated successfully.
[2025-05-13T03:50:05.646Z] [HistoryService] Initialized.
[2025-05-13T03:50:05.646Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB] New connection. Socket ID: DuIBUO6C7g7ArDQtAAAB. Initial socket.data.userId: null
[2025-05-13T03:50:05.646Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:50:05.647Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB] Attempting to fetch user info using token...
[2025-05-13T03:50:05.648Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:50:05.648Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:50:06.334Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:50:06.334Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:50:06.335Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:50:06.337Z] [HistoryService] Initialized.
[2025-05-13T03:50:06.337Z] [coreHandlers][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:50:06.338Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:50:06.339Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:50:06.340Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:50:06.343Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:50:06.344Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:50:06.384Z] [SERVER SOCKET DuIBUO6C7g7ArDQtAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:50:06.630Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:50:06.631Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:50:06.631Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:50:06.632Z] [SERVER GLOBAL][connection][DuIBUO6C7g7ArDQtAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:50:46.481Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:50:46.481Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:50:46.927Z] [MainLoader] Starting application loading process...
[2025-05-13T03:50:46.929Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:50:46.930Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:50:47.815Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:50:47.815Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:50:47.815Z] [MainLoader] Database loaded.
[2025-05-13T03:50:47.816Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:50:47.816Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:50:47.823Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:50:47.825Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:50:47.826Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:50:47.826Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:50:47.826Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:50:47.828Z] [MainLoader] Express loaded.
[2025-05-13T03:50:47.828Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:50:47.833Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:50:47.834Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:50:47.834Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:50:47.835Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:50:47.835Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:50:47.888Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:50:47.888Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:50:47.889Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:50:47.955Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:50:47.956Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:50:48.137Z] [socketAuth][a5t-62GkYgB5NL07AAAB] Authentication attempt. Has token: true
[2025-05-13T03:50:48.143Z] [socketAuth][a5t-62GkYgB5NL07AAAB] Token signature validated successfully.
[2025-05-13T03:50:48.146Z] [HistoryService] Initialized.
[2025-05-13T03:50:48.146Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB] New connection. Socket ID: a5t-62GkYgB5NL07AAAB. Initial socket.data.userId: null
[2025-05-13T03:50:48.146Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:50:48.146Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB] Attempting to fetch user info using token...
[2025-05-13T03:50:48.147Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:50:48.147Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:50:48.847Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:50:48.847Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:50:48.848Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:50:48.849Z] [HistoryService] Initialized.
[2025-05-13T03:50:48.850Z] [coreHandlers][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:50:48.850Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:50:48.850Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:50:48.851Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:50:48.852Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:50:48.853Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:50:48.922Z] [SERVER SOCKET a5t-62GkYgB5NL07AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:50:49.147Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:50:49.149Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:50:49.149Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:50:49.150Z] [SERVER GLOBAL][connection][a5t-62GkYgB5NL07AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:51:39.232Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:51:39.233Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:51:39.680Z] [MainLoader] Starting application loading process...
[2025-05-13T03:51:39.681Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:51:39.682Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:51:40.901Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:51:40.901Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:51:40.902Z] [MainLoader] Database loaded.
[2025-05-13T03:51:40.902Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:51:40.903Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:51:40.909Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:51:40.917Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:51:40.917Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:51:40.917Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:51:40.918Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:51:40.919Z] [MainLoader] Express loaded.
[2025-05-13T03:51:40.920Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:51:40.929Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:51:40.930Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:51:40.930Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:51:40.930Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:51:40.931Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:51:41.009Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:51:41.010Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:51:41.012Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:51:41.106Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:51:41.108Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:51:41.217Z] [socketAuth][LIvdlBYAbea0R7MNAAAB] Authentication attempt. Has token: true
[2025-05-13T03:51:41.231Z] [socketAuth][LIvdlBYAbea0R7MNAAAB] Token signature validated successfully.
[2025-05-13T03:51:41.234Z] [HistoryService] Initialized.
[2025-05-13T03:51:41.234Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB] New connection. Socket ID: LIvdlBYAbea0R7MNAAAB. Initial socket.data.userId: null
[2025-05-13T03:51:41.235Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:51:41.235Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB] Attempting to fetch user info using token...
[2025-05-13T03:51:41.236Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:51:41.237Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:51:42.140Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:51:42.141Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:51:42.141Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:51:42.143Z] [HistoryService] Initialized.
[2025-05-13T03:51:42.143Z] [coreHandlers][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:51:42.143Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:51:42.144Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:51:42.144Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:51:42.147Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:51:42.148Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:51:42.342Z] [SERVER SOCKET LIvdlBYAbea0R7MNAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:51:42.425Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:51:42.426Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:51:42.426Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:51:42.426Z] [SERVER GLOBAL][connection][LIvdlBYAbea0R7MNAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:52:36.233Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T03:52:36.233Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T03:52:36.589Z] [MainLoader] Starting application loading process...
[2025-05-13T03:52:36.590Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T03:52:36.590Z] [Database] Attempting MongoDB connection...
[2025-05-13T03:52:37.490Z] [Database] MongoDB Connected Successfully.
[2025-05-13T03:52:37.490Z] [DatabaseLoader] Database connection successful.
[2025-05-13T03:52:37.491Z] [MainLoader] Database loaded.
[2025-05-13T03:52:37.491Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T03:52:37.492Z] [ExpressLoader] Configuring Express app...
[2025-05-13T03:52:37.499Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T03:52:37.502Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T03:52:37.503Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T03:52:37.503Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T03:52:37.503Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T03:52:37.505Z] [MainLoader] Express loaded.
[2025-05-13T03:52:37.505Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T03:52:37.511Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T03:52:37.512Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T03:52:37.512Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T03:52:37.512Z] [MainLoader] Socket.IO loaded.
[2025-05-13T03:52:37.513Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T03:52:37.551Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T03:52:37.551Z] [MainLoader] Jobs scheduled.
[2025-05-13T03:52:37.552Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T03:52:37.599Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T03:52:37.599Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T03:52:39.472Z] [socketAuth][EmfI4d4WcHA04_XuAAAB] Authentication attempt. Has token: true
[2025-05-13T03:52:39.477Z] [socketAuth][EmfI4d4WcHA04_XuAAAB] Token signature validated successfully.
[2025-05-13T03:52:39.480Z] [HistoryService] Initialized.
[2025-05-13T03:52:39.481Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB] New connection. Socket ID: EmfI4d4WcHA04_XuAAAB. Initial socket.data.userId: null
[2025-05-13T03:52:39.481Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T03:52:39.482Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB] Attempting to fetch user info using token...
[2025-05-13T03:52:39.482Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:52:39.482Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:52:40.212Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:52:40.212Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:52:40.212Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:52:40.214Z] [HistoryService] Initialized.
[2025-05-13T03:52:40.215Z] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:52:40.215Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:52:40.215Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:52:40.215Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:52:40.217Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:52:40.217Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:52:40.264Z] [SERVER SOCKET EmfI4d4WcHA04_XuAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:52:40.498Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:52:40.499Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:52:40.499Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:52:40.500Z] [SERVER GLOBAL][connection][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:52:41.674Z] [SERVER SOCKET EmfI4d4WcHA04_XuAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"681f1fe58ac65f3d51bf0bc4"}]
[2025-05-13T03:52:41.679Z] [INFO] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"681f1fe58ac65f3d51bf0bc4"}
[2025-05-13T03:52:41.679Z] [INFO] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f1fe58ac65f3d51bf0bc4] Request received.
[2025-05-13T03:52:41.765Z] [INFO] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:681f1fe58ac65f3d51bf0bc4] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T03:52:42.667Z] [SERVER SOCKET EmfI4d4WcHA04_XuAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822bd7ac7d7891bd8295939"}]
[2025-05-13T03:52:42.670Z] [INFO] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822bd7ac7d7891bd8295939"}
[2025-05-13T03:52:42.670Z] [INFO] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822bd7ac7d7891bd8295939] Request received.
[2025-05-13T03:52:42.831Z] [INFO] [coreHandlers][EmfI4d4WcHA04_XuAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822bd7ac7d7891bd8295939] Sent history. Set as active conversation. Message Count: 10
[2025-05-13T03:55:35.275Z] [SERVER GLOBAL][disconnect][EmfI4d4WcHA04_XuAAAB] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: 6822bd7ac7d7891bd8295939
[2025-05-13T03:55:35.387Z] [socketAuth][hg0JePIKfppt5zouAAAD] Authentication attempt. Has token: true
[2025-05-13T03:55:35.390Z] [socketAuth][hg0JePIKfppt5zouAAAD] Token signature validated successfully.
[2025-05-13T03:55:35.391Z] [HistoryService] Initialized.
[2025-05-13T03:55:35.391Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD] New connection. Socket ID: hg0JePIKfppt5zouAAAD. Initial socket.data.userId: null
[2025-05-13T03:55:35.391Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD] Client connected, processing authentication. Has token: true
[2025-05-13T03:55:35.392Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD] Attempting to fetch user info using token...
[2025-05-13T03:55:35.392Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:55:35.392Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:55:36.122Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:55:36.123Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:55:36.123Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:55:36.123Z] [HistoryService] Initialized.
[2025-05-13T03:55:36.123Z] [coreHandlers][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:55:36.124Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:55:36.124Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:55:36.124Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:55:36.125Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:55:36.125Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:55:36.134Z] [SERVER SOCKET hg0JePIKfppt5zouAAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:55:36.360Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:55:36.361Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:55:36.361Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:55:36.362Z] [SERVER GLOBAL][connection][hg0JePIKfppt5zouAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:55:44.491Z] [SERVER GLOBAL][disconnect][hg0JePIKfppt5zouAAAD] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T03:55:44.514Z] [socketAuth][A7eHl5JGS98eS5EmAAAF] Authentication attempt. Has token: true
[2025-05-13T03:55:44.516Z] [socketAuth][A7eHl5JGS98eS5EmAAAF] Token signature validated successfully.
[2025-05-13T03:55:44.517Z] [HistoryService] Initialized.
[2025-05-13T03:55:44.518Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF] New connection. Socket ID: A7eHl5JGS98eS5EmAAAF. Initial socket.data.userId: null
[2025-05-13T03:55:44.518Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF] Client connected, processing authentication. Has token: true
[2025-05-13T03:55:44.518Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF] Attempting to fetch user info using token...
[2025-05-13T03:55:44.518Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:55:44.519Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:55:45.159Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:55:45.160Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:55:45.160Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:55:45.160Z] [HistoryService] Initialized.
[2025-05-13T03:55:45.161Z] [coreHandlers][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:55:45.161Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:55:45.161Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:55:45.161Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:55:45.162Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:55:45.163Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:55:45.168Z] [SERVER SOCKET A7eHl5JGS98eS5EmAAAF - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:55:45.422Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:55:45.423Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:55:45.423Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:55:45.424Z] [SERVER GLOBAL][connection][A7eHl5JGS98eS5EmAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T03:59:33.152Z] [SERVER GLOBAL][disconnect][A7eHl5JGS98eS5EmAAAF] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T03:59:33.190Z] [socketAuth][We9U0hUFaARwocTFAAAH] Authentication attempt. Has token: true
[2025-05-13T03:59:33.193Z] [socketAuth][We9U0hUFaARwocTFAAAH] Token signature validated successfully.
[2025-05-13T03:59:33.194Z] [HistoryService] Initialized.
[2025-05-13T03:59:33.195Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH] New connection. Socket ID: We9U0hUFaARwocTFAAAH. Initial socket.data.userId: null
[2025-05-13T03:59:33.195Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH] Client connected, processing authentication. Has token: true
[2025-05-13T03:59:33.195Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH] Attempting to fetch user info using token...
[2025-05-13T03:59:33.195Z] [API Client] Attempting to fetch user info.
[2025-05-13T03:59:33.196Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T03:59:33.897Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T03:59:33.897Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T03:59:33.897Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T03:59:33.898Z] [HistoryService] Initialized.
[2025-05-13T03:59:33.898Z] [coreHandlers][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T03:59:33.898Z] [INFO] Core event handlers successfully registered.
[2025-05-13T03:59:33.898Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:59:33.899Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T03:59:33.899Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T03:59:33.900Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T03:59:33.904Z] [SERVER SOCKET We9U0hUFaARwocTFAAAH - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T03:59:34.201Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T03:59:34.201Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T03:59:34.202Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T03:59:34.202Z] [SERVER GLOBAL][connection][We9U0hUFaARwocTFAAAH][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:00:30.808Z] [SERVER GLOBAL][disconnect][We9U0hUFaARwocTFAAAH] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T04:00:30.843Z] [socketAuth][Q2kdTWV_jaYpHAraAAAJ] Authentication attempt. Has token: true
[2025-05-13T04:00:30.845Z] [socketAuth][Q2kdTWV_jaYpHAraAAAJ] Token signature validated successfully.
[2025-05-13T04:00:30.846Z] [HistoryService] Initialized.
[2025-05-13T04:00:30.846Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ] New connection. Socket ID: Q2kdTWV_jaYpHAraAAAJ. Initial socket.data.userId: null
[2025-05-13T04:00:30.847Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ] Client connected, processing authentication. Has token: true
[2025-05-13T04:00:30.847Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ] Attempting to fetch user info using token...
[2025-05-13T04:00:30.847Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:00:30.847Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:00:31.549Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:00:31.550Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:00:31.550Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:00:31.554Z] [HistoryService] Initialized.
[2025-05-13T04:00:31.556Z] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:00:31.557Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:00:31.559Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:00:31.560Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:00:31.562Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:00:31.566Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:00:31.574Z] [SERVER SOCKET Q2kdTWV_jaYpHAraAAAJ - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:00:31.787Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T04:00:31.788Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 9
[2025-05-13T04:00:31.789Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:00:31.789Z] [SERVER GLOBAL][connection][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:00:57.620Z] [SERVER SOCKET Q2kdTWV_jaYpHAraAAAJ - ON ANY] Event: send_message, Args: [{"userInput":"Who are uou ?","isStreaming":true,"language":"ja","conversationId":null}]
[2025-05-13T04:00:57.622Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622] Request received. UserInput: "Who are uou ?", Streaming: true, Language: ja, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T04:00:57.622Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T04:00:57.827Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T04:00:57.828Z] [DEBUG] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T04:00:57.828Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:00:58.072Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:00:58.073Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Emitted updated conversation list. Reason: new conversation from send_message, Count: 10
[2025-05-13T04:00:58.144Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Fetched current history. Count: 0
[2025-05-13T04:00:58.144Z] [DEBUG] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Calling streaming intent handler.
[2025-05-13T04:00:58.145Z] --- [Q2kd-1747108857622 Socket Q2kdTWV_jaYpHAraAAAJ] Handling STREAMING input: "Who are uou ?", Lang: ja ---
[2025-05-13T04:00:58.146Z] [Language Config] WARN: Config not found for language "ja" in agent "HostAgent". Falling back to default language "en" for this agent.
[2025-05-13T04:00:58.147Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T04:00:58.153Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:00:58.154Z] --- [Q2kd-1747108857622 HostAgent Streaming Turn 1 Start - Q2kdTWV_jaYpHAraAAAJ] ---
[2025-05-13T04:00:58.154Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:00:58.154Z] [Q2kd-1747108857622 History T1 Send - Q2kdTWV_jaYpHAraAAAJ] Host History Size: 1
[2025-05-13T04:00:58.156Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:00:58.156Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:00:58.156Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:00:58.157Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:00:58.157Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:00:58.157Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:00:58.157Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:00:58.158Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:00:58.158Z]   - No valid next turn added, sending only history.
[2025-05-13T04:00:58.977Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:00:58.977Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:00:58.978Z] [Q2kd-1747108857622 Stream Processing - Q2kdTWV_jaYpHAraAAAJ] Starting...
[2025-05-13T04:00:58.979Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:00:58.979Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:00:59.019Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:00:59.130Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:00:59.141Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:00:59.149Z] [Q2kd-1747108857622 Stream Processing - Q2kdTWV_jaYpHAraAAAJ] Finished. Length: 181
[2025-05-13T04:00:59.149Z] [Q2kd-1747108857622 Q2kdTWV_jaYpHAraAAAJ] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:00:59.150Z] [Q2kd-1747108857622 Streaming Emit Sent - Q2kdTWV_jaYpHAraAAAJ] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:00:59.150Z] --- [Q2kd-1747108857622 Q2kdTWV_jaYpHAraAAAJ Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:00:59.151Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T04:00:59.240Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Successfully updated history in DB.
[2025-05-13T04:00:59.240Z] [DEBUG] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:00:59.241Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:00:59.492Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:00:59.493Z] [INFO] [coreHandlers][Q2kdTWV_jaYpHAraAAAJ][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Q2kd-1747108857622][Conv:6822c3f92dff50ca4665d5c9] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:06:17.314Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:06:17.315Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:06:17.754Z] [MainLoader] Starting application loading process...
[2025-05-13T04:06:17.756Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:06:17.758Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:06:18.650Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:06:18.650Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:06:18.650Z] [MainLoader] Database loaded.
[2025-05-13T04:06:18.651Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:06:18.652Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:06:18.658Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:06:18.661Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:06:18.662Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:06:18.662Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:06:18.662Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:06:18.664Z] [MainLoader] Express loaded.
[2025-05-13T04:06:18.664Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:06:18.670Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:06:18.670Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:06:18.671Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:06:18.671Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:06:18.672Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:06:18.716Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:06:18.717Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:06:18.717Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:06:18.770Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:06:18.771Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:06:18.870Z] [socketAuth][y7xe3SaNZQxDjctIAAAB] Authentication attempt. Has token: true
[2025-05-13T04:06:18.874Z] [socketAuth][y7xe3SaNZQxDjctIAAAB] Token signature validated successfully.
[2025-05-13T04:06:18.877Z] [HistoryService] Initialized.
[2025-05-13T04:06:18.878Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB] New connection. Socket ID: y7xe3SaNZQxDjctIAAAB. Initial socket.data.userId: null
[2025-05-13T04:06:18.878Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:06:18.878Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB] Attempting to fetch user info using token...
[2025-05-13T04:06:18.879Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:06:18.879Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:06:19.601Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:06:19.602Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:06:19.602Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:06:19.604Z] [HistoryService] Initialized.
[2025-05-13T04:06:19.604Z] [coreHandlers][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:06:19.604Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:06:19.604Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:06:19.605Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:06:19.606Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:06:19.607Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:06:19.641Z] [SERVER SOCKET y7xe3SaNZQxDjctIAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:06:19.840Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:06:19.841Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:06:19.842Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:06:19.842Z] [SERVER GLOBAL][connection][y7xe3SaNZQxDjctIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:22:10.817Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:22:10.818Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:22:11.566Z] [MainLoader] Starting application loading process...
[2025-05-13T04:22:11.569Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:22:11.572Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:22:12.502Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:22:12.502Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:22:12.503Z] [MainLoader] Database loaded.
[2025-05-13T04:22:12.503Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:22:12.504Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:22:12.510Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:22:12.513Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:22:12.514Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:22:12.514Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:22:12.514Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:22:12.516Z] [MainLoader] Express loaded.
[2025-05-13T04:22:12.516Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:22:12.521Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:22:12.522Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:22:12.522Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:22:12.522Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:22:12.523Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:22:12.590Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:22:12.591Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:22:12.593Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:22:12.661Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:22:12.661Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:22:12.983Z] [socketAuth][nRdsmOIhne90b3-6AAAB] Authentication attempt. Has token: true
[2025-05-13T04:22:12.990Z] [socketAuth][nRdsmOIhne90b3-6AAAB] Token signature validated successfully.
[2025-05-13T04:22:12.993Z] [HistoryService] Initialized.
[2025-05-13T04:22:12.994Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB] New connection. Socket ID: nRdsmOIhne90b3-6AAAB. Initial socket.data.userId: null
[2025-05-13T04:22:12.994Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:22:12.994Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB] Attempting to fetch user info using token...
[2025-05-13T04:22:12.995Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:22:12.995Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:22:13.718Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:22:13.718Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:22:13.719Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:22:13.720Z] [HistoryService] Initialized.
[2025-05-13T04:22:13.721Z] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:22:13.721Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:22:13.721Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:22:13.721Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:22:13.723Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:22:13.723Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:22:13.953Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:22:13.954Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:22:13.954Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:22:13.954Z] [SERVER GLOBAL][connection][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:22:14.272Z] [SERVER SOCKET nRdsmOIhne90b3-6AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:22:14.497Z] [SERVER SOCKET nRdsmOIhne90b3-6AAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822c3f92dff50ca4665d5c9"}]
[2025-05-13T04:22:14.500Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822c3f92dff50ca4665d5c9"}
[2025-05-13T04:22:14.501Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822c3f92dff50ca4665d5c9] Request received.
[2025-05-13T04:22:14.582Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822c3f92dff50ca4665d5c9] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T04:22:25.603Z] [SERVER SOCKET nRdsmOIhne90b3-6AAAB - ON ANY] Event: send_message, Args: [{"userInput":"who are you ?","isStreaming":true,"language":"ko","conversationId":"6822c3f92dff50ca4665d5c9"}]
[2025-05-13T04:22:25.605Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605] Request received. UserInput: "who are you ?", Streaming: true, Language: ko, PayloadConvId: 6822c3f92dff50ca4665d5c9, SocketDataConvId: 6822c3f92dff50ca4665d5c9
[2025-05-13T04:22:25.605Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Using conversationId from payload.
[2025-05-13T04:22:25.666Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Fetched current history. Count: 2
[2025-05-13T04:22:25.666Z] [DEBUG] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Calling streaming intent handler.
[2025-05-13T04:22:25.668Z] --- [nRds-1747110145605 Socket nRdsmOIhne90b3-6AAAB] Handling STREAMING input: "who are you ?", Lang: ko ---
[2025-05-13T04:22:25.668Z] [Language Config] Using configuration for Agent: HostAgent, Language: ko
[2025-05-13T04:22:25.669Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:22:25.670Z] --- [nRds-1747110145605 HostAgent Streaming Turn 1 Start - nRdsmOIhne90b3-6AAAB] ---
[2025-05-13T04:22:25.670Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:22:25.670Z] [nRds-1747110145605 History T1 Send - nRdsmOIhne90b3-6AAAB] Host History Size: 3
[2025-05-13T04:22:25.671Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:22:25.672Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:22:25.672Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:22:25.672Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:22:25.672Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:22:25.672Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:22:25.673Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:22:25.673Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:22:25.673Z]   - No valid next turn added, sending only history.
[2025-05-13T04:22:26.451Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:22:26.452Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:22:26.453Z] [nRds-1747110145605 Stream Processing - nRdsmOIhne90b3-6AAAB] Starting...
[2025-05-13T04:22:26.454Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:22:26.455Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:22:26.482Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:22:26.550Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:22:26.578Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:22:26.592Z] [nRds-1747110145605 Stream Processing - nRdsmOIhne90b3-6AAAB] Finished. Length: 181
[2025-05-13T04:22:26.593Z] [nRds-1747110145605 nRdsmOIhne90b3-6AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:22:26.593Z] [nRds-1747110145605 Streaming Emit Sent - nRdsmOIhne90b3-6AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:22:26.594Z] --- [nRds-1747110145605 nRdsmOIhne90b3-6AAAB Lang: ko] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:22:26.594Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:22:26.744Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Successfully updated history in DB.
[2025-05-13T04:22:26.744Z] [DEBUG] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:22:26.745Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:22:27.061Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:22:27.062Z] [INFO] [coreHandlers][nRdsmOIhne90b3-6AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nRds-1747110145605][Conv:6822c3f92dff50ca4665d5c9] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:23:25.660Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:23:25.663Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:23:26.060Z] [MainLoader] Starting application loading process...
[2025-05-13T04:23:26.060Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:23:26.061Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:23:26.915Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:23:26.915Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:23:26.915Z] [MainLoader] Database loaded.
[2025-05-13T04:23:26.916Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:23:26.916Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:23:26.921Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:23:26.924Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:23:26.925Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:23:26.925Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:23:26.925Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:23:26.927Z] [MainLoader] Express loaded.
[2025-05-13T04:23:26.927Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:23:26.932Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:23:26.932Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:23:26.933Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:23:26.933Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:23:26.934Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:23:26.970Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:23:26.970Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:23:26.971Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:23:27.020Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:23:27.021Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:23:30.825Z] [socketAuth][MPdpOV-3OZ7FIDOXAAAB] Authentication attempt. Has token: true
[2025-05-13T04:23:30.830Z] [socketAuth][MPdpOV-3OZ7FIDOXAAAB] Token signature validated successfully.
[2025-05-13T04:23:30.834Z] [HistoryService] Initialized.
[2025-05-13T04:23:30.834Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB] New connection. Socket ID: MPdpOV-3OZ7FIDOXAAAB. Initial socket.data.userId: null
[2025-05-13T04:23:30.835Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:23:30.835Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB] Attempting to fetch user info using token...
[2025-05-13T04:23:30.836Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:23:30.836Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:23:31.517Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:23:31.517Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:23:31.517Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:23:31.519Z] [HistoryService] Initialized.
[2025-05-13T04:23:31.519Z] [coreHandlers][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:23:31.519Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:23:31.520Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:23:31.520Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:23:31.521Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:23:31.522Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:23:31.553Z] [SERVER SOCKET MPdpOV-3OZ7FIDOXAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:23:31.763Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:23:31.764Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:23:31.765Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:23:31.765Z] [SERVER GLOBAL][connection][MPdpOV-3OZ7FIDOXAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:31:49.430Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:31:49.431Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:31:49.811Z] [MainLoader] Starting application loading process...
[2025-05-13T04:31:49.812Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:31:49.813Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:31:50.793Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:31:50.793Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:31:50.794Z] [MainLoader] Database loaded.
[2025-05-13T04:31:50.794Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:31:50.795Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:31:50.804Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:31:50.807Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:31:50.807Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:31:50.808Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:31:50.808Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:31:50.809Z] [MainLoader] Express loaded.
[2025-05-13T04:31:50.810Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:31:50.815Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:31:50.816Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:31:50.816Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:31:50.817Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:31:50.817Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:31:50.903Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:31:50.905Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:31:50.906Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:31:51.010Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:31:51.010Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:31:52.836Z] [socketAuth][hIWeR008oHJXZLQOAAAB] Authentication attempt. Has token: true
[2025-05-13T04:31:52.843Z] [socketAuth][hIWeR008oHJXZLQOAAAB] Token signature validated successfully.
[2025-05-13T04:31:52.847Z] [HistoryService] Initialized.
[2025-05-13T04:31:52.847Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB] New connection. Socket ID: hIWeR008oHJXZLQOAAAB. Initial socket.data.userId: null
[2025-05-13T04:31:52.848Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:31:52.848Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB] Attempting to fetch user info using token...
[2025-05-13T04:31:52.849Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:31:52.849Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:31:53.530Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:31:53.530Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:31:53.531Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:31:53.532Z] [HistoryService] Initialized.
[2025-05-13T04:31:53.533Z] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:31:53.533Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:31:53.533Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:31:53.534Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:31:53.535Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:31:53.536Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:31:53.576Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:31:53.763Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:31:53.764Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:31:53.765Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:31:53.765Z] [SERVER GLOBAL][connection][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:31:59.199Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822c3f92dff50ca4665d5c9"}]
[2025-05-13T04:31:59.201Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822c3f92dff50ca4665d5c9] Request received.
[2025-05-13T04:31:59.278Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822c3f92dff50ca4665d5c9] Successfully processed deletion.
[2025-05-13T04:31:59.279Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822c3f92dff50ca4665d5c9
[2025-05-13T04:31:59.279Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:31:59.472Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T04:31:59.473Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822c3f92dff50ca4665d5c9, Count: 9
[2025-05-13T04:32:05.952Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Hello","isStreaming":true,"language":"ko","conversationId":null}]
[2025-05-13T04:32:05.953Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953] Request received. UserInput: "Hello", Streaming: true, Language: ko, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T04:32:05.953Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T04:32:06.120Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T04:32:06.121Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T04:32:06.121Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:32:06.314Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:32:06.315Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: new conversation from send_message, Count: 10
[2025-05-13T04:32:06.379Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 0
[2025-05-13T04:32:06.379Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:32:06.381Z] --- [hIWe-1747110725953 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "Hello", Lang: ko ---
[2025-05-13T04:32:06.382Z] [Language Config] Using configuration for Agent: HostAgent, Language: ko
[2025-05-13T04:32:06.385Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:06.385Z] --- [hIWe-1747110725953 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:32:06.386Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:06.386Z] [hIWe-1747110725953 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 1
[2025-05-13T04:32:06.388Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:32:06.388Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:32:06.389Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:32:06.389Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:32:06.389Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:32:06.389Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:32:06.389Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:32:06.390Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:32:06.390Z]   - No valid next turn added, sending only history.
[2025-05-13T04:32:08.156Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:32:08.158Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:08.158Z] [hIWe-1747110725953 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:32:08.159Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:08.160Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:08.256Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:08.266Z] [hIWe-1747110725953 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 19
[2025-05-13T04:32:08.266Z] [hIWe-1747110725953 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:32:08.268Z] [hIWe-1747110725953 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:32:08.268Z] --- [hIWe-1747110725953 hIWeR008oHJXZLQOAAAB Lang: ko] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:32:08.269Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T04:32:08.352Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:32:08.352Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:32:08.353Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:32:08.553Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:32:08.554Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110725953][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:32:15.443Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"who are you ?","isStreaming":true,"language":"fa","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:32:15.443Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443] Request received. UserInput: "who are you ?", Streaming: true, Language: fa, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:32:15.444Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:32:15.509Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 2
[2025-05-13T04:32:15.509Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:32:15.509Z] --- [hIWe-1747110735443 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "who are you ?", Lang: fa ---
[2025-05-13T04:32:15.510Z] [Language Config] Using configuration for Agent: HostAgent, Language: fa
[2025-05-13T04:32:15.510Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:15.511Z] --- [hIWe-1747110735443 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:32:15.511Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:15.511Z] [hIWe-1747110735443 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 3
[2025-05-13T04:32:15.512Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:32:15.512Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:32:15.512Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:32:15.512Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:32:15.513Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:32:15.513Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:32:15.513Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:32:15.513Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:32:15.513Z]   - No valid next turn added, sending only history.
[2025-05-13T04:32:16.173Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:32:16.174Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:16.175Z] [hIWe-1747110735443 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:32:16.175Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:16.175Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:16.235Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:16.348Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:16.352Z] [hIWe-1747110735443 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 94
[2025-05-13T04:32:16.353Z] [hIWe-1747110735443 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:32:16.353Z] [hIWe-1747110735443 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:32:16.354Z] --- [hIWe-1747110735443 hIWeR008oHJXZLQOAAAB Lang: fa] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:32:16.354Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:32:16.426Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:32:16.426Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:32:16.427Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:32:16.627Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:32:16.628Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110735443][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:32:25.067Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"oke","isStreaming":true,"language":"fr","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:32:25.067Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067] Request received. UserInput: "oke", Streaming: true, Language: fr, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:32:25.067Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:32:25.129Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 4
[2025-05-13T04:32:25.130Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:32:25.130Z] --- [hIWe-1747110745067 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "oke", Lang: fr ---
[2025-05-13T04:32:25.130Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T04:32:25.130Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:25.131Z] --- [hIWe-1747110745067 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:32:25.131Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:25.131Z] [hIWe-1747110745067 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 5
[2025-05-13T04:32:25.132Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T04:32:25.132Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T04:32:25.133Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:32:25.133Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:32:25.134Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:32:25.134Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:32:25.134Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:32:25.134Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T04:32:25.134Z]   - No valid next turn added, sending only history.
[2025-05-13T04:32:25.993Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:32:25.993Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:25.993Z] [hIWe-1747110745067 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:32:25.994Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:25.994Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:26.079Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:26.085Z] [hIWe-1747110745067 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 51
[2025-05-13T04:32:26.085Z] [hIWe-1747110745067 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:32:26.086Z] [hIWe-1747110745067 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:32:26.086Z] --- [hIWe-1747110745067 hIWeR008oHJXZLQOAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:32:26.086Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T04:32:26.156Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:32:26.157Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:32:26.157Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:32:26.344Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:32:26.345Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110745067][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:32:37.889Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"abnj có thể làm gì","isStreaming":true,"language":"de","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:32:37.889Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889] Request received. UserInput: "abnj có thể làm gì", Streaming: true, Language: de, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:32:37.889Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:32:37.956Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 6
[2025-05-13T04:32:37.956Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:32:37.957Z] --- [hIWe-1747110757889 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "abnj có thể làm gì", Lang: de ---
[2025-05-13T04:32:37.957Z] [Language Config] Using configuration for Agent: HostAgent, Language: de
[2025-05-13T04:32:37.957Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:37.958Z] --- [hIWe-1747110757889 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:32:37.958Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:37.958Z] [hIWe-1747110757889 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 7
[2025-05-13T04:32:37.959Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T04:32:37.959Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T04:32:37.959Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:32:37.959Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:32:37.960Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:32:37.960Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:32:37.960Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:32:37.960Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T04:32:37.960Z]   - No valid next turn added, sending only history.
[2025-05-13T04:32:39.568Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:32:39.569Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:39.569Z] [hIWe-1747110757889 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:32:39.570Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:32:39.570Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:39.673Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:39.857Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:39.978Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:32:39.985Z] [hIWe-1747110757889 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 211
[2025-05-13T04:32:39.985Z] [hIWe-1747110757889 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:32:39.986Z] [hIWe-1747110757889 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:32:39.986Z] --- [hIWe-1747110757889 hIWeR008oHJXZLQOAAAB Lang: de] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:32:39.986Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T04:32:40.057Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:32:40.058Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:32:40.058Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:32:40.250Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:32:40.250Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110757889][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:33:26.972Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"oke","isStreaming":true,"language":"de","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:33:26.973Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973] Request received. UserInput: "oke", Streaming: true, Language: de, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:33:26.973Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:33:27.034Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 8
[2025-05-13T04:33:27.034Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:33:27.035Z] --- [hIWe-1747110806973 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "oke", Lang: de ---
[2025-05-13T04:33:27.035Z] [Language Config] Using configuration for Agent: HostAgent, Language: de
[2025-05-13T04:33:27.036Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:27.036Z] --- [hIWe-1747110806973 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:33:27.036Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:27.036Z] [hIWe-1747110806973 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 9
[2025-05-13T04:33:27.037Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T04:33:27.037Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T04:33:27.037Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:33:27.037Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:33:27.037Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:33:27.038Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:33:27.038Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:33:27.038Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T04:33:27.038Z]   - No valid next turn added, sending only history.
[2025-05-13T04:33:27.620Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:33:27.621Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:27.621Z] [hIWe-1747110806973 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:33:27.621Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:27.622Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:27.697Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:27.700Z] [hIWe-1747110806973 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 33
[2025-05-13T04:33:27.700Z] [hIWe-1747110806973 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:33:27.701Z] [hIWe-1747110806973 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:33:27.701Z] --- [hIWe-1747110806973 hIWeR008oHJXZLQOAAAB Lang: de] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:33:27.702Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T04:33:27.770Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:33:27.771Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:33:27.771Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:33:27.956Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:33:27.956Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110806973][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:33:37.119Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tên trang web","isStreaming":true,"language":"de","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:33:37.119Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119] Request received. UserInput: "tên trang web", Streaming: true, Language: de, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:33:37.120Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:33:37.184Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 10
[2025-05-13T04:33:37.184Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:33:37.185Z] --- [hIWe-1747110817119 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "tên trang web", Lang: de ---
[2025-05-13T04:33:37.186Z] [Language Config] Using configuration for Agent: HostAgent, Language: de
[2025-05-13T04:33:37.186Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:37.187Z] --- [hIWe-1747110817119 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:33:37.187Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:37.187Z] [hIWe-1747110817119 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 11
[2025-05-13T04:33:37.188Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T04:33:37.188Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T04:33:37.188Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:33:37.189Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:33:37.189Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:33:37.189Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:33:37.189Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:33:37.189Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T04:33:37.189Z]   - No valid next turn added, sending only history.
[2025-05-13T04:33:37.984Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:33:37.985Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:37.986Z] [hIWe-1747110817119 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:33:37.986Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:37.986Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:38.059Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:38.065Z] [hIWe-1747110817119 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 50
[2025-05-13T04:33:38.066Z] [hIWe-1747110817119 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:33:38.066Z] [hIWe-1747110817119 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:33:38.066Z] --- [hIWe-1747110817119 hIWeR008oHJXZLQOAAAB Lang: de] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:33:38.067Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T04:33:38.215Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:33:38.216Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:33:38.216Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:33:38.407Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:33:38.408Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110817119][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:33:52.486Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tên của trang web này","isStreaming":true,"language":"de","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:33:52.486Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486] Request received. UserInput: "tên của trang web này", Streaming: true, Language: de, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:33:52.486Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:33:52.549Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 12
[2025-05-13T04:33:52.550Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:33:52.550Z] --- [hIWe-1747110832486 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "tên của trang web này", Lang: de ---
[2025-05-13T04:33:52.551Z] [Language Config] Using configuration for Agent: HostAgent, Language: de
[2025-05-13T04:33:52.551Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:52.552Z] --- [hIWe-1747110832486 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:33:52.552Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:52.552Z] [hIWe-1747110832486 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 13
[2025-05-13T04:33:52.552Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T04:33:52.552Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T04:33:52.553Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:33:52.553Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:33:52.553Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:33:52.553Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:33:52.553Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:33:52.553Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T04:33:52.553Z]   - No valid next turn added, sending only history.
[2025-05-13T04:33:53.206Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:33:53.207Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:53.207Z] [hIWe-1747110832486 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:33:53.207Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:33:53.208Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:53.296Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:53.365Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:33:53.370Z] [hIWe-1747110832486 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 149
[2025-05-13T04:33:53.371Z] [hIWe-1747110832486 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:33:53.371Z] [hIWe-1747110832486 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:33:53.372Z] --- [hIWe-1747110832486 hIWeR008oHJXZLQOAAAB Lang: de] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:33:53.372Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T04:33:53.449Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:33:53.450Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:33:53.450Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:33:53.637Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:33:53.638Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110832486][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:34:01.794Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"who are you ?","isStreaming":true,"language":"es","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:34:01.795Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795] Request received. UserInput: "who are you ?", Streaming: true, Language: es, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:34:01.795Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:34:01.858Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 14
[2025-05-13T04:34:01.859Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:34:01.859Z] --- [hIWe-1747110841795 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "who are you ?", Lang: es ---
[2025-05-13T04:34:01.859Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T04:34:01.860Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:01.861Z] --- [hIWe-1747110841795 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:34:01.861Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:01.862Z] [hIWe-1747110841795 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 15
[2025-05-13T04:34:01.862Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T04:34:01.862Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T04:34:01.863Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:34:01.863Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:01.864Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:01.864Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:34:01.864Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:01.864Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T04:34:01.865Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:02.483Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:34:02.484Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:02.484Z] [hIWe-1747110841795 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:34:02.484Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:02.485Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:02.612Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:02.668Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:02.677Z] [hIWe-1747110841795 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 110
[2025-05-13T04:34:02.678Z] [hIWe-1747110841795 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:34:02.679Z] [hIWe-1747110841795 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:34:02.679Z] --- [hIWe-1747110841795 hIWeR008oHJXZLQOAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:34:02.679Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 16
[2025-05-13T04:34:02.752Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:34:02.752Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:34:02.752Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:34:02.940Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:34:02.941Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110841795][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:34:19.412Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tìm hội nghị tại Vietnam","isStreaming":true,"language":"es","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:34:19.413Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413] Request received. UserInput: "tìm hội nghị tại Vietnam", Streaming: true, Language: es, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:34:19.413Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:34:19.475Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 16
[2025-05-13T04:34:19.475Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:34:19.476Z] --- [hIWe-1747110859413 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "tìm hội nghị tại Vietnam", Lang: es ---
[2025-05-13T04:34:19.476Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T04:34:19.477Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:19.477Z] --- [hIWe-1747110859413 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:34:19.478Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:19.479Z] [hIWe-1747110859413 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 17
[2025-05-13T04:34:19.479Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T04:34:19.479Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T04:34:19.480Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:34:19.480Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:19.480Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:19.480Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:34:19.481Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:19.481Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T04:34:19.482Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:20.340Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:34:20.341Z] [hIWe-1747110859413 HostAgent Streaming T1 - hIWeR008oHJXZLQOAAAB] Requests function: routeToAgent
[2025-05-13T04:34:20.341Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:20.344Z] --- [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 Socket hIWeR008oHJXZLQOAAAB] Calling Sub Agent: ConferenceAgent, Task: b5109e08-6246-4c42-8fab-e2e304d85330 ---
[2025-05-13T04:34:20.345Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T04:34:20.345Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:34:20.346Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:34:20.347Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:34:20.348Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:34:20.348Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:34:20.348Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:20.348Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:20.349Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:34:20.349Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:20.349Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:34:20.349Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:21.086Z] Model Finish Reason: STOP
[2025-05-13T04:34:21.086Z] Model requested function call: getConferences
[2025-05-13T04:34:21.086Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:34:21.087Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:34:21.087Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344] ConferenceAgent requests function call: getConferences
[2025-05-13T04:34:21.088Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:34:21.088Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:34:21.089Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:34:21.089Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:34:21.090Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:34:21.091Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:34:21.092Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:34:21.092Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:34:21.093Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:34:21.094Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:34:21.094Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:34:21.095Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T04:34:21.815Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T04:34:21.816Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T04:34:21.816Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:34:21.817Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T04:34:21.823Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T04:34:21.824Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T04:34:21.824Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:34:21.824Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:34:21.825Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:34:21.826Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:34:21.826Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:34:21.827Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:34:21.828Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:34:21.828Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:34:21.828Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:34:21.829Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:34:21.829Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:34:21.830Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:34:21.830Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:34:21.830Z] [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:34:21.831Z] --- [hIWe-1747110859413-Sub-ConferenceAgent-1747110860344] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:34:21.831Z] [hIWe-1747110859413 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:34:21.832Z] --- [hIWe-1747110859413 HostAgent Streaming Turn 2 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:34:21.832Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:21.832Z] [hIWe-1747110859413 History T2 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 19
[2025-05-13T04:34:21.833Z] [GeminiService] Received history with 19 items before mapping (for stream).
[2025-05-13T04:34:21.833Z] [GeminiService] Mapped history (SDK Content[]) with 19 items (for stream).
[2025-05-13T04:34:21.833Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:34:21.833Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:21.834Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:21.834Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:34:21.834Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:21.834Z] [GeminiService Stream] Preparing stream request with 19 Content items.
[2025-05-13T04:34:21.834Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:22.447Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:34:22.448Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:22.448Z] [hIWe-1747110859413 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:34:22.449Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:22.449Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:22.537Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:22.635Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:22.760Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:22.895Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:23.117Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:23.307Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:23.577Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:23.929Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:24.056Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:24.060Z] [hIWe-1747110859413 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 969
[2025-05-13T04:34:24.061Z] [hIWe-1747110859413 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:34:24.061Z] [hIWe-1747110859413 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:34:24.061Z] --- [hIWe-1747110859413 hIWeR008oHJXZLQOAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:34:24.062Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 20
[2025-05-13T04:34:24.142Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:34:24.143Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:34:24.143Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:34:24.381Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:34:24.382Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110859413][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:34:44.417Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"chi tiết về hội nghị cuối cùng","isStreaming":true,"language":"ja","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:34:44.417Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417] Request received. UserInput: "chi tiết về hội nghị cuối cùng", Streaming: true, Language: ja, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:34:44.417Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:34:44.480Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 20
[2025-05-13T04:34:44.480Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:34:44.481Z] --- [hIWe-1747110884417 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "chi tiết về hội nghị cuối cùng", Lang: ja ---
[2025-05-13T04:34:44.481Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T04:34:44.482Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:44.483Z] --- [hIWe-1747110884417 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:34:44.483Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:44.484Z] [hIWe-1747110884417 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 21
[2025-05-13T04:34:44.484Z] [GeminiService] Received history with 21 items before mapping (for stream).
[2025-05-13T04:34:44.484Z] [GeminiService] Mapped history (SDK Content[]) with 21 items (for stream).
[2025-05-13T04:34:44.484Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:34:44.484Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:44.485Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:44.485Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:34:44.486Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:44.486Z] [GeminiService Stream] Preparing stream request with 21 Content items.
[2025-05-13T04:34:44.486Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:45.421Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:34:45.422Z] [hIWe-1747110884417 HostAgent Streaming T1 - hIWeR008oHJXZLQOAAAB] Requests function: routeToAgent
[2025-05-13T04:34:45.422Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:45.423Z] --- [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 Socket hIWeR008oHJXZLQOAAAB] Calling Sub Agent: ConferenceAgent, Task: 8170b2d6-0814-4f20-a8a7-eedc46e6a507 ---
[2025-05-13T04:34:45.423Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: ja
[2025-05-13T04:34:45.423Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:34:45.424Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:34:45.424Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:34:45.424Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:34:45.424Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:34:45.425Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:45.425Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:45.425Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:34:45.425Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:45.426Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:34:45.426Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:46.242Z] Model Finish Reason: STOP
[2025-05-13T04:34:46.242Z] Model requested function call: getConferences
[2025-05-13T04:34:46.243Z] Arguments: {"searchQuery":"mode=detail&title=Hoi+nghi+dien+hong"}
[2025-05-13T04:34:46.243Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:34:46.243Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423] ConferenceAgent requests function call: getConferences
[2025-05-13T04:34:46.243Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:34:46.244Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:34:46.244Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:34:46.244Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:34:46.245Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"mode=detail&title=Hoi+nghi+dien+hong"}
[2025-05-13T04:34:46.245Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:34:46.245Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:34:46.246Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:34:46.246Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:34:46.246Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:34:46.246Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:34:46.247Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?mode=detail&title=Hoi+nghi+dien+hong}
[2025-05-13T04:34:46.900Z] [BackendService] [conference] API Success (200). Data length: 109. Attempting parsing...
[2025-05-13T04:34:46.900Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":10,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T04:34:46.900Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:34:46.901Z] Transforming conference data with Markdown. Search query: mode=detail&title=Hoi+nghi+dien+hong
[2025-05-13T04:34:46.901Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 10
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T04:34:46.901Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="mode=detail&title=Hoi+nghi+dien+hong"
[2025-05-13T04:34:46.902Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:34:46.902Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:34:46.903Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:34:46.903Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:34:46.903Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:34:46.903Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:34:46.904Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:34:46.904Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:34:46.904Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:34:46.905Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:34:46.905Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:34:46.905Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:34:46.906Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:34:46.906Z] [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:34:46.906Z] --- [hIWe-1747110884417-Sub-ConferenceAgent-1747110885423] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:34:46.906Z] [hIWe-1747110884417 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:34:46.907Z] --- [hIWe-1747110884417 HostAgent Streaming Turn 2 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:34:46.907Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:46.907Z] [hIWe-1747110884417 History T2 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 23
[2025-05-13T04:34:46.908Z] [GeminiService] Received history with 23 items before mapping (for stream).
[2025-05-13T04:34:46.908Z] [GeminiService] Mapped history (SDK Content[]) with 23 items (for stream).
[2025-05-13T04:34:46.908Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:34:46.908Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:34:46.908Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:34:46.909Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:34:46.909Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:34:46.909Z] [GeminiService Stream] Preparing stream request with 23 Content items.
[2025-05-13T04:34:46.909Z]   - No valid next turn added, sending only history.
[2025-05-13T04:34:47.547Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:34:47.548Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:47.548Z] [hIWe-1747110884417 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:34:47.548Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:34:47.549Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:47.646Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:47.685Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:34:47.689Z] [hIWe-1747110884417 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 85
[2025-05-13T04:34:47.690Z] [hIWe-1747110884417 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:34:47.690Z] [hIWe-1747110884417 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:34:47.691Z] --- [hIWe-1747110884417 hIWeR008oHJXZLQOAAAB Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:34:47.691Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 24
[2025-05-13T04:34:47.772Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:34:47.773Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:34:47.773Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:34:48.015Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:34:48.016Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110884417][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:35:21.780Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"chi tiết về hội nghị đầu tiên","isStreaming":true,"language":"ja","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:35:21.781Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781] Request received. UserInput: "chi tiết về hội nghị đầu tiên", Streaming: true, Language: ja, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:35:21.782Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:35:21.846Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 24
[2025-05-13T04:35:21.846Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:35:21.848Z] --- [hIWe-1747110921781 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "chi tiết về hội nghị đầu tiên", Lang: ja ---
[2025-05-13T04:35:21.848Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T04:35:21.849Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:35:21.850Z] --- [hIWe-1747110921781 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:35:21.850Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:35:21.850Z] [hIWe-1747110921781 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 25
[2025-05-13T04:35:21.850Z] [GeminiService] Received history with 25 items before mapping (for stream).
[2025-05-13T04:35:21.851Z] [GeminiService] Mapped history (SDK Content[]) with 25 items (for stream).
[2025-05-13T04:35:21.851Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:35:21.851Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:35:21.851Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:35:21.852Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:35:21.852Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:35:21.852Z] [GeminiService Stream] Preparing stream request with 25 Content items.
[2025-05-13T04:35:21.852Z]   - No valid next turn added, sending only history.
[2025-05-13T04:35:22.768Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:35:22.768Z] [hIWe-1747110921781 HostAgent Streaming T1 - hIWeR008oHJXZLQOAAAB] Requests function: routeToAgent
[2025-05-13T04:35:22.769Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:35:22.769Z] --- [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 Socket hIWeR008oHJXZLQOAAAB] Calling Sub Agent: ConferenceAgent, Task: 7bfc30ce-ea3b-48ae-83b3-df7149fccfa1 ---
[2025-05-13T04:35:22.770Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: ja
[2025-05-13T04:35:22.770Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:35:22.770Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:35:22.770Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:35:22.770Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:35:22.771Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:35:22.771Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:35:22.771Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:35:22.771Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:35:22.771Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:35:22.771Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:35:22.772Z]   - No valid next turn added, sending only history.
[2025-05-13T04:35:24.608Z] Model Finish Reason: STOP
[2025-05-13T04:35:24.608Z] Model requested function call: getConferences
[2025-05-13T04:35:24.608Z] Arguments: {"searchQuery":"mode=detail&title=Asian+Conference+on+Computer+Vision&perPage=5&page=1"}
[2025-05-13T04:35:24.609Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:35:24.609Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769] ConferenceAgent requests function call: getConferences
[2025-05-13T04:35:24.609Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:35:24.609Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:35:24.610Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:35:24.610Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:35:24.611Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"mode=detail&title=Asian+Conference+on+Computer+Vision&perPage=5&page=1"}
[2025-05-13T04:35:24.611Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:35:24.611Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:35:24.611Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:35:24.612Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:35:24.612Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:35:24.612Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:35:24.613Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?mode=detail&title=Asian+Conference+on+Computer+Vision&perPage=5&page=1}
[2025-05-13T04:35:25.285Z] [BackendService] [conference] API Success (200). Data length: 2829. Attempting parsing...
[2025-05-13T04:35:25.286Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","creatorId":null,"adminId":"077f9da9-5570-4b2e-80e3-35e875c8f8b2","createdAt":"2025-05-04T06:50:41.292Z","updatedAt":"2025-05-04T0...
[2025-05-13T04:35:25.286Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:35:25.286Z] Transforming conference data with Markdown. Search query: mode=detail&title=Asian+Conference+on+Computer+Vision&perPage=5&page=1
[2025-05-13T04:35:25.292Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  -...
[2025-05-13T04:35:25.292Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="mode=detail&title=Asian+Conference+on+Computer+Vision&perPage=5&page=1"
[2025-05-13T04:35:25.293Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:35:25.293Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:35:25.293Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:35:25.294Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:35:25.294Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:35:25.294Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:35:25.295Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:35:25.295Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:35:25.295Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:35:25.295Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:35:25.295Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:35:25.296Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:35:25.296Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:35:25.296Z] [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:35:25.297Z] --- [hIWe-1747110921781-Sub-ConferenceAgent-1747110922769] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:35:25.297Z] [hIWe-1747110921781 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:35:25.299Z] --- [hIWe-1747110921781 HostAgent Streaming Turn 2 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:35:25.299Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:35:25.299Z] [hIWe-1747110921781 History T2 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 27
[2025-05-13T04:35:25.300Z] [GeminiService] Received history with 27 items before mapping (for stream).
[2025-05-13T04:35:25.300Z] [GeminiService] Mapped history (SDK Content[]) with 27 items (for stream).
[2025-05-13T04:35:25.300Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:35:25.300Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:35:25.301Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:35:25.301Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:35:25.301Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:35:25.301Z] [GeminiService Stream] Preparing stream request with 27 Content items.
[2025-05-13T04:35:25.301Z]   - No valid next turn added, sending only history.
[2025-05-13T04:35:25.984Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:35:25.985Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:35:25.985Z] [hIWe-1747110921781 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:35:25.985Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:35:25.986Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:26.057Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:26.139Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:26.340Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:26.510Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:26.717Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:26.935Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:27.219Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:27.475Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:27.801Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:28.113Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:28.396Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:28.703Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:28.771Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:35:28.778Z] [hIWe-1747110921781 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 2083
[2025-05-13T04:35:28.778Z] [hIWe-1747110921781 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:35:28.779Z] [hIWe-1747110921781 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:35:28.779Z] --- [hIWe-1747110921781 hIWeR008oHJXZLQOAAAB Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:35:28.779Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 28
[2025-05-13T04:35:28.870Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:35:28.870Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:35:28.870Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:35:29.120Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:35:29.121Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110921781][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:36:22.041Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Taiwan","isStreaming":true,"language":"vi","conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:36:22.041Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041] Request received. UserInput: "find conference in Taiwan", Streaming: true, Language: vi, PayloadConvId: 6822cb458c982ceea00aab7d, SocketDataConvId: 6822cb458c982ceea00aab7d
[2025-05-13T04:36:22.041Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Using conversationId from payload.
[2025-05-13T04:36:22.162Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Fetched current history. Count: 28
[2025-05-13T04:36:22.162Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Calling streaming intent handler.
[2025-05-13T04:36:22.162Z] --- [hIWe-1747110982041 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "find conference in Taiwan", Lang: vi ---
[2025-05-13T04:36:22.162Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:36:22.163Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:36:22.163Z] --- [hIWe-1747110982041 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:36:22.164Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:36:22.164Z] [hIWe-1747110982041 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 29
[2025-05-13T04:36:22.164Z] [GeminiService] Received history with 29 items before mapping (for stream).
[2025-05-13T04:36:22.164Z] [GeminiService] Mapped history (SDK Content[]) with 29 items (for stream).
[2025-05-13T04:36:22.164Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:36:22.165Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:36:22.165Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:36:22.165Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:36:22.166Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:36:22.166Z] [GeminiService Stream] Preparing stream request with 29 Content items.
[2025-05-13T04:36:22.166Z]   - No valid next turn added, sending only history.
[2025-05-13T04:36:23.228Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:36:23.228Z] [hIWe-1747110982041 HostAgent Streaming T1 - hIWeR008oHJXZLQOAAAB] Requests function: routeToAgent
[2025-05-13T04:36:23.229Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:36:23.229Z] --- [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 Socket hIWeR008oHJXZLQOAAAB] Calling Sub Agent: ConferenceAgent, Task: 5fa02790-f109-4c0f-9fcd-ed01cf95dc91 ---
[2025-05-13T04:36:23.230Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T04:36:23.230Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:36:23.231Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:36:23.231Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:36:23.231Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:36:23.231Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:36:23.232Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:36:23.232Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:36:23.232Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:36:23.232Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:36:23.232Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:36:23.232Z]   - No valid next turn added, sending only history.
[2025-05-13T04:36:24.006Z] Model Finish Reason: STOP
[2025-05-13T04:36:24.006Z] Model requested function call: getConferences
[2025-05-13T04:36:24.006Z] Arguments: {"searchQuery":"country=Taiwan&perPage=5&page=1"}
[2025-05-13T04:36:24.007Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:36:24.007Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229] ConferenceAgent requests function call: getConferences
[2025-05-13T04:36:24.007Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:36:24.007Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:36:24.008Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:36:24.008Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:36:24.009Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Taiwan&perPage=5&page=1"}
[2025-05-13T04:36:24.009Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:36:24.009Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:36:24.010Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:36:24.010Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:36:24.010Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:36:24.010Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:36:24.011Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Taiwan&perPage=5&page=1}
[2025-05-13T04:36:24.707Z] [BackendService] [conference] API Success (200). Data length: 8048. Attempting parsing...
[2025-05-13T04:36:24.708Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"05d4ff52-92c8-4636-82a4-d40bfea3c328","title":"Asia-Pacific Services Computing Conference","acronym":"APSCC","location":{"cityStateProvince":"Kaohsiung","country":"Taiwan","address":"National Sun Yat-sen University, Kaohsiung, Taiw...
[2025-05-13T04:36:24.708Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:36:24.708Z] Transforming conference data with Markdown. Search query: country=Taiwan&perPage=5&page=1
[2025-05-13T04:36:24.715Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 20
- **Total page:** 4
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asia-Pacific Services Computing Conference
  - **Acronym:** APS...
[2025-05-13T04:36:24.715Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Taiwan&perPage=5&page=1"
[2025-05-13T04:36:24.715Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:36:24.716Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:36:24.716Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:36:24.717Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:36:24.717Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:36:24.717Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:36:24.717Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:36:24.718Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:36:24.718Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:36:24.719Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:36:24.720Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:36:24.720Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:36:24.721Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:36:24.721Z] [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:36:24.722Z] --- [hIWe-1747110982041-Sub-ConferenceAgent-1747110983229] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:36:24.722Z] [hIWe-1747110982041 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:36:24.722Z] --- [hIWe-1747110982041 HostAgent Streaming Turn 2 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:36:24.722Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:36:24.723Z] [hIWe-1747110982041 History T2 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 31
[2025-05-13T04:36:24.723Z] [GeminiService] Received history with 31 items before mapping (for stream).
[2025-05-13T04:36:24.723Z] [GeminiService] Mapped history (SDK Content[]) with 31 items (for stream).
[2025-05-13T04:36:24.723Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:36:24.723Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:36:24.723Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:36:24.723Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:36:24.724Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:36:24.724Z] [GeminiService Stream] Preparing stream request with 31 Content items.
[2025-05-13T04:36:24.724Z]   - No valid next turn added, sending only history.
[2025-05-13T04:36:25.454Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:36:25.455Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:36:25.455Z] [hIWe-1747110982041 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:36:25.456Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:36:25.456Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:25.539Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:25.622Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:25.778Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:25.934Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:26.126Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:26.336Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:26.647Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:26.938Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:27.061Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:36:27.068Z] [hIWe-1747110982041 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 984
[2025-05-13T04:36:27.069Z] [hIWe-1747110982041 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:36:27.070Z] [hIWe-1747110982041 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:36:27.070Z] --- [hIWe-1747110982041 hIWeR008oHJXZLQOAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:36:27.071Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Intent handler returned updated history. Attempting save. New size: 32
[2025-05-13T04:36:27.155Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Successfully updated history in DB.
[2025-05-13T04:36:27.155Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:36:27.156Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:36:27.400Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:36:27.401Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747110982041][Conv:6822cb458c982ceea00aab7d] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:36:54.944Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822cb458c982ceea00aab7d"}]
[2025-05-13T04:36:54.945Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cb458c982ceea00aab7d] Request received.
[2025-05-13T04:36:55.008Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cb458c982ceea00aab7d] Successfully processed deletion.
[2025-05-13T04:36:55.009Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cb458c982ceea00aab7d] Deleted conversation was active. Clearing active ID.
[2025-05-13T04:36:55.009Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822cb458c982ceea00aab7d
[2025-05-13T04:36:55.010Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:36:55.195Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T04:36:55.196Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822cb458c982ceea00aab7d, Count: 9
[2025-05-13T04:37:04.033Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"ja","conversationId":null}]
[2025-05-13T04:37:04.033Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: ja, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T04:37:04.034Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T04:37:04.162Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T04:37:04.162Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T04:37:04.163Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:37:04.352Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:37:04.353Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: new conversation from send_message, Count: 10
[2025-05-13T04:37:04.413Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 0
[2025-05-13T04:37:04.414Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:37:04.414Z] --- [hIWe-1747111024033 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "find conference in Vietnam", Lang: ja ---
[2025-05-13T04:37:04.414Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T04:37:04.415Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:04.415Z] --- [hIWe-1747111024033 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:37:04.415Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:04.416Z] [hIWe-1747111024033 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 1
[2025-05-13T04:37:04.416Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:37:04.416Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:37:04.416Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:37:04.416Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:37:04.417Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:37:04.417Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:37:04.417Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:37:04.417Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:37:04.417Z]   - No valid next turn added, sending only history.
[2025-05-13T04:37:05.022Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:37:05.024Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:05.024Z] [hIWe-1747111024033 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:37:05.024Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:05.025Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:37:05.151Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:37:05.159Z] [hIWe-1747111024033 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 34
[2025-05-13T04:37:05.160Z] [hIWe-1747111024033 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:37:05.161Z] [hIWe-1747111024033 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:37:05.161Z] --- [hIWe-1747111024033 hIWeR008oHJXZLQOAAAB Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:37:05.161Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T04:37:05.227Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:37:05.227Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:37:05.228Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:37:05.417Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:37:05.418Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111024033][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:37:34.858Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"take place in Vietnam","isStreaming":true,"language":"ja","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:37:34.859Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859] Request received. UserInput: "take place in Vietnam", Streaming: true, Language: ja, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:37:34.859Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:37:34.924Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 2
[2025-05-13T04:37:34.924Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:37:34.924Z] --- [hIWe-1747111054859 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "take place in Vietnam", Lang: ja ---
[2025-05-13T04:37:34.924Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T04:37:34.925Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:34.925Z] --- [hIWe-1747111054859 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:37:34.926Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:34.926Z] [hIWe-1747111054859 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 3
[2025-05-13T04:37:34.926Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:37:34.926Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:37:34.927Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:37:34.927Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:37:34.927Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:37:34.927Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:37:34.927Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:37:34.928Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:37:34.928Z]   - No valid next turn added, sending only history.
[2025-05-13T04:37:35.557Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:37:35.557Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:35.557Z] [hIWe-1747111054859 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:37:35.558Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:37:35.558Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:37:35.736Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:37:35.773Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:37:35.779Z] [hIWe-1747111054859 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 47
[2025-05-13T04:37:35.779Z] [hIWe-1747111054859 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:37:35.779Z] [hIWe-1747111054859 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:37:35.780Z] --- [hIWe-1747111054859 hIWeR008oHJXZLQOAAAB Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:37:35.780Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:37:35.850Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:37:35.850Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:37:35.851Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:37:36.054Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:37:36.055Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111054859][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:38:13.415Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference take place in Vietnam","isStreaming":true,"language":"ja","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:38:13.416Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416] Request received. UserInput: "find conference take place in ...", Streaming: true, Language: ja, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:38:13.416Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:38:13.479Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 4
[2025-05-13T04:38:13.480Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:38:13.480Z] --- [hIWe-1747111093416 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "find conference take place in Vietnam", Lang: ja ---
[2025-05-13T04:38:13.480Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T04:38:13.481Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:38:13.481Z] --- [hIWe-1747111093416 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:38:13.481Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:38:13.482Z] [hIWe-1747111093416 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 5
[2025-05-13T04:38:13.482Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T04:38:13.482Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T04:38:13.483Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:38:13.483Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:38:13.483Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:38:13.483Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:38:13.483Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:38:13.484Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T04:38:13.484Z]   - No valid next turn added, sending only history.
[2025-05-13T04:38:14.150Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:38:14.150Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:38:14.151Z] [hIWe-1747111093416 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:38:14.151Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:38:14.151Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:38:14.301Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:38:14.317Z] [hIWe-1747111093416 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 34
[2025-05-13T04:38:14.317Z] [hIWe-1747111093416 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:38:14.318Z] [hIWe-1747111093416 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:38:14.318Z] --- [hIWe-1747111093416 hIWeR008oHJXZLQOAAAB Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:38:14.318Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T04:38:14.385Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:38:14.385Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:38:14.386Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:38:14.571Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:38:14.572Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111093416][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:39:11.089Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:39:11.090Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Request received.
[2025-05-13T04:39:11.158Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Successfully processed message clearing.
[2025-05-13T04:39:11.159Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Cleared conversation was active. Emitting empty history.
[2025-05-13T04:39:11.159Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822cc708c982ceea00aaba7
[2025-05-13T04:39:11.160Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:39:11.346Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:39:11.347Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822cc708c982ceea00aaba7, Count: 10
[2025-05-13T04:39:17.517Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:39:17.517Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:39:17.518Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:39:17.578Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 0
[2025-05-13T04:39:17.579Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:39:17.579Z] --- [hIWe-1747111157517 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "find conference in Vietnam", Lang: vi ---
[2025-05-13T04:39:17.579Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:39:17.580Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:17.580Z] --- [hIWe-1747111157517 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:39:17.580Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:17.581Z] [hIWe-1747111157517 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 1
[2025-05-13T04:39:17.581Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:39:17.581Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:39:17.581Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:39:17.582Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:39:17.582Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:39:17.582Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:39:17.582Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:39:17.582Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:39:17.582Z]   - No valid next turn added, sending only history.
[2025-05-13T04:39:18.250Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:39:18.251Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:18.251Z] [hIWe-1747111157517 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:39:18.252Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:18.252Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:18.356Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:18.370Z] [hIWe-1747111157517 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 37
[2025-05-13T04:39:18.371Z] [hIWe-1747111157517 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:39:18.372Z] [hIWe-1747111157517 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:39:18.372Z] --- [hIWe-1747111157517 hIWeR008oHJXZLQOAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:39:18.373Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T04:39:18.437Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:39:18.438Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:39:18.439Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:39:18.626Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:39:18.627Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111157517][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:39:22.992Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"any","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:39:22.992Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992] Request received. UserInput: "any", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:39:22.993Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:39:23.053Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 2
[2025-05-13T04:39:23.055Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:39:23.056Z] --- [hIWe-1747111162992 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "any", Lang: vi ---
[2025-05-13T04:39:23.056Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:39:23.057Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:23.057Z] --- [hIWe-1747111162992 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:39:23.057Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:23.058Z] [hIWe-1747111162992 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 3
[2025-05-13T04:39:23.058Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:39:23.058Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:39:23.058Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:39:23.059Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:39:23.059Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:39:23.059Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:39:23.059Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:39:23.059Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:39:23.060Z]   - No valid next turn added, sending only history.
[2025-05-13T04:39:23.680Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:39:23.681Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:23.681Z] [hIWe-1747111162992 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:39:23.681Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:23.682Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:23.777Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:23.846Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:23.848Z] [hIWe-1747111162992 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 113
[2025-05-13T04:39:23.848Z] [hIWe-1747111162992 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:39:23.849Z] [hIWe-1747111162992 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:39:23.849Z] --- [hIWe-1747111162992 hIWeR008oHJXZLQOAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:39:23.850Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:39:23.916Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:39:23.916Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:39:23.916Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:39:24.119Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:39:24.121Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111162992][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:39:33.198Z] [SERVER SOCKET hIWeR008oHJXZLQOAAAB - ON ANY] Event: send_message, Args: [{"userInput":"jusst in Vietnam","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:39:33.198Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198] Request received. UserInput: "jusst in Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:39:33.199Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:39:33.265Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 4
[2025-05-13T04:39:33.265Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:39:33.265Z] --- [hIWe-1747111173198 Socket hIWeR008oHJXZLQOAAAB] Handling STREAMING input: "jusst in Vietnam", Lang: vi ---
[2025-05-13T04:39:33.266Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:39:33.266Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:33.266Z] --- [hIWe-1747111173198 HostAgent Streaming Turn 1 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:39:33.267Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:33.267Z] [hIWe-1747111173198 History T1 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 5
[2025-05-13T04:39:33.267Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T04:39:33.267Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T04:39:33.267Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:39:33.268Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:39:33.268Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:39:33.268Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:39:33.268Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:39:33.268Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T04:39:33.269Z]   - No valid next turn added, sending only history.
[2025-05-13T04:39:35.150Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:39:35.150Z] [hIWe-1747111173198 HostAgent Streaming T1 - hIWeR008oHJXZLQOAAAB] Requests function: routeToAgent
[2025-05-13T04:39:35.151Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:35.151Z] --- [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 Socket hIWeR008oHJXZLQOAAAB] Calling Sub Agent: ConferenceAgent, Task: a5334b0d-7dcb-464a-a9e2-444094d3b440 ---
[2025-05-13T04:39:35.151Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T04:39:35.152Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:39:35.152Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:39:35.152Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:39:35.153Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:39:35.153Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:39:35.154Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:39:35.155Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:39:35.155Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:39:35.155Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:39:35.156Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:39:35.156Z]   - No valid next turn added, sending only history.
[2025-05-13T04:39:36.050Z] Model Finish Reason: STOP
[2025-05-13T04:39:36.050Z] Model requested function call: getConferences
[2025-05-13T04:39:36.051Z] Arguments: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T04:39:36.051Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:39:36.051Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151] ConferenceAgent requests function call: getConferences
[2025-05-13T04:39:36.052Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:39:36.052Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:39:36.052Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:39:36.053Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:39:36.054Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T04:39:36.054Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:39:36.055Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:39:36.056Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:39:36.056Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:39:36.056Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:39:36.057Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:39:36.057Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Việt+Nam&perPage=5&page=1}
[2025-05-13T04:39:36.741Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T04:39:36.741Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T04:39:36.741Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:39:36.742Z] Transforming conference data with Markdown. Search query: country=Việt+Nam&perPage=5&page=1
[2025-05-13T04:39:36.742Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T04:39:36.742Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Việt+Nam&perPage=5&page=1"
[2025-05-13T04:39:36.742Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:39:36.743Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:39:36.743Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:39:36.744Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:39:36.744Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:39:36.744Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:39:36.745Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:39:36.745Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:39:36.745Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:39:36.745Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 hIWeR008oHJXZLQOAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:39:36.746Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:39:36.746Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:39:36.746Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Thought Added - hIWeR008oHJXZLQOAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:39:36.747Z] [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151 SubAgent Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:39:36.747Z] --- [hIWe-1747111173198-Sub-ConferenceAgent-1747111175151] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:39:36.747Z] [hIWe-1747111173198 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:39:36.748Z] --- [hIWe-1747111173198 HostAgent Streaming Turn 2 Start - hIWeR008oHJXZLQOAAAB] ---
[2025-05-13T04:39:36.748Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:36.748Z] [hIWe-1747111173198 History T2 Send - hIWeR008oHJXZLQOAAAB] Host History Size: 7
[2025-05-13T04:39:36.748Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T04:39:36.748Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T04:39:36.749Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:39:36.749Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:39:36.749Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:39:36.750Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:39:36.750Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:39:36.750Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T04:39:36.750Z]   - No valid next turn added, sending only history.
[2025-05-13T04:39:37.340Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:39:37.340Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:37.340Z] [hIWe-1747111173198 Stream Processing - hIWeR008oHJXZLQOAAAB] Starting...
[2025-05-13T04:39:37.341Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:39:37.341Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:37.428Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:39:37.430Z] [hIWe-1747111173198 Stream Processing - hIWeR008oHJXZLQOAAAB] Finished. Length: 57
[2025-05-13T04:39:37.431Z] [hIWe-1747111173198 hIWeR008oHJXZLQOAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:39:37.431Z] [hIWe-1747111173198 Streaming Emit Sent - hIWeR008oHJXZLQOAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:39:37.432Z] --- [hIWe-1747111173198 hIWeR008oHJXZLQOAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:39:37.432Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T04:39:37.504Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:39:37.505Z] [DEBUG] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:39:37.505Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:39:37.698Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:39:37.699Z] [INFO] [coreHandlers][hIWeR008oHJXZLQOAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:hIWe-1747111173198][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:40:43.062Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:40:43.063Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:40:43.441Z] [MainLoader] Starting application loading process...
[2025-05-13T04:40:43.443Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:40:43.444Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:40:44.452Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:40:44.452Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:40:44.452Z] [MainLoader] Database loaded.
[2025-05-13T04:40:44.453Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:40:44.454Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:40:44.459Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:40:44.462Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:40:44.462Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:40:44.463Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:40:44.463Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:40:44.464Z] [MainLoader] Express loaded.
[2025-05-13T04:40:44.465Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:40:44.469Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:40:44.470Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:40:44.470Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:40:44.471Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:40:44.471Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:40:44.508Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:40:44.508Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:40:44.509Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:40:44.549Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:40:44.550Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:40:44.707Z] [socketAuth][F4Yk_US_z9ppG49hAAAB] Authentication attempt. Has token: true
[2025-05-13T04:40:44.712Z] [socketAuth][F4Yk_US_z9ppG49hAAAB] Token signature validated successfully.
[2025-05-13T04:40:44.714Z] [HistoryService] Initialized.
[2025-05-13T04:40:44.715Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB] New connection. Socket ID: F4Yk_US_z9ppG49hAAAB. Initial socket.data.userId: null
[2025-05-13T04:40:44.715Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:40:44.716Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB] Attempting to fetch user info using token...
[2025-05-13T04:40:44.716Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:40:44.717Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:40:45.417Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:40:45.418Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:40:45.418Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:40:45.420Z] [HistoryService] Initialized.
[2025-05-13T04:40:45.420Z] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:40:45.420Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:40:45.420Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:40:45.421Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:40:45.422Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:40:45.423Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:40:45.657Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:40:45.659Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Request received.
[2025-05-13T04:40:45.688Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:40:45.701Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:40:45.703Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:40:45.705Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:40:45.707Z] [SERVER GLOBAL][connection][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:40:46.152Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Successfully processed message clearing.
[2025-05-13T04:40:46.153Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822cc708c982ceea00aaba7
[2025-05-13T04:40:46.153Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:40:46.362Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:40:46.363Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822cc708c982ceea00aaba7, Count: 10
[2025-05-13T04:40:54.461Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:40:54.463Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: N/A
[2025-05-13T04:40:54.463Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Updating socket.data.currentConversationId to match payloadConversationId. Old: N/A
[2025-05-13T04:40:54.463Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:40:54.534Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 0
[2025-05-13T04:40:54.534Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:40:54.536Z] --- [F4Yk-1747111254463 Socket F4Yk_US_z9ppG49hAAAB] Handling STREAMING input: "find conference in Vietnam", Lang: vi ---
[2025-05-13T04:40:54.536Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:40:54.538Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:40:54.538Z] --- [F4Yk-1747111254463 HostAgent Streaming Turn 1 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:40:54.539Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:40:54.539Z] [F4Yk-1747111254463 History T1 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 1
[2025-05-13T04:40:54.540Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:40:54.541Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:40:54.541Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:40:54.541Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:40:54.542Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:40:54.542Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:40:54.543Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:40:54.543Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:40:54.544Z]   - No valid next turn added, sending only history.
[2025-05-13T04:40:55.371Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:40:55.372Z] [F4Yk-1747111254463 HostAgent Streaming T1 - F4Yk_US_z9ppG49hAAAB] Requests function: routeToAgent
[2025-05-13T04:40:55.373Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:40:55.376Z] --- [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 Socket F4Yk_US_z9ppG49hAAAB] Calling Sub Agent: ConferenceAgent, Task: 9ee3beab-625a-4502-b4aa-d18e488c401a ---
[2025-05-13T04:40:55.377Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T04:40:55.377Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:40:55.378Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:40:55.379Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:40:55.379Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:40:55.380Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:40:55.380Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:40:55.380Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:40:55.381Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:40:55.381Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:40:55.381Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:40:55.381Z]   - No valid next turn added, sending only history.
[2025-05-13T04:40:56.227Z] Model Finish Reason: STOP
[2025-05-13T04:40:56.227Z] Model requested function call: getConferences
[2025-05-13T04:40:56.228Z] Arguments: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T04:40:56.228Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:40:56.228Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376] ConferenceAgent requests function call: getConferences
[2025-05-13T04:40:56.229Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:40:56.230Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:40:56.230Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:40:56.230Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:40:56.231Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T04:40:56.232Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:40:56.232Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:40:56.233Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:40:56.233Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:40:56.233Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:40:56.233Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:40:56.234Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Việt+Nam&perPage=5&page=1}
[2025-05-13T04:40:56.911Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T04:40:56.911Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T04:40:56.912Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:40:56.913Z] Transforming conference data with Markdown. Search query: country=Việt+Nam&perPage=5&page=1
[2025-05-13T04:40:56.913Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T04:40:56.914Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Việt+Nam&perPage=5&page=1"
[2025-05-13T04:40:56.914Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:40:56.914Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:40:56.915Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:40:56.915Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:40:56.915Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:40:56.916Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:40:56.916Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:40:56.916Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:40:56.916Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:40:56.917Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 F4Yk_US_z9ppG49hAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:40:56.917Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:40:56.917Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:40:56.918Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:40:56.918Z] [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:40:56.918Z] --- [F4Yk-1747111254463-Sub-ConferenceAgent-1747111255376] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:40:56.919Z] [F4Yk-1747111254463 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:40:56.919Z] --- [F4Yk-1747111254463 HostAgent Streaming Turn 2 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:40:56.919Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:40:56.920Z] [F4Yk-1747111254463 History T2 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 3
[2025-05-13T04:40:56.920Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:40:56.920Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:40:56.920Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:40:56.921Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:40:56.921Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:40:56.922Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:40:56.923Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:40:56.924Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:40:56.926Z]   - No valid next turn added, sending only history.
[2025-05-13T04:40:57.433Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:40:57.434Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:40:57.435Z] [F4Yk-1747111254463 Stream Processing - F4Yk_US_z9ppG49hAAAB] Starting...
[2025-05-13T04:40:57.435Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:40:57.436Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:40:57.594Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:40:57.604Z] [F4Yk-1747111254463 Stream Processing - F4Yk_US_z9ppG49hAAAB] Finished. Length: 58
[2025-05-13T04:40:57.605Z] [F4Yk-1747111254463 F4Yk_US_z9ppG49hAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:40:57.605Z] [F4Yk-1747111254463 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:40:57.606Z] --- [F4Yk-1747111254463 F4Yk_US_z9ppG49hAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:40:57.606Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:40:57.698Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:40:57.699Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:40:57.699Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:40:57.904Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:40:57.905Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111254463][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:41:16.925Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Vietnam","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:41:16.926Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926] Request received. UserInput: "Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:41:16.926Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:41:16.994Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 4
[2025-05-13T04:41:16.994Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:41:16.994Z] --- [F4Yk-1747111276926 Socket F4Yk_US_z9ppG49hAAAB] Handling STREAMING input: "Vietnam", Lang: vi ---
[2025-05-13T04:41:16.994Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:41:16.995Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:16.996Z] --- [F4Yk-1747111276926 HostAgent Streaming Turn 1 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:41:16.996Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:16.996Z] [F4Yk-1747111276926 History T1 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 5
[2025-05-13T04:41:16.997Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T04:41:16.997Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T04:41:16.997Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:41:16.998Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:41:16.998Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:41:16.998Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:41:16.998Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:41:16.998Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T04:41:16.998Z]   - No valid next turn added, sending only history.
[2025-05-13T04:41:17.578Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:41:17.578Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:17.579Z] [F4Yk-1747111276926 Stream Processing - F4Yk_US_z9ppG49hAAAB] Starting...
[2025-05-13T04:41:17.579Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:17.580Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:17.742Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:17.839Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:17.849Z] [F4Yk-1747111276926 Stream Processing - F4Yk_US_z9ppG49hAAAB] Finished. Length: 135
[2025-05-13T04:41:17.849Z] [F4Yk-1747111276926 F4Yk_US_z9ppG49hAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:41:17.850Z] [F4Yk-1747111276926 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:41:17.850Z] --- [F4Yk-1747111276926 F4Yk_US_z9ppG49hAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:41:17.850Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T04:41:17.937Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:41:17.938Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:41:17.938Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:41:18.135Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:41:18.136Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111276926][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:41:30.935Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: send_message, Args: [{"userInput":"country is Vietnam","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:41:30.936Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936] Request received. UserInput: "country is Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:41:30.936Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:41:31.002Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 6
[2025-05-13T04:41:31.002Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:41:31.003Z] --- [F4Yk-1747111290936 Socket F4Yk_US_z9ppG49hAAAB] Handling STREAMING input: "country is Vietnam", Lang: vi ---
[2025-05-13T04:41:31.003Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:41:31.004Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:31.004Z] --- [F4Yk-1747111290936 HostAgent Streaming Turn 1 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:41:31.005Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:31.005Z] [F4Yk-1747111290936 History T1 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 7
[2025-05-13T04:41:31.005Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T04:41:31.007Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T04:41:31.008Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:41:31.009Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:41:31.009Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:41:31.010Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:41:31.011Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:41:31.011Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T04:41:31.012Z]   - No valid next turn added, sending only history.
[2025-05-13T04:41:31.726Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:41:31.727Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:31.727Z] [F4Yk-1747111290936 Stream Processing - F4Yk_US_z9ppG49hAAAB] Starting...
[2025-05-13T04:41:31.727Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:31.728Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:31.814Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:31.866Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:31.874Z] [F4Yk-1747111290936 Stream Processing - F4Yk_US_z9ppG49hAAAB] Finished. Length: 76
[2025-05-13T04:41:31.874Z] [F4Yk-1747111290936 F4Yk_US_z9ppG49hAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:41:31.875Z] [F4Yk-1747111290936 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:41:31.875Z] --- [F4Yk-1747111290936 F4Yk_US_z9ppG49hAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:41:31.876Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T04:41:31.949Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:41:31.949Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:41:31.950Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:41:32.147Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:41:32.148Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111290936][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:41:35.857Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: send_message, Args: [{"userInput":"ok","isStreaming":true,"language":"vi","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:41:35.857Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857] Request received. UserInput: "ok", Streaming: true, Language: vi, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:41:35.858Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:41:35.927Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 8
[2025-05-13T04:41:35.927Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:41:35.928Z] --- [F4Yk-1747111295857 Socket F4Yk_US_z9ppG49hAAAB] Handling STREAMING input: "ok", Lang: vi ---
[2025-05-13T04:41:35.928Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:41:35.929Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:35.929Z] --- [F4Yk-1747111295857 HostAgent Streaming Turn 1 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:41:35.930Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:35.930Z] [F4Yk-1747111295857 History T1 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 9
[2025-05-13T04:41:35.931Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T04:41:35.932Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T04:41:35.932Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:41:35.933Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:41:35.933Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:41:35.933Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:41:35.934Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:41:35.934Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T04:41:35.934Z]   - No valid next turn added, sending only history.
[2025-05-13T04:41:37.577Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:41:37.577Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:37.578Z] [F4Yk-1747111295857 Stream Processing - F4Yk_US_z9ppG49hAAAB] Starting...
[2025-05-13T04:41:37.578Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:41:37.578Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:37.691Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:37.720Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:41:37.725Z] [F4Yk-1747111295857 Stream Processing - F4Yk_US_z9ppG49hAAAB] Finished. Length: 90
[2025-05-13T04:41:37.725Z] [F4Yk-1747111295857 F4Yk_US_z9ppG49hAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:41:37.726Z] [F4Yk-1747111295857 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:41:37.726Z] --- [F4Yk-1747111295857 F4Yk_US_z9ppG49hAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:41:37.726Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T04:41:37.801Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:41:37.802Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:41:37.802Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:41:37.997Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:41:37.999Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111295857][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:42:22.295Z] [SERVER SOCKET F4Yk_US_z9ppG49hAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"en","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:42:22.295Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: en, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:42:22.296Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:42:22.362Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 10
[2025-05-13T04:42:22.363Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:42:22.363Z] --- [F4Yk-1747111342295 Socket F4Yk_US_z9ppG49hAAAB] Handling STREAMING input: "find conference in Vietnam", Lang: en ---
[2025-05-13T04:42:22.363Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T04:42:22.364Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:42:22.364Z] --- [F4Yk-1747111342295 HostAgent Streaming Turn 1 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:42:22.365Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:42:22.365Z] [F4Yk-1747111342295 History T1 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 11
[2025-05-13T04:42:22.365Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T04:42:22.365Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T04:42:22.366Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:42:22.366Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:42:22.366Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:42:22.367Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:42:22.367Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:42:22.367Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T04:42:22.368Z]   - No valid next turn added, sending only history.
[2025-05-13T04:42:23.182Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:42:23.183Z] [F4Yk-1747111342295 HostAgent Streaming T1 - F4Yk_US_z9ppG49hAAAB] Requests function: routeToAgent
[2025-05-13T04:42:23.183Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:42:23.184Z] --- [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 Socket F4Yk_US_z9ppG49hAAAB] Calling Sub Agent: ConferenceAgent, Task: 094d052f-0067-4b95-aec2-7f8ede9c4c0f ---
[2025-05-13T04:42:23.184Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T04:42:23.184Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:42:23.185Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:42:23.185Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:42:23.185Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:42:23.185Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:42:23.185Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:42:23.186Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:42:23.186Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:42:23.186Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:42:23.186Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:42:23.186Z]   - No valid next turn added, sending only history.
[2025-05-13T04:42:24.037Z] Model Finish Reason: STOP
[2025-05-13T04:42:24.037Z] Model requested function call: getConferences
[2025-05-13T04:42:24.037Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:42:24.038Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:42:24.038Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184] ConferenceAgent requests function call: getConferences
[2025-05-13T04:42:24.038Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:42:24.039Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:42:24.039Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:42:24.039Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:42:24.040Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:42:24.040Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:42:24.040Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:42:24.041Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:42:24.041Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:42:24.042Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:42:24.042Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:42:24.042Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T04:42:24.757Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T04:42:24.757Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T04:42:24.758Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:42:24.758Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T04:42:24.767Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T04:42:24.767Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T04:42:24.767Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:42:24.768Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:42:24.768Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:42:24.769Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:42:24.769Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:42:24.769Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:42:24.770Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:42:24.770Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:42:24.771Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:42:24.771Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 F4Yk_US_z9ppG49hAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:42:24.771Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:42:24.771Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:42:24.772Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Thought Added - F4Yk_US_z9ppG49hAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:42:24.772Z] [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184 SubAgent Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:42:24.773Z] --- [F4Yk-1747111342295-Sub-ConferenceAgent-1747111343184] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:42:24.773Z] [F4Yk-1747111342295 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:42:24.773Z] --- [F4Yk-1747111342295 HostAgent Streaming Turn 2 Start - F4Yk_US_z9ppG49hAAAB] ---
[2025-05-13T04:42:24.773Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:42:24.774Z] [F4Yk-1747111342295 History T2 Send - F4Yk_US_z9ppG49hAAAB] Host History Size: 13
[2025-05-13T04:42:24.774Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T04:42:24.775Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T04:42:24.775Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:42:24.776Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:42:24.776Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:42:24.777Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:42:24.780Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:42:24.780Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T04:42:24.781Z]   - No valid next turn added, sending only history.
[2025-05-13T04:42:25.404Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:42:25.404Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:42:25.405Z] [F4Yk-1747111342295 Stream Processing - F4Yk_US_z9ppG49hAAAB] Starting...
[2025-05-13T04:42:25.405Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:42:25.405Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:25.525Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:25.619Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:25.764Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:25.918Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:26.147Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:26.337Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:26.596Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:26.854Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:27.006Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:42:27.011Z] [F4Yk-1747111342295 Stream Processing - F4Yk_US_z9ppG49hAAAB] Finished. Length: 951
[2025-05-13T04:42:27.012Z] [F4Yk-1747111342295 F4Yk_US_z9ppG49hAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:42:27.013Z] [F4Yk-1747111342295 Streaming Emit Sent - F4Yk_US_z9ppG49hAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:42:27.014Z] --- [F4Yk-1747111342295 F4Yk_US_z9ppG49hAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:42:27.014Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T04:42:27.091Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:42:27.092Z] [DEBUG] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:42:27.092Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:42:27.349Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:42:27.350Z] [INFO] [coreHandlers][F4Yk_US_z9ppG49hAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:F4Yk-1747111342295][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:46:01.007Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:46:01.015Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:46:01.485Z] [MainLoader] Starting application loading process...
[2025-05-13T04:46:01.486Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:46:01.487Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:46:04.414Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:46:04.415Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:46:04.415Z] [MainLoader] Database loaded.
[2025-05-13T04:46:04.415Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:46:04.416Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:46:04.421Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:46:04.424Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:46:04.424Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:46:04.424Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:46:04.424Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:46:04.426Z] [MainLoader] Express loaded.
[2025-05-13T04:46:04.426Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:46:04.431Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:46:04.431Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:46:04.431Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:46:04.432Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:46:04.432Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:46:04.468Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:46:04.469Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:46:04.469Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:46:04.511Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:46:04.511Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:46:05.546Z] [socketAuth][q1x6ft3MUbW5-9bWAAAB] Authentication attempt. Has token: true
[2025-05-13T04:46:05.552Z] [socketAuth][q1x6ft3MUbW5-9bWAAAB] Token signature validated successfully.
[2025-05-13T04:46:05.555Z] [HistoryService] Initialized.
[2025-05-13T04:46:05.555Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB] New connection. Socket ID: q1x6ft3MUbW5-9bWAAAB. Initial socket.data.userId: null
[2025-05-13T04:46:05.556Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:46:05.556Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB] Attempting to fetch user info using token...
[2025-05-13T04:46:05.557Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:46:05.557Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:46:06.263Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:46:06.263Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:46:06.264Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:46:06.265Z] [HistoryService] Initialized.
[2025-05-13T04:46:06.266Z] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:46:06.266Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:46:06.266Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:46:06.266Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:46:06.268Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:46:06.268Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:46:06.317Z] [SERVER SOCKET q1x6ft3MUbW5-9bWAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:46:06.580Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:46:06.581Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:46:06.581Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:46:06.582Z] [SERVER GLOBAL][connection][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:46:47.248Z] [SERVER SOCKET q1x6ft3MUbW5-9bWAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:46:47.260Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822cc708c982ceea00aaba7"}
[2025-05-13T04:46:47.260Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Request received.
[2025-05-13T04:46:47.381Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Sent history. Set as active conversation. Message Count: 10
[2025-05-13T04:47:03.506Z] [SERVER SOCKET q1x6ft3MUbW5-9bWAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in USA","isStreaming":true,"language":"ko","conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:47:03.507Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507] Request received. UserInput: "find conference in USA", Streaming: true, Language: ko, PayloadConvId: 6822cc708c982ceea00aaba7, SocketDataConvId: 6822cc708c982ceea00aaba7
[2025-05-13T04:47:03.508Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Using conversationId from payload.
[2025-05-13T04:47:03.579Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Fetched current history. Count: 14
[2025-05-13T04:47:03.579Z] [DEBUG] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Calling streaming intent handler.
[2025-05-13T04:47:03.581Z] --- [q1x6-1747111623507 Socket q1x6ft3MUbW5-9bWAAAB] Handling STREAMING input: "find conference in USA", Lang: ko ---
[2025-05-13T04:47:03.582Z] [Language Config] Using configuration for Agent: HostAgent, Language: ko
[2025-05-13T04:47:03.584Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:47:03.584Z] --- [q1x6-1747111623507 HostAgent Streaming Turn 1 Start - q1x6ft3MUbW5-9bWAAAB] ---
[2025-05-13T04:47:03.584Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:47:03.585Z] [q1x6-1747111623507 History T1 Send - q1x6ft3MUbW5-9bWAAAB] Host History Size: 15
[2025-05-13T04:47:03.586Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T04:47:03.587Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T04:47:03.587Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:47:03.587Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:47:03.587Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:47:03.588Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:47:03.588Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:47:03.589Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T04:47:03.589Z]   - No valid next turn added, sending only history.
[2025-05-13T04:47:04.519Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:47:04.519Z] [q1x6-1747111623507 HostAgent Streaming T1 - q1x6ft3MUbW5-9bWAAAB] Requests function: routeToAgent
[2025-05-13T04:47:04.520Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:47:04.522Z] --- [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 Socket q1x6ft3MUbW5-9bWAAAB] Calling Sub Agent: ConferenceAgent, Task: a4119325-2e26-445b-a80a-4f7d540a87d5 ---
[2025-05-13T04:47:04.522Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: ko
[2025-05-13T04:47:04.523Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:47:04.524Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:47:04.526Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:47:04.527Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:47:04.527Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:47:04.527Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:47:04.527Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:47:04.527Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:47:04.528Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:47:04.528Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:47:04.528Z]   - No valid next turn added, sending only history.
[2025-05-13T04:47:05.457Z] Model Finish Reason: STOP
[2025-05-13T04:47:05.458Z] Model requested function call: getConferences
[2025-05-13T04:47:05.459Z] Arguments: {"searchQuery":"country=USA&perPage=5&page=1"}
[2025-05-13T04:47:05.459Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:47:05.459Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522] ConferenceAgent requests function call: getConferences
[2025-05-13T04:47:05.460Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:47:05.461Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:47:05.462Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:47:05.462Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:47:05.463Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=USA&perPage=5&page=1"}
[2025-05-13T04:47:05.464Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:47:05.464Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:47:05.464Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:47:05.464Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:47:05.465Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:47:05.465Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:47:05.466Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=USA&perPage=5&page=1}
[2025-05-13T04:47:06.797Z] [BackendService] [conference] API Success (200). Data length: 5077. Attempting parsing...
[2025-05-13T04:47:06.798Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"360872d3-ce97-4a09-88d5-e7e16080a77d","title":"IEEE International Symposium on Information Theory","acronym":"ISIT","location":{"cityStateProvince":"Ann Arbor, Michigan","country":"USA","address":"Ann Arbor (Michigan), USA","contin...
[2025-05-13T04:47:06.798Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:47:06.799Z] Transforming conference data with Markdown. Search query: country=USA&perPage=5&page=1
[2025-05-13T04:47:06.805Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 3
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** IEEE International Symposium on Information Theory
  - **Acro...
[2025-05-13T04:47:06.805Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=USA&perPage=5&page=1"
[2025-05-13T04:47:06.806Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:47:06.806Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:47:06.807Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:47:06.807Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:47:06.807Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:47:06.808Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:47:06.809Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:47:06.809Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:47:06.810Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:47:06.810Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 q1x6ft3MUbW5-9bWAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:47:06.811Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:47:06.811Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:47:06.812Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:47:06.812Z] [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:47:06.812Z] --- [q1x6-1747111623507-Sub-ConferenceAgent-1747111624522] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:47:06.813Z] [q1x6-1747111623507 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:47:06.813Z] --- [q1x6-1747111623507 HostAgent Streaming Turn 2 Start - q1x6ft3MUbW5-9bWAAAB] ---
[2025-05-13T04:47:06.813Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:47:06.814Z] [q1x6-1747111623507 History T2 Send - q1x6ft3MUbW5-9bWAAAB] Host History Size: 17
[2025-05-13T04:47:06.814Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T04:47:06.814Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T04:47:06.814Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:47:06.815Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:47:06.815Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:47:06.815Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:47:06.815Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:47:06.815Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T04:47:06.816Z]   - No valid next turn added, sending only history.
[2025-05-13T04:47:07.416Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:47:07.417Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:47:07.418Z] [q1x6-1747111623507 Stream Processing - q1x6ft3MUbW5-9bWAAAB] Starting...
[2025-05-13T04:47:07.418Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:47:07.419Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:07.534Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:07.590Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:07.715Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:07.860Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:08.075Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:08.335Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:08.526Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:47:08.537Z] [q1x6-1747111623507 Stream Processing - q1x6ft3MUbW5-9bWAAAB] Finished. Length: 637
[2025-05-13T04:47:08.538Z] [q1x6-1747111623507 q1x6ft3MUbW5-9bWAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:47:08.538Z] [q1x6-1747111623507 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:47:08.539Z] --- [q1x6-1747111623507 q1x6ft3MUbW5-9bWAAAB Lang: ko] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:47:08.539Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Intent handler returned updated history. Attempting save. New size: 18
[2025-05-13T04:47:08.660Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Successfully updated history in DB.
[2025-05-13T04:47:08.661Z] [DEBUG] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:47:08.661Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:47:08.922Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:47:08.922Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111623507][Conv:6822cc708c982ceea00aaba7] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:47:50.525Z] [SERVER SOCKET q1x6ft3MUbW5-9bWAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822cc708c982ceea00aaba7"}]
[2025-05-13T04:47:50.526Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Request received.
[2025-05-13T04:47:50.597Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Successfully processed deletion.
[2025-05-13T04:47:50.598Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cc708c982ceea00aaba7] Deleted conversation was active. Clearing active ID.
[2025-05-13T04:47:50.598Z] [DEBUG] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822cc708c982ceea00aaba7
[2025-05-13T04:47:50.598Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:47:50.848Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T04:47:50.849Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822cc708c982ceea00aaba7, Count: 9
[2025-05-13T04:48:00.815Z] [SERVER SOCKET q1x6ft3MUbW5-9bWAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"es","conversationId":null}]
[2025-05-13T04:48:00.815Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: es, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T04:48:00.815Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T04:48:00.969Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T04:48:00.970Z] [DEBUG] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T04:48:00.970Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:48:01.175Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:48:01.176Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Emitted updated conversation list. Reason: new conversation from send_message, Count: 10
[2025-05-13T04:48:01.243Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Fetched current history. Count: 0
[2025-05-13T04:48:01.243Z] [DEBUG] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Calling streaming intent handler.
[2025-05-13T04:48:01.243Z] --- [q1x6-1747111680815 Socket q1x6ft3MUbW5-9bWAAAB] Handling STREAMING input: "find conference in Vietnam", Lang: es ---
[2025-05-13T04:48:01.244Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T04:48:01.244Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:48:01.245Z] --- [q1x6-1747111680815 HostAgent Streaming Turn 1 Start - q1x6ft3MUbW5-9bWAAAB] ---
[2025-05-13T04:48:01.245Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:48:01.245Z] [q1x6-1747111680815 History T1 Send - q1x6ft3MUbW5-9bWAAAB] Host History Size: 1
[2025-05-13T04:48:01.246Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:48:01.246Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:48:01.246Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:48:01.246Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:48:01.247Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:48:01.247Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:48:01.247Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:48:01.247Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:48:01.247Z]   - No valid next turn added, sending only history.
[2025-05-13T04:48:03.268Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:48:03.268Z] [q1x6-1747111680815 HostAgent Streaming T1 - q1x6ft3MUbW5-9bWAAAB] Requests function: routeToAgent
[2025-05-13T04:48:03.269Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:48:03.269Z] --- [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 Socket q1x6ft3MUbW5-9bWAAAB] Calling Sub Agent: ConferenceAgent, Task: 6293a34a-f451-42d1-ac9d-040739e48180 ---
[2025-05-13T04:48:03.270Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T04:48:03.270Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:48:03.270Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:48:03.270Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:48:03.271Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:48:03.271Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:48:03.271Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:48:03.272Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:48:03.272Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:48:03.273Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:48:03.273Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:48:03.274Z]   - No valid next turn added, sending only history.
[2025-05-13T04:48:04.345Z] Model Finish Reason: STOP
[2025-05-13T04:48:04.345Z] Model requested function call: getConferences
[2025-05-13T04:48:04.345Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:48:04.346Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:48:04.346Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269] ConferenceAgent requests function call: getConferences
[2025-05-13T04:48:04.346Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:48:04.346Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:48:04.347Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:48:04.347Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:48:04.348Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:48:04.348Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:48:04.348Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:48:04.349Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:48:04.349Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:48:04.350Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:48:04.350Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:48:04.351Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T04:48:09.434Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T04:48:09.434Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T04:48:09.434Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:48:09.435Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T04:48:09.443Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T04:48:09.443Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T04:48:09.444Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:48:09.444Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:48:09.445Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:48:09.445Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:48:09.445Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:48:09.446Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:48:09.446Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:48:09.446Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:48:09.447Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:48:09.447Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 q1x6ft3MUbW5-9bWAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:48:09.447Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:48:09.448Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:48:09.448Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Thought Added - q1x6ft3MUbW5-9bWAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:48:09.448Z] [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269 SubAgent Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:48:09.449Z] --- [q1x6-1747111680815-Sub-ConferenceAgent-1747111683269] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:48:09.449Z] [q1x6-1747111680815 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:48:09.449Z] --- [q1x6-1747111680815 HostAgent Streaming Turn 2 Start - q1x6ft3MUbW5-9bWAAAB] ---
[2025-05-13T04:48:09.449Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:48:09.450Z] [q1x6-1747111680815 History T2 Send - q1x6ft3MUbW5-9bWAAAB] Host History Size: 3
[2025-05-13T04:48:09.450Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:48:09.450Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:48:09.450Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:48:09.451Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:48:09.451Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:48:09.451Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:48:09.451Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:48:09.452Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:48:09.452Z]   - No valid next turn added, sending only history.
[2025-05-13T04:48:10.098Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:48:10.099Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:48:10.099Z] [q1x6-1747111680815 Stream Processing - q1x6ft3MUbW5-9bWAAAB] Starting...
[2025-05-13T04:48:10.100Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:48:10.100Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:10.176Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:10.259Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:10.445Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:10.575Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:10.788Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:11.024Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:11.103Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:48:11.106Z] [q1x6-1747111680815 Stream Processing - q1x6ft3MUbW5-9bWAAAB] Finished. Length: 703
[2025-05-13T04:48:11.107Z] [q1x6-1747111680815 q1x6ft3MUbW5-9bWAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:48:11.108Z] [q1x6-1747111680815 Streaming Emit Sent - q1x6ft3MUbW5-9bWAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:48:11.108Z] --- [q1x6-1747111680815 q1x6ft3MUbW5-9bWAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:48:11.108Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:48:11.185Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Successfully updated history in DB.
[2025-05-13T04:48:11.185Z] [DEBUG] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:48:11.186Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:48:11.442Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:48:11.442Z] [INFO] [coreHandlers][q1x6ft3MUbW5-9bWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:q1x6-1747111680815][Conv:6822cf00fad6c57f84d7973f] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T04:51:20.740Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:51:20.741Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:51:21.180Z] [MainLoader] Starting application loading process...
[2025-05-13T04:51:21.182Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:51:21.183Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:51:22.043Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:51:22.043Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:51:22.044Z] [MainLoader] Database loaded.
[2025-05-13T04:51:22.044Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:51:22.046Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:51:22.057Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:51:22.060Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:51:22.060Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:51:22.061Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:51:22.061Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:51:22.063Z] [MainLoader] Express loaded.
[2025-05-13T04:51:22.064Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:51:22.070Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:51:22.071Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:51:22.071Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:51:22.071Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:51:22.072Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:51:22.176Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:51:22.178Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:51:22.180Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:51:22.422Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:51:22.423Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:51:22.864Z] [socketAuth][Ephy9tmB1yjDiVoDAAAB] Authentication attempt. Has token: true
[2025-05-13T04:51:22.871Z] [socketAuth][Ephy9tmB1yjDiVoDAAAB] Token signature validated successfully.
[2025-05-13T04:51:22.874Z] [HistoryService] Initialized.
[2025-05-13T04:51:22.874Z] [SERVER GLOBAL][connection][Ephy9tmB1yjDiVoDAAAB] New connection. Socket ID: Ephy9tmB1yjDiVoDAAAB. Initial socket.data.userId: null
[2025-05-13T04:51:22.875Z] [SERVER GLOBAL][connection][Ephy9tmB1yjDiVoDAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:51:22.875Z] [SERVER GLOBAL][connection][Ephy9tmB1yjDiVoDAAAB] Attempting to fetch user info using token...
[2025-05-13T04:51:22.876Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:51:22.876Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:51:28.070Z] [API Client] Network or timeout error fetching from https://confhub.westus3.cloudapp.azure.com/api/v1/user/me: timeout of 5000ms exceeded
[2025-05-13T04:51:28.071Z] [SERVER GLOBAL][connection][Ephy9tmB1yjDiVoDAAAB] WARNING: Failed to fetch user info from API /me. Disconnecting.
[2025-05-13T04:52:43.585Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:52:43.587Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:52:44.251Z] [MainLoader] Starting application loading process...
[2025-05-13T04:52:44.252Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:52:44.254Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:52:47.236Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:52:47.237Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:52:47.237Z] [MainLoader] Database loaded.
[2025-05-13T04:52:47.237Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:52:47.238Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:52:47.245Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:52:47.248Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:52:47.249Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:52:47.249Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:52:47.249Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:52:47.251Z] [MainLoader] Express loaded.
[2025-05-13T04:52:47.251Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:52:47.256Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:52:47.257Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:52:47.257Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:52:47.258Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:52:47.259Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:52:47.305Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:52:47.305Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:52:47.306Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:52:47.372Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:52:47.373Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:55:10.228Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:55:10.229Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:55:10.594Z] [MainLoader] Starting application loading process...
[2025-05-13T04:55:10.595Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:55:10.596Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:55:11.418Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:55:11.418Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:55:11.419Z] [MainLoader] Database loaded.
[2025-05-13T04:55:11.419Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:55:11.420Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:55:11.425Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:55:11.428Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:55:11.429Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:55:11.429Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:55:11.429Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:55:11.431Z] [MainLoader] Express loaded.
[2025-05-13T04:55:11.431Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:55:11.436Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:55:11.437Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:55:11.437Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:55:11.437Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:55:11.438Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:55:11.483Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:55:11.483Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:55:11.484Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:55:11.529Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:55:11.529Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:56:45.362Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T04:56:45.363Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:56:45.712Z] [MainLoader] Starting application loading process...
[2025-05-13T04:56:45.714Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T04:56:45.715Z] [Database] Attempting MongoDB connection...
[2025-05-13T04:56:46.562Z] [Database] MongoDB Connected Successfully.
[2025-05-13T04:56:46.562Z] [DatabaseLoader] Database connection successful.
[2025-05-13T04:56:46.563Z] [MainLoader] Database loaded.
[2025-05-13T04:56:46.563Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T04:56:46.564Z] [ExpressLoader] Configuring Express app...
[2025-05-13T04:56:46.570Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T04:56:46.573Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T04:56:46.574Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T04:56:46.574Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T04:56:46.574Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T04:56:46.575Z] [MainLoader] Express loaded.
[2025-05-13T04:56:46.576Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T04:56:46.581Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T04:56:46.582Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T04:56:46.582Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T04:56:46.583Z] [MainLoader] Socket.IO loaded.
[2025-05-13T04:56:46.583Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T04:56:46.622Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T04:56:46.622Z] [MainLoader] Jobs scheduled.
[2025-05-13T04:56:46.622Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T04:56:46.666Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T04:56:46.666Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T04:56:57.773Z] [socketAuth][mNGM6WMdAfGYtS1FAAAB] Authentication attempt. Has token: true
[2025-05-13T04:56:57.780Z] [socketAuth][mNGM6WMdAfGYtS1FAAAB] Token signature validated successfully.
[2025-05-13T04:56:57.783Z] [HistoryService] Initialized.
[2025-05-13T04:56:57.784Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB] New connection. Socket ID: mNGM6WMdAfGYtS1FAAAB. Initial socket.data.userId: null
[2025-05-13T04:56:57.784Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T04:56:57.785Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB] Attempting to fetch user info using token...
[2025-05-13T04:56:57.785Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:56:57.786Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:56:58.559Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:56:58.560Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:56:58.560Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:56:58.562Z] [HistoryService] Initialized.
[2025-05-13T04:56:58.562Z] [coreHandlers][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:56:58.563Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:56:58.563Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:56:58.563Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:56:58.565Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:56:58.566Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:56:58.626Z] [SERVER SOCKET mNGM6WMdAfGYtS1FAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:56:58.859Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:56:58.861Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:56:58.862Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:56:58.862Z] [SERVER GLOBAL][connection][mNGM6WMdAfGYtS1FAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:57:09.870Z] [SERVER GLOBAL][disconnect][mNGM6WMdAfGYtS1FAAAB] Client disconnected. Reason: client namespace disconnect, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T04:57:17.865Z] [socketAuth][eqi5qKAxYh1Fyj1UAAAD] Authentication attempt. Has token: true
[2025-05-13T04:57:17.868Z] [socketAuth][eqi5qKAxYh1Fyj1UAAAD] Token signature validated successfully.
[2025-05-13T04:57:17.869Z] [HistoryService] Initialized.
[2025-05-13T04:57:17.869Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD] New connection. Socket ID: eqi5qKAxYh1Fyj1UAAAD. Initial socket.data.userId: null
[2025-05-13T04:57:17.869Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD] Client connected, processing authentication. Has token: true
[2025-05-13T04:57:17.870Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD] Attempting to fetch user info using token...
[2025-05-13T04:57:17.870Z] [API Client] Attempting to fetch user info.
[2025-05-13T04:57:17.870Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T04:57:18.587Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T04:57:18.587Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T04:57:18.588Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T04:57:18.588Z] [HistoryService] Initialized.
[2025-05-13T04:57:18.588Z] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T04:57:18.588Z] [INFO] Core event handlers successfully registered.
[2025-05-13T04:57:18.588Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:57:18.589Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T04:57:18.589Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T04:57:18.590Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:57:18.652Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T04:57:18.934Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T04:57:18.936Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T04:57:18.936Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T04:57:18.937Z] [SERVER GLOBAL][connection][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T04:57:49.543Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Who developed this website?","isStreaming":true,"language":"es","conversationId":null}]
[2025-05-13T04:57:49.545Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545] Request received. UserInput: "Who developed this website?", Streaming: true, Language: es, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T04:57:49.546Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T04:57:49.717Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T04:57:49.719Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T04:57:49.719Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:57:49.939Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T04:57:49.940Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Emitted updated conversation list. Reason: new conversation from send_message, Count: 11
[2025-05-13T04:57:50.000Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Fetched current history. Count: 0
[2025-05-13T04:57:50.001Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Calling streaming intent handler.
[2025-05-13T04:57:50.002Z] --- [eqi5-1747112269545 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "Who developed this website?", Lang: es ---
[2025-05-13T04:57:50.003Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T04:57:50.004Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:57:50.004Z] --- [eqi5-1747112269545 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T04:57:50.005Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:57:50.005Z] [eqi5-1747112269545 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 1
[2025-05-13T04:57:50.007Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T04:57:50.007Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T04:57:50.007Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:57:50.008Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:57:50.008Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:57:50.008Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:57:50.008Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:57:50.009Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T04:57:50.009Z]   - No valid next turn added, sending only history.
[2025-05-13T04:57:50.993Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:57:50.994Z] [eqi5-1747112269545 HostAgent Streaming T1 - eqi5qKAxYh1Fyj1UAAAD] Requests function: routeToAgent
[2025-05-13T04:57:50.995Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:57:50.998Z] --- [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 Socket eqi5qKAxYh1Fyj1UAAAD] Calling Sub Agent: WebsiteInfoAgent, Task: 31ae7994-74b2-4632-a4f9-b8ae6087da2c ---
[2025-05-13T04:57:50.998Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: es
[2025-05-13T04:57:50.999Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T04:57:50.999Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T04:57:51.000Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:57:51.001Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:57:51.001Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:57:51.001Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:57:51.001Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:57:51.002Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T04:57:51.002Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:57:51.002Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:57:51.002Z]   - No valid next turn added, sending only history.
[2025-05-13T04:57:51.834Z] Model Finish Reason: STOP
[2025-05-13T04:57:51.834Z] Model requested function call: getWebsiteInfo
[2025-05-13T04:57:51.835Z] Arguments: {}
[2025-05-13T04:57:51.835Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T04:57:51.835Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T04:57:51.836Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 eqi5qKAxYh1Fyj1UAAAD Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T04:57:51.836Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T04:57:51.837Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T04:57:51.837Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 eqi5qKAxYh1Fyj1UAAAD Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T04:57:51.838Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 eqi5qKAxYh1Fyj1UAAAD] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T04:57:51.839Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T04:57:51.839Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T04:57:51.839Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T04:57:51.840Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T04:57:51.840Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T04:57:51.841Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 eqi5qKAxYh1Fyj1UAAAD] API result: Success=true
[2025-05-13T04:57:51.841Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T04:57:51.841Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T04:57:51.841Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 eqi5qKAxYh1Fyj1UAAAD Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T04:57:51.842Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T04:57:51.842Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T04:57:51.842Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T04:57:51.843Z] [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T04:57:51.843Z] --- [eqi5-1747112269545-Sub-WebsiteInfoAgent-1747112270998] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T04:57:51.845Z] [eqi5-1747112269545 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T04:57:51.846Z] --- [eqi5-1747112269545 HostAgent Streaming Turn 2 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T04:57:51.846Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:57:51.846Z] [eqi5-1747112269545 History T2 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 3
[2025-05-13T04:57:51.847Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T04:57:51.847Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T04:57:51.847Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:57:51.847Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:57:51.848Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:57:51.848Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:57:51.848Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:57:51.848Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T04:57:51.848Z]   - No valid next turn added, sending only history.
[2025-05-13T04:57:52.530Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:57:52.531Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:57:52.532Z] [eqi5-1747112269545 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T04:57:52.532Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:57:52.533Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:57:52.634Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:57:52.716Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:57:52.752Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:57:52.762Z] [eqi5-1747112269545 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 193
[2025-05-13T04:57:52.763Z] [eqi5-1747112269545 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T04:57:52.764Z] [eqi5-1747112269545 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:57:52.764Z] --- [eqi5-1747112269545 eqi5qKAxYh1Fyj1UAAAD Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:57:52.764Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T04:57:52.847Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Successfully updated history in DB.
[2025-05-13T04:57:52.847Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:57:52.848Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:57:53.080Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T04:57:53.081Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112269545][Conv:6822d14dbeeb825070c07bff] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T04:59:08.409Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"tìm hội nghị tại Vietnam","isStreaming":true,"language":"es","conversationId":"6822d14dbeeb825070c07bff"}]
[2025-05-13T04:59:08.409Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409] Request received. UserInput: "tìm hội nghị tại Vietnam", Streaming: true, Language: es, PayloadConvId: 6822d14dbeeb825070c07bff, SocketDataConvId: 6822d14dbeeb825070c07bff
[2025-05-13T04:59:08.410Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Using conversationId from payload.
[2025-05-13T04:59:08.522Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Fetched current history. Count: 4
[2025-05-13T04:59:08.522Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Calling streaming intent handler.
[2025-05-13T04:59:08.522Z] --- [eqi5-1747112348409 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "tìm hội nghị tại Vietnam", Lang: es ---
[2025-05-13T04:59:08.523Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T04:59:08.523Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:08.524Z] --- [eqi5-1747112348409 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T04:59:08.525Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:08.525Z] [eqi5-1747112348409 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 5
[2025-05-13T04:59:08.526Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T04:59:08.526Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T04:59:08.527Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:59:08.527Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:59:08.527Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:59:08.527Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:59:08.528Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:59:08.528Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T04:59:08.528Z]   - No valid next turn added, sending only history.
[2025-05-13T04:59:09.366Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:59:09.367Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:09.367Z] [eqi5-1747112348409 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T04:59:09.368Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:09.368Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:09.487Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:09.491Z] [eqi5-1747112348409 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 79
[2025-05-13T04:59:09.491Z] [eqi5-1747112348409 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:59:09.492Z] [eqi5-1747112348409 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:59:09.493Z] --- [eqi5-1747112348409 eqi5qKAxYh1Fyj1UAAAD Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:59:09.493Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T04:59:09.602Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Successfully updated history in DB.
[2025-05-13T04:59:09.602Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:59:09.602Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:59:09.830Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T04:59:09.832Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112348409][Conv:6822d14dbeeb825070c07bff] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T04:59:21.946Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"đúng","isStreaming":true,"language":"es","conversationId":"6822d14dbeeb825070c07bff"}]
[2025-05-13T04:59:21.947Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947] Request received. UserInput: "đúng", Streaming: true, Language: es, PayloadConvId: 6822d14dbeeb825070c07bff, SocketDataConvId: 6822d14dbeeb825070c07bff
[2025-05-13T04:59:21.947Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Using conversationId from payload.
[2025-05-13T04:59:22.060Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Fetched current history. Count: 6
[2025-05-13T04:59:22.061Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Calling streaming intent handler.
[2025-05-13T04:59:22.061Z] --- [eqi5-1747112361947 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "đúng", Lang: es ---
[2025-05-13T04:59:22.061Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T04:59:22.062Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:22.062Z] --- [eqi5-1747112361947 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T04:59:22.062Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:22.063Z] [eqi5-1747112361947 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 7
[2025-05-13T04:59:22.063Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T04:59:22.063Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T04:59:22.063Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:59:22.063Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:59:22.064Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:59:22.064Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:59:22.064Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:59:22.064Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T04:59:22.065Z]   - No valid next turn added, sending only history.
[2025-05-13T04:59:22.956Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T04:59:22.956Z] [eqi5-1747112361947 HostAgent Streaming T1 - eqi5qKAxYh1Fyj1UAAAD] Requests function: routeToAgent
[2025-05-13T04:59:22.958Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:22.959Z] --- [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 Socket eqi5qKAxYh1Fyj1UAAAD] Calling Sub Agent: ConferenceAgent, Task: f400d102-222c-42b8-8082-46b96a1657bc ---
[2025-05-13T04:59:22.959Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T04:59:22.960Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T04:59:22.960Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T04:59:22.960Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T04:59:22.960Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T04:59:22.961Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:59:22.961Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:59:22.961Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:59:22.961Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T04:59:22.962Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:59:22.962Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T04:59:22.962Z]   - No valid next turn added, sending only history.
[2025-05-13T04:59:23.828Z] Model Finish Reason: STOP
[2025-05-13T04:59:23.828Z] Model requested function call: getConferences
[2025-05-13T04:59:23.828Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:59:23.829Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T04:59:23.829Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959] ConferenceAgent requests function call: getConferences
[2025-05-13T04:59:23.829Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T04:59:23.830Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T04:59:23.830Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T04:59:23.830Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T04:59:23.831Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T04:59:23.832Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:59:23.832Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T04:59:23.832Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T04:59:23.833Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:59:23.833Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T04:59:23.833Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T04:59:23.834Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T04:59:24.543Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T04:59:24.543Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T04:59:24.544Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T04:59:24.545Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T04:59:24.552Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T04:59:24.552Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T04:59:24.553Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:59:24.553Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T04:59:24.553Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T04:59:24.554Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:59:24.554Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T04:59:24.554Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T04:59:24.555Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:59:24.555Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T04:59:24.555Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T04:59:24.556Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T04:59:24.556Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T04:59:24.557Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T04:59:24.559Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T04:59:24.559Z] [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T04:59:24.559Z] --- [eqi5-1747112361947-Sub-ConferenceAgent-1747112362959] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T04:59:24.560Z] [eqi5-1747112361947 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T04:59:24.560Z] --- [eqi5-1747112361947 HostAgent Streaming Turn 2 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T04:59:24.560Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:24.561Z] [eqi5-1747112361947 History T2 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 9
[2025-05-13T04:59:24.561Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T04:59:24.561Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T04:59:24.562Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T04:59:24.562Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:59:24.562Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:59:24.562Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:59:24.562Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:59:24.563Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T04:59:24.563Z]   - No valid next turn added, sending only history.
[2025-05-13T04:59:25.194Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:59:25.194Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:25.195Z] [eqi5-1747112361947 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T04:59:25.195Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:25.195Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:25.309Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:25.426Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:25.566Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:25.718Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:25.911Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:26.123Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:26.226Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:26.230Z] [eqi5-1747112361947 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 763
[2025-05-13T04:59:26.230Z] [eqi5-1747112361947 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T04:59:26.231Z] [eqi5-1747112361947 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:59:26.231Z] --- [eqi5-1747112361947 eqi5qKAxYh1Fyj1UAAAD Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:59:26.231Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T04:59:26.311Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Successfully updated history in DB.
[2025-05-13T04:59:26.312Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:59:26.312Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:59:26.549Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T04:59:26.550Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112361947][Conv:6822d14dbeeb825070c07bff] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T04:59:49.639Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Who are you ?","isStreaming":true,"language":"vi","conversationId":"6822d14dbeeb825070c07bff"}]
[2025-05-13T04:59:49.639Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639] Request received. UserInput: "Who are you ?", Streaming: true, Language: vi, PayloadConvId: 6822d14dbeeb825070c07bff, SocketDataConvId: 6822d14dbeeb825070c07bff
[2025-05-13T04:59:49.640Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Using conversationId from payload.
[2025-05-13T04:59:49.752Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Fetched current history. Count: 10
[2025-05-13T04:59:49.753Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Calling streaming intent handler.
[2025-05-13T04:59:49.753Z] --- [eqi5-1747112389639 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "Who are you ?", Lang: vi ---
[2025-05-13T04:59:49.753Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T04:59:49.754Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:49.754Z] --- [eqi5-1747112389639 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T04:59:49.754Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:49.754Z] [eqi5-1747112389639 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 11
[2025-05-13T04:59:49.755Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T04:59:49.755Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T04:59:49.755Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T04:59:49.755Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T04:59:49.755Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T04:59:49.756Z] Tools provided: ["routeToAgent"]
[2025-05-13T04:59:49.756Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T04:59:49.756Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T04:59:49.756Z]   - No valid next turn added, sending only history.
[2025-05-13T04:59:50.591Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T04:59:50.592Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:50.592Z] [eqi5-1747112389639 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T04:59:50.592Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T04:59:50.593Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:50.678Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:50.710Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T04:59:50.727Z] [eqi5-1747112389639 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 109
[2025-05-13T04:59:50.727Z] [eqi5-1747112389639 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T04:59:50.728Z] [eqi5-1747112389639 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T04:59:50.728Z] --- [eqi5-1747112389639 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T04:59:50.728Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T04:59:50.804Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Successfully updated history in DB.
[2025-05-13T04:59:50.805Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T04:59:50.805Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T04:59:51.036Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T04:59:51.037Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112389639][Conv:6822d14dbeeb825070c07bff] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:01:02.454Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822d14dbeeb825070c07bff"}]
[2025-05-13T05:01:02.455Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d14dbeeb825070c07bff] Request received.
[2025-05-13T05:01:02.520Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d14dbeeb825070c07bff] Successfully processed deletion.
[2025-05-13T05:01:02.522Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d14dbeeb825070c07bff] Deleted conversation was active. Clearing active ID.
[2025-05-13T05:01:02.523Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822d14dbeeb825070c07bff
[2025-05-13T05:01:02.523Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:01:02.748Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:01:02.749Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822d14dbeeb825070c07bff, Count: 10
[2025-05-13T05:01:10.232Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"ru","conversationId":null}]
[2025-05-13T05:01:10.232Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: ru, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T05:01:10.233Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T05:01:10.355Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T05:01:10.355Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T05:01:10.356Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:01:10.579Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:01:10.580Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: new conversation from send_message, Count: 11
[2025-05-13T05:01:10.636Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 0
[2025-05-13T05:01:10.637Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:01:10.637Z] --- [eqi5-1747112470232 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "find conference in Vietnam", Lang: ru ---
[2025-05-13T05:01:10.637Z] [Language Config] Using configuration for Agent: HostAgent, Language: ru
[2025-05-13T05:01:10.638Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:10.638Z] --- [eqi5-1747112470232 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:01:10.639Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:10.639Z] [eqi5-1747112470232 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 1
[2025-05-13T05:01:10.639Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:01:10.640Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:01:10.640Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:01:10.640Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:01:10.640Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:01:10.641Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:01:10.641Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:01:10.641Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:01:10.641Z]   - No valid next turn added, sending only history.
[2025-05-13T05:01:11.560Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:01:11.560Z] [eqi5-1747112470232 HostAgent Streaming T1 - eqi5qKAxYh1Fyj1UAAAD] Requests function: routeToAgent
[2025-05-13T05:01:11.561Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:11.561Z] --- [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 Socket eqi5qKAxYh1Fyj1UAAAD] Calling Sub Agent: ConferenceAgent, Task: 0bc18798-ab24-4bc6-a90c-9b7981036e9b ---
[2025-05-13T05:01:11.561Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: ru
[2025-05-13T05:01:11.562Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:01:11.562Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:01:11.562Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:01:11.563Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:01:11.563Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:01:11.563Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:01:11.563Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:01:11.563Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:01:11.564Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:01:11.564Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:01:11.564Z]   - No valid next turn added, sending only history.
[2025-05-13T05:01:12.586Z] Model Finish Reason: STOP
[2025-05-13T05:01:12.586Z] Model requested function call: getConferences
[2025-05-13T05:01:12.587Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T05:01:12.587Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:01:12.587Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561] ConferenceAgent requests function call: getConferences
[2025-05-13T05:01:12.588Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:01:12.588Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:01:12.589Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:01:12.589Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:01:12.589Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T05:01:12.590Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:01:12.590Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:01:12.590Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:01:12.591Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:01:12.591Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:01:12.591Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:01:12.592Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T05:01:13.300Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T05:01:13.300Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T05:01:13.301Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:01:13.302Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T05:01:13.309Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T05:01:13.310Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T05:01:13.310Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:01:13.310Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:01:13.311Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:01:13.311Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:01:13.311Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:01:13.312Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:01:13.312Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:01:13.312Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:01:13.313Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:01:13.313Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:01:13.313Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:01:13.314Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:01:13.314Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:01:13.315Z] [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:01:13.315Z] --- [eqi5-1747112470232-Sub-ConferenceAgent-1747112471561] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:01:13.315Z] [eqi5-1747112470232 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:01:13.316Z] --- [eqi5-1747112470232 HostAgent Streaming Turn 2 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:01:13.316Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:13.316Z] [eqi5-1747112470232 History T2 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 3
[2025-05-13T05:01:13.317Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:01:13.317Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:01:13.317Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:01:13.317Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:01:13.318Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:01:13.318Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:01:13.319Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:01:13.319Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:01:13.320Z]   - No valid next turn added, sending only history.
[2025-05-13T05:01:13.888Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:01:13.888Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:13.889Z] [eqi5-1747112470232 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:01:13.889Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:13.890Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.066Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.137Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.323Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.481Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.683Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.901Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.986Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:14.993Z] [eqi5-1747112470232 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 624
[2025-05-13T05:01:14.994Z] [eqi5-1747112470232 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:01:14.994Z] [eqi5-1747112470232 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:01:14.995Z] --- [eqi5-1747112470232 eqi5qKAxYh1Fyj1UAAAD Lang: ru] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:01:14.995Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:01:15.066Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:01:15.066Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:01:15.066Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:01:15.290Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:01:15.291Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112470232][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:01:45.587Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"who are you","isStreaming":true,"language":"es","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:01:45.588Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588] Request received. UserInput: "who are you", Streaming: true, Language: es, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:01:45.588Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:01:45.646Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 4
[2025-05-13T05:01:45.646Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:01:45.646Z] --- [eqi5-1747112505588 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "who are you", Lang: es ---
[2025-05-13T05:01:45.647Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T05:01:45.648Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:45.649Z] --- [eqi5-1747112505588 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:01:45.649Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:45.649Z] [eqi5-1747112505588 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 5
[2025-05-13T05:01:45.650Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T05:01:45.650Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T05:01:45.650Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:01:45.650Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:01:45.650Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:01:45.651Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:01:45.651Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:01:45.651Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T05:01:45.652Z]   - No valid next turn added, sending only history.
[2025-05-13T05:01:46.429Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:01:46.430Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:46.430Z] [eqi5-1747112505588 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:01:46.431Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:01:46.432Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:46.529Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:46.561Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:01:46.568Z] [eqi5-1747112505588 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 109
[2025-05-13T05:01:46.568Z] [eqi5-1747112505588 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:01:46.569Z] [eqi5-1747112505588 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:01:46.569Z] --- [eqi5-1747112505588 eqi5qKAxYh1Fyj1UAAAD Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:01:46.569Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T05:01:46.635Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:01:46.636Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:01:46.636Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:01:46.854Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:01:46.854Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112505588][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:02:04.575Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"hello","isStreaming":true,"language":"ja","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:02:04.576Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576] Request received. UserInput: "hello", Streaming: true, Language: ja, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:02:04.576Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:02:04.634Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 6
[2025-05-13T05:02:04.634Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:02:04.635Z] --- [eqi5-1747112524576 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "hello", Lang: ja ---
[2025-05-13T05:02:04.635Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T05:02:04.635Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:04.636Z] --- [eqi5-1747112524576 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:02:04.636Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:04.636Z] [eqi5-1747112524576 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 7
[2025-05-13T05:02:04.637Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T05:02:04.637Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T05:02:04.637Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:02:04.638Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:02:04.638Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:02:04.638Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:02:04.638Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:02:04.639Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T05:02:04.639Z]   - No valid next turn added, sending only history.
[2025-05-13T05:02:05.353Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:02:05.354Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:05.354Z] [eqi5-1747112524576 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:02:05.354Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:05.356Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:02:05.428Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:02:05.433Z] [eqi5-1747112524576 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 25
[2025-05-13T05:02:05.433Z] [eqi5-1747112524576 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:02:05.434Z] [eqi5-1747112524576 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:02:05.434Z] --- [eqi5-1747112524576 eqi5qKAxYh1Fyj1UAAAD Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:02:05.435Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T05:02:05.501Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:02:05.501Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:02:05.502Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:02:05.718Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:02:05.719Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112524576][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:02:29.596Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"bạn làm được gì","isStreaming":true,"language":"ja","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:02:29.597Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596] Request received. UserInput: "bạn làm được gì", Streaming: true, Language: ja, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:02:29.597Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:02:29.655Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 8
[2025-05-13T05:02:29.655Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:02:29.656Z] --- [eqi5-1747112549596 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "bạn làm được gì", Lang: ja ---
[2025-05-13T05:02:29.656Z] [Language Config] Using configuration for Agent: HostAgent, Language: ja
[2025-05-13T05:02:29.657Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:29.657Z] --- [eqi5-1747112549596 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:02:29.658Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:29.658Z] [eqi5-1747112549596 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 9
[2025-05-13T05:02:29.659Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T05:02:29.659Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T05:02:29.659Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:02:29.660Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:02:29.666Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:02:29.667Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:02:29.668Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:02:29.668Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T05:02:29.668Z]   - No valid next turn added, sending only history.
[2025-05-13T05:02:30.299Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:02:30.300Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:30.300Z] [eqi5-1747112549596 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:02:30.300Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:02:30.301Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:02:30.346Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:02:30.445Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:02:30.570Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:02:30.579Z] [eqi5-1747112549596 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 112
[2025-05-13T05:02:30.580Z] [eqi5-1747112549596 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:02:30.581Z] [eqi5-1747112549596 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:02:30.581Z] --- [eqi5-1747112549596 eqi5qKAxYh1Fyj1UAAAD Lang: ja] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:02:30.582Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T05:02:30.649Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:02:30.649Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:02:30.649Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:02:30.871Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:02:30.872Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112549596][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:03:16.441Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"tìm hội nghị AI","isStreaming":true,"language":"zh","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:03:16.442Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442] Request received. UserInput: "tìm hội nghị AI", Streaming: true, Language: zh, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:03:16.442Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:03:16.500Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 10
[2025-05-13T05:03:16.501Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:03:16.501Z] --- [eqi5-1747112596442 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "tìm hội nghị AI", Lang: zh ---
[2025-05-13T05:03:16.501Z] [Language Config] Using configuration for Agent: HostAgent, Language: zh
[2025-05-13T05:03:16.502Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:03:16.502Z] --- [eqi5-1747112596442 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:03:16.503Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:03:16.503Z] [eqi5-1747112596442 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 11
[2025-05-13T05:03:16.503Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T05:03:16.504Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T05:03:16.504Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:03:16.504Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:03:16.504Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:03:16.504Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:03:16.505Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:03:16.505Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T05:03:16.505Z]   - No valid next turn added, sending only history.
[2025-05-13T05:03:18.285Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:03:18.286Z] [eqi5-1747112596442 HostAgent Streaming T1 - eqi5qKAxYh1Fyj1UAAAD] Requests function: routeToAgent
[2025-05-13T05:03:18.286Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:03:18.287Z] --- [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 Socket eqi5qKAxYh1Fyj1UAAAD] Calling Sub Agent: ConferenceAgent, Task: f5166bbe-898a-4b70-b77d-2e94d2db2276 ---
[2025-05-13T05:03:18.287Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: zh
[2025-05-13T05:03:18.287Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:03:18.288Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:03:18.288Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:03:18.288Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:03:18.289Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:03:18.289Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:03:18.289Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:03:18.289Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:03:18.289Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:03:18.290Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:03:18.290Z]   - No valid next turn added, sending only history.
[2025-05-13T05:03:20.058Z] Model Finish Reason: STOP
[2025-05-13T05:03:20.058Z] Model requested function call: getConferences
[2025-05-13T05:03:20.058Z] Arguments: {"searchQuery":"topics=AI&perPage=5&page=1"}
[2025-05-13T05:03:20.058Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:03:20.059Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287] ConferenceAgent requests function call: getConferences
[2025-05-13T05:03:20.059Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:03:20.059Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:03:20.060Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:03:20.060Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:03:20.060Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=AI&perPage=5&page=1"}
[2025-05-13T05:03:20.060Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:03:20.061Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:03:20.061Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:03:20.061Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:03:20.061Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:03:20.062Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:03:20.063Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=AI&perPage=5&page=1}
[2025-05-13T05:03:20.831Z] [BackendService] [conference] API Success (200). Data length: 6686. Attempting parsing...
[2025-05-13T05:03:20.832Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0ccc90ad-7e7f-4509-8348-fa63943a9b8b","title":"European SPI","acronym":"EuroSPI","location":{"cityStateProvince":"Riga","country":"Latvia","address":"Riga Technical University, Riga, Latvia","continent":"Europe"},"rank":"B","source...
[2025-05-13T05:03:20.832Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:03:20.832Z] Transforming conference data with Markdown. Search query: topics=AI&perPage=5&page=1
[2025-05-13T05:03:20.837Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 24
- **Total page:** 5
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** European SPI
  - **Acronym:** EuroSPI
  - **Location:** Riga Te...
[2025-05-13T05:03:20.838Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=AI&perPage=5&page=1"
[2025-05-13T05:03:20.838Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:03:20.838Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:03:20.839Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:03:20.839Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:03:20.839Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:03:20.840Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:03:20.840Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:03:20.840Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:03:20.840Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:03:20.841Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:03:20.841Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:03:20.841Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:03:20.841Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:03:20.842Z] [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:03:20.842Z] --- [eqi5-1747112596442-Sub-ConferenceAgent-1747112598287] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:03:20.842Z] [eqi5-1747112596442 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:03:20.842Z] --- [eqi5-1747112596442 HostAgent Streaming Turn 2 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:03:20.843Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:03:20.843Z] [eqi5-1747112596442 History T2 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 13
[2025-05-13T05:03:20.843Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T05:03:20.844Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T05:03:20.844Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:03:20.844Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:03:20.844Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:03:20.844Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:03:20.845Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:03:20.846Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T05:03:20.846Z]   - No valid next turn added, sending only history.
[2025-05-13T05:03:21.374Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:03:21.375Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:03:21.375Z] [eqi5-1747112596442 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:03:21.376Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:03:21.376Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:21.513Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:21.589Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:21.709Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:21.845Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:22.048Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:22.246Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:22.330Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:03:22.334Z] [eqi5-1747112596442 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 696
[2025-05-13T05:03:22.334Z] [eqi5-1747112596442 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:03:22.335Z] [eqi5-1747112596442 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:03:22.336Z] --- [eqi5-1747112596442 eqi5qKAxYh1Fyj1UAAAD Lang: zh] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:03:22.336Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T05:03:22.414Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:03:22.415Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:03:22.415Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:03:22.637Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:03:22.638Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112596442][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:07:24.815Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:07:24.819Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Request received.
[2025-05-13T05:07:24.887Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Successfully processed message clearing.
[2025-05-13T05:07:24.888Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Cleared conversation was active. Emitting empty history.
[2025-05-13T05:07:24.888Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11
[2025-05-13T05:07:24.889Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:07:25.187Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:07:25.188Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11, Count: 11
[2025-05-13T05:07:28.103Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"XIn chào","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:07:28.103Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103] Request received. UserInput: "XIn chào", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:07:28.104Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:07:28.161Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 0
[2025-05-13T05:07:28.161Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:07:28.161Z] --- [eqi5-1747112848103 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "XIn chào", Lang: vi ---
[2025-05-13T05:07:28.162Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:07:28.162Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:28.162Z] --- [eqi5-1747112848103 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:07:28.162Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:28.163Z] [eqi5-1747112848103 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 1
[2025-05-13T05:07:28.163Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:07:28.163Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:07:28.163Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:07:28.163Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:07:28.163Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:07:28.164Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:07:28.164Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:07:28.164Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:07:28.164Z]   - No valid next turn added, sending only history.
[2025-05-13T05:07:28.798Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:07:28.799Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:28.799Z] [eqi5-1747112848103 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:07:28.800Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:28.801Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:07:28.920Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:07:28.926Z] [eqi5-1747112848103 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 38
[2025-05-13T05:07:28.926Z] [eqi5-1747112848103 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:07:28.927Z] [eqi5-1747112848103 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:07:28.927Z] --- [eqi5-1747112848103 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:07:28.927Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T05:07:28.987Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:07:28.988Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:07:28.988Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:07:29.215Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:07:29.215Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112848103][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:07:35.802Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"bạn là ai","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:07:35.802Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802] Request received. UserInput: "bạn là ai", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:07:35.803Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:07:35.859Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 2
[2025-05-13T05:07:35.860Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:07:35.860Z] --- [eqi5-1747112855802 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "bạn là ai", Lang: vi ---
[2025-05-13T05:07:35.860Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:07:35.861Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:35.861Z] --- [eqi5-1747112855802 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:07:35.861Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:35.862Z] [eqi5-1747112855802 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 3
[2025-05-13T05:07:35.862Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:07:35.862Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:07:35.862Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:07:35.862Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:07:35.863Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:07:35.863Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:07:35.863Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:07:35.863Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:07:35.864Z]   - No valid next turn added, sending only history.
[2025-05-13T05:07:36.572Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:07:36.572Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:36.573Z] [eqi5-1747112855802 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:07:36.573Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:07:36.573Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:07:36.635Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:07:36.731Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:07:36.901Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:07:36.909Z] [eqi5-1747112855802 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 263
[2025-05-13T05:07:36.909Z] [eqi5-1747112855802 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:07:36.910Z] [eqi5-1747112855802 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:07:36.910Z] --- [eqi5-1747112855802 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:07:36.911Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:07:36.971Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:07:36.971Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:07:36.972Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:07:37.185Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:07:37.186Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112855802][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:08:30.135Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Tìm hội nghị tại Việt nam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:08:30.135Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135] Request received. UserInput: "Tìm hội nghị tại Việt nam", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:08:30.135Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:08:30.192Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 4
[2025-05-13T05:08:30.192Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:08:30.192Z] --- [eqi5-1747112910135 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "Tìm hội nghị tại Việt nam", Lang: vi ---
[2025-05-13T05:08:30.193Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:08:30.193Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:30.194Z] --- [eqi5-1747112910135 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:08:30.194Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:30.194Z] [eqi5-1747112910135 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 5
[2025-05-13T05:08:30.195Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T05:08:30.195Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T05:08:30.195Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:08:30.195Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:08:30.195Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:08:30.196Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:08:30.196Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:08:30.196Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T05:08:30.196Z]   - No valid next turn added, sending only history.
[2025-05-13T05:08:31.849Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:08:31.850Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:31.850Z] [eqi5-1747112910135 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:08:31.851Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:31.851Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:31.948Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:32.047Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:32.054Z] [eqi5-1747112910135 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 136
[2025-05-13T05:08:32.055Z] [eqi5-1747112910135 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:08:32.055Z] [eqi5-1747112910135 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:08:32.056Z] --- [eqi5-1747112910135 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:08:32.056Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T05:08:32.122Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:08:32.122Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:08:32.122Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:08:32.347Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:08:32.348Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112910135][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:08:42.420Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"hội nghị diễn ra tại Vietnam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:08:42.421Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421] Request received. UserInput: "hội nghị diễn ra tại Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:08:42.421Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:08:42.478Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 6
[2025-05-13T05:08:42.479Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:08:42.479Z] --- [eqi5-1747112922421 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "hội nghị diễn ra tại Vietnam", Lang: vi ---
[2025-05-13T05:08:42.479Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:08:42.480Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:42.481Z] --- [eqi5-1747112922421 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:08:42.481Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:42.481Z] [eqi5-1747112922421 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 7
[2025-05-13T05:08:42.482Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T05:08:42.482Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T05:08:42.482Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:08:42.482Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:08:42.483Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:08:42.483Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:08:42.484Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:08:42.485Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T05:08:42.485Z]   - No valid next turn added, sending only history.
[2025-05-13T05:08:43.156Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:08:43.156Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:43.157Z] [eqi5-1747112922421 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:08:43.157Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:43.157Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:43.262Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:43.266Z] [eqi5-1747112922421 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 68
[2025-05-13T05:08:43.267Z] [eqi5-1747112922421 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:08:43.268Z] [eqi5-1747112922421 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:08:43.268Z] --- [eqi5-1747112922421 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:08:43.268Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T05:08:43.332Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:08:43.332Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:08:43.332Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:08:43.553Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:08:43.554Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112922421][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:08:55.720Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"Bất kỳ hội nghị nào tại Vietnam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:08:55.721Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721] Request received. UserInput: "Bất kỳ hội nghị nào tại Vietna...", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:08:55.721Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:08:55.777Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 8
[2025-05-13T05:08:55.778Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:08:55.778Z] --- [eqi5-1747112935721 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "Bất kỳ hội nghị nào tại Vietnam", Lang: vi ---
[2025-05-13T05:08:55.778Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:08:55.779Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:55.784Z] --- [eqi5-1747112935721 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:08:55.786Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:55.789Z] [eqi5-1747112935721 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 9
[2025-05-13T05:08:55.791Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T05:08:55.796Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T05:08:55.798Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:08:55.799Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:08:55.801Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:08:55.802Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:08:55.803Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:08:55.803Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T05:08:55.803Z]   - No valid next turn added, sending only history.
[2025-05-13T05:08:56.495Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:08:56.495Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:56.495Z] [eqi5-1747112935721 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:08:56.496Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:08:56.496Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:56.574Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:56.700Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:56.925Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:56.975Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:08:56.982Z] [eqi5-1747112935721 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 301
[2025-05-13T05:08:56.982Z] [eqi5-1747112935721 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:08:56.982Z] [eqi5-1747112935721 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:08:56.983Z] --- [eqi5-1747112935721 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:08:56.984Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T05:08:57.049Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:08:57.049Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:08:57.049Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:08:57.276Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:08:57.276Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112935721][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:09:09.224Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"không, tìm đi","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:09:09.225Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225] Request received. UserInput: "không, tìm đi", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:09:09.225Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:09:09.284Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 10
[2025-05-13T05:09:09.285Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:09:09.285Z] --- [eqi5-1747112949225 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "không, tìm đi", Lang: vi ---
[2025-05-13T05:09:09.286Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:09:09.286Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:09:09.286Z] --- [eqi5-1747112949225 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:09:09.287Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:09:09.287Z] [eqi5-1747112949225 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 11
[2025-05-13T05:09:09.287Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T05:09:09.288Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T05:09:09.288Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:09:09.288Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:09:09.288Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:09:09.288Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:09:09.289Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:09:09.289Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T05:09:09.290Z]   - No valid next turn added, sending only history.
[2025-05-13T05:09:10.030Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:09:10.031Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:09:10.031Z] [eqi5-1747112949225 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:09:10.032Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:09:10.032Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:09:10.187Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:09:10.297Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:09:10.332Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:09:10.339Z] [eqi5-1747112949225 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 171
[2025-05-13T05:09:10.339Z] [eqi5-1747112949225 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:09:10.340Z] [eqi5-1747112949225 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:09:10.340Z] --- [eqi5-1747112949225 eqi5qKAxYh1Fyj1UAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:09:10.340Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T05:09:10.406Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:09:10.407Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:09:10.407Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:09:10.643Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:09:10.644Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747112949225][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:12:00.938Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:12:00.939Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Request received.
[2025-05-13T05:12:01.005Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Successfully processed message clearing.
[2025-05-13T05:12:01.006Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Cleared conversation was active. Emitting empty history.
[2025-05-13T05:12:01.007Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11
[2025-05-13T05:12:01.007Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:12:01.228Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:12:01.228Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11, Count: 11
[2025-05-13T05:12:10.785Z] [SERVER SOCKET eqi5qKAxYh1Fyj1UAAAD - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"en","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:12:10.785Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: en, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:12:10.786Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:12:10.842Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 0
[2025-05-13T05:12:10.842Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:12:10.842Z] --- [eqi5-1747113130785 Socket eqi5qKAxYh1Fyj1UAAAD] Handling STREAMING input: "find conference in Vietnam", Lang: en ---
[2025-05-13T05:12:10.843Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T05:12:10.843Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:12:10.843Z] --- [eqi5-1747113130785 HostAgent Streaming Turn 1 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:12:10.843Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:12:10.844Z] [eqi5-1747113130785 History T1 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 1
[2025-05-13T05:12:10.844Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:12:10.844Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:12:10.844Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:12:10.844Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:12:10.845Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:12:10.845Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:12:10.845Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:12:10.846Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:12:10.846Z]   - No valid next turn added, sending only history.
[2025-05-13T05:12:11.697Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:12:11.697Z] [eqi5-1747113130785 HostAgent Streaming T1 - eqi5qKAxYh1Fyj1UAAAD] Requests function: routeToAgent
[2025-05-13T05:12:11.698Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:12:11.698Z] --- [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 Socket eqi5qKAxYh1Fyj1UAAAD] Calling Sub Agent: ConferenceAgent, Task: 6a68f839-afc1-49ae-a4f3-ba54828096d4 ---
[2025-05-13T05:12:11.698Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: en
[2025-05-13T05:12:11.699Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:12:11.699Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:12:11.699Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:12:11.700Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:12:11.700Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:12:11.701Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:12:11.701Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:12:11.701Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:12:11.702Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:12:11.702Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:12:11.703Z]   - No valid next turn added, sending only history.
[2025-05-13T05:12:12.606Z] Model Finish Reason: STOP
[2025-05-13T05:12:12.607Z] Model requested function call: getConferences
[2025-05-13T05:12:12.607Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T05:12:12.607Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:12:12.608Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698] ConferenceAgent requests function call: getConferences
[2025-05-13T05:12:12.608Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:12:12.608Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:12:12.609Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:12:12.609Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:12:12.609Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T05:12:12.610Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:12:12.610Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:12:12.610Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:12:12.610Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:12:12.611Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:12:12.611Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:12:12.611Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T05:12:13.335Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T05:12:13.336Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T05:12:13.336Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:12:13.336Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T05:12:13.346Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T05:12:13.346Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T05:12:13.347Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:12:13.347Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:12:13.347Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:12:13.348Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:12:13.348Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:12:13.348Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:12:13.348Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:12:13.349Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:12:13.349Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:12:13.349Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 eqi5qKAxYh1Fyj1UAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:12:13.349Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:12:13.350Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:12:13.350Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Thought Added - eqi5qKAxYh1Fyj1UAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:12:13.350Z] [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698 SubAgent Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:12:13.350Z] --- [eqi5-1747113130785-Sub-ConferenceAgent-1747113131698] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:12:13.351Z] [eqi5-1747113130785 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:12:13.351Z] --- [eqi5-1747113130785 HostAgent Streaming Turn 2 Start - eqi5qKAxYh1Fyj1UAAAD] ---
[2025-05-13T05:12:13.351Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:12:13.351Z] [eqi5-1747113130785 History T2 Send - eqi5qKAxYh1Fyj1UAAAD] Host History Size: 3
[2025-05-13T05:12:13.352Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:12:13.352Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:12:13.352Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:12:13.352Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:12:13.352Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:12:13.353Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:12:13.353Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:12:13.353Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:12:13.353Z]   - No valid next turn added, sending only history.
[2025-05-13T05:12:13.935Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:12:13.936Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:12:13.936Z] [eqi5-1747113130785 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Starting...
[2025-05-13T05:12:13.937Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:12:13.938Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:12:14.086Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:12:14.156Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:12:14.287Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:12:14.440Z] [eqi5-1747113130785 Stream Processing - eqi5qKAxYh1Fyj1UAAAD] Finished. Length: 338
[2025-05-13T05:12:14.441Z] [eqi5-1747113130785 eqi5qKAxYh1Fyj1UAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:12:14.441Z] [eqi5-1747113130785 Streaming Emit Sent - eqi5qKAxYh1Fyj1UAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:12:14.442Z] --- [eqi5-1747113130785 eqi5qKAxYh1Fyj1UAAAD Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:12:14.442Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:12:14.510Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:12:14.511Z] [DEBUG] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:12:14.511Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:12:14.746Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:12:14.747Z] [INFO] [coreHandlers][eqi5qKAxYh1Fyj1UAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:eqi5-1747113130785][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:13:40.499Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T05:13:40.500Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:13:40.844Z] [MainLoader] Starting application loading process...
[2025-05-13T05:13:40.845Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T05:13:40.846Z] [Database] Attempting MongoDB connection...
[2025-05-13T05:13:41.681Z] [Database] MongoDB Connected Successfully.
[2025-05-13T05:13:41.681Z] [DatabaseLoader] Database connection successful.
[2025-05-13T05:13:41.682Z] [MainLoader] Database loaded.
[2025-05-13T05:13:41.682Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T05:13:41.683Z] [ExpressLoader] Configuring Express app...
[2025-05-13T05:13:41.689Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T05:13:41.693Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T05:13:41.694Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T05:13:41.694Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T05:13:41.694Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T05:13:41.696Z] [MainLoader] Express loaded.
[2025-05-13T05:13:41.697Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T05:13:41.703Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T05:13:41.703Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T05:13:41.704Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T05:13:41.704Z] [MainLoader] Socket.IO loaded.
[2025-05-13T05:13:41.705Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T05:13:41.788Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T05:13:41.788Z] [MainLoader] Jobs scheduled.
[2025-05-13T05:13:41.789Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T05:13:41.914Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T05:13:41.916Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T05:13:43.344Z] [socketAuth][DnspBVvDev_8IWCdAAAB] Authentication attempt. Has token: true
[2025-05-13T05:13:43.349Z] [socketAuth][DnspBVvDev_8IWCdAAAB] Token signature validated successfully.
[2025-05-13T05:13:43.352Z] [HistoryService] Initialized.
[2025-05-13T05:13:43.352Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB] New connection. Socket ID: DnspBVvDev_8IWCdAAAB. Initial socket.data.userId: null
[2025-05-13T05:13:43.352Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T05:13:43.353Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB] Attempting to fetch user info using token...
[2025-05-13T05:13:43.353Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:13:43.354Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:13:44.033Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:13:44.033Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:13:44.033Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:13:44.035Z] [HistoryService] Initialized.
[2025-05-13T05:13:44.035Z] [coreHandlers][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:13:44.036Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:13:44.036Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:13:44.036Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:13:44.038Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:13:44.038Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:13:44.094Z] [SERVER SOCKET DnspBVvDev_8IWCdAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:13:44.344Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:13:44.347Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T05:13:44.347Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:13:44.347Z] [SERVER GLOBAL][connection][DnspBVvDev_8IWCdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:14:20.038Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T05:14:20.040Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:14:20.389Z] [MainLoader] Starting application loading process...
[2025-05-13T05:14:20.390Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T05:14:20.391Z] [Database] Attempting MongoDB connection...
[2025-05-13T05:14:21.172Z] [Database] MongoDB Connected Successfully.
[2025-05-13T05:14:21.172Z] [DatabaseLoader] Database connection successful.
[2025-05-13T05:14:21.173Z] [MainLoader] Database loaded.
[2025-05-13T05:14:21.173Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T05:14:21.174Z] [ExpressLoader] Configuring Express app...
[2025-05-13T05:14:21.178Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T05:14:21.182Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T05:14:21.183Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T05:14:21.183Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T05:14:21.183Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T05:14:21.185Z] [MainLoader] Express loaded.
[2025-05-13T05:14:21.185Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T05:14:21.190Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T05:14:21.190Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T05:14:21.190Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T05:14:21.191Z] [MainLoader] Socket.IO loaded.
[2025-05-13T05:14:21.191Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T05:14:21.229Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T05:14:21.230Z] [MainLoader] Jobs scheduled.
[2025-05-13T05:14:21.230Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T05:14:21.281Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T05:14:21.283Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T05:14:22.176Z] [socketAuth][KZ5ygir8q4hQ18wlAAAB] Authentication attempt. Has token: true
[2025-05-13T05:14:22.180Z] [socketAuth][KZ5ygir8q4hQ18wlAAAB] Token signature validated successfully.
[2025-05-13T05:14:22.184Z] [HistoryService] Initialized.
[2025-05-13T05:14:22.184Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB] New connection. Socket ID: KZ5ygir8q4hQ18wlAAAB. Initial socket.data.userId: null
[2025-05-13T05:14:22.184Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T05:14:22.185Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB] Attempting to fetch user info using token...
[2025-05-13T05:14:22.185Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:14:22.186Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:14:22.888Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:14:22.888Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:14:22.888Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:14:22.890Z] [HistoryService] Initialized.
[2025-05-13T05:14:22.890Z] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:14:22.890Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:14:22.891Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:14:22.891Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:14:22.892Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:14:22.893Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:14:22.930Z] [SERVER SOCKET KZ5ygir8q4hQ18wlAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:14:23.184Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:14:23.186Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T05:14:23.186Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:14:23.186Z] [SERVER GLOBAL][connection][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:14:25.101Z] [SERVER SOCKET KZ5ygir8q4hQ18wlAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:14:25.102Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Request received.
[2025-05-13T05:14:25.193Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Successfully processed message clearing.
[2025-05-13T05:14:25.194Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11
[2025-05-13T05:14:25.194Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:14:25.456Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:14:25.457Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11, Count: 11
[2025-05-13T05:14:32.496Z] [SERVER SOCKET KZ5ygir8q4hQ18wlAAAB - ON ANY] Event: send_message, Args: [{"userInput":"find conference in Vietnam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:14:32.499Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499] Request received. UserInput: "find conference in Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: N/A
[2025-05-13T05:14:32.500Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Updating socket.data.currentConversationId to match payloadConversationId. Old: N/A
[2025-05-13T05:14:32.500Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:14:32.569Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 0
[2025-05-13T05:14:32.569Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:14:32.571Z] --- [KZ5y-1747113272499 Socket KZ5ygir8q4hQ18wlAAAB] Handling STREAMING input: "find conference in Vietnam", Lang: vi ---
[2025-05-13T05:14:32.571Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:14:32.572Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:32.573Z] --- [KZ5y-1747113272499 HostAgent Streaming Turn 1 Start - KZ5ygir8q4hQ18wlAAAB] ---
[2025-05-13T05:14:32.573Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:32.573Z] [KZ5y-1747113272499 History T1 Send - KZ5ygir8q4hQ18wlAAAB] Host History Size: 1
[2025-05-13T05:14:32.575Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:14:32.575Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:14:32.575Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:14:32.576Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:14:32.576Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:14:32.576Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:14:32.577Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:14:32.577Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:14:32.577Z]   - No valid next turn added, sending only history.
[2025-05-13T05:14:33.412Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:14:33.413Z] [KZ5y-1747113272499 HostAgent Streaming T1 - KZ5ygir8q4hQ18wlAAAB] Requests function: routeToAgent
[2025-05-13T05:14:33.414Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:33.417Z] --- [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 Socket KZ5ygir8q4hQ18wlAAAB] Calling Sub Agent: ConferenceAgent, Task: c7817396-1092-40c1-b036-71534a4c4b70 ---
[2025-05-13T05:14:33.437Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T05:14:33.438Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:14:33.439Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:14:33.440Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:14:33.441Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:14:33.441Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:14:33.441Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:14:33.441Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:14:33.442Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:14:33.442Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:14:33.442Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:14:33.442Z]   - No valid next turn added, sending only history.
[2025-05-13T05:14:34.316Z] Model Finish Reason: STOP
[2025-05-13T05:14:34.317Z] Model requested function call: getConferences
[2025-05-13T05:14:34.317Z] Arguments: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T05:14:34.317Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:14:34.318Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417] ConferenceAgent requests function call: getConferences
[2025-05-13T05:14:34.320Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:14:34.321Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:14:34.323Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:14:34.324Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:14:34.328Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T05:14:34.329Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:14:34.333Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:14:34.336Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:14:34.338Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:14:34.339Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:14:34.340Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:14:34.341Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Việt+Nam&perPage=5&page=1}
[2025-05-13T05:14:35.020Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T05:14:35.020Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T05:14:35.020Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:14:35.021Z] Transforming conference data with Markdown. Search query: country=Việt+Nam&perPage=5&page=1
[2025-05-13T05:14:35.022Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T05:14:35.022Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Việt+Nam&perPage=5&page=1"
[2025-05-13T05:14:35.023Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:14:35.023Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:14:35.023Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:14:35.024Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:14:35.024Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:14:35.024Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:14:35.025Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:14:35.025Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:14:35.025Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:14:35.025Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 KZ5ygir8q4hQ18wlAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:14:35.026Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:14:35.026Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:14:35.027Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:14:35.027Z] [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:14:35.027Z] --- [KZ5y-1747113272499-Sub-ConferenceAgent-1747113273417] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:14:35.027Z] [KZ5y-1747113272499 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:14:35.028Z] --- [KZ5y-1747113272499 HostAgent Streaming Turn 2 Start - KZ5ygir8q4hQ18wlAAAB] ---
[2025-05-13T05:14:35.028Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:35.028Z] [KZ5y-1747113272499 History T2 Send - KZ5ygir8q4hQ18wlAAAB] Host History Size: 3
[2025-05-13T05:14:35.028Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:14:35.029Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:14:35.029Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:14:35.029Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:14:35.029Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:14:35.030Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:14:35.030Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:14:35.030Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:14:35.030Z]   - No valid next turn added, sending only history.
[2025-05-13T05:14:35.545Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:14:35.546Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:35.546Z] [KZ5y-1747113272499 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Starting...
[2025-05-13T05:14:35.547Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:35.548Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:35.656Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:35.661Z] [KZ5y-1747113272499 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Finished. Length: 58
[2025-05-13T05:14:35.662Z] [KZ5y-1747113272499 KZ5ygir8q4hQ18wlAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:14:35.662Z] [KZ5y-1747113272499 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:14:35.663Z] --- [KZ5y-1747113272499 KZ5ygir8q4hQ18wlAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:14:35.663Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:14:35.759Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:14:35.759Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:14:35.760Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:14:36.016Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:14:36.017Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113272499][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:14:42.806Z] [SERVER SOCKET KZ5ygir8q4hQ18wlAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Vietnam ?","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:14:42.807Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807] Request received. UserInput: "Vietnam ?", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:14:42.807Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:14:42.872Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 4
[2025-05-13T05:14:42.873Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:14:42.873Z] --- [KZ5y-1747113282807 Socket KZ5ygir8q4hQ18wlAAAB] Handling STREAMING input: "Vietnam ?", Lang: vi ---
[2025-05-13T05:14:42.873Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:14:42.874Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:42.874Z] --- [KZ5y-1747113282807 HostAgent Streaming Turn 1 Start - KZ5ygir8q4hQ18wlAAAB] ---
[2025-05-13T05:14:42.874Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:42.875Z] [KZ5y-1747113282807 History T1 Send - KZ5ygir8q4hQ18wlAAAB] Host History Size: 5
[2025-05-13T05:14:42.875Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T05:14:42.875Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T05:14:42.875Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:14:42.876Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:14:42.876Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:14:42.876Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:14:42.876Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:14:42.876Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T05:14:42.876Z]   - No valid next turn added, sending only history.
[2025-05-13T05:14:43.544Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:14:43.545Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:43.545Z] [KZ5y-1747113282807 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Starting...
[2025-05-13T05:14:43.546Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:43.546Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:43.709Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:43.770Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:43.834Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:43.836Z] [KZ5y-1747113282807 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Finished. Length: 143
[2025-05-13T05:14:43.837Z] [KZ5y-1747113282807 KZ5ygir8q4hQ18wlAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:14:43.837Z] [KZ5y-1747113282807 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:14:43.838Z] --- [KZ5y-1747113282807 KZ5ygir8q4hQ18wlAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:14:43.838Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T05:14:43.912Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:14:43.913Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:14:43.913Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:14:44.181Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:14:44.182Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113282807][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:14:58.804Z] [SERVER SOCKET KZ5ygir8q4hQ18wlAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Quốc gia Vietnam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:14:58.804Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804] Request received. UserInput: "Quốc gia Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:14:58.804Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:14:58.872Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 6
[2025-05-13T05:14:58.873Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:14:58.873Z] --- [KZ5y-1747113298804 Socket KZ5ygir8q4hQ18wlAAAB] Handling STREAMING input: "Quốc gia Vietnam", Lang: vi ---
[2025-05-13T05:14:58.873Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:14:58.874Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:58.874Z] --- [KZ5y-1747113298804 HostAgent Streaming Turn 1 Start - KZ5ygir8q4hQ18wlAAAB] ---
[2025-05-13T05:14:58.875Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:58.875Z] [KZ5y-1747113298804 History T1 Send - KZ5ygir8q4hQ18wlAAAB] Host History Size: 7
[2025-05-13T05:14:58.875Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T05:14:58.876Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T05:14:58.876Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:14:58.876Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:14:58.877Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:14:58.877Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:14:58.877Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:14:58.877Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T05:14:58.878Z]   - No valid next turn added, sending only history.
[2025-05-13T05:14:59.693Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:14:59.693Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:59.694Z] [KZ5y-1747113298804 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Starting...
[2025-05-13T05:14:59.694Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:14:59.695Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:59.762Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:59.794Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:14:59.797Z] [KZ5y-1747113298804 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Finished. Length: 92
[2025-05-13T05:14:59.798Z] [KZ5y-1747113298804 KZ5ygir8q4hQ18wlAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:14:59.799Z] [KZ5y-1747113298804 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:14:59.799Z] --- [KZ5y-1747113298804 KZ5ygir8q4hQ18wlAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:14:59.799Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T05:14:59.874Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:14:59.875Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:14:59.875Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:15:00.127Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:15:00.128Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113298804][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:15:09.232Z] [SERVER SOCKET KZ5ygir8q4hQ18wlAAAB - ON ANY] Event: send_message, Args: [{"userInput":"hội nghị tại Vietnam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:15:09.233Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233] Request received. UserInput: "hội nghị tại Vietnam", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: 6822d216beeb825070c07c11
[2025-05-13T05:15:09.233Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:15:09.300Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 8
[2025-05-13T05:15:09.300Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:15:09.300Z] --- [KZ5y-1747113309233 Socket KZ5ygir8q4hQ18wlAAAB] Handling STREAMING input: "hội nghị tại Vietnam", Lang: vi ---
[2025-05-13T05:15:09.301Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:15:09.301Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:15:09.301Z] --- [KZ5y-1747113309233 HostAgent Streaming Turn 1 Start - KZ5ygir8q4hQ18wlAAAB] ---
[2025-05-13T05:15:09.302Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:15:09.302Z] [KZ5y-1747113309233 History T1 Send - KZ5ygir8q4hQ18wlAAAB] Host History Size: 9
[2025-05-13T05:15:09.302Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T05:15:09.302Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T05:15:09.303Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:15:09.303Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:15:09.303Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:15:09.303Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:15:09.303Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:15:09.304Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T05:15:09.304Z]   - No valid next turn added, sending only history.
[2025-05-13T05:15:10.225Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:15:10.225Z] [KZ5y-1747113309233 HostAgent Streaming T1 - KZ5ygir8q4hQ18wlAAAB] Requests function: routeToAgent
[2025-05-13T05:15:10.226Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:15:10.226Z] --- [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 Socket KZ5ygir8q4hQ18wlAAAB] Calling Sub Agent: ConferenceAgent, Task: fac3e61a-1004-43df-9f87-2053d8a1f5ca ---
[2025-05-13T05:15:10.226Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T05:15:10.227Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:15:10.227Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:15:10.227Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:15:10.228Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:15:10.228Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:15:10.228Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:15:10.229Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:15:10.229Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:15:10.230Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:15:10.231Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:15:10.231Z]   - No valid next turn added, sending only history.
[2025-05-13T05:15:11.132Z] Model Finish Reason: STOP
[2025-05-13T05:15:11.132Z] Model requested function call: getConferences
[2025-05-13T05:15:11.132Z] Arguments: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T05:15:11.133Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:15:11.133Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226] ConferenceAgent requests function call: getConferences
[2025-05-13T05:15:11.134Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:15:11.135Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:15:11.136Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:15:11.136Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:15:11.137Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T05:15:11.137Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:15:11.138Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:15:11.138Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:15:11.139Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:15:11.139Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:15:11.139Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:15:11.140Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Việt+Nam&perPage=5&page=1}
[2025-05-13T05:15:11.804Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T05:15:11.805Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T05:15:11.805Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:15:11.805Z] Transforming conference data with Markdown. Search query: country=Việt+Nam&perPage=5&page=1
[2025-05-13T05:15:11.806Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T05:15:11.806Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Việt+Nam&perPage=5&page=1"
[2025-05-13T05:15:11.806Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:15:11.807Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:15:11.807Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:15:11.808Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:15:11.808Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:15:11.808Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:15:11.809Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:15:11.809Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:15:11.809Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:15:11.810Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 KZ5ygir8q4hQ18wlAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:15:11.810Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:15:11.810Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:15:11.811Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Thought Added - KZ5ygir8q4hQ18wlAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:15:11.811Z] [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226 SubAgent Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:15:11.811Z] --- [KZ5y-1747113309233-Sub-ConferenceAgent-1747113310226] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:15:11.812Z] [KZ5y-1747113309233 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:15:11.813Z] --- [KZ5y-1747113309233 HostAgent Streaming Turn 2 Start - KZ5ygir8q4hQ18wlAAAB] ---
[2025-05-13T05:15:11.814Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:15:11.814Z] [KZ5y-1747113309233 History T2 Send - KZ5ygir8q4hQ18wlAAAB] Host History Size: 11
[2025-05-13T05:15:11.814Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T05:15:11.815Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T05:15:11.815Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:15:11.815Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:15:11.815Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:15:11.816Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:15:11.816Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:15:11.816Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T05:15:11.817Z]   - No valid next turn added, sending only history.
[2025-05-13T05:15:12.468Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:15:12.469Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:15:12.469Z] [KZ5y-1747113309233 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Starting...
[2025-05-13T05:15:12.469Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:15:12.470Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:15:12.520Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:15:12.525Z] [KZ5y-1747113309233 Stream Processing - KZ5ygir8q4hQ18wlAAAB] Finished. Length: 58
[2025-05-13T05:15:12.525Z] [KZ5y-1747113309233 KZ5ygir8q4hQ18wlAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:15:12.526Z] [KZ5y-1747113309233 Streaming Emit Sent - KZ5ygir8q4hQ18wlAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:15:12.527Z] --- [KZ5y-1747113309233 KZ5ygir8q4hQ18wlAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:15:12.527Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T05:15:12.616Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:15:12.616Z] [DEBUG] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:15:12.617Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:15:12.882Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:15:12.882Z] [INFO] [coreHandlers][KZ5ygir8q4hQ18wlAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:KZ5y-1747113309233][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:17:29.452Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T05:17:29.458Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:17:29.860Z] [MainLoader] Starting application loading process...
[2025-05-13T05:17:29.862Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T05:17:29.862Z] [Database] Attempting MongoDB connection...
[2025-05-13T05:17:30.796Z] [Database] MongoDB Connected Successfully.
[2025-05-13T05:17:30.797Z] [DatabaseLoader] Database connection successful.
[2025-05-13T05:17:30.797Z] [MainLoader] Database loaded.
[2025-05-13T05:17:30.797Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T05:17:30.798Z] [ExpressLoader] Configuring Express app...
[2025-05-13T05:17:30.803Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T05:17:30.806Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T05:17:30.807Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T05:17:30.807Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T05:17:30.807Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T05:17:30.808Z] [MainLoader] Express loaded.
[2025-05-13T05:17:30.809Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T05:17:30.813Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T05:17:30.814Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T05:17:30.814Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T05:17:30.815Z] [MainLoader] Socket.IO loaded.
[2025-05-13T05:17:30.815Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T05:17:30.851Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T05:17:30.851Z] [MainLoader] Jobs scheduled.
[2025-05-13T05:17:30.852Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T05:17:30.894Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T05:17:30.894Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T05:17:32.517Z] [socketAuth][bW6KYQYQqOJEJu7gAAAB] Authentication attempt. Has token: true
[2025-05-13T05:17:32.522Z] [socketAuth][bW6KYQYQqOJEJu7gAAAB] Token signature validated successfully.
[2025-05-13T05:17:32.524Z] [HistoryService] Initialized.
[2025-05-13T05:17:32.525Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB] New connection. Socket ID: bW6KYQYQqOJEJu7gAAAB. Initial socket.data.userId: null
[2025-05-13T05:17:32.525Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T05:17:32.525Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB] Attempting to fetch user info using token...
[2025-05-13T05:17:32.526Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:17:32.526Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:17:33.218Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:17:33.218Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:17:33.219Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:17:33.221Z] [HistoryService] Initialized.
[2025-05-13T05:17:33.221Z] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:17:33.221Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:17:33.222Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:17:33.222Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:17:33.223Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:17:33.224Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:17:33.263Z] [SERVER SOCKET bW6KYQYQqOJEJu7gAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:17:33.548Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:17:33.549Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T05:17:33.549Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:17:33.550Z] [SERVER GLOBAL][connection][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:17:46.071Z] [SERVER SOCKET bW6KYQYQqOJEJu7gAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:17:46.074Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Request received.
[2025-05-13T05:17:46.196Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Successfully processed message clearing.
[2025-05-13T05:17:46.197Z] [DEBUG] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11
[2025-05-13T05:17:46.197Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:17:46.490Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:17:46.491Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822d216beeb825070c07c11, Count: 11
[2025-05-13T05:17:56.626Z] [SERVER SOCKET bW6KYQYQqOJEJu7gAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tìm hội nghị tại Việt Nam","isStreaming":true,"language":"vi","conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:17:56.627Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627] Request received. UserInput: "tìm hội nghị tại Việt Nam", Streaming: true, Language: vi, PayloadConvId: 6822d216beeb825070c07c11, SocketDataConvId: N/A
[2025-05-13T05:17:56.628Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Updating socket.data.currentConversationId to match payloadConversationId. Old: N/A
[2025-05-13T05:17:56.628Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Using conversationId from payload.
[2025-05-13T05:17:56.706Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Fetched current history. Count: 0
[2025-05-13T05:17:56.706Z] [DEBUG] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Calling streaming intent handler.
[2025-05-13T05:17:56.708Z] --- [bW6K-1747113476627 Socket bW6KYQYQqOJEJu7gAAAB] Handling STREAMING input: "tìm hội nghị tại Việt Nam", Lang: vi ---
[2025-05-13T05:17:56.708Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:17:56.710Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:17:56.710Z] --- [bW6K-1747113476627 HostAgent Streaming Turn 1 Start - bW6KYQYQqOJEJu7gAAAB] ---
[2025-05-13T05:17:56.711Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:17:56.711Z] [bW6K-1747113476627 History T1 Send - bW6KYQYQqOJEJu7gAAAB] Host History Size: 1
[2025-05-13T05:17:56.712Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:17:56.713Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:17:56.713Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:17:56.713Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:17:56.714Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:17:56.714Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:17:56.714Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:17:56.714Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:17:56.715Z]   - No valid next turn added, sending only history.
[2025-05-13T05:17:57.533Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:17:57.533Z] [bW6K-1747113476627 HostAgent Streaming T1 - bW6KYQYQqOJEJu7gAAAB] Requests function: routeToAgent
[2025-05-13T05:17:57.534Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:17:57.539Z] --- [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 Socket bW6KYQYQqOJEJu7gAAAB] Calling Sub Agent: ConferenceAgent, Task: e1257279-5d95-4028-a156-de9ab772977c ---
[2025-05-13T05:17:57.540Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T05:17:57.542Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:17:57.545Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:17:57.548Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:17:57.550Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:17:57.551Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:17:57.553Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:17:57.554Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:17:57.556Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:17:57.557Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:17:57.558Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:17:57.559Z]   - No valid next turn added, sending only history.
[2025-05-13T05:17:58.413Z] Model Finish Reason: STOP
[2025-05-13T05:17:58.413Z] Model requested function call: getConferences
[2025-05-13T05:17:58.414Z] Arguments: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T05:17:58.415Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:17:58.416Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539] ConferenceAgent requests function call: getConferences
[2025-05-13T05:17:58.416Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:17:58.418Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:17:58.421Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:17:58.421Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:17:58.422Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Việt+Nam&perPage=5&page=1"}
[2025-05-13T05:17:58.423Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:17:58.424Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:17:58.424Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:17:58.424Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:17:58.425Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:17:58.425Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:17:58.426Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Việt+Nam&perPage=5&page=1}
[2025-05-13T05:17:59.091Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T05:17:59.091Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T05:17:59.091Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:17:59.092Z] Transforming conference data with Markdown. Search query: country=Việt+Nam&perPage=5&page=1
[2025-05-13T05:17:59.093Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T05:17:59.093Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Việt+Nam&perPage=5&page=1"
[2025-05-13T05:17:59.094Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:17:59.094Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:17:59.095Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:17:59.095Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:17:59.095Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:17:59.095Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:17:59.096Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:17:59.096Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:17:59.096Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:17:59.097Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 bW6KYQYQqOJEJu7gAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:17:59.097Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:17:59.098Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:17:59.098Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Thought Added - bW6KYQYQqOJEJu7gAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:17:59.099Z] [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539 SubAgent Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:17:59.099Z] --- [bW6K-1747113476627-Sub-ConferenceAgent-1747113477539] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:17:59.099Z] [bW6K-1747113476627 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:17:59.100Z] --- [bW6K-1747113476627 HostAgent Streaming Turn 2 Start - bW6KYQYQqOJEJu7gAAAB] ---
[2025-05-13T05:17:59.101Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:17:59.101Z] [bW6K-1747113476627 History T2 Send - bW6KYQYQqOJEJu7gAAAB] Host History Size: 3
[2025-05-13T05:17:59.103Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:17:59.104Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:17:59.104Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:17:59.104Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:17:59.105Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:17:59.105Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:17:59.106Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:17:59.106Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:17:59.107Z]   - No valid next turn added, sending only history.
[2025-05-13T05:17:59.696Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:17:59.696Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:17:59.697Z] [bW6K-1747113476627 Stream Processing - bW6KYQYQqOJEJu7gAAAB] Starting...
[2025-05-13T05:17:59.698Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:17:59.698Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:17:59.804Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:17:59.809Z] [bW6K-1747113476627 Stream Processing - bW6KYQYQqOJEJu7gAAAB] Finished. Length: 63
[2025-05-13T05:17:59.809Z] [bW6K-1747113476627 bW6KYQYQqOJEJu7gAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:17:59.810Z] [bW6K-1747113476627 Streaming Emit Sent - bW6KYQYQqOJEJu7gAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:17:59.810Z] --- [bW6K-1747113476627 bW6KYQYQqOJEJu7gAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:17:59.811Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:17:59.905Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Successfully updated history in DB.
[2025-05-13T05:17:59.905Z] [DEBUG] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:17:59.905Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:18:00.192Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:18:00.193Z] [INFO] [coreHandlers][bW6KYQYQqOJEJu7gAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:bW6K-1747113476627][Conv:6822d216beeb825070c07c11] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T05:25:29.947Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T05:25:29.950Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:25:30.337Z] [MainLoader] Starting application loading process...
[2025-05-13T05:25:30.337Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T05:25:30.338Z] [Database] Attempting MongoDB connection...
[2025-05-13T05:25:31.236Z] [Database] MongoDB Connected Successfully.
[2025-05-13T05:25:31.237Z] [DatabaseLoader] Database connection successful.
[2025-05-13T05:25:31.237Z] [MainLoader] Database loaded.
[2025-05-13T05:25:31.237Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T05:25:31.238Z] [ExpressLoader] Configuring Express app...
[2025-05-13T05:25:31.242Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T05:25:31.245Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T05:25:31.246Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T05:25:31.246Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T05:25:31.246Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T05:25:31.248Z] [MainLoader] Express loaded.
[2025-05-13T05:25:31.248Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T05:25:31.253Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T05:25:31.253Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T05:25:31.254Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T05:25:31.254Z] [MainLoader] Socket.IO loaded.
[2025-05-13T05:25:31.254Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T05:25:31.291Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T05:25:31.291Z] [MainLoader] Jobs scheduled.
[2025-05-13T05:25:31.291Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T05:25:31.334Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T05:25:31.335Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T05:25:32.826Z] [socketAuth][_neuP73_C1RDwV0DAAAB] Authentication attempt. Has token: true
[2025-05-13T05:25:32.830Z] [socketAuth][_neuP73_C1RDwV0DAAAB] Token signature validated successfully.
[2025-05-13T05:25:32.833Z] [HistoryService] Initialized.
[2025-05-13T05:25:32.834Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB] New connection. Socket ID: _neuP73_C1RDwV0DAAAB. Initial socket.data.userId: null
[2025-05-13T05:25:32.834Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T05:25:32.834Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB] Attempting to fetch user info using token...
[2025-05-13T05:25:32.835Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:25:32.835Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:25:33.531Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:25:33.532Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:25:33.532Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:25:33.534Z] [HistoryService] Initialized.
[2025-05-13T05:25:33.535Z] [coreHandlers][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:25:33.535Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:25:33.535Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:25:33.536Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:25:33.537Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:25:33.538Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:25:33.593Z] [SERVER SOCKET _neuP73_C1RDwV0DAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:25:34.102Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:25:34.104Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T05:25:34.104Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:25:34.104Z] [SERVER GLOBAL][connection][_neuP73_C1RDwV0DAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:26:40.636Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T05:26:40.637Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:26:41.076Z] [MainLoader] Starting application loading process...
[2025-05-13T05:26:41.078Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T05:26:41.079Z] [Database] Attempting MongoDB connection...
[2025-05-13T05:26:42.011Z] [Database] MongoDB Connected Successfully.
[2025-05-13T05:26:42.011Z] [DatabaseLoader] Database connection successful.
[2025-05-13T05:26:42.011Z] [MainLoader] Database loaded.
[2025-05-13T05:26:42.012Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T05:26:42.012Z] [ExpressLoader] Configuring Express app...
[2025-05-13T05:26:42.018Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T05:26:42.022Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T05:26:42.022Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T05:26:42.022Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T05:26:42.022Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T05:26:42.024Z] [MainLoader] Express loaded.
[2025-05-13T05:26:42.024Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T05:26:42.028Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T05:26:42.029Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T05:26:42.029Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T05:26:42.029Z] [MainLoader] Socket.IO loaded.
[2025-05-13T05:26:42.030Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T05:26:42.071Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T05:26:42.072Z] [MainLoader] Jobs scheduled.
[2025-05-13T05:26:42.072Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T05:26:42.126Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T05:26:42.126Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T05:26:43.852Z] [socketAuth][5tMTFvfvLK8RWJ5uAAAB] Authentication attempt. Has token: true
[2025-05-13T05:26:43.856Z] [socketAuth][5tMTFvfvLK8RWJ5uAAAB] Token signature validated successfully.
[2025-05-13T05:26:43.858Z] [HistoryService] Initialized.
[2025-05-13T05:26:43.859Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB] New connection. Socket ID: 5tMTFvfvLK8RWJ5uAAAB. Initial socket.data.userId: null
[2025-05-13T05:26:43.859Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T05:26:43.860Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB] Attempting to fetch user info using token...
[2025-05-13T05:26:43.860Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:26:43.860Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:26:44.201Z] [SERVER SOCKET 5tMTFvfvLK8RWJ5uAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822cf00fad6c57f84d7973f"}]
[2025-05-13T05:26:44.566Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:26:44.566Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:26:44.567Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:26:44.569Z] [HistoryService] Initialized.
[2025-05-13T05:26:44.569Z] [coreHandlers][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:26:44.570Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:26:44.570Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:26:44.570Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:26:44.571Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:26:44.572Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:26:44.621Z] [SERVER SOCKET 5tMTFvfvLK8RWJ5uAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:26:44.879Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:26:44.881Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T05:26:44.881Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:26:44.882Z] [SERVER GLOBAL][connection][5tMTFvfvLK8RWJ5uAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:27:01.045Z] [SERVER GLOBAL][disconnect][5tMTFvfvLK8RWJ5uAAAB] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T05:27:02.993Z] [socketAuth][O_0LAOhEkqv_jyjrAAAD] Authentication attempt. Has token: true
[2025-05-13T05:27:02.996Z] [socketAuth][O_0LAOhEkqv_jyjrAAAD] Token signature validated successfully.
[2025-05-13T05:27:02.998Z] [HistoryService] Initialized.
[2025-05-13T05:27:02.999Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD] New connection. Socket ID: O_0LAOhEkqv_jyjrAAAD. Initial socket.data.userId: null
[2025-05-13T05:27:02.999Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD] Client connected, processing authentication. Has token: true
[2025-05-13T05:27:02.999Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD] Attempting to fetch user info using token...
[2025-05-13T05:27:03.000Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:27:03.000Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:27:03.677Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:27:03.677Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:27:03.678Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:27:03.678Z] [HistoryService] Initialized.
[2025-05-13T05:27:03.678Z] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:27:03.678Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:27:03.678Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:27:03.679Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:27:03.680Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:27:03.680Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:27:03.686Z] [SERVER SOCKET O_0LAOhEkqv_jyjrAAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:27:03.717Z] [SERVER SOCKET O_0LAOhEkqv_jyjrAAAD - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822cf00fad6c57f84d7973f"}]
[2025-05-13T05:27:03.751Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822cf00fad6c57f84d7973f"}
[2025-05-13T05:27:03.751Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cf00fad6c57f84d7973f] Request received.
[2025-05-13T05:27:03.932Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T05:27:03.934Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T05:27:03.934Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:27:03.935Z] [SERVER GLOBAL][connection][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:27:04.186Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cf00fad6c57f84d7973f] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T05:27:10.349Z] [SERVER SOCKET O_0LAOhEkqv_jyjrAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822cf00fad6c57f84d7973f"}]
[2025-05-13T05:27:10.350Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cf00fad6c57f84d7973f] Request received.
[2025-05-13T05:27:10.421Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cf00fad6c57f84d7973f] Successfully processed deletion.
[2025-05-13T05:27:10.422Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822cf00fad6c57f84d7973f] Deleted conversation was active. Clearing active ID.
[2025-05-13T05:27:10.422Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822cf00fad6c57f84d7973f
[2025-05-13T05:27:10.423Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:27:10.609Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:27:10.610Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822cf00fad6c57f84d7973f, Count: 10
[2025-05-13T05:27:12.990Z] [SERVER SOCKET O_0LAOhEkqv_jyjrAAAD - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822d216beeb825070c07c11"}]
[2025-05-13T05:27:12.991Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Request received.
[2025-05-13T05:27:13.056Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d216beeb825070c07c11] Successfully processed deletion.
[2025-05-13T05:27:13.056Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822d216beeb825070c07c11
[2025-05-13T05:27:13.057Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:27:13.242Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T05:27:13.243Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822d216beeb825070c07c11, Count: 9
[2025-05-13T05:27:29.014Z] [SERVER SOCKET O_0LAOhEkqv_jyjrAAAD - ON ANY] Event: send_message, Args: [{"userInput":"tìm hội nghị tại Việt nam","isStreaming":true,"language":"vi","conversationId":null}]
[2025-05-13T05:27:29.015Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015] Request received. UserInput: "tìm hội nghị tại Việt nam", Streaming: true, Language: vi, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T05:27:29.016Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T05:27:29.177Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T05:27:29.178Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T05:27:29.178Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:27:29.369Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:27:29.369Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: new conversation from send_message, Count: 10
[2025-05-13T05:27:29.433Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 0
[2025-05-13T05:27:29.433Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:27:29.435Z] --- [O_0L-1747114049015 Socket O_0LAOhEkqv_jyjrAAAD] Handling STREAMING input: "tìm hội nghị tại Việt nam", Lang: vi ---
[2025-05-13T05:27:29.435Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:27:29.436Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:27:29.437Z] --- [O_0L-1747114049015 HostAgent Streaming Turn 1 Start - O_0LAOhEkqv_jyjrAAAD] ---
[2025-05-13T05:27:29.437Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:27:29.438Z] [O_0L-1747114049015 History T1 Send - O_0LAOhEkqv_jyjrAAAD] Host History Size: 1
[2025-05-13T05:27:29.439Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:27:29.440Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:27:29.440Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:27:29.440Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:27:29.440Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:27:29.441Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:27:29.441Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:27:29.441Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:27:29.441Z]   - No valid next turn added, sending only history.
[2025-05-13T05:27:30.307Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:27:30.307Z] [O_0L-1747114049015 HostAgent Streaming T1 - O_0LAOhEkqv_jyjrAAAD] Requests function: routeToAgent
[2025-05-13T05:27:30.308Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:27:30.310Z] --- [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 Socket O_0LAOhEkqv_jyjrAAAD] Calling Sub Agent: ConferenceAgent, Task: 8145b1a5-12b5-4f85-9584-0054f528067a ---
[2025-05-13T05:27:30.311Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T05:27:30.311Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:27:30.312Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:27:30.314Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:27:30.315Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:27:30.315Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:27:30.315Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:27:30.316Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:27:30.316Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:27:30.316Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:27:30.316Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:27:30.317Z]   - No valid next turn added, sending only history.
[2025-05-13T05:27:31.252Z] Model Finish Reason: STOP
[2025-05-13T05:27:31.253Z] Model requested function call: getConferences
[2025-05-13T05:27:31.253Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T05:27:31.253Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:27:31.254Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310] ConferenceAgent requests function call: getConferences
[2025-05-13T05:27:31.254Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:27:31.255Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:27:31.256Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:27:31.256Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:27:31.257Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T05:27:31.257Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:27:31.258Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:27:31.258Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:27:31.258Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:27:31.259Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:27:31.259Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:27:31.260Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T05:27:31.998Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T05:27:31.998Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T05:27:31.999Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:27:31.999Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T05:27:32.008Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T05:27:32.009Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T05:27:32.009Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:27:32.009Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:27:32.010Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:27:32.010Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:27:32.011Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:27:32.011Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:27:32.011Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:27:32.011Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:27:32.012Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:27:32.012Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 O_0LAOhEkqv_jyjrAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:27:32.012Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:27:32.013Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:27:32.013Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:27:32.014Z] [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:27:32.014Z] --- [O_0L-1747114049015-Sub-ConferenceAgent-1747114050310] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:27:32.014Z] [O_0L-1747114049015 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:27:32.015Z] --- [O_0L-1747114049015 HostAgent Streaming Turn 2 Start - O_0LAOhEkqv_jyjrAAAD] ---
[2025-05-13T05:27:32.015Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:27:32.015Z] [O_0L-1747114049015 History T2 Send - O_0LAOhEkqv_jyjrAAAD] Host History Size: 3
[2025-05-13T05:27:32.016Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:27:32.016Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:27:32.016Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:27:32.016Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:27:32.017Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:27:32.017Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:27:32.017Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:27:32.017Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:27:32.018Z]   - No valid next turn added, sending only history.
[2025-05-13T05:27:32.672Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:27:32.674Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:27:32.675Z] [O_0L-1747114049015 Stream Processing - O_0LAOhEkqv_jyjrAAAD] Starting...
[2025-05-13T05:27:32.676Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:27:32.676Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:32.760Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:32.842Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:33.030Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:33.176Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:33.382Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:33.570Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:33.825Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:34.108Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:34.349Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:34.575Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:27:34.581Z] [O_0L-1747114049015 Stream Processing - O_0LAOhEkqv_jyjrAAAD] Finished. Length: 1161
[2025-05-13T05:27:34.582Z] [O_0L-1747114049015 O_0LAOhEkqv_jyjrAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:27:34.583Z] [O_0L-1747114049015 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:27:34.583Z] --- [O_0L-1747114049015 O_0LAOhEkqv_jyjrAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:27:34.583Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:27:34.670Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:27:34.670Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:27:34.671Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:27:34.928Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:27:34.928Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114049015][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:28:41.752Z] [SERVER SOCKET O_0LAOhEkqv_jyjrAAAD - ON ANY] Event: send_message, Args: [{"userInput":"hội nghị về Trí tuệ nhân tạo","isStreaming":true,"language":"vi","conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:28:41.752Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752] Request received. UserInput: "hội nghị về Trí tuệ nhân tạo", Streaming: true, Language: vi, PayloadConvId: 6822d84170e914a127e551bf, SocketDataConvId: 6822d84170e914a127e551bf
[2025-05-13T05:28:41.753Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Using conversationId from payload.
[2025-05-13T05:28:41.816Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 4
[2025-05-13T05:28:41.816Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:28:41.816Z] --- [O_0L-1747114121752 Socket O_0LAOhEkqv_jyjrAAAD] Handling STREAMING input: "hội nghị về Trí tuệ nhân tạo", Lang: vi ---
[2025-05-13T05:28:41.817Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:28:41.817Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:28:41.818Z] --- [O_0L-1747114121752 HostAgent Streaming Turn 1 Start - O_0LAOhEkqv_jyjrAAAD] ---
[2025-05-13T05:28:41.818Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:28:41.819Z] [O_0L-1747114121752 History T1 Send - O_0LAOhEkqv_jyjrAAAD] Host History Size: 5
[2025-05-13T05:28:41.819Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T05:28:41.819Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T05:28:41.820Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:28:41.820Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:28:41.820Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:28:41.821Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:28:41.821Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:28:41.821Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T05:28:41.822Z]   - No valid next turn added, sending only history.
[2025-05-13T05:28:42.759Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:28:42.759Z] [O_0L-1747114121752 HostAgent Streaming T1 - O_0LAOhEkqv_jyjrAAAD] Requests function: routeToAgent
[2025-05-13T05:28:42.760Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:28:42.760Z] --- [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 Socket O_0LAOhEkqv_jyjrAAAD] Calling Sub Agent: ConferenceAgent, Task: 560ec2ca-4792-4ba5-8681-fec6b2902449 ---
[2025-05-13T05:28:42.760Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T05:28:42.761Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:28:42.761Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:28:42.761Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:28:42.762Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:28:42.762Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:28:42.762Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:28:42.762Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:28:42.763Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:28:42.763Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:28:42.763Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:28:42.764Z]   - No valid next turn added, sending only history.
[2025-05-13T05:28:43.637Z] Model Finish Reason: STOP
[2025-05-13T05:28:43.638Z] Model requested function call: getConferences
[2025-05-13T05:28:43.638Z] Arguments: {"searchQuery":"topics=Trí+tuệ+nhân+tạo&perPage=5&page=1"}
[2025-05-13T05:28:43.638Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:28:43.638Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760] ConferenceAgent requests function call: getConferences
[2025-05-13T05:28:43.638Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:28:43.639Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:28:43.639Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:28:43.640Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:28:43.640Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Trí+tuệ+nhân+tạo&perPage=5&page=1"}
[2025-05-13T05:28:43.640Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:28:43.640Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:28:43.641Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:28:43.641Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:28:43.641Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:28:43.642Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:28:43.642Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Trí+tuệ+nhân+tạo&perPage=5&page=1}
[2025-05-13T05:28:44.333Z] [BackendService] [conference] API Success (200). Data length: 108. Attempting parsing...
[2025-05-13T05:28:44.333Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":5,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T05:28:44.333Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:28:44.333Z] Transforming conference data with Markdown. Search query: topics=Trí+tuệ+nhân+tạo&perPage=5&page=1
[2025-05-13T05:28:44.334Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T05:28:44.334Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Trí+tuệ+nhân+tạo&perPage=5&page=1"
[2025-05-13T05:28:44.335Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:28:44.335Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:28:44.335Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:28:44.336Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:28:44.336Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:28:44.336Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:28:44.337Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:28:44.337Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:28:44.337Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:28:44.338Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 O_0LAOhEkqv_jyjrAAAD Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:28:44.338Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:28:44.338Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:28:44.339Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Thought Added - O_0LAOhEkqv_jyjrAAAD] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:28:44.339Z] [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760 SubAgent Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:28:44.339Z] --- [O_0L-1747114121752-Sub-ConferenceAgent-1747114122760] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:28:44.339Z] [O_0L-1747114121752 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:28:44.340Z] --- [O_0L-1747114121752 HostAgent Streaming Turn 2 Start - O_0LAOhEkqv_jyjrAAAD] ---
[2025-05-13T05:28:44.340Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:28:44.340Z] [O_0L-1747114121752 History T2 Send - O_0LAOhEkqv_jyjrAAAD] Host History Size: 7
[2025-05-13T05:28:44.340Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T05:28:44.341Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T05:28:44.341Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:28:44.341Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:28:44.341Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:28:44.341Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:28:44.342Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:28:44.342Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T05:28:44.342Z]   - No valid next turn added, sending only history.
[2025-05-13T05:28:45.025Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:28:45.026Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:28:45.026Z] [O_0L-1747114121752 Stream Processing - O_0LAOhEkqv_jyjrAAAD] Starting...
[2025-05-13T05:28:45.027Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:28:45.027Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:28:45.119Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:28:45.124Z] [O_0L-1747114121752 Stream Processing - O_0LAOhEkqv_jyjrAAAD] Finished. Length: 48
[2025-05-13T05:28:45.125Z] [O_0L-1747114121752 O_0LAOhEkqv_jyjrAAAD] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:28:45.125Z] [O_0L-1747114121752 Streaming Emit Sent - O_0LAOhEkqv_jyjrAAAD] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:28:45.126Z] --- [O_0L-1747114121752 O_0LAOhEkqv_jyjrAAAD Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:28:45.126Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T05:28:45.206Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:28:45.206Z] [DEBUG] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:28:45.206Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:28:45.452Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:28:45.452Z] [INFO] [coreHandlers][O_0LAOhEkqv_jyjrAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:O_0L-1747114121752][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:29:56.716Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T05:29:56.717Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:29:57.115Z] [MainLoader] Starting application loading process...
[2025-05-13T05:29:57.118Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T05:29:57.119Z] [Database] Attempting MongoDB connection...
[2025-05-13T05:29:58.016Z] [Database] MongoDB Connected Successfully.
[2025-05-13T05:29:58.017Z] [DatabaseLoader] Database connection successful.
[2025-05-13T05:29:58.017Z] [MainLoader] Database loaded.
[2025-05-13T05:29:58.018Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T05:29:58.018Z] [ExpressLoader] Configuring Express app...
[2025-05-13T05:29:58.026Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T05:29:58.030Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T05:29:58.030Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T05:29:58.030Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T05:29:58.031Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T05:29:58.032Z] [MainLoader] Express loaded.
[2025-05-13T05:29:58.033Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T05:29:58.037Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T05:29:58.038Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T05:29:58.038Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T05:29:58.039Z] [MainLoader] Socket.IO loaded.
[2025-05-13T05:29:58.039Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T05:29:58.093Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T05:29:58.095Z] [MainLoader] Jobs scheduled.
[2025-05-13T05:29:58.096Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T05:29:58.169Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T05:29:58.169Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T05:30:02.817Z] [socketAuth][nqZW1LajQPiZPvsIAAAB] Authentication attempt. Has token: true
[2025-05-13T05:30:02.821Z] [socketAuth][nqZW1LajQPiZPvsIAAAB] Token signature validated successfully.
[2025-05-13T05:30:02.824Z] [HistoryService] Initialized.
[2025-05-13T05:30:02.824Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB] New connection. Socket ID: nqZW1LajQPiZPvsIAAAB. Initial socket.data.userId: null
[2025-05-13T05:30:02.824Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T05:30:02.825Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB] Attempting to fetch user info using token...
[2025-05-13T05:30:02.825Z] [API Client] Attempting to fetch user info.
[2025-05-13T05:30:02.826Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T05:30:03.517Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T05:30:03.517Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T05:30:03.518Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T05:30:03.519Z] [HistoryService] Initialized.
[2025-05-13T05:30:03.520Z] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T05:30:03.520Z] [INFO] Core event handlers successfully registered.
[2025-05-13T05:30:03.520Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:30:03.521Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T05:30:03.523Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T05:30:03.523Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:30:03.577Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T05:30:03.846Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:30:03.847Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 10
[2025-05-13T05:30:03.847Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T05:30:03.848Z] [SERVER GLOBAL][connection][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T05:32:04.336Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822bd7ac7d7891bd8295939"}]
[2025-05-13T05:32:04.340Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822bd7ac7d7891bd8295939"}
[2025-05-13T05:32:04.340Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822bd7ac7d7891bd8295939] Request received.
[2025-05-13T05:32:04.505Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822bd7ac7d7891bd8295939] Sent history. Set as active conversation. Message Count: 10
[2025-05-13T05:32:08.720Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:32:08.722Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822d84170e914a127e551bf"}
[2025-05-13T05:32:08.722Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Request received.
[2025-05-13T05:32:08.792Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Sent history. Set as active conversation. Message Count: 4
[2025-05-13T05:32:12.988Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:32:12.989Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Request received.
[2025-05-13T05:32:13.080Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Successfully processed message clearing.
[2025-05-13T05:32:13.080Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Cleared conversation was active. Emitting empty history.
[2025-05-13T05:32:13.081Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822d84170e914a127e551bf
[2025-05-13T05:32:13.082Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:32:13.289Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:32:13.290Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822d84170e914a127e551bf, Count: 10
[2025-05-13T05:32:16.045Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"hội nghị về Trí tuệ nhân tạo","isStreaming":true,"language":"vi","conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:32:16.046Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046] Request received. UserInput: "hội nghị về Trí tuệ nhân tạo", Streaming: true, Language: vi, PayloadConvId: 6822d84170e914a127e551bf, SocketDataConvId: 6822d84170e914a127e551bf
[2025-05-13T05:32:16.046Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Using conversationId from payload.
[2025-05-13T05:32:16.113Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 0
[2025-05-13T05:32:16.113Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:32:16.115Z] --- [nqZW-1747114336046 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "hội nghị về Trí tuệ nhân tạo", Lang: vi ---
[2025-05-13T05:32:16.116Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T05:32:16.118Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:32:16.118Z] --- [nqZW-1747114336046 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:32:16.119Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:32:16.119Z] [nqZW-1747114336046 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 1
[2025-05-13T05:32:16.121Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:32:16.121Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:32:16.122Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:32:16.122Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:32:16.123Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:32:16.125Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:32:16.126Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:32:16.127Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:32:16.127Z]   - No valid next turn added, sending only history.
[2025-05-13T05:32:17.163Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T05:32:17.163Z] [nqZW-1747114336046 HostAgent Streaming T1 - nqZW1LajQPiZPvsIAAAB] Requests function: routeToAgent
[2025-05-13T05:32:17.164Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:32:17.167Z] --- [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 Socket nqZW1LajQPiZPvsIAAAB] Calling Sub Agent: ConferenceAgent, Task: 0fbf37ef-b66a-4060-aa63-478ca3c08a59 ---
[2025-05-13T05:32:17.167Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T05:32:17.168Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T05:32:17.168Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T05:32:17.170Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T05:32:17.170Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T05:32:17.170Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:32:17.170Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:32:17.171Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:32:17.171Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T05:32:17.171Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:32:17.172Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T05:32:17.172Z]   - No valid next turn added, sending only history.
[2025-05-13T05:32:18.105Z] Model Finish Reason: STOP
[2025-05-13T05:32:18.106Z] Model requested function call: getConferences
[2025-05-13T05:32:18.106Z] Arguments: {"searchQuery":"topics=Artificial+Intelligence&perPage=5&page=1"}
[2025-05-13T05:32:18.106Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T05:32:18.106Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167] ConferenceAgent requests function call: getConferences
[2025-05-13T05:32:18.107Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T05:32:18.108Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T05:32:18.108Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T05:32:18.109Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T05:32:18.110Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Artificial+Intelligence&perPage=5&page=1"}
[2025-05-13T05:32:18.110Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:32:18.111Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T05:32:18.111Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T05:32:18.111Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:32:18.111Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T05:32:18.112Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T05:32:18.113Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Artificial+Intelligence&perPage=5&page=1}
[2025-05-13T05:32:18.895Z] [BackendService] [conference] API Success (200). Data length: 7919. Attempting parsing...
[2025-05-13T05:32:18.896Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0355e308-1f83-447f-84da-7893b97a6af6","title":"International Conference on Scientific and Statistical Data Base Management","acronym":"SSDBM","location":{"cityStateProvince":"Columbus, Ohio","country":"United States","address":"Pom...
[2025-05-13T05:32:18.896Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T05:32:18.897Z] Transforming conference data with Markdown. Search query: topics=Artificial+Intelligence&perPage=5&page=1
[2025-05-13T05:32:18.906Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 116
- **Total page:** 24
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Scientific and Statistical Data B...
[2025-05-13T05:32:18.906Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Artificial+Intelligence&perPage=5&page=1"
[2025-05-13T05:32:18.906Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:32:18.906Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T05:32:18.907Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T05:32:18.907Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:32:18.908Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T05:32:18.908Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T05:32:18.908Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:32:18.909Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T05:32:18.909Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T05:32:18.909Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 nqZW1LajQPiZPvsIAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T05:32:18.910Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T05:32:18.910Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T05:32:18.910Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Thought Added - nqZW1LajQPiZPvsIAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T05:32:18.911Z] [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167 SubAgent Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T05:32:18.911Z] --- [nqZW-1747114336046-Sub-ConferenceAgent-1747114337167] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T05:32:18.911Z] [nqZW-1747114336046 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T05:32:18.912Z] --- [nqZW-1747114336046 HostAgent Streaming Turn 2 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:32:18.912Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:32:18.912Z] [nqZW-1747114336046 History T2 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 3
[2025-05-13T05:32:18.913Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:32:18.913Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:32:18.913Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T05:32:18.913Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:32:18.914Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:32:18.914Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:32:18.922Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:32:18.922Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:32:18.923Z]   - No valid next turn added, sending only history.
[2025-05-13T05:32:19.603Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:32:19.604Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:32:19.604Z] [nqZW-1747114336046 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:32:19.605Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:32:19.606Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:32:19.735Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:32:19.797Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:32:19.996Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:32:20.125Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:32:20.389Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:32:20.394Z] [nqZW-1747114336046 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 563
[2025-05-13T05:32:20.395Z] [nqZW-1747114336046 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T05:32:20.395Z] [nqZW-1747114336046 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:32:20.396Z] --- [nqZW-1747114336046 nqZW1LajQPiZPvsIAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:32:20.396Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:32:20.491Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:32:20.491Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:32:20.492Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:32:20.774Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:32:20.775Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747114336046][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:51:54.214Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Bạn là ai","isStreaming":true,"language":"zh","conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:51:54.215Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215] Request received. UserInput: "Bạn là ai", Streaming: true, Language: zh, PayloadConvId: 6822d84170e914a127e551bf, SocketDataConvId: 6822d84170e914a127e551bf
[2025-05-13T05:51:54.215Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Using conversationId from payload.
[2025-05-13T05:51:54.295Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 4
[2025-05-13T05:51:54.296Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:51:54.296Z] --- [nqZW-1747115514215 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "Bạn là ai", Lang: zh ---
[2025-05-13T05:51:54.296Z] [Language Config] Using configuration for Agent: HostAgent, Language: zh
[2025-05-13T05:51:54.297Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:51:54.297Z] --- [nqZW-1747115514215 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:51:54.298Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:51:54.298Z] [nqZW-1747115514215 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 5
[2025-05-13T05:51:54.298Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T05:51:54.299Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T05:51:54.299Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:51:54.299Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:51:54.300Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:51:54.300Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:51:54.300Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:51:54.300Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T05:51:54.300Z]   - No valid next turn added, sending only history.
[2025-05-13T05:51:56.091Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:51:56.092Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:51:56.092Z] [nqZW-1747115514215 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:51:56.093Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:51:56.094Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:51:56.213Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:51:56.347Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:51:56.518Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:51:56.544Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:51:56.552Z] [nqZW-1747115514215 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 278
[2025-05-13T05:51:56.553Z] [nqZW-1747115514215 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:51:56.554Z] [nqZW-1747115514215 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:51:56.554Z] --- [nqZW-1747115514215 nqZW1LajQPiZPvsIAAAB Lang: zh] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:51:56.554Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T05:51:56.699Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:51:56.699Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:51:56.700Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:51:56.977Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:51:56.978Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115514215][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:52:04.459Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"oke","isStreaming":true,"language":"zh","conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:52:04.460Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460] Request received. UserInput: "oke", Streaming: true, Language: zh, PayloadConvId: 6822d84170e914a127e551bf, SocketDataConvId: 6822d84170e914a127e551bf
[2025-05-13T05:52:04.460Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Using conversationId from payload.
[2025-05-13T05:52:04.528Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 6
[2025-05-13T05:52:04.528Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:52:04.528Z] --- [nqZW-1747115524460 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "oke", Lang: zh ---
[2025-05-13T05:52:04.529Z] [Language Config] Using configuration for Agent: HostAgent, Language: zh
[2025-05-13T05:52:04.529Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:04.530Z] --- [nqZW-1747115524460 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:52:04.530Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:04.530Z] [nqZW-1747115524460 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 7
[2025-05-13T05:52:04.530Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T05:52:04.531Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T05:52:04.531Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:52:04.531Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:52:04.531Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:52:04.533Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:52:04.533Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:52:04.534Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T05:52:04.534Z]   - No valid next turn added, sending only history.
[2025-05-13T05:52:06.218Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:52:06.219Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:06.219Z] [nqZW-1747115524460 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:52:06.220Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:06.220Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:06.296Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:06.316Z] [nqZW-1747115524460 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 28
[2025-05-13T05:52:06.317Z] [nqZW-1747115524460 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:52:06.318Z] [nqZW-1747115524460 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:52:06.318Z] --- [nqZW-1747115524460 nqZW1LajQPiZPvsIAAAB Lang: zh] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:52:06.318Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T05:52:06.392Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:52:06.392Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:52:06.392Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:52:06.717Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:52:06.718Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115524460][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:52:15.265Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:52:15.266Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Request received.
[2025-05-13T05:52:15.336Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Successfully processed message clearing.
[2025-05-13T05:52:15.336Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Cleared conversation was active. Emitting empty history.
[2025-05-13T05:52:15.337Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822d84170e914a127e551bf
[2025-05-13T05:52:15.337Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:52:15.546Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:52:15.547Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822d84170e914a127e551bf, Count: 10
[2025-05-13T05:52:19.130Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Bạn là ai","isStreaming":true,"language":"zh","conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:52:19.131Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131] Request received. UserInput: "Bạn là ai", Streaming: true, Language: zh, PayloadConvId: 6822d84170e914a127e551bf, SocketDataConvId: 6822d84170e914a127e551bf
[2025-05-13T05:52:19.131Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Using conversationId from payload.
[2025-05-13T05:52:19.195Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 0
[2025-05-13T05:52:19.196Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:52:19.196Z] --- [nqZW-1747115539131 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "Bạn là ai", Lang: zh ---
[2025-05-13T05:52:19.196Z] [Language Config] Using configuration for Agent: HostAgent, Language: zh
[2025-05-13T05:52:19.197Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:19.197Z] --- [nqZW-1747115539131 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:52:19.197Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:19.199Z] [nqZW-1747115539131 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 1
[2025-05-13T05:52:19.200Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:52:19.200Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:52:19.200Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:52:19.200Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:52:19.201Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:52:19.201Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:52:19.201Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:52:19.201Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:52:19.201Z]   - No valid next turn added, sending only history.
[2025-05-13T05:52:20.752Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:52:20.753Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:20.753Z] [nqZW-1747115539131 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:52:20.754Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:20.754Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:20.862Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:20.871Z] [nqZW-1747115539131 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 24
[2025-05-13T05:52:20.871Z] [nqZW-1747115539131 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:52:20.872Z] [nqZW-1747115539131 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:52:20.872Z] --- [nqZW-1747115539131 nqZW1LajQPiZPvsIAAAB Lang: zh] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:52:20.873Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T05:52:20.945Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:52:20.945Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:52:20.945Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:52:21.153Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:52:21.154Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115539131][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:52:40.890Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"bạn có thể làm gì","isStreaming":true,"language":"zh","conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:52:40.891Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891] Request received. UserInput: "bạn có thể làm gì", Streaming: true, Language: zh, PayloadConvId: 6822d84170e914a127e551bf, SocketDataConvId: 6822d84170e914a127e551bf
[2025-05-13T05:52:40.891Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Using conversationId from payload.
[2025-05-13T05:52:40.958Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Fetched current history. Count: 2
[2025-05-13T05:52:40.959Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Calling streaming intent handler.
[2025-05-13T05:52:40.959Z] --- [nqZW-1747115560891 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "bạn có thể làm gì", Lang: zh ---
[2025-05-13T05:52:40.959Z] [Language Config] Using configuration for Agent: HostAgent, Language: zh
[2025-05-13T05:52:40.960Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:40.960Z] --- [nqZW-1747115560891 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:52:40.960Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:40.961Z] [nqZW-1747115560891 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 3
[2025-05-13T05:52:40.961Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T05:52:40.961Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T05:52:40.966Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:52:40.968Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:52:40.969Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:52:40.973Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:52:40.973Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:52:40.975Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T05:52:40.975Z]   - No valid next turn added, sending only history.
[2025-05-13T05:52:42.583Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:52:42.584Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:42.584Z] [nqZW-1747115560891 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:52:42.585Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:52:42.585Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:42.746Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:42.860Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:43.127Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:43.345Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:52:43.348Z] [nqZW-1747115560891 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 157
[2025-05-13T05:52:43.348Z] [nqZW-1747115560891 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:52:43.349Z] [nqZW-1747115560891 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:52:43.349Z] --- [nqZW-1747115560891 nqZW1LajQPiZPvsIAAAB Lang: zh] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:52:43.349Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T05:52:43.442Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Successfully updated history in DB.
[2025-05-13T05:52:43.442Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:52:43.442Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:52:43.637Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:52:43.638Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115560891][Conv:6822d84170e914a127e551bf] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:53:48.470Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822d84170e914a127e551bf"}]
[2025-05-13T05:53:48.472Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Request received.
[2025-05-13T05:53:48.543Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Successfully processed deletion.
[2025-05-13T05:53:48.544Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822d84170e914a127e551bf] Deleted conversation was active. Clearing active ID.
[2025-05-13T05:53:48.544Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822d84170e914a127e551bf
[2025-05-13T05:53:48.544Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:53:48.775Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 9 conversations.
[2025-05-13T05:53:48.776Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822d84170e914a127e551bf, Count: 9
[2025-05-13T05:53:58.414Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Who are you ?","isStreaming":true,"language":"zh","conversationId":null}]
[2025-05-13T05:53:58.415Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415] Request received. UserInput: "Who are you ?", Streaming: true, Language: zh, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T05:53:58.415Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T05:53:58.574Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T05:53:58.574Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T05:53:58.575Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:53:58.777Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:53:58.778Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Emitted updated conversation list. Reason: new conversation from send_message, Count: 10
[2025-05-13T05:53:58.844Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Fetched current history. Count: 0
[2025-05-13T05:53:58.845Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Calling streaming intent handler.
[2025-05-13T05:53:58.845Z] --- [nqZW-1747115638415 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "Who are you ?", Lang: zh ---
[2025-05-13T05:53:58.845Z] [Language Config] Using configuration for Agent: HostAgent, Language: zh
[2025-05-13T05:53:58.846Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:53:58.846Z] --- [nqZW-1747115638415 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:53:58.846Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:53:58.847Z] [nqZW-1747115638415 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 1
[2025-05-13T05:53:58.847Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:53:58.847Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:53:58.847Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:53:58.847Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:53:58.847Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:53:58.848Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:53:58.848Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:53:58.848Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:53:58.848Z]   - No valid next turn added, sending only history.
[2025-05-13T05:53:59.492Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:53:59.492Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:53:59.493Z] [nqZW-1747115638415 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:53:59.493Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:53:59.493Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:53:59.563Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:53:59.568Z] [nqZW-1747115638415 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 23
[2025-05-13T05:53:59.569Z] [nqZW-1747115638415 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:53:59.569Z] [nqZW-1747115638415 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:53:59.570Z] --- [nqZW-1747115638415 nqZW1LajQPiZPvsIAAAB Lang: zh] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:53:59.570Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T05:53:59.640Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Successfully updated history in DB.
[2025-05-13T05:53:59.641Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:53:59.641Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:53:59.840Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:53:59.841Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115638415][Conv:6822de763544885a205a52be] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T05:54:24.649Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822de763544885a205a52be"}]
[2025-05-13T05:54:24.650Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Request received.
[2025-05-13T05:54:24.723Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Successfully processed message clearing.
[2025-05-13T05:54:24.724Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Cleared conversation was active. Emitting empty history.
[2025-05-13T05:54:24.724Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822de763544885a205a52be
[2025-05-13T05:54:24.724Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:54:24.929Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:54:24.930Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822de763544885a205a52be, Count: 10
[2025-05-13T05:54:32.793Z] [SERVER SOCKET nqZW1LajQPiZPvsIAAAB - ON ANY] Event: send_message, Args: [{"userInput":"bạn là ai","isStreaming":true,"language":"en","conversationId":"6822de763544885a205a52be"}]
[2025-05-13T05:54:32.793Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793] Request received. UserInput: "bạn là ai", Streaming: true, Language: en, PayloadConvId: 6822de763544885a205a52be, SocketDataConvId: 6822de763544885a205a52be
[2025-05-13T05:54:32.794Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Using conversationId from payload.
[2025-05-13T05:54:32.860Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Fetched current history. Count: 0
[2025-05-13T05:54:32.860Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Calling streaming intent handler.
[2025-05-13T05:54:32.861Z] --- [nqZW-1747115672793 Socket nqZW1LajQPiZPvsIAAAB] Handling STREAMING input: "bạn là ai", Lang: en ---
[2025-05-13T05:54:32.861Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T05:54:32.861Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:54:32.862Z] --- [nqZW-1747115672793 HostAgent Streaming Turn 1 Start - nqZW1LajQPiZPvsIAAAB] ---
[2025-05-13T05:54:32.862Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:54:32.862Z] [nqZW-1747115672793 History T1 Send - nqZW1LajQPiZPvsIAAAB] Host History Size: 1
[2025-05-13T05:54:32.863Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T05:54:32.863Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T05:54:32.863Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T05:54:32.863Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T05:54:32.864Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T05:54:32.864Z] Tools provided: ["routeToAgent"]
[2025-05-13T05:54:32.864Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T05:54:32.864Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T05:54:32.865Z]   - No valid next turn added, sending only history.
[2025-05-13T05:54:33.475Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T05:54:33.475Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:54:33.476Z] [nqZW-1747115672793 Stream Processing - nqZW1LajQPiZPvsIAAAB] Starting...
[2025-05-13T05:54:33.476Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T05:54:33.476Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:54:33.556Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:54:33.587Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T05:54:33.590Z] [nqZW-1747115672793 Stream Processing - nqZW1LajQPiZPvsIAAAB] Finished. Length: 106
[2025-05-13T05:54:33.591Z] [nqZW-1747115672793 nqZW1LajQPiZPvsIAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T05:54:33.592Z] [nqZW-1747115672793 Streaming Emit Sent - nqZW1LajQPiZPvsIAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T05:54:33.592Z] --- [nqZW-1747115672793 nqZW1LajQPiZPvsIAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T05:54:33.592Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T05:54:33.663Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Successfully updated history in DB.
[2025-05-13T05:54:33.663Z] [DEBUG] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T05:54:33.663Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T05:54:33.877Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T05:54:33.878Z] [INFO] [coreHandlers][nqZW1LajQPiZPvsIAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:nqZW-1747115672793][Conv:6822de763544885a205a52be] Emitted updated conversation list. Reason: message saved, Count: 10
[2025-05-13T06:12:53.602Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:12:53.602Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:12:54.167Z] [MainLoader] Starting application loading process...
[2025-05-13T06:12:54.168Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:12:54.169Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:12:55.067Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:12:55.068Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:12:55.068Z] [MainLoader] Database loaded.
[2025-05-13T06:12:55.068Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:12:55.069Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:12:55.075Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:12:55.078Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:12:55.079Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:12:55.079Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:12:55.079Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:12:55.081Z] [MainLoader] Express loaded.
[2025-05-13T06:12:55.081Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:12:55.087Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:12:55.087Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:12:55.088Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:12:55.089Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:12:55.089Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:12:55.139Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:12:55.139Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:12:55.139Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:12:55.196Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:12:55.196Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:12:58.811Z] [socketAuth][IEo-VAr-ig0dy1RWAAAB] Authentication attempt. Has token: true
[2025-05-13T06:12:58.815Z] [socketAuth][IEo-VAr-ig0dy1RWAAAB] Token signature validated successfully.
[2025-05-13T06:12:58.818Z] [HistoryService] Initialized.
[2025-05-13T06:12:58.818Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB] New connection. Socket ID: IEo-VAr-ig0dy1RWAAAB. Initial socket.data.userId: null
[2025-05-13T06:12:58.819Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:12:58.819Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB] Attempting to fetch user info using token...
[2025-05-13T06:12:58.820Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:12:58.820Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:12:59.501Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:12:59.502Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:12:59.502Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:12:59.504Z] [HistoryService] Initialized.
[2025-05-13T06:12:59.504Z] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:12:59.504Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:12:59.504Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:12:59.505Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:12:59.506Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:12:59.507Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:12:59.544Z] [SERVER SOCKET IEo-VAr-ig0dy1RWAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:12:59.795Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:12:59.796Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T06:12:59.796Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:12:59.797Z] [SERVER GLOBAL][connection][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:13:06.971Z] [SERVER SOCKET IEo-VAr-ig0dy1RWAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822df6663e80435401c9b4b"}]
[2025-05-13T06:13:06.974Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822df6663e80435401c9b4b"}
[2025-05-13T06:13:06.975Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822df6663e80435401c9b4b] Request received.
[2025-05-13T06:13:07.067Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822df6663e80435401c9b4b] Sent history. Set as active conversation. Message Count: 4
[2025-05-13T06:13:08.036Z] [SERVER SOCKET IEo-VAr-ig0dy1RWAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822de763544885a205a52be"}]
[2025-05-13T06:13:08.042Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822de763544885a205a52be"}
[2025-05-13T06:13:08.042Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Request received.
[2025-05-13T06:13:08.108Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T06:13:11.264Z] [SERVER SOCKET IEo-VAr-ig0dy1RWAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822de763544885a205a52be"}]
[2025-05-13T06:13:11.264Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Request received.
[2025-05-13T06:13:11.333Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Successfully processed deletion.
[2025-05-13T06:13:11.334Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822de763544885a205a52be] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:13:11.335Z] [DEBUG] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822de763544885a205a52be
[2025-05-13T06:13:11.335Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:13:11.580Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 10 conversations.
[2025-05-13T06:13:11.582Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822de763544885a205a52be, Count: 10
[2025-05-13T06:13:15.318Z] [SERVER SOCKET IEo-VAr-ig0dy1RWAAAB - ON ANY] Event: send_message, Args: [{"userInput":"I want to report a problem.","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T06:13:15.319Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319] Request received. UserInput: "I want to report a problem.", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:13:15.320Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:13:15.476Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:13:15.478Z] [DEBUG] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:13:15.478Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:13:15.732Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:13:15.734Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Emitted updated conversation list. Reason: new conversation from send_message, Count: 11
[2025-05-13T06:13:15.796Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Fetched current history. Count: 0
[2025-05-13T06:13:15.796Z] [DEBUG] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Calling streaming intent handler.
[2025-05-13T06:13:15.798Z] --- [IEo--1747116795319 Socket IEo-VAr-ig0dy1RWAAAB] Handling STREAMING input: "I want to report a problem.", Lang: en ---
[2025-05-13T06:13:15.798Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:13:15.799Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:15.799Z] --- [IEo--1747116795319 HostAgent Streaming Turn 1 Start - IEo-VAr-ig0dy1RWAAAB] ---
[2025-05-13T06:13:15.800Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:15.800Z] [IEo--1747116795319 History T1 Send - IEo-VAr-ig0dy1RWAAAB] Host History Size: 1
[2025-05-13T06:13:15.801Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:13:15.801Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:13:15.802Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:13:15.802Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:13:15.802Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:13:15.802Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:13:15.802Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:13:15.802Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:13:15.803Z]   - No valid next turn added, sending only history.
[2025-05-13T06:13:17.472Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:13:17.473Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:17.473Z] [IEo--1747116795319 Stream Processing - IEo-VAr-ig0dy1RWAAAB] Starting...
[2025-05-13T06:13:17.474Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:17.476Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:17.588Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:17.666Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:17.843Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:17.849Z] [IEo--1747116795319 Stream Processing - IEo-VAr-ig0dy1RWAAAB] Finished. Length: 220
[2025-05-13T06:13:17.850Z] [IEo--1747116795319 IEo-VAr-ig0dy1RWAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:13:17.850Z] [IEo--1747116795319 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:13:17.851Z] --- [IEo--1747116795319 IEo-VAr-ig0dy1RWAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:13:17.851Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T06:13:17.932Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Successfully updated history in DB.
[2025-05-13T06:13:17.933Z] [DEBUG] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:13:17.933Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:13:18.188Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:13:18.188Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116795319][Conv:6822e2fb977aa7fe353aabac] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T06:13:36.815Z] [SERVER SOCKET IEo-VAr-ig0dy1RWAAAB - ON ANY] Event: send_message, Args: [{"userInput":"suggest full email for me","isStreaming":true,"language":"en","conversationId":"6822e2fb977aa7fe353aabac"}]
[2025-05-13T06:13:36.815Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815] Request received. UserInput: "suggest full email for me", Streaming: true, Language: en, PayloadConvId: 6822e2fb977aa7fe353aabac, SocketDataConvId: 6822e2fb977aa7fe353aabac
[2025-05-13T06:13:36.816Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Using conversationId from payload.
[2025-05-13T06:13:36.879Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Fetched current history. Count: 2
[2025-05-13T06:13:36.879Z] [DEBUG] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Calling streaming intent handler.
[2025-05-13T06:13:36.879Z] --- [IEo--1747116816815 Socket IEo-VAr-ig0dy1RWAAAB] Handling STREAMING input: "suggest full email for me", Lang: en ---
[2025-05-13T06:13:36.880Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:13:36.880Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:36.881Z] --- [IEo--1747116816815 HostAgent Streaming Turn 1 Start - IEo-VAr-ig0dy1RWAAAB] ---
[2025-05-13T06:13:36.881Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:36.881Z] [IEo--1747116816815 History T1 Send - IEo-VAr-ig0dy1RWAAAB] Host History Size: 3
[2025-05-13T06:13:36.882Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:13:36.882Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:13:36.882Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:13:36.883Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:13:36.883Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:13:36.883Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:13:36.883Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:13:36.883Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:13:36.884Z]   - No valid next turn added, sending only history.
[2025-05-13T06:13:37.562Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:13:37.562Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:37.563Z] [IEo--1747116816815 Stream Processing - IEo-VAr-ig0dy1RWAAAB] Starting...
[2025-05-13T06:13:37.563Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:13:37.563Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:37.728Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:37.730Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:37.741Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:13:37.744Z] [IEo--1747116816815 Stream Processing - IEo-VAr-ig0dy1RWAAAB] Finished. Length: 180
[2025-05-13T06:13:37.744Z] [IEo--1747116816815 IEo-VAr-ig0dy1RWAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:13:37.745Z] [IEo--1747116816815 Streaming Emit Sent - IEo-VAr-ig0dy1RWAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:13:37.745Z] --- [IEo--1747116816815 IEo-VAr-ig0dy1RWAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:13:37.745Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:13:37.817Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Successfully updated history in DB.
[2025-05-13T06:13:37.817Z] [DEBUG] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:13:37.817Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:13:38.069Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:13:38.069Z] [INFO] [coreHandlers][IEo-VAr-ig0dy1RWAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:IEo--1747116816815][Conv:6822e2fb977aa7fe353aabac] Emitted updated conversation list. Reason: message saved, Count: 11
[2025-05-13T06:15:14.591Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:15:14.592Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:15:14.963Z] [MainLoader] Starting application loading process...
[2025-05-13T06:15:14.963Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:15:14.964Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:15:15.813Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:15:15.814Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:15:15.814Z] [MainLoader] Database loaded.
[2025-05-13T06:15:15.814Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:15:15.815Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:15:15.820Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:15:15.822Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:15:15.823Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:15:15.823Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:15:15.823Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:15:15.824Z] [MainLoader] Express loaded.
[2025-05-13T06:15:15.825Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:15:15.829Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:15:15.829Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:15:15.830Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:15:15.830Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:15:15.830Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:15:15.866Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:15:15.867Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:15:15.867Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:15:15.934Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:15:15.934Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:15:16.326Z] [socketAuth][oFCzAH0WNF8v7pchAAAB] Authentication attempt. Has token: true
[2025-05-13T06:15:16.330Z] [socketAuth][oFCzAH0WNF8v7pchAAAB] Token signature validated successfully.
[2025-05-13T06:15:16.333Z] [HistoryService] Initialized.
[2025-05-13T06:15:16.333Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB] New connection. Socket ID: oFCzAH0WNF8v7pchAAAB. Initial socket.data.userId: null
[2025-05-13T06:15:16.334Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:15:16.334Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB] Attempting to fetch user info using token...
[2025-05-13T06:15:16.335Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:15:16.335Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:15:17.038Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:15:17.038Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:15:17.039Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:15:17.042Z] [HistoryService] Initialized.
[2025-05-13T06:15:17.043Z] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:15:17.043Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:15:17.043Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:15:17.044Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:15:17.047Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:15:17.048Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:15:17.104Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:15:17.356Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:15:17.358Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 11
[2025-05-13T06:15:17.358Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:15:17.358Z] [SERVER GLOBAL][connection][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:15:19.544Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822df6663e80435401c9b4b"}]
[2025-05-13T06:15:19.549Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822df6663e80435401c9b4b"}
[2025-05-13T06:15:19.550Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822df6663e80435401c9b4b] Request received.
[2025-05-13T06:15:19.651Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822df6663e80435401c9b4b] Sent history. Set as active conversation. Message Count: 4
[2025-05-13T06:15:20.817Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e2fb977aa7fe353aabac"}]
[2025-05-13T06:15:20.819Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e2fb977aa7fe353aabac"}
[2025-05-13T06:15:20.819Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Request received.
[2025-05-13T06:15:20.892Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Sent history. Set as active conversation. Message Count: 4
[2025-05-13T06:15:23.476Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822e2fb977aa7fe353aabac"}]
[2025-05-13T06:15:23.478Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Request received.
[2025-05-13T06:15:23.566Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Successfully processed message clearing.
[2025-05-13T06:15:23.568Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Cleared conversation was active. Emitting empty history.
[2025-05-13T06:15:23.568Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822e2fb977aa7fe353aabac
[2025-05-13T06:15:23.569Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:15:23.849Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:15:23.850Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822e2fb977aa7fe353aabac, Count: 11
[2025-05-13T06:15:38.280Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: start_new_conversation, Args: [{}]
[2025-05-13T06:15:38.281Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Request received.
[2025-05-13T06:15:38.436Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Emitting 'new_conversation_started'.
[2025-05-13T06:15:38.437Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Started new conversation. Set as active.
[2025-05-13T06:15:38.437Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: new conversation started
[2025-05-13T06:15:38.437Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:15:38.687Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:15:38.687Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: new conversation started, Count: 12
[2025-05-13T06:15:39.790Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e2fb977aa7fe353aabac"}]
[2025-05-13T06:15:39.792Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e2fb977aa7fe353aabac"}
[2025-05-13T06:15:39.792Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Request received.
[2025-05-13T06:15:39.856Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Sent history. Set as active conversation. Message Count: 0
[2025-05-13T06:15:40.736Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e38a51d6adb22756a00f"}]
[2025-05-13T06:15:40.739Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e38a51d6adb22756a00f"}
[2025-05-13T06:15:40.739Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Request received.
[2025-05-13T06:15:40.803Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Sent history. Set as active conversation. Message Count: 0
[2025-05-13T06:15:43.868Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822e38a51d6adb22756a00f"}]
[2025-05-13T06:15:43.869Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Request received.
[2025-05-13T06:15:43.950Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Successfully processed deletion.
[2025-05-13T06:15:43.950Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e38a51d6adb22756a00f] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:15:43.950Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822e38a51d6adb22756a00f
[2025-05-13T06:15:43.951Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:15:44.220Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:15:44.221Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822e38a51d6adb22756a00f, Count: 11
[2025-05-13T06:15:48.620Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"How can I contact the administrator?","isStreaming":true,"language":"en","conversationId":null}]
[2025-05-13T06:15:48.621Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621] Request received. UserInput: "How can I contact the administ...", Streaming: true, Language: en, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:15:48.622Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:15:48.754Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:15:48.755Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:15:48.755Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:15:49.014Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:15:49.022Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:15:49.083Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 0
[2025-05-13T06:15:49.083Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:15:49.085Z] --- [oFCz-1747116948621 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "How can I contact the administrator?", Lang: en ---
[2025-05-13T06:15:49.085Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:15:49.086Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:15:49.087Z] --- [oFCz-1747116948621 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:15:49.087Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:15:49.087Z] [oFCz-1747116948621 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 1
[2025-05-13T06:15:49.089Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:15:49.089Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:15:49.089Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:15:49.089Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:15:49.090Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:15:49.090Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:15:49.090Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:15:49.090Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:15:49.091Z]   - No valid next turn added, sending only history.
[2025-05-13T06:15:50.754Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:15:50.755Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:15:50.755Z] [oFCz-1747116948621 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:15:50.756Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:15:50.757Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:15:50.832Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:15:50.920Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:15:50.964Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:15:50.973Z] [oFCz-1747116948621 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 196
[2025-05-13T06:15:50.973Z] [oFCz-1747116948621 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:15:50.974Z] [oFCz-1747116948621 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:15:50.974Z] --- [oFCz-1747116948621 oFCzAH0WNF8v7pchAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:15:50.974Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T06:15:51.047Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:15:51.047Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:15:51.047Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:15:51.316Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:15:51.316Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116948621][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:16:23.298Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"gợi ý tôi","isStreaming":true,"language":"en","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:16:23.299Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299] Request received. UserInput: "gợi ý tôi", Streaming: true, Language: en, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:16:23.299Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:16:23.361Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 2
[2025-05-13T06:16:23.362Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:16:23.362Z] --- [oFCz-1747116983299 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "gợi ý tôi", Lang: en ---
[2025-05-13T06:16:23.362Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:16:23.362Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:23.365Z] --- [oFCz-1747116983299 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:16:23.366Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:23.366Z] [oFCz-1747116983299 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 3
[2025-05-13T06:16:23.367Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:16:23.367Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:16:23.367Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:16:23.367Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:16:23.367Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:16:23.368Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:16:23.368Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:16:23.368Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:16:23.368Z]   - No valid next turn added, sending only history.
[2025-05-13T06:16:25.080Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:16:25.081Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:25.082Z] [oFCz-1747116983299 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:16:25.083Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:25.083Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:25.200Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:25.354Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:25.709Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:25.882Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:25.966Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:25.986Z] [oFCz-1747116983299 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 507
[2025-05-13T06:16:25.986Z] [oFCz-1747116983299 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:16:25.987Z] [oFCz-1747116983299 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:16:25.987Z] --- [oFCz-1747116983299 oFCzAH0WNF8v7pchAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:16:25.988Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:16:26.054Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:16:26.055Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:16:26.055Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:16:26.306Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:16:26.307Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747116983299][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:16:45.882Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"báo cáo về việc ACCV conference wrong conference dates","isStreaming":true,"language":"en","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:16:45.883Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883] Request received. UserInput: "báo cáo về việc ACCV conferenc...", Streaming: true, Language: en, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:16:45.883Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:16:45.944Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 4
[2025-05-13T06:16:45.944Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:16:45.944Z] --- [oFCz-1747117005883 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "báo cáo về việc ACCV conference wrong conference dates", Lang: en ---
[2025-05-13T06:16:45.945Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:16:45.947Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:45.947Z] --- [oFCz-1747117005883 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:16:45.948Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:45.948Z] [oFCz-1747117005883 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 5
[2025-05-13T06:16:45.949Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:16:45.949Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:16:45.949Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:16:45.949Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:16:45.949Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:16:45.950Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:16:45.950Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:16:45.950Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:16:45.950Z]   - No valid next turn added, sending only history.
[2025-05-13T06:16:47.476Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:16:47.477Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:47.477Z] [oFCz-1747117005883 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:16:47.478Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:16:47.479Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:47.557Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:47.622Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:16:47.628Z] [oFCz-1747117005883 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 119
[2025-05-13T06:16:47.628Z] [oFCz-1747117005883 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:16:47.629Z] [oFCz-1747117005883 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:16:47.629Z] --- [oFCz-1747117005883 oFCzAH0WNF8v7pchAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:16:47.630Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T06:16:47.700Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:16:47.700Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:16:47.701Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:16:47.954Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:16:47.955Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117005883][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:17:05.430Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"viết luôn full email cho tôi đi","isStreaming":true,"language":"en","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:17:05.431Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431] Request received. UserInput: "viết luôn full email cho tôi đ...", Streaming: true, Language: en, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:17:05.431Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:17:05.495Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 6
[2025-05-13T06:17:05.496Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:17:05.496Z] --- [oFCz-1747117025431 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "viết luôn full email cho tôi đi", Lang: en ---
[2025-05-13T06:17:05.496Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:17:05.497Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:05.497Z] --- [oFCz-1747117025431 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:17:05.498Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:05.498Z] [oFCz-1747117025431 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 7
[2025-05-13T06:17:05.499Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T06:17:05.499Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T06:17:05.499Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:17:05.499Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:17:05.500Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:17:05.500Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:17:05.500Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:17:05.500Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T06:17:05.501Z]   - No valid next turn added, sending only history.
[2025-05-13T06:17:07.222Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:17:07.223Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:07.223Z] [oFCz-1747117025431 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:17:07.224Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:07.224Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:07.312Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:07.441Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:07.622Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:07.861Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:08.125Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:08.225Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:08.238Z] [oFCz-1747117025431 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 727
[2025-05-13T06:17:08.238Z] [oFCz-1747117025431 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:17:08.239Z] [oFCz-1747117025431 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:17:08.239Z] --- [oFCz-1747117025431 oFCzAH0WNF8v7pchAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:17:08.239Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T06:17:08.307Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:17:08.308Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:17:08.308Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:17:08.565Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:17:08.566Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117025431][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:17:20.578Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"it is ok","isStreaming":true,"language":"en","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:17:20.578Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578] Request received. UserInput: "it is ok", Streaming: true, Language: en, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:17:20.579Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:17:20.640Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 8
[2025-05-13T06:17:20.641Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:17:20.641Z] --- [oFCz-1747117040578 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "it is ok", Lang: en ---
[2025-05-13T06:17:20.641Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:17:20.642Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:20.642Z] --- [oFCz-1747117040578 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:17:20.643Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:20.643Z] [oFCz-1747117040578 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 9
[2025-05-13T06:17:20.644Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T06:17:20.644Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T06:17:20.644Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:17:20.644Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:17:20.645Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:17:20.645Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:17:20.645Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:17:20.645Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T06:17:20.646Z]   - No valid next turn added, sending only history.
[2025-05-13T06:17:22.326Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:17:22.327Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:22.327Z] [oFCz-1747117040578 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:17:22.328Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:22.328Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:22.473Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:22.579Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:22.674Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:22.811Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:22.981Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:22.989Z] [oFCz-1747117040578 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 609
[2025-05-13T06:17:22.989Z] [oFCz-1747117040578 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:17:22.990Z] [oFCz-1747117040578 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:17:22.990Z] --- [oFCz-1747117040578 oFCzAH0WNF8v7pchAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:17:22.990Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T06:17:23.062Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:17:23.062Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:17:23.062Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:17:23.327Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:17:23.328Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117040578][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:17:32.385Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"đúng","isStreaming":true,"language":"en","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:17:32.386Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386] Request received. UserInput: "đúng", Streaming: true, Language: en, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:17:32.386Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:17:32.448Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 10
[2025-05-13T06:17:32.449Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:17:32.449Z] --- [oFCz-1747117052386 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "đúng", Lang: en ---
[2025-05-13T06:17:32.449Z] [Language Config] Using configuration for Agent: HostAgent, Language: en
[2025-05-13T06:17:32.450Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:32.451Z] --- [oFCz-1747117052386 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:17:32.452Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:32.452Z] [oFCz-1747117052386 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 11
[2025-05-13T06:17:32.453Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T06:17:32.453Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T06:17:32.453Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:17:32.454Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:17:32.454Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:17:32.454Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:17:32.454Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:17:32.455Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T06:17:32.455Z]   - No valid next turn added, sending only history.
[2025-05-13T06:17:34.904Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:17:34.904Z] [oFCz-1747117052386 HostAgent Streaming T1 - oFCzAH0WNF8v7pchAAAB] Requests function: routeToAgent
[2025-05-13T06:17:34.905Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:34.907Z] --- [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 Socket oFCzAH0WNF8v7pchAAAB] Calling Sub Agent: AdminContactAgent, Task: 77b1bcd0-a219-495f-af3b-7172e6ce49c1 ---
[2025-05-13T06:17:34.907Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: en
[2025-05-13T06:17:34.908Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T06:17:34.908Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T06:17:34.909Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:17:34.910Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:17:34.910Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:17:34.910Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:17:34.911Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:17:34.911Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T06:17:34.911Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:17:34.911Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:17:34.912Z]   - No valid next turn added, sending only history.
[2025-05-13T06:17:37.112Z] Model Finish Reason: STOP
[2025-05-13T06:17:37.113Z] Model requested function call: sendEmailToAdmin
[2025-05-13T06:17:37.114Z] Arguments: {"message":"Dear Administrator, I am writing to report that the conference dates listed for ACCV appear to be incorrect. [Explain where you saw the incorrect dates - e.g., on the website, in a listing, etc.]. The dates are listed as [incorrect dates], but I believe the correct dates are [correct dates - if you know them]. Could you please investigate and update the information accordingly? Thank you for your time and attention to this matter. Sincerely, [Your Name]","subject":"Incorrect Conference Dates for ACCV","requestType":"report"}
[2025-05-13T06:17:37.115Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T06:17:37.116Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T06:17:37.121Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 oFCzAH0WNF8v7pchAAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T06:17:37.122Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T06:17:37.124Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T06:17:37.124Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 oFCzAH0WNF8v7pchAAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T06:17:37.126Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 oFCzAH0WNF8v7pchAAAB] Handler: SendEmailToAdmin (Confirmation Step), Args: {"message":"Dear Administrator, I am writing to report that the conference dates listed for ACCV appear to be incorrect. [Explain where you saw the incorrect dates - e.g., on the website, in a listing, etc.]. The dates are listed as [incorrect dates], but I believe the correct dates are [correct dates - if you know them]. Could you please investigate and update the information accordingly? Thank you for your time and attention to this matter. Sincerely, [Your Name]","subject":"Incorrect Conference Dates for ACCV","requestType":"report"}, Auth: true
[2025-05-13T06:17:37.128Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T06:17:37.128Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T06:17:37.129Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 oFCzAH0WNF8v7pchAAAB] SendEmailToAdmin: Preparing confirmation request ID: 21b47a17-15ce-453e-ac53-49008fe0a787
[2025-05-13T06:17:37.130Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T06:17:37.131Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T06:17:37.132Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 oFCzAH0WNF8v7pchAAAB] SendEmailToAdmin: Staging confirmation 21b47a17-15ce-453e-ac53-49008fe0a787. Awaiting frontend response. (Requires external state management)
[2025-05-13T06:17:37.132Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 oFCzAH0WNF8v7pchAAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T06:17:37.135Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T06:17:37.135Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T06:17:37.136Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T06:17:37.136Z] [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T06:17:37.137Z] --- [oFCz-1747117052386-Sub-AdminContactAgent-1747117054907] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T06:17:37.137Z] [oFCz-1747117052386 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T06:17:37.138Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Staging email confirmation action. Confirmation ID: 21b47a17-15ce-453e-ac53-49008fe0a787
[2025-05-13T06:17:37.138Z] [oFCz-1747117052386 oFCzAH0WNF8v7pchAAAB] Staging email confirmation ID: 21b47a17-15ce-453e-ac53-49008fe0a787 with timeout 60000ms
[2025-05-13T06:17:37.138Z] [oFCz-1747117052386 oFCzAH0WNF8v7pchAAAB] Confirmation 21b47a17-15ce-453e-ac53-49008fe0a787 stored. Status: pending.
[2025-05-13T06:17:37.139Z] --- [oFCz-1747117052386 HostAgent Streaming Turn 2 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:17:37.139Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:37.139Z] [oFCz-1747117052386 History T2 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 13
[2025-05-13T06:17:37.140Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T06:17:37.140Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T06:17:37.140Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:17:37.140Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:17:37.140Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:17:37.141Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:17:37.141Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:17:37.141Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T06:17:37.141Z]   - No valid next turn added, sending only history.
[2025-05-13T06:17:37.732Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:17:37.733Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:37.733Z] [oFCz-1747117052386 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:17:37.735Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:17:37.736Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:37.861Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:37.946Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:37.975Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:17:37.981Z] [oFCz-1747117052386 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 194
[2025-05-13T06:17:37.982Z] [oFCz-1747117052386 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T06:17:37.983Z] [oFCz-1747117052386 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:17:37.983Z] --- [oFCz-1747117052386 oFCzAH0WNF8v7pchAAAB Lang: en] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:17:37.984Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T06:17:38.059Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:17:38.059Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:17:38.060Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:17:38.308Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:17:38.309Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117052386][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:17:50.057Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: user_confirm_email, Args: [{"confirmationId":"21b47a17-15ce-453e-ac53-49008fe0a787"}]
[2025-05-13T06:17:50.058Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Confirm:21b47a17-15ce-453e-ac53-49008fe0a787] Request received.
[2025-05-13T06:17:50.059Z] [oFCz-1747117052386 oFCzAH0WNF8v7pchAAAB] User confirmed email ID: 21b47a17-15ce-453e-ac53-49008fe0a787. Proceeding to send.
[2025-05-13T06:17:50.059Z] Attempting to send email to admin. Type: report, Subject: "Incorrect Conference Dates for ACCV", Token Present: true
[2025-05-13T06:17:50.060Z] SIMULATING Email Send:
To: Admin
Subject: [REPORT] Incorrect Conference Dates for ACCV
Body:

            Request Type: report
            From: User: Authenticated (token present)
            Subject: Incorrect Conference Dates for ACCV
            --------------------
            Message:
            Dear Administrator, I am writing to report that the conference dates listed for ACCV appear to be incorrect. [Explain where you saw the incorrect dates - e.g., on the website, in a listing, etc.]. The dates are listed as [incorrect dates], but I believe the correct dates are [correct dates - if you know them]. Could you please investigate and update the information accordingly? Thank you for your time and attention to this matter. Sincerely, [Your Name]
            --------------------
            Sent via Chatbot Function Call
        

[2025-05-13T06:17:50.270Z] [oFCz-1747117052386 oFCzAH0WNF8v7pchAAAB] Email 21b47a17-15ce-453e-ac53-49008fe0a787 sent successfully.
[2025-05-13T06:17:50.271Z] [User Confirm oFCzAH0WNF8v7pchAAAB] Cleaned up entry 21b47a17-15ce-453e-ac53-49008fe0a787 after processing (Status: confirmed).
[2025-05-13T06:19:53.171Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:19:53.171Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Request received.
[2025-05-13T06:19:53.239Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Successfully processed message clearing.
[2025-05-13T06:19:53.240Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Cleared conversation was active. Emitting empty history.
[2025-05-13T06:19:53.240Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822e39451d6adb22756a017
[2025-05-13T06:19:53.240Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:19:53.490Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:19:53.491Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822e39451d6adb22756a017, Count: 12
[2025-05-13T06:20:02.709Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: send_message, Args: [{"userInput":"gửi email cho admin cho tôi","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:20:02.710Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710] Request received. UserInput: "gửi email cho admin cho tôi", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:20:02.710Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:20:02.774Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 0
[2025-05-13T06:20:02.774Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:20:02.774Z] --- [oFCz-1747117202710 Socket oFCzAH0WNF8v7pchAAAB] Handling STREAMING input: "gửi email cho admin cho tôi", Lang: vi ---
[2025-05-13T06:20:02.775Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:20:02.775Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:20:02.775Z] --- [oFCz-1747117202710 HostAgent Streaming Turn 1 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:20:02.776Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:20:02.776Z] [oFCz-1747117202710 History T1 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 1
[2025-05-13T06:20:02.776Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:20:02.777Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:20:02.777Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:20:02.777Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:20:02.777Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:20:02.778Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:20:02.778Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:20:02.778Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:20:02.778Z]   - No valid next turn added, sending only history.
[2025-05-13T06:20:04.760Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:20:04.761Z] [oFCz-1747117202710 HostAgent Streaming T1 - oFCzAH0WNF8v7pchAAAB] Requests function: routeToAgent
[2025-05-13T06:20:04.761Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:20:04.762Z] --- [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 Socket oFCzAH0WNF8v7pchAAAB] Calling Sub Agent: AdminContactAgent, Task: 37f374e0-b9b3-4126-a933-1969196b1dbf ---
[2025-05-13T06:20:04.762Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: vi
[2025-05-13T06:20:04.763Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T06:20:04.763Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T06:20:04.763Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:20:04.763Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:20:04.764Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:20:04.764Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:20:04.764Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:20:04.764Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T06:20:04.765Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:20:04.765Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:20:04.765Z]   - No valid next turn added, sending only history.
[2025-05-13T06:20:06.571Z] Model Finish Reason: STOP
[2025-05-13T06:20:06.571Z] Model requested function call: sendEmailToAdmin
[2025-05-13T06:20:06.572Z] Arguments: {"message":"Tôi muốn liên hệ với bạn.","requestType":"contact","subject":"Liên hệ"}
[2025-05-13T06:20:06.572Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T06:20:06.572Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T06:20:06.572Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 oFCzAH0WNF8v7pchAAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T06:20:06.573Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T06:20:06.573Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T06:20:06.573Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 oFCzAH0WNF8v7pchAAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T06:20:06.574Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 oFCzAH0WNF8v7pchAAAB] Handler: SendEmailToAdmin (Confirmation Step), Args: {"message":"Tôi muốn liên hệ với bạn.","requestType":"contact","subject":"Liên hệ"}, Auth: true
[2025-05-13T06:20:06.574Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T06:20:06.574Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T06:20:06.574Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 oFCzAH0WNF8v7pchAAAB] SendEmailToAdmin: Preparing confirmation request ID: 3c62d376-6dcc-41f2-8d68-791df3281693
[2025-05-13T06:20:06.575Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T06:20:06.575Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T06:20:06.575Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 oFCzAH0WNF8v7pchAAAB] SendEmailToAdmin: Staging confirmation 3c62d376-6dcc-41f2-8d68-791df3281693. Awaiting frontend response. (Requires external state management)
[2025-05-13T06:20:06.576Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 oFCzAH0WNF8v7pchAAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T06:20:06.576Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T06:20:06.576Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T06:20:06.577Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Thought Added - oFCzAH0WNF8v7pchAAAB] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T06:20:06.577Z] [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762 SubAgent Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T06:20:06.577Z] --- [oFCz-1747117202710-Sub-AdminContactAgent-1747117204762] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T06:20:06.578Z] [oFCz-1747117202710 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T06:20:06.578Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Staging email confirmation action. Confirmation ID: 3c62d376-6dcc-41f2-8d68-791df3281693
[2025-05-13T06:20:06.578Z] [oFCz-1747117202710 oFCzAH0WNF8v7pchAAAB] Staging email confirmation ID: 3c62d376-6dcc-41f2-8d68-791df3281693 with timeout 60000ms
[2025-05-13T06:20:06.578Z] [oFCz-1747117202710 oFCzAH0WNF8v7pchAAAB] Confirmation 3c62d376-6dcc-41f2-8d68-791df3281693 stored. Status: pending.
[2025-05-13T06:20:06.579Z] --- [oFCz-1747117202710 HostAgent Streaming Turn 2 Start - oFCzAH0WNF8v7pchAAAB] ---
[2025-05-13T06:20:06.579Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:20:06.579Z] [oFCz-1747117202710 History T2 Send - oFCzAH0WNF8v7pchAAAB] Host History Size: 3
[2025-05-13T06:20:06.580Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:20:06.580Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:20:06.580Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:20:06.580Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:20:06.581Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:20:06.581Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:20:06.581Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:20:06.581Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:20:06.581Z]   - No valid next turn added, sending only history.
[2025-05-13T06:20:07.222Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:20:07.224Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:20:07.224Z] [oFCz-1747117202710 Stream Processing - oFCzAH0WNF8v7pchAAAB] Starting...
[2025-05-13T06:20:07.224Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:20:07.225Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:20:07.309Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:20:07.412Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:20:07.474Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:20:07.485Z] [oFCz-1747117202710 Stream Processing - oFCzAH0WNF8v7pchAAAB] Finished. Length: 172
[2025-05-13T06:20:07.486Z] [oFCz-1747117202710 oFCzAH0WNF8v7pchAAAB] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T06:20:07.486Z] [oFCz-1747117202710 Streaming Emit Sent - oFCzAH0WNF8v7pchAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:20:07.486Z] --- [oFCz-1747117202710 oFCzAH0WNF8v7pchAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:20:07.487Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:20:07.555Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:20:07.556Z] [DEBUG] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:20:07.556Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:20:07.804Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:20:07.805Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:oFCz-1747117202710][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:20:14.257Z] [SERVER SOCKET oFCzAH0WNF8v7pchAAAB - ON ANY] Event: user_confirm_email, Args: [{"confirmationId":"3c62d376-6dcc-41f2-8d68-791df3281693"}]
[2025-05-13T06:20:14.257Z] [INFO] [coreHandlers][oFCzAH0WNF8v7pchAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Confirm:3c62d376-6dcc-41f2-8d68-791df3281693] Request received.
[2025-05-13T06:20:14.258Z] [oFCz-1747117202710 oFCzAH0WNF8v7pchAAAB] User confirmed email ID: 3c62d376-6dcc-41f2-8d68-791df3281693. Proceeding to send.
[2025-05-13T06:20:14.258Z] Attempting to send email to admin. Type: contact, Subject: "Liên hệ", Token Present: true
[2025-05-13T06:20:14.258Z] SIMULATING Email Send:
To: Admin
Subject: [CONTACT] Liên hệ
Body:

            Request Type: contact
            From: User: Authenticated (token present)
            Subject: Liên hệ
            --------------------
            Message:
            Tôi muốn liên hệ với bạn.
            --------------------
            Sent via Chatbot Function Call
        

[2025-05-13T06:20:14.466Z] [oFCz-1747117202710 oFCzAH0WNF8v7pchAAAB] Email 3c62d376-6dcc-41f2-8d68-791df3281693 sent successfully.
[2025-05-13T06:20:14.467Z] [User Confirm oFCzAH0WNF8v7pchAAAB] Cleaned up entry 3c62d376-6dcc-41f2-8d68-791df3281693 after processing (Status: confirmed).
[2025-05-13T06:22:03.198Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:22:03.198Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:22:03.590Z] [MainLoader] Starting application loading process...
[2025-05-13T06:22:03.592Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:22:03.593Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:22:04.450Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:22:04.450Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:22:04.450Z] [MainLoader] Database loaded.
[2025-05-13T06:22:04.451Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:22:04.451Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:22:04.457Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:22:04.460Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:22:04.460Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:22:04.461Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:22:04.461Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:22:04.462Z] [MainLoader] Express loaded.
[2025-05-13T06:22:04.463Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:22:04.468Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:22:04.469Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:22:04.469Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:22:04.469Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:22:04.470Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:22:04.510Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:22:04.510Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:22:04.511Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:22:04.558Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:22:04.559Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:22:06.825Z] [socketAuth][IFBbRNOHOqT7Mf69AAAB] Authentication attempt. Has token: true
[2025-05-13T06:22:06.829Z] [socketAuth][IFBbRNOHOqT7Mf69AAAB] Token signature validated successfully.
[2025-05-13T06:22:06.832Z] [HistoryService] Initialized.
[2025-05-13T06:22:06.832Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB] New connection. Socket ID: IFBbRNOHOqT7Mf69AAAB. Initial socket.data.userId: null
[2025-05-13T06:22:06.833Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:22:06.833Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB] Attempting to fetch user info using token...
[2025-05-13T06:22:06.833Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:22:06.834Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:22:07.519Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:22:07.520Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:22:07.520Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:22:07.522Z] [HistoryService] Initialized.
[2025-05-13T06:22:07.522Z] [coreHandlers][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:22:07.522Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:22:07.522Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:22:07.523Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:22:07.524Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:22:07.525Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:22:07.567Z] [SERVER SOCKET IFBbRNOHOqT7Mf69AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:22:07.848Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:22:07.849Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:22:07.849Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:22:07.850Z] [SERVER GLOBAL][connection][IFBbRNOHOqT7Mf69AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:22:58.519Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:22:58.520Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:22:58.922Z] [MainLoader] Starting application loading process...
[2025-05-13T06:22:58.922Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:22:58.923Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:22:59.701Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:22:59.701Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:22:59.702Z] [MainLoader] Database loaded.
[2025-05-13T06:22:59.702Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:22:59.703Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:22:59.708Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:22:59.711Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:22:59.711Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:22:59.712Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:22:59.712Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:22:59.713Z] [MainLoader] Express loaded.
[2025-05-13T06:22:59.714Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:22:59.718Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:22:59.719Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:22:59.719Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:22:59.719Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:22:59.720Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:22:59.760Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:22:59.760Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:22:59.760Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:22:59.819Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:22:59.819Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:23:02.205Z] [socketAuth][K0cBxDOcI3yxB6T8AAAB] Authentication attempt. Has token: true
[2025-05-13T06:23:02.209Z] [socketAuth][K0cBxDOcI3yxB6T8AAAB] Token signature validated successfully.
[2025-05-13T06:23:02.212Z] [HistoryService] Initialized.
[2025-05-13T06:23:02.212Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB] New connection. Socket ID: K0cBxDOcI3yxB6T8AAAB. Initial socket.data.userId: null
[2025-05-13T06:23:02.212Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:23:02.213Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB] Attempting to fetch user info using token...
[2025-05-13T06:23:02.213Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:23:02.214Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:23:02.897Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:23:02.897Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:23:02.898Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:23:02.899Z] [HistoryService] Initialized.
[2025-05-13T06:23:02.900Z] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:23:02.900Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:23:02.900Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:23:02.900Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:23:02.902Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:23:02.902Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:23:02.952Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:23:03.210Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:23:03.211Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:23:03.212Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:23:03.212Z] [SERVER GLOBAL][connection][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:23:03.392Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e2fb977aa7fe353aabac"}]
[2025-05-13T06:23:03.397Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e2fb977aa7fe353aabac"}
[2025-05-13T06:23:03.397Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Request received.
[2025-05-13T06:23:03.472Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Sent history. Set as active conversation. Message Count: 0
[2025-05-13T06:23:04.182Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:23:04.185Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e39451d6adb22756a017"}
[2025-05-13T06:23:04.185Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Request received.
[2025-05-13T06:23:04.252Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Sent history. Set as active conversation. Message Count: 2
[2025-05-13T06:23:06.765Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"gửi 1 email khác","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:23:06.767Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766] Request received. UserInput: "gửi 1 email khác", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:23:06.767Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:23:06.843Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 4
[2025-05-13T06:23:06.844Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:23:06.846Z] --- [K0cB-1747117386766 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "gửi 1 email khác", Lang: vi ---
[2025-05-13T06:23:06.846Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:23:06.848Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:06.848Z] --- [K0cB-1747117386766 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:23:06.849Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:06.849Z] [K0cB-1747117386766 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 5
[2025-05-13T06:23:06.851Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:23:06.851Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:23:06.851Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:23:06.852Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:23:06.852Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:23:06.852Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:23:06.852Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:23:06.853Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:23:06.853Z]   - No valid next turn added, sending only history.
[2025-05-13T06:23:08.668Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:23:08.669Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:08.670Z] [K0cB-1747117386766 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:23:08.670Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:08.671Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:08.773Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:08.799Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:08.808Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:08.820Z] [K0cB-1747117386766 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 141
[2025-05-13T06:23:08.821Z] [K0cB-1747117386766 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:23:08.822Z] [K0cB-1747117386766 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:23:08.822Z] --- [K0cB-1747117386766 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:23:08.822Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T06:23:08.979Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:23:08.979Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:23:08.980Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:23:09.247Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:23:09.248Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117386766][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:23:40.600Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"gợi ý tôi","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:23:40.600Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600] Request received. UserInput: "gợi ý tôi", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:23:40.601Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:23:40.666Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 6
[2025-05-13T06:23:40.666Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:23:40.666Z] --- [K0cB-1747117420600 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "gợi ý tôi", Lang: vi ---
[2025-05-13T06:23:40.667Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:23:40.667Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:40.667Z] --- [K0cB-1747117420600 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:23:40.668Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:40.668Z] [K0cB-1747117420600 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 7
[2025-05-13T06:23:40.668Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T06:23:40.669Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T06:23:40.669Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:23:40.669Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:23:40.669Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:23:40.670Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:23:40.670Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:23:40.670Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T06:23:40.670Z]   - No valid next turn added, sending only history.
[2025-05-13T06:23:42.410Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:23:42.411Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:42.411Z] [K0cB-1747117420600 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:23:42.411Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:23:42.412Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:42.512Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:42.603Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:42.834Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:42.996Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:43.393Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:43.401Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:23:43.409Z] [K0cB-1747117420600 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 548
[2025-05-13T06:23:43.409Z] [K0cB-1747117420600 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:23:43.410Z] [K0cB-1747117420600 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:23:43.410Z] --- [K0cB-1747117420600 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:23:43.410Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T06:23:43.483Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:23:43.483Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:23:43.484Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:23:43.731Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:23:43.732Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117420600][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:24:33.040Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"viết email về vấn đề trang web xấu quá","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:24:33.041Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041] Request received. UserInput: "viết email về vấn đề trang web...", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:24:33.041Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:24:33.106Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 8
[2025-05-13T06:24:33.106Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:24:33.107Z] --- [K0cB-1747117473041 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "viết email về vấn đề trang web xấu quá", Lang: vi ---
[2025-05-13T06:24:33.107Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:24:33.107Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:33.108Z] --- [K0cB-1747117473041 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:24:33.108Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:33.109Z] [K0cB-1747117473041 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 9
[2025-05-13T06:24:33.109Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T06:24:33.109Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T06:24:33.110Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:24:33.110Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:24:33.110Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:24:33.110Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:24:33.111Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:24:33.121Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T06:24:33.126Z]   - No valid next turn added, sending only history.
[2025-05-13T06:24:34.874Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:24:34.875Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:34.875Z] [K0cB-1747117473041 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:24:34.875Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:34.876Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:34.961Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:35.048Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:35.112Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:35.118Z] [K0cB-1747117473041 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 191
[2025-05-13T06:24:35.119Z] [K0cB-1747117473041 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:24:35.119Z] [K0cB-1747117473041 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:24:35.119Z] --- [K0cB-1747117473041 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:24:35.120Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 10
[2025-05-13T06:24:35.192Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:24:35.192Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:24:35.193Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:24:35.448Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:24:35.449Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117473041][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:24:42.650Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"viết full cho tôi đi","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:24:42.651Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651] Request received. UserInput: "viết full cho tôi đi", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:24:42.651Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:24:42.728Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 10
[2025-05-13T06:24:42.728Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:24:42.728Z] --- [K0cB-1747117482651 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "viết full cho tôi đi", Lang: vi ---
[2025-05-13T06:24:42.728Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:24:42.729Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:42.729Z] --- [K0cB-1747117482651 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:24:42.730Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:42.731Z] [K0cB-1747117482651 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 11
[2025-05-13T06:24:42.731Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T06:24:42.731Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T06:24:42.732Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:24:42.732Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:24:42.733Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:24:42.733Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:24:42.734Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:24:42.734Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T06:24:42.734Z]   - No valid next turn added, sending only history.
[2025-05-13T06:24:44.474Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:24:44.475Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:44.475Z] [K0cB-1747117482651 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:24:44.475Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:44.476Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:44.548Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:44.623Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:44.814Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:45.032Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:45.211Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:45.217Z] [K0cB-1747117482651 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 448
[2025-05-13T06:24:45.217Z] [K0cB-1747117482651 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:24:45.218Z] [K0cB-1747117482651 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:24:45.218Z] --- [K0cB-1747117482651 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:24:45.218Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T06:24:45.295Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:24:45.295Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:24:45.296Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:24:45.589Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:24:45.590Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117482651][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:24:52.477Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"Gợi ý full email","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:24:52.478Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478] Request received. UserInput: "Gợi ý full email", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:24:52.478Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:24:52.542Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 12
[2025-05-13T06:24:52.542Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:24:52.542Z] --- [K0cB-1747117492478 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "Gợi ý full email", Lang: vi ---
[2025-05-13T06:24:52.543Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:24:52.543Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:52.544Z] --- [K0cB-1747117492478 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:24:52.544Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:52.545Z] [K0cB-1747117492478 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 13
[2025-05-13T06:24:52.545Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T06:24:52.545Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T06:24:52.546Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:24:52.546Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:24:52.546Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:24:52.546Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:24:52.547Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:24:52.547Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T06:24:52.547Z]   - No valid next turn added, sending only history.
[2025-05-13T06:24:54.318Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:24:54.319Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:54.319Z] [K0cB-1747117492478 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:24:54.321Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:24:54.323Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:54.420Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:54.604Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:54.736Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:54.959Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:55.234Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:55.498Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:55.788Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:56.129Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:56.486Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:56.904Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:57.233Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:57.573Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:57.791Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:24:57.798Z] [K0cB-1747117492478 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 2021
[2025-05-13T06:24:57.798Z] [K0cB-1747117492478 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:24:57.799Z] [K0cB-1747117492478 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:24:57.799Z] --- [K0cB-1747117492478 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:24:57.799Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T06:24:57.873Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:24:57.874Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:24:57.874Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:24:58.123Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:24:58.124Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117492478][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:25:24.234Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"chọn ngẫu nhien và viết email cho tôi","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:25:24.235Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235] Request received. UserInput: "chọn ngẫu nhien và viết email ...", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:25:24.235Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:25:24.302Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 14
[2025-05-13T06:25:24.302Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:25:24.302Z] --- [K0cB-1747117524235 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "chọn ngẫu nhien và viết email cho tôi", Lang: vi ---
[2025-05-13T06:25:24.302Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:25:24.303Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:24.303Z] --- [K0cB-1747117524235 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:25:24.303Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:24.304Z] [K0cB-1747117524235 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 15
[2025-05-13T06:25:24.304Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T06:25:24.304Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T06:25:24.304Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:25:24.304Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:25:24.305Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:25:24.305Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:25:24.305Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:25:24.305Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T06:25:24.305Z]   - No valid next turn added, sending only history.
[2025-05-13T06:25:26.994Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:25:26.994Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:26.995Z] [K0cB-1747117524235 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:25:26.995Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:26.995Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.108Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.176Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.353Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.479Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.711Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.770Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:27.777Z] [K0cB-1747117524235 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 533
[2025-05-13T06:25:27.777Z] [K0cB-1747117524235 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:25:27.778Z] [K0cB-1747117524235 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:25:27.778Z] --- [K0cB-1747117524235 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:25:27.778Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 16
[2025-05-13T06:25:27.856Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:25:27.856Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:25:27.856Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:25:28.115Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:25:28.116Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117524235][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:25:32.402Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"oke","isStreaming":true,"language":"vi","conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:25:32.402Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402] Request received. UserInput: "oke", Streaming: true, Language: vi, PayloadConvId: 6822e39451d6adb22756a017, SocketDataConvId: 6822e39451d6adb22756a017
[2025-05-13T06:25:32.402Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Using conversationId from payload.
[2025-05-13T06:25:32.468Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Fetched current history. Count: 16
[2025-05-13T06:25:32.469Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Calling streaming intent handler.
[2025-05-13T06:25:32.469Z] --- [K0cB-1747117532402 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "oke", Lang: vi ---
[2025-05-13T06:25:32.469Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:25:32.470Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:32.471Z] --- [K0cB-1747117532402 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:25:32.471Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:32.471Z] [K0cB-1747117532402 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 17
[2025-05-13T06:25:32.472Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T06:25:32.472Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T06:25:32.472Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:25:32.473Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:25:32.473Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:25:32.473Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:25:32.473Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:25:32.474Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T06:25:32.474Z]   - No valid next turn added, sending only history.
[2025-05-13T06:25:34.218Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:25:34.219Z] [K0cB-1747117532402 HostAgent Streaming T1 - K0cBxDOcI3yxB6T8AAAB] Requests function: routeToAgent
[2025-05-13T06:25:34.219Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:34.221Z] --- [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 Socket K0cBxDOcI3yxB6T8AAAB] Calling Sub Agent: AdminContactAgent, Task: 20929c8d-f752-4998-995b-55b9797080aa ---
[2025-05-13T06:25:34.222Z] [Language Config] Using configuration for Agent: AdminContactAgent, Language: vi
[2025-05-13T06:25:34.222Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: sub_agent_thinking, Agent: AdminContactAgent
[2025-05-13T06:25:34.223Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: sub_agent_thinking for AdminContactAgent
[2025-05-13T06:25:34.224Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:25:34.224Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:25:34.224Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:25:34.224Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:25:34.225Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:25:34.225Z] Tools provided: ["sendEmailToAdmin"]
[2025-05-13T06:25:34.225Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:25:34.225Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:25:34.225Z]   - No valid next turn added, sending only history.
[2025-05-13T06:25:36.412Z] Model Finish Reason: STOP
[2025-05-13T06:25:36.413Z] Model requested function call: sendEmailToAdmin
[2025-05-13T06:25:36.413Z] Arguments: {"message":"Chào quản trị viên,\nTôi muốn cung cấp phản hồi về trang web. Tôi thấy rằng thiết kế chưa được hiện đại và bố cục hơi khó điều hướng.\nTôi hy vọng bạn có thể xem xét những góp ý này để cải thiện trải nghiệm người dùng.\nTrân trọng,\n[Tên của bạn]","subject":"Phản hồi về trang web","requestType":"contact"}
[2025-05-13T06:25:36.413Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221] LLM result from AdminContactAgent: Status requires_function_call
[2025-05-13T06:25:36.414Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221] AdminContactAgent requests function call: sendEmailToAdmin
[2025-05-13T06:25:36.414Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 K0cBxDOcI3yxB6T8AAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Received request.
[2025-05-13T06:25:36.415Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_call_received, Agent: AdminContactAgent
[2025-05-13T06:25:36.416Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_call_received for AdminContactAgent
[2025-05-13T06:25:36.417Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 K0cBxDOcI3yxB6T8AAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Executing handler...
[2025-05-13T06:25:36.419Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 K0cBxDOcI3yxB6T8AAAB] Handler: SendEmailToAdmin (Confirmation Step), Args: {"message":"Chào quản trị viên,\nTôi muốn cung cấp phản hồi về trang web. Tôi thấy rằng thiết kế chưa được hiện đại và bố cục hơi khó điều hướng.\nTôi hy vọng bạn có thể xem xét những góp ý này để cải thiện trải nghiệm người dùng.\nTrân trọng,\n[Tên của bạn]","subject":"Phản hồi về trang web","requestType":"contact"}, Auth: true
[2025-05-13T06:25:36.419Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: validating_email_args, Agent: AdminContactAgent
[2025-05-13T06:25:36.420Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: validating_email_args for AdminContactAgent
[2025-05-13T06:25:36.420Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 K0cBxDOcI3yxB6T8AAAB] SendEmailToAdmin: Preparing confirmation request ID: 12c8c64d-8537-4b2f-9047-4da905bdcd24
[2025-05-13T06:25:36.420Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: preparing_email_confirmation, Agent: AdminContactAgent
[2025-05-13T06:25:36.421Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: preparing_email_confirmation for AdminContactAgent
[2025-05-13T06:25:36.421Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 K0cBxDOcI3yxB6T8AAAB] SendEmailToAdmin: Staging confirmation 12c8c64d-8537-4b2f-9047-4da905bdcd24. Awaiting frontend response. (Requires external state management)
[2025-05-13T06:25:36.421Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 K0cBxDOcI3yxB6T8AAAB Agent:AdminContactAgent FuncRegistry Func:sendEmailToAdmin] Handler execution finished. Result indicates error: false
[2025-05-13T06:25:36.422Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_result_processed, Agent: AdminContactAgent
[2025-05-13T06:25:36.422Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_result_processed for AdminContactAgent
[2025-05-13T06:25:36.422Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: sub_agent_processing_complete, Agent: AdminContactAgent
[2025-05-13T06:25:36.423Z] [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: sub_agent_processing_complete for AdminContactAgent
[2025-05-13T06:25:36.423Z] --- [K0cB-1747117532402-Sub-AdminContactAgent-1747117534221] Sub Agent AdminContactAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T06:25:36.423Z] [K0cB-1747117532402 Streaming] Appended 6 thoughts from AdminContactAgent. Total: 9
[2025-05-13T06:25:36.423Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Staging email confirmation action. Confirmation ID: 12c8c64d-8537-4b2f-9047-4da905bdcd24
[2025-05-13T06:25:36.424Z] [K0cB-1747117532402 K0cBxDOcI3yxB6T8AAAB] Staging email confirmation ID: 12c8c64d-8537-4b2f-9047-4da905bdcd24 with timeout 60000ms
[2025-05-13T06:25:36.424Z] [K0cB-1747117532402 K0cBxDOcI3yxB6T8AAAB] Confirmation 12c8c64d-8537-4b2f-9047-4da905bdcd24 stored. Status: pending.
[2025-05-13T06:25:36.425Z] --- [K0cB-1747117532402 HostAgent Streaming Turn 2 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:25:36.425Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:36.425Z] [K0cB-1747117532402 History T2 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 19
[2025-05-13T06:25:36.426Z] [GeminiService] Received history with 19 items before mapping (for stream).
[2025-05-13T06:25:36.426Z] [GeminiService] Mapped history (SDK Content[]) with 19 items (for stream).
[2025-05-13T06:25:36.426Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:25:36.427Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:25:36.427Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:25:36.442Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:25:36.442Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:25:36.443Z] [GeminiService Stream] Preparing stream request with 19 Content items.
[2025-05-13T06:25:36.445Z]   - No valid next turn added, sending only history.
[2025-05-13T06:25:37.095Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:25:37.096Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:37.096Z] [K0cB-1747117532402 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:25:37.096Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:25:37.097Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:37.214Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:37.287Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:37.422Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:25:37.428Z] [K0cB-1747117532402 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 186
[2025-05-13T06:25:37.429Z] [K0cB-1747117532402 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T06:25:37.430Z] [K0cB-1747117532402 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:25:37.430Z] --- [K0cB-1747117532402 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:25:37.430Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Intent handler returned updated history. Attempting save. New size: 20
[2025-05-13T06:25:37.515Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Successfully updated history in DB.
[2025-05-13T06:25:37.515Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:25:37.516Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:25:37.786Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:25:37.788Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117532402][Conv:6822e39451d6adb22756a017] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:26:09.298Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: user_confirm_email, Args: [{"confirmationId":"12c8c64d-8537-4b2f-9047-4da905bdcd24"}]
[2025-05-13T06:26:09.299Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Confirm:12c8c64d-8537-4b2f-9047-4da905bdcd24] Request received.
[2025-05-13T06:26:09.300Z] [K0cB-1747117532402 K0cBxDOcI3yxB6T8AAAB] User confirmed email ID: 12c8c64d-8537-4b2f-9047-4da905bdcd24. Proceeding to send.
[2025-05-13T06:26:09.300Z] Attempting to send email to admin. Type: contact, Subject: "Phản hồi về trang web", Token Present: true
[2025-05-13T06:26:09.300Z] SIMULATING Email Send:
To: Admin
Subject: [CONTACT] Phản hồi về trang web
Body:

            Request Type: contact
            From: User: Authenticated (token present)
            Subject: Phản hồi về trang web
            --------------------
            Message:
            Chào quản trị viên,
Tôi muốn cung cấp phản hồi về trang web. Tôi thấy rằng thiết kế chưa được hiện đại và bố cục hơi khó điều hướng.
Tôi hy vọng bạn có thể xem xét những góp ý này để cải thiện trải nghiệm người dùng.
Trân trọng,
[Tên của bạn]
            --------------------
            Sent via Chatbot Function Call
        

[2025-05-13T06:26:09.503Z] [K0cB-1747117532402 K0cBxDOcI3yxB6T8AAAB] Email 12c8c64d-8537-4b2f-9047-4da905bdcd24 sent successfully.
[2025-05-13T06:26:09.504Z] [User Confirm K0cBxDOcI3yxB6T8AAAB] Cleaned up entry 12c8c64d-8537-4b2f-9047-4da905bdcd24 after processing (Status: confirmed).
[2025-05-13T06:26:15.490Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822e39451d6adb22756a017"}]
[2025-05-13T06:26:15.491Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Request received.
[2025-05-13T06:26:15.560Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Successfully processed deletion.
[2025-05-13T06:26:15.561Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e39451d6adb22756a017] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:26:15.562Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822e39451d6adb22756a017
[2025-05-13T06:26:15.562Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:26:15.826Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:26:15.827Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822e39451d6adb22756a017, Count: 11
[2025-05-13T06:26:18.207Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"Địa điểm tổ chức \"ACM International Symposium on Computer Architecture\" ở đâu?","isStreaming":true,"language":"vi","conversationId":null}]
[2025-05-13T06:26:18.207Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207] Request received. UserInput: "Địa điểm tổ chức "ACM Internat...", Streaming: true, Language: vi, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:26:18.207Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:26:18.360Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:26:18.360Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:26:18.361Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:26:18.617Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:26:18.617Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:26:18.680Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Fetched current history. Count: 0
[2025-05-13T06:26:18.680Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Calling streaming intent handler.
[2025-05-13T06:26:18.680Z] --- [K0cB-1747117578207 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "Địa điểm tổ chức "ACM International Symposium on Computer Architecture" ở đâu?", Lang: vi ---
[2025-05-13T06:26:18.681Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:26:18.681Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:18.682Z] --- [K0cB-1747117578207 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:26:18.682Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:18.682Z] [K0cB-1747117578207 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 1
[2025-05-13T06:26:18.682Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:26:18.684Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:26:18.686Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:26:18.686Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:26:18.686Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:26:18.687Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:26:18.691Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:26:18.692Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:26:18.693Z]   - No valid next turn added, sending only history.
[2025-05-13T06:26:20.510Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:26:20.510Z] [K0cB-1747117578207 HostAgent Streaming T1 - K0cBxDOcI3yxB6T8AAAB] Requests function: routeToAgent
[2025-05-13T06:26:20.511Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:20.512Z] --- [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 Socket K0cBxDOcI3yxB6T8AAAB] Calling Sub Agent: ConferenceAgent, Task: c22e7e76-4f0e-4f7b-a6c7-e3f4bd377051 ---
[2025-05-13T06:26:20.512Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T06:26:20.512Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:26:20.513Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:26:20.513Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:26:20.513Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:26:20.513Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:26:20.513Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:26:20.514Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:26:20.514Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:26:20.514Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:26:20.514Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:26:20.514Z]   - No valid next turn added, sending only history.
[2025-05-13T06:26:22.316Z] Model Finish Reason: STOP
[2025-05-13T06:26:22.317Z] Model requested function call: getConferences
[2025-05-13T06:26:22.317Z] Arguments: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T06:26:22.317Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:26:22.317Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512] ConferenceAgent requests function call: getConferences
[2025-05-13T06:26:22.317Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:26:22.318Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:26:22.318Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:26:22.319Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:26:22.319Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T06:26:22.320Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:26:22.320Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:26:22.321Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:26:22.321Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:26:22.321Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:26:22.322Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:26:22.323Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1}
[2025-05-13T06:26:23.042Z] [BackendService] [conference] API Success (200). Data length: 1905. Attempting parsing...
[2025-05-13T06:26:23.043Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"00d654a0-f73f-4efb-b785-7c8847e00b05","title":"ACM International Symposium on Computer Architecture","acronym":"ISCA","location":{"cityStateProvince":"Tokyo","country":"Japan","address":"Waseda University, Shinjuku, Tokyo, Japan","...
[2025-05-13T06:26:23.043Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:26:23.044Z] Transforming conference data with Markdown. Search query: title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1
[2025-05-13T06:26:23.047Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACM International Symposium on Computer Architecture
  - **Ac...
[2025-05-13T06:26:23.048Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"
[2025-05-13T06:26:23.048Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:26:23.048Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:26:23.049Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:26:23.049Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:26:23.049Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:26:23.050Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:26:23.050Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:26:23.050Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:26:23.051Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:26:23.051Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 K0cBxDOcI3yxB6T8AAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:26:23.051Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:26:23.051Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:26:23.052Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:26:23.052Z] [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:26:23.052Z] --- [K0cB-1747117578207-Sub-ConferenceAgent-1747117580512] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:26:23.052Z] [K0cB-1747117578207 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:26:23.053Z] --- [K0cB-1747117578207 HostAgent Streaming Turn 2 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:26:23.053Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:23.054Z] [K0cB-1747117578207 History T2 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 3
[2025-05-13T06:26:23.054Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:26:23.054Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:26:23.055Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:26:23.055Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:26:23.055Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:26:23.056Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:26:23.056Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:26:23.057Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:26:23.058Z]   - No valid next turn added, sending only history.
[2025-05-13T06:26:23.594Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:26:23.595Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:23.595Z] [K0cB-1747117578207 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:26:23.596Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:23.596Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:23.699Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:23.825Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:23.862Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:23.865Z] [K0cB-1747117578207 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 139
[2025-05-13T06:26:23.865Z] [K0cB-1747117578207 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:26:23.866Z] [K0cB-1747117578207 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:26:23.866Z] --- [K0cB-1747117578207 K0cBxDOcI3yxB6T8AAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:26:23.867Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:26:23.938Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Successfully updated history in DB.
[2025-05-13T06:26:23.938Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:26:23.938Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:26:24.194Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:26:24.195Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117578207][Conv:6822e60a2402d17be3c05183] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:26:33.608Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822e60a2402d17be3c05183"}]
[2025-05-13T06:26:33.609Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e60a2402d17be3c05183] Request received.
[2025-05-13T06:26:33.685Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e60a2402d17be3c05183] Successfully processed message clearing.
[2025-05-13T06:26:33.685Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e60a2402d17be3c05183] Cleared conversation was active. Emitting empty history.
[2025-05-13T06:26:33.686Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822e60a2402d17be3c05183
[2025-05-13T06:26:33.686Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:26:33.958Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:26:33.958Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822e60a2402d17be3c05183, Count: 12
[2025-05-13T06:26:35.373Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"Địa điểm tổ chức \"ACM International Symposium on Computer Architecture\" ở đâu?","isStreaming":true,"language":"de","conversationId":"6822e60a2402d17be3c05183"}]
[2025-05-13T06:26:35.374Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374] Request received. UserInput: "Địa điểm tổ chức "ACM Internat...", Streaming: true, Language: de, PayloadConvId: 6822e60a2402d17be3c05183, SocketDataConvId: 6822e60a2402d17be3c05183
[2025-05-13T06:26:35.374Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Using conversationId from payload.
[2025-05-13T06:26:35.438Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Fetched current history. Count: 0
[2025-05-13T06:26:35.438Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Calling streaming intent handler.
[2025-05-13T06:26:35.439Z] --- [K0cB-1747117595374 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "Địa điểm tổ chức "ACM International Symposium on Computer Architecture" ở đâu?", Lang: de ---
[2025-05-13T06:26:35.440Z] [Language Config] Using configuration for Agent: HostAgent, Language: de
[2025-05-13T06:26:35.440Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:35.441Z] --- [K0cB-1747117595374 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:26:35.442Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:35.442Z] [K0cB-1747117595374 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 1
[2025-05-13T06:26:35.442Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:26:35.442Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:26:35.443Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:26:35.443Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:26:35.443Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:26:35.443Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:26:35.444Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:26:35.444Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:26:35.444Z]   - No valid next turn added, sending only history.
[2025-05-13T06:26:37.241Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:26:37.242Z] [K0cB-1747117595374 HostAgent Streaming T1 - K0cBxDOcI3yxB6T8AAAB] Requests function: routeToAgent
[2025-05-13T06:26:37.242Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:37.243Z] --- [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 Socket K0cBxDOcI3yxB6T8AAAB] Calling Sub Agent: ConferenceAgent, Task: 89cdf31c-1918-495d-850b-854a8b1b7c2b ---
[2025-05-13T06:26:37.243Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: de
[2025-05-13T06:26:37.244Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:26:37.244Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:26:37.244Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:26:37.244Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:26:37.244Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:26:37.245Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:26:37.245Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:26:37.245Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:26:37.245Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:26:37.245Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:26:37.246Z]   - No valid next turn added, sending only history.
[2025-05-13T06:26:38.406Z] Model Finish Reason: STOP
[2025-05-13T06:26:38.406Z] Model requested function call: getConferences
[2025-05-13T06:26:38.407Z] Arguments: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T06:26:38.407Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:26:38.408Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243] ConferenceAgent requests function call: getConferences
[2025-05-13T06:26:38.408Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:26:38.408Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:26:38.409Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:26:38.409Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:26:38.409Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"}
[2025-05-13T06:26:38.410Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:26:38.410Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:26:38.410Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:26:38.410Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:26:38.411Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:26:38.411Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:26:38.411Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1}
[2025-05-13T06:26:39.111Z] [BackendService] [conference] API Success (200). Data length: 1905. Attempting parsing...
[2025-05-13T06:26:39.111Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"00d654a0-f73f-4efb-b785-7c8847e00b05","title":"ACM International Symposium on Computer Architecture","acronym":"ISCA","location":{"cityStateProvince":"Tokyo","country":"Japan","address":"Waseda University, Shinjuku, Tokyo, Japan","...
[2025-05-13T06:26:39.111Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:26:39.112Z] Transforming conference data with Markdown. Search query: title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1
[2025-05-13T06:26:39.114Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** ACM International Symposium on Computer Architecture
  - **Ac...
[2025-05-13T06:26:39.114Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=ACM+International+Symposium+on+Computer+Architecture&perPage=5&page=1"
[2025-05-13T06:26:39.114Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:26:39.114Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:26:39.115Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:26:39.115Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:26:39.116Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:26:39.116Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:26:39.116Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:26:39.117Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:26:39.117Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:26:39.117Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 K0cBxDOcI3yxB6T8AAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:26:39.117Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:26:39.118Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:26:39.118Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Thought Added - K0cBxDOcI3yxB6T8AAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:26:39.118Z] [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243 SubAgent Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:26:39.119Z] --- [K0cB-1747117595374-Sub-ConferenceAgent-1747117597243] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:26:39.119Z] [K0cB-1747117595374 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:26:39.119Z] --- [K0cB-1747117595374 HostAgent Streaming Turn 2 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:26:39.119Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:39.120Z] [K0cB-1747117595374 History T2 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 3
[2025-05-13T06:26:39.120Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:26:39.120Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:26:39.120Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:26:39.120Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:26:39.120Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:26:39.121Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:26:39.121Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:26:39.121Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:26:39.122Z]   - No valid next turn added, sending only history.
[2025-05-13T06:26:39.642Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:26:39.642Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:39.643Z] [K0cB-1747117595374 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:26:39.643Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:26:39.643Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:39.802Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:39.866Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:26:39.874Z] [K0cB-1747117595374 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 119
[2025-05-13T06:26:39.874Z] [K0cB-1747117595374 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:26:39.875Z] [K0cB-1747117595374 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:26:39.875Z] --- [K0cB-1747117595374 K0cBxDOcI3yxB6T8AAAB Lang: de] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:26:39.876Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:26:39.945Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Successfully updated history in DB.
[2025-05-13T06:26:39.945Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:26:39.946Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:26:40.210Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:26:40.210Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117595374][Conv:6822e60a2402d17be3c05183] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:27:41.123Z] [SERVER SOCKET K0cBxDOcI3yxB6T8AAAB - ON ANY] Event: send_message, Args: [{"userInput":"bạn là ai ?","isStreaming":true,"language":"ru","conversationId":"6822e60a2402d17be3c05183"}]
[2025-05-13T06:27:41.123Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123] Request received. UserInput: "bạn là ai ?", Streaming: true, Language: ru, PayloadConvId: 6822e60a2402d17be3c05183, SocketDataConvId: 6822e60a2402d17be3c05183
[2025-05-13T06:27:41.124Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Using conversationId from payload.
[2025-05-13T06:27:41.185Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Fetched current history. Count: 4
[2025-05-13T06:27:41.185Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Calling streaming intent handler.
[2025-05-13T06:27:41.186Z] --- [K0cB-1747117661123 Socket K0cBxDOcI3yxB6T8AAAB] Handling STREAMING input: "bạn là ai ?", Lang: ru ---
[2025-05-13T06:27:41.187Z] [Language Config] Using configuration for Agent: HostAgent, Language: ru
[2025-05-13T06:27:41.187Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:27:41.187Z] --- [K0cB-1747117661123 HostAgent Streaming Turn 1 Start - K0cBxDOcI3yxB6T8AAAB] ---
[2025-05-13T06:27:41.188Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:27:41.188Z] [K0cB-1747117661123 History T1 Send - K0cBxDOcI3yxB6T8AAAB] Host History Size: 5
[2025-05-13T06:27:41.188Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:27:41.188Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:27:41.188Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:27:41.189Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:27:41.189Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:27:41.189Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:27:41.189Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:27:41.189Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:27:41.190Z]   - No valid next turn added, sending only history.
[2025-05-13T06:27:42.863Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:27:42.863Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:27:42.863Z] [K0cB-1747117661123 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Starting...
[2025-05-13T06:27:42.864Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:27:42.864Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:27:42.972Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:27:42.976Z] [K0cB-1747117661123 Stream Processing - K0cBxDOcI3yxB6T8AAAB] Finished. Length: 60
[2025-05-13T06:27:42.976Z] [K0cB-1747117661123 K0cBxDOcI3yxB6T8AAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:27:42.977Z] [K0cB-1747117661123 Streaming Emit Sent - K0cBxDOcI3yxB6T8AAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:27:42.977Z] --- [K0cB-1747117661123 K0cBxDOcI3yxB6T8AAAB Lang: ru] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:27:42.978Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T06:27:43.057Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Successfully updated history in DB.
[2025-05-13T06:27:43.058Z] [DEBUG] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:27:43.058Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:27:43.305Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:27:43.306Z] [INFO] [coreHandlers][K0cBxDOcI3yxB6T8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:K0cB-1747117661123][Conv:6822e60a2402d17be3c05183] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:28:58.168Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:28:58.169Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:28:58.502Z] [MainLoader] Starting application loading process...
[2025-05-13T06:28:58.503Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:28:58.505Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:28:59.353Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:28:59.354Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:28:59.354Z] [MainLoader] Database loaded.
[2025-05-13T06:28:59.354Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:28:59.355Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:28:59.360Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:28:59.363Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:28:59.364Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:28:59.364Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:28:59.364Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:28:59.365Z] [MainLoader] Express loaded.
[2025-05-13T06:28:59.366Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:28:59.371Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:28:59.371Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:28:59.371Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:28:59.372Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:28:59.372Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:28:59.408Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:28:59.409Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:28:59.409Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:28:59.451Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:28:59.452Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:29:01.168Z] [socketAuth][Odsy_XSCyHzyPjPSAAAB] Authentication attempt. Has token: true
[2025-05-13T06:29:01.172Z] [socketAuth][Odsy_XSCyHzyPjPSAAAB] Token signature validated successfully.
[2025-05-13T06:29:01.175Z] [HistoryService] Initialized.
[2025-05-13T06:29:01.176Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB] New connection. Socket ID: Odsy_XSCyHzyPjPSAAAB. Initial socket.data.userId: null
[2025-05-13T06:29:01.176Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:29:01.177Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB] Attempting to fetch user info using token...
[2025-05-13T06:29:01.177Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:29:01.178Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:29:01.865Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:29:01.866Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:29:01.866Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:29:01.868Z] [HistoryService] Initialized.
[2025-05-13T06:29:01.868Z] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:29:01.868Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:29:01.868Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:29:01.869Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:29:01.870Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:29:01.870Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:29:01.913Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:29:02.191Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:29:02.192Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:29:02.193Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:29:02.193Z] [SERVER GLOBAL][connection][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:29:10.326Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822e60a2402d17be3c05183"}]
[2025-05-13T06:29:10.327Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e60a2402d17be3c05183] Request received.
[2025-05-13T06:29:10.413Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e60a2402d17be3c05183] Successfully processed deletion.
[2025-05-13T06:29:10.415Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822e60a2402d17be3c05183
[2025-05-13T06:29:10.415Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:29:10.694Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:29:10.695Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822e60a2402d17be3c05183, Count: 11
[2025-05-13T06:29:32.409Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Find Big Data conferences this year (2025).","isStreaming":true,"language":"ru","conversationId":null}]
[2025-05-13T06:29:32.411Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411] Request received. UserInput: "Find Big Data conferences this...", Streaming: true, Language: ru, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:29:32.411Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:29:32.597Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:29:32.599Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:29:32.599Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:29:32.891Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:29:32.893Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:29:32.965Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Fetched current history. Count: 0
[2025-05-13T06:29:32.966Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Calling streaming intent handler.
[2025-05-13T06:29:32.967Z] --- [Odsy-1747117772411 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "Find Big Data conferences this year (2025).", Lang: ru ---
[2025-05-13T06:29:32.968Z] [Language Config] Using configuration for Agent: HostAgent, Language: ru
[2025-05-13T06:29:32.969Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:29:32.970Z] --- [Odsy-1747117772411 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:29:32.971Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:29:32.971Z] [Odsy-1747117772411 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 1
[2025-05-13T06:29:32.974Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:29:32.975Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:29:32.975Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:29:32.975Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:29:32.976Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:29:32.976Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:29:32.976Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:29:32.976Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:29:32.977Z]   - No valid next turn added, sending only history.
[2025-05-13T06:29:34.790Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:29:34.791Z] [Odsy-1747117772411 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:29:34.792Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:29:34.794Z] --- [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: ConferenceAgent, Task: ffc23c3b-6481-4927-83a6-7900def6c058 ---
[2025-05-13T06:29:34.794Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: ru
[2025-05-13T06:29:34.795Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:29:34.795Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:29:34.796Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:29:34.796Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:29:34.797Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:29:34.797Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:29:34.797Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:29:34.798Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:29:34.799Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:29:34.800Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:29:34.801Z]   - No valid next turn added, sending only history.
[2025-05-13T06:29:36.548Z] Model Finish Reason: STOP
[2025-05-13T06:29:36.548Z] Model requested function call: getConferences
[2025-05-13T06:29:36.549Z] Arguments: {"searchQuery":"title=Big+Data&perPage=5&page=1"}
[2025-05-13T06:29:36.549Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:29:36.549Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794] ConferenceAgent requests function call: getConferences
[2025-05-13T06:29:36.550Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:29:36.550Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:29:36.551Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:29:36.551Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:29:36.552Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"title=Big+Data&perPage=5&page=1"}
[2025-05-13T06:29:36.553Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:29:36.553Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:29:36.553Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:29:36.554Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:29:36.554Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:29:36.554Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:29:36.556Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?title=Big+Data&perPage=5&page=1}
[2025-05-13T06:29:37.275Z] [BackendService] [conference] API Success (200). Data length: 3980. Attempting parsing...
[2025-05-13T06:29:37.275Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"115d92f6-5665-4e37-9f6a-f352126b33bc","title":"International Conference on Internet of Things, Big Data and Security","acronym":"IoTBDS","location":{"cityStateProvince":"Porto","country":"Portugal","address":"Vila Galé Porto hotel,...
[2025-05-13T06:29:37.276Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:29:37.277Z] Transforming conference data with Markdown. Search query: title=Big+Data&perPage=5&page=1
[2025-05-13T06:29:37.282Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 4
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Internet of Things, Big Data and ...
[2025-05-13T06:29:37.283Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="title=Big+Data&perPage=5&page=1"
[2025-05-13T06:29:37.283Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:29:37.283Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:29:37.284Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:29:37.284Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:29:37.284Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:29:37.285Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:29:37.285Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:29:37.285Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:29:37.286Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:29:37.286Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:29:37.286Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:29:37.286Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:29:37.287Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:29:37.287Z] [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:29:37.287Z] --- [Odsy-1747117772411-Sub-ConferenceAgent-1747117774794] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:29:37.288Z] [Odsy-1747117772411 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:29:37.289Z] --- [Odsy-1747117772411 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:29:37.290Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:29:37.290Z] [Odsy-1747117772411 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 3
[2025-05-13T06:29:37.291Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:29:37.291Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:29:37.291Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:29:37.291Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:29:37.292Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:29:37.292Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:29:37.292Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:29:37.292Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:29:37.292Z]   - No valid next turn added, sending only history.
[2025-05-13T06:29:37.842Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:29:37.843Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:29:37.844Z] [Odsy-1747117772411 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:29:37.844Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:29:37.845Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:37.953Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:38.102Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:38.293Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:38.446Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:38.658Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:38.890Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:29:38.895Z] [Odsy-1747117772411 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 635
[2025-05-13T06:29:38.896Z] [Odsy-1747117772411 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:29:38.897Z] [Odsy-1747117772411 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:29:38.897Z] --- [Odsy-1747117772411 Odsy_XSCyHzyPjPSAAAB Lang: ru] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:29:38.897Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:29:39.015Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Successfully updated history in DB.
[2025-05-13T06:29:39.016Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:29:39.016Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:29:39.327Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:29:39.328Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117772411][Conv:6822e6ccb753913854ef3312] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:30:04.995Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Bạn là ai ?","isStreaming":true,"language":"fr","conversationId":"6822e6ccb753913854ef3312"}]
[2025-05-13T06:30:04.995Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995] Request received. UserInput: "Bạn là ai ?", Streaming: true, Language: fr, PayloadConvId: 6822e6ccb753913854ef3312, SocketDataConvId: 6822e6ccb753913854ef3312
[2025-05-13T06:30:04.995Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Using conversationId from payload.
[2025-05-13T06:30:05.074Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Fetched current history. Count: 4
[2025-05-13T06:30:05.074Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Calling streaming intent handler.
[2025-05-13T06:30:05.074Z] --- [Odsy-1747117804995 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "Bạn là ai ?", Lang: fr ---
[2025-05-13T06:30:05.074Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:30:05.075Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:05.075Z] --- [Odsy-1747117804995 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:30:05.076Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:05.076Z] [Odsy-1747117804995 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 5
[2025-05-13T06:30:05.076Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:30:05.077Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:30:05.077Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:30:05.077Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:30:05.077Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:30:05.078Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:30:05.078Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:30:05.078Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:30:05.078Z]   - No valid next turn added, sending only history.
[2025-05-13T06:30:06.775Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:30:06.776Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:06.776Z] [Odsy-1747117804995 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:30:06.777Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:06.777Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:06.825Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:06.832Z] [Odsy-1747117804995 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 56
[2025-05-13T06:30:06.833Z] [Odsy-1747117804995 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:30:06.834Z] [Odsy-1747117804995 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:30:06.834Z] --- [Odsy-1747117804995 Odsy_XSCyHzyPjPSAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:30:06.834Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T06:30:06.916Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Successfully updated history in DB.
[2025-05-13T06:30:06.916Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:30:06.917Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:30:07.239Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:30:07.240Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117804995][Conv:6822e6ccb753913854ef3312] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:30:25.811Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822e6ccb753913854ef3312"}]
[2025-05-13T06:30:25.812Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e6ccb753913854ef3312] Request received.
[2025-05-13T06:30:25.886Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e6ccb753913854ef3312] Successfully processed deletion.
[2025-05-13T06:30:25.887Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e6ccb753913854ef3312] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:30:25.887Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822e6ccb753913854ef3312
[2025-05-13T06:30:25.887Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:30:26.171Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:30:26.172Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822e6ccb753913854ef3312, Count: 11
[2025-05-13T06:30:41.018Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Bạn là ai","isStreaming":true,"language":"fr","conversationId":null}]
[2025-05-13T06:30:41.019Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019] Request received. UserInput: "Bạn là ai", Streaming: true, Language: fr, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:30:41.019Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:30:41.166Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:30:41.167Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:30:41.167Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:30:41.442Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:30:41.442Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:30:41.510Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Fetched current history. Count: 0
[2025-05-13T06:30:41.510Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:30:41.511Z] --- [Odsy-1747117841019 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "Bạn là ai", Lang: fr ---
[2025-05-13T06:30:41.511Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:30:41.512Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:41.514Z] --- [Odsy-1747117841019 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:30:41.514Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:41.515Z] [Odsy-1747117841019 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 1
[2025-05-13T06:30:41.515Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:30:41.515Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:30:41.515Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:30:41.516Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:30:41.516Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:30:41.516Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:30:41.516Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:30:41.516Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:30:41.517Z]   - No valid next turn added, sending only history.
[2025-05-13T06:30:43.086Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:30:43.087Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:43.087Z] [Odsy-1747117841019 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:30:43.088Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:30:43.088Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:43.193Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:43.255Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:43.440Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:43.468Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:30:43.478Z] [Odsy-1747117841019 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 337
[2025-05-13T06:30:43.478Z] [Odsy-1747117841019 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:30:43.479Z] [Odsy-1747117841019 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:30:43.480Z] --- [Odsy-1747117841019 Odsy_XSCyHzyPjPSAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:30:43.481Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T06:30:43.557Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:30:43.557Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:30:43.557Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:30:43.839Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:30:43.840Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117841019][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:31:20.657Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Bạn có thể làm gì ?","isStreaming":true,"language":"fr","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:31:20.658Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658] Request received. UserInput: "Bạn có thể làm gì ?", Streaming: true, Language: fr, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:31:20.658Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:31:20.728Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Fetched current history. Count: 2
[2025-05-13T06:31:20.728Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:31:20.728Z] --- [Odsy-1747117880658 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "Bạn có thể làm gì ?", Lang: fr ---
[2025-05-13T06:31:20.728Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:31:20.729Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:31:20.731Z] --- [Odsy-1747117880658 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:31:20.731Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:31:20.732Z] [Odsy-1747117880658 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 3
[2025-05-13T06:31:20.733Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:31:20.734Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:31:20.735Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:31:20.739Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:31:20.739Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:31:20.743Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:31:20.744Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:31:20.748Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:31:20.749Z]   - No valid next turn added, sending only history.
[2025-05-13T06:31:22.267Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:31:22.268Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:31:22.269Z] [Odsy-1747117880658 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:31:22.269Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:31:22.269Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:31:22.361Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:31:22.465Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:31:22.516Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:31:22.522Z] [Odsy-1747117880658 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 201
[2025-05-13T06:31:22.522Z] [Odsy-1747117880658 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:31:22.523Z] [Odsy-1747117880658 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:31:22.523Z] --- [Odsy-1747117880658 Odsy_XSCyHzyPjPSAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:31:22.523Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:31:22.600Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:31:22.601Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:31:22.601Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:31:22.900Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:31:22.901Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117880658][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:32:08.821Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tìm hội nghị tại việt nam","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:32:08.821Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821] Request received. UserInput: "tìm hội nghị tại việt nam", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:32:08.821Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:32:08.892Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Fetched current history. Count: 4
[2025-05-13T06:32:08.893Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:32:08.893Z] --- [Odsy-1747117928821 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "tìm hội nghị tại việt nam", Lang: es ---
[2025-05-13T06:32:08.893Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:32:08.894Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:32:08.895Z] --- [Odsy-1747117928821 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:32:08.895Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:32:08.896Z] [Odsy-1747117928821 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 5
[2025-05-13T06:32:08.897Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:32:08.897Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:32:08.898Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:32:08.899Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:32:08.899Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:32:08.899Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:32:08.900Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:32:08.901Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:32:08.901Z]   - No valid next turn added, sending only history.
[2025-05-13T06:32:10.474Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:32:10.475Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:32:10.475Z] [Odsy-1747117928821 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:32:10.476Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:32:10.476Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:32:10.599Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:32:10.659Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:32:10.667Z] [Odsy-1747117928821 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 130
[2025-05-13T06:32:10.667Z] [Odsy-1747117928821 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:32:10.668Z] [Odsy-1747117928821 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:32:10.668Z] --- [Odsy-1747117928821 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:32:10.668Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T06:32:10.744Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:32:10.745Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:32:10.745Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:32:11.021Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:32:11.022Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747117928821][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:34:35.078Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tìm các hội nghị diễn ra tại Vietnam","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:34:35.078Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078] Request received. UserInput: "tìm các hội nghị diễn ra tại V...", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:34:35.079Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:34:35.153Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Fetched current history. Count: 6
[2025-05-13T06:34:35.154Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:34:35.154Z] --- [Odsy-1747118075078 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "tìm các hội nghị diễn ra tại Vietnam", Lang: es ---
[2025-05-13T06:34:35.154Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:34:35.155Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:35.166Z] --- [Odsy-1747118075078 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:34:35.168Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:35.170Z] [Odsy-1747118075078 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 7
[2025-05-13T06:34:35.171Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T06:34:35.178Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T06:34:35.180Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:34:35.180Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:34:35.181Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:34:35.182Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:34:35.183Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:34:35.184Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T06:34:35.185Z]   - No valid next turn added, sending only history.
[2025-05-13T06:34:36.914Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:34:36.915Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:36.915Z] [Odsy-1747118075078 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:34:36.915Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:36.916Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:36.976Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:37.011Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:37.015Z] [Odsy-1747118075078 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 130
[2025-05-13T06:34:37.015Z] [Odsy-1747118075078 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:34:37.016Z] [Odsy-1747118075078 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:34:37.016Z] --- [Odsy-1747118075078 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:34:37.017Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T06:34:37.097Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:34:37.098Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:34:37.098Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:34:37.379Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:34:37.379Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118075078][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:34:45.031Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:34:45.032Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Request received.
[2025-05-13T06:34:45.106Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Successfully processed message clearing.
[2025-05-13T06:34:45.106Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Cleared conversation was active. Emitting empty history.
[2025-05-13T06:34:45.107Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822e711b753913854ef331e
[2025-05-13T06:34:45.110Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:34:45.397Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:34:45.398Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822e711b753913854ef331e, Count: 12
[2025-05-13T06:34:48.124Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tìm các hội nghị diễn ra tại Vietnam","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:34:48.125Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125] Request received. UserInput: "tìm các hội nghị diễn ra tại V...", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:34:48.125Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:34:48.196Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Fetched current history. Count: 0
[2025-05-13T06:34:48.196Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:34:48.196Z] --- [Odsy-1747118088125 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "tìm các hội nghị diễn ra tại Vietnam", Lang: es ---
[2025-05-13T06:34:48.197Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:34:48.197Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:48.198Z] --- [Odsy-1747118088125 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:34:48.198Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:48.198Z] [Odsy-1747118088125 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 1
[2025-05-13T06:34:48.198Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:34:48.199Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:34:48.199Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:34:48.199Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:34:48.199Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:34:48.199Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:34:48.200Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:34:48.200Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:34:48.200Z]   - No valid next turn added, sending only history.
[2025-05-13T06:34:50.119Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:34:50.119Z] [Odsy-1747118088125 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:34:50.120Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:50.120Z] --- [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: ConferenceAgent, Task: 6262d5d5-914a-4c70-9553-d8c3c142b88c ---
[2025-05-13T06:34:50.120Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T06:34:50.121Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:34:50.121Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:34:50.121Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:34:50.122Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:34:50.122Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:34:50.122Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:34:50.122Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:34:50.122Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:34:50.123Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:34:50.124Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:34:50.124Z]   - No valid next turn added, sending only history.
[2025-05-13T06:34:51.910Z] Model Finish Reason: STOP
[2025-05-13T06:34:51.910Z] Model requested function call: getConferences
[2025-05-13T06:34:51.910Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T06:34:51.910Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:34:51.911Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120] ConferenceAgent requests function call: getConferences
[2025-05-13T06:34:51.911Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:34:51.911Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:34:51.912Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:34:51.912Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:34:51.912Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T06:34:51.913Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:34:51.913Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:34:51.913Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:34:51.914Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:34:51.914Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:34:51.914Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:34:51.914Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T06:34:52.659Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T06:34:52.659Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T06:34:52.660Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:34:52.660Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T06:34:52.665Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T06:34:52.666Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T06:34:52.667Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:34:52.668Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:34:52.668Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:34:52.669Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:34:52.669Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:34:52.670Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:34:52.670Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:34:52.670Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:34:52.670Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:34:52.671Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:34:52.672Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:34:52.673Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:34:52.674Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:34:52.674Z] [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:34:52.675Z] --- [Odsy-1747118088125-Sub-ConferenceAgent-1747118090120] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:34:52.677Z] [Odsy-1747118088125 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:34:52.678Z] --- [Odsy-1747118088125 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:34:52.678Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:52.679Z] [Odsy-1747118088125 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 3
[2025-05-13T06:34:52.680Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:34:52.680Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:34:52.680Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:34:52.680Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:34:52.681Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:34:52.681Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:34:52.681Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:34:52.681Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:34:52.682Z]   - No valid next turn added, sending only history.
[2025-05-13T06:34:53.336Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:34:53.337Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:53.337Z] [Odsy-1747118088125 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:34:53.337Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:34:53.338Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:53.447Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:53.527Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:53.669Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:53.810Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:54.037Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:54.155Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:34:54.164Z] [Odsy-1747118088125 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 581
[2025-05-13T06:34:54.164Z] [Odsy-1747118088125 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:34:54.165Z] [Odsy-1747118088125 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:34:54.167Z] --- [Odsy-1747118088125 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:34:54.168Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:34:54.244Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:34:54.244Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:34:54.245Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:34:54.521Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:34:54.522Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118088125][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:35:09.271Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"hội nghị về chủ đề trí tuệ nhân tạo","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:35:09.271Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271] Request received. UserInput: "hội nghị về chủ đề trí tuệ nhâ...", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:35:09.271Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:35:09.342Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Fetched current history. Count: 4
[2025-05-13T06:35:09.343Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:35:09.343Z] --- [Odsy-1747118109271 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "hội nghị về chủ đề trí tuệ nhân tạo", Lang: es ---
[2025-05-13T06:35:09.343Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:35:09.344Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:35:09.344Z] --- [Odsy-1747118109271 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:35:09.345Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:35:09.345Z] [Odsy-1747118109271 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 5
[2025-05-13T06:35:09.345Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:35:09.345Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:35:09.345Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:35:09.346Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:35:09.347Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:35:09.347Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:35:09.347Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:35:09.349Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:35:09.351Z]   - No valid next turn added, sending only history.
[2025-05-13T06:35:11.107Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:35:11.108Z] [Odsy-1747118109271 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:35:11.108Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:35:11.109Z] --- [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: ConferenceAgent, Task: 1b01a3e8-9b23-4bd3-a55f-4c0ab5b82cf8 ---
[2025-05-13T06:35:11.109Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T06:35:11.109Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:35:11.110Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:35:11.110Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:35:11.110Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:35:11.110Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:35:11.110Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:35:11.110Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:35:11.111Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:35:11.111Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:35:11.111Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:35:11.111Z]   - No valid next turn added, sending only history.
[2025-05-13T06:35:12.854Z] Model Finish Reason: STOP
[2025-05-13T06:35:12.854Z] Model requested function call: getConferences
[2025-05-13T06:35:12.854Z] Arguments: {"searchQuery":"topics=Artificial+Intelligence&perPage=5&page=1"}
[2025-05-13T06:35:12.854Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:35:12.855Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109] ConferenceAgent requests function call: getConferences
[2025-05-13T06:35:12.855Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:35:12.855Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:35:12.856Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:35:12.856Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:35:12.856Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Artificial+Intelligence&perPage=5&page=1"}
[2025-05-13T06:35:12.857Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:35:12.857Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:35:12.857Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:35:12.857Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:35:12.857Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:35:12.858Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:35:12.858Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Artificial+Intelligence&perPage=5&page=1}
[2025-05-13T06:35:13.577Z] [BackendService] [conference] API Success (200). Data length: 7919. Attempting parsing...
[2025-05-13T06:35:13.578Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0355e308-1f83-447f-84da-7893b97a6af6","title":"International Conference on Scientific and Statistical Data Base Management","acronym":"SSDBM","location":{"cityStateProvince":"Columbus, Ohio","country":"United States","address":"Pom...
[2025-05-13T06:35:13.578Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:35:13.578Z] Transforming conference data with Markdown. Search query: topics=Artificial+Intelligence&perPage=5&page=1
[2025-05-13T06:35:13.588Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 116
- **Total page:** 24
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Scientific and Statistical Data B...
[2025-05-13T06:35:13.588Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Artificial+Intelligence&perPage=5&page=1"
[2025-05-13T06:35:13.589Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:35:13.589Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:35:13.589Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:35:13.589Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:35:13.590Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:35:13.590Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:35:13.590Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:35:13.590Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:35:13.591Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:35:13.591Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:35:13.591Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:35:13.591Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:35:13.592Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:35:13.592Z] [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:35:13.592Z] --- [Odsy-1747118109271-Sub-ConferenceAgent-1747118111109] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:35:13.592Z] [Odsy-1747118109271 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:35:13.593Z] --- [Odsy-1747118109271 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:35:13.593Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:35:13.593Z] [Odsy-1747118109271 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 7
[2025-05-13T06:35:13.593Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T06:35:13.594Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T06:35:13.594Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:35:13.594Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:35:13.594Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:35:13.595Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:35:13.596Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:35:13.596Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T06:35:13.597Z]   - No valid next turn added, sending only history.
[2025-05-13T06:35:14.204Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:35:14.205Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:35:14.205Z] [Odsy-1747118109271 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:35:14.206Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:35:14.206Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:14.267Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:14.360Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:14.486Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:14.617Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:14.883Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:15.063Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:15.167Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:35:15.174Z] [Odsy-1747118109271 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 775
[2025-05-13T06:35:15.175Z] [Odsy-1747118109271 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:35:15.176Z] [Odsy-1747118109271 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:35:15.177Z] --- [Odsy-1747118109271 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:35:15.178Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T06:35:15.266Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:35:15.267Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:35:15.267Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:35:15.556Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:35:15.557Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118109271][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:36:20.011Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"chi tiết về hội nghị cuối cùng","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:36:20.012Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012] Request received. UserInput: "chi tiết về hội nghị cuối cùng", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:36:20.012Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:36:20.089Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Fetched current history. Count: 8
[2025-05-13T06:36:20.090Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:36:20.090Z] --- [Odsy-1747118180012 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "chi tiết về hội nghị cuối cùng", Lang: es ---
[2025-05-13T06:36:20.090Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:36:20.091Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:20.092Z] --- [Odsy-1747118180012 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:36:20.092Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:20.093Z] [Odsy-1747118180012 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 9
[2025-05-13T06:36:20.093Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T06:36:20.094Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T06:36:20.094Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:36:20.094Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:20.094Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:20.095Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:36:20.095Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:20.095Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T06:36:20.095Z]   - No valid next turn added, sending only history.
[2025-05-13T06:36:21.074Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:36:21.074Z] [Odsy-1747118180012 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:36:21.075Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:21.075Z] --- [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: ConferenceAgent, Task: fd58164e-5060-429e-84ef-9626c3a855a6 ---
[2025-05-13T06:36:21.076Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T06:36:21.076Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:36:21.076Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:36:21.077Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:36:21.077Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:36:21.077Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:36:21.077Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:21.077Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:21.078Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:36:21.078Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:21.078Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:36:21.078Z]   - No valid next turn added, sending only history.
[2025-05-13T06:36:21.851Z] Model Finish Reason: STOP
[2025-05-13T06:36:21.851Z] Model requested function call: getConferences
[2025-05-13T06:36:21.851Z] Arguments: {"searchQuery":"mode=detail&acronym=IEEE+CIFEr&perPage=5&page=1"}
[2025-05-13T06:36:21.851Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:36:21.852Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075] ConferenceAgent requests function call: getConferences
[2025-05-13T06:36:21.852Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:36:21.852Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:36:21.853Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:36:21.854Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:36:21.854Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"mode=detail&acronym=IEEE+CIFEr&perPage=5&page=1"}
[2025-05-13T06:36:21.855Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:36:21.855Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:36:21.856Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:36:21.856Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:36:21.856Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:36:21.857Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:36:21.857Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?mode=detail&acronym=IEEE+CIFEr&perPage=5&page=1}
[2025-05-13T06:36:22.516Z] [BackendService] [conference] API Success (200). Data length: 7387. Attempting parsing...
[2025-05-13T06:36:22.517Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"08f8d905-e4f8-40a6-9529-6652f477c89f","title":"IEEE Symposium on Computational Intelligence for Financial Engineering","acronym":"IEEE CIFEr","creatorId":null,"adminId":"077f9da9-5570-4b2e-80e3-35e875c8f8b2","createdAt":"2025-05-04...
[2025-05-13T06:36:22.517Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:36:22.517Z] Transforming conference data with Markdown. Search query: mode=detail&acronym=IEEE+CIFEr&perPage=5&page=1
[2025-05-13T06:36:22.528Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** IEEE Symposium on Computational Intelligence for Financial En...
[2025-05-13T06:36:22.528Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="mode=detail&acronym=IEEE+CIFEr&perPage=5&page=1"
[2025-05-13T06:36:22.529Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:36:22.529Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:36:22.529Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:36:22.530Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:36:22.530Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:36:22.531Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:36:22.531Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:36:22.531Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:36:22.531Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:36:22.532Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:36:22.532Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:36:22.532Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:36:22.533Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:36:22.533Z] [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:36:22.533Z] --- [Odsy-1747118180012-Sub-ConferenceAgent-1747118181075] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:36:22.533Z] [Odsy-1747118180012 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:36:22.534Z] --- [Odsy-1747118180012 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:36:22.534Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:22.534Z] [Odsy-1747118180012 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 11
[2025-05-13T06:36:22.534Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T06:36:22.535Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T06:36:22.535Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:36:22.535Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:22.535Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:22.536Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:36:22.536Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:22.536Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T06:36:22.536Z]   - No valid next turn added, sending only history.
[2025-05-13T06:36:23.242Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:36:23.243Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:23.243Z] [Odsy-1747118180012 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:36:23.244Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:23.244Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:23.311Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:23.417Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:23.528Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:23.651Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:23.889Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:24.185Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:24.478Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:24.806Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:25.076Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:25.338Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:25.621Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:25.962Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:26.091Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:26.097Z] [Odsy-1747118180012 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 2140
[2025-05-13T06:36:26.098Z] [Odsy-1747118180012 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:36:26.098Z] [Odsy-1747118180012 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:36:26.098Z] --- [Odsy-1747118180012 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:36:26.099Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T06:36:26.191Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:36:26.191Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:36:26.191Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:36:26.472Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:36:26.473Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118180012][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:36:51.659Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"rank của hội nghị","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:36:51.660Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660] Request received. UserInput: "rank của hội nghị", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:36:51.660Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:36:51.809Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Fetched current history. Count: 12
[2025-05-13T06:36:51.810Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:36:51.810Z] --- [Odsy-1747118211660 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "rank của hội nghị", Lang: es ---
[2025-05-13T06:36:51.810Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:36:51.811Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:51.811Z] --- [Odsy-1747118211660 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:36:51.812Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:51.812Z] [Odsy-1747118211660 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 13
[2025-05-13T06:36:51.812Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T06:36:51.812Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T06:36:51.812Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:36:51.813Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:51.813Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:51.813Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:36:51.813Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:51.815Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T06:36:51.817Z]   - No valid next turn added, sending only history.
[2025-05-13T06:36:52.708Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:36:52.709Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:52.709Z] [Odsy-1747118211660 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:36:52.710Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:52.710Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:52.737Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:36:52.935Z] [Odsy-1747118211660 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 65
[2025-05-13T06:36:52.936Z] [Odsy-1747118211660 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:36:52.936Z] [Odsy-1747118211660 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:36:52.936Z] --- [Odsy-1747118211660 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:36:52.937Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T06:36:53.022Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:36:53.023Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:36:53.023Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:36:53.295Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:36:53.296Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118211660][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:36:57.038Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"đúng","isStreaming":true,"language":"es","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:36:57.038Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038] Request received. UserInput: "đúng", Streaming: true, Language: es, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:36:57.038Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:36:57.185Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Fetched current history. Count: 14
[2025-05-13T06:36:57.185Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:36:57.186Z] --- [Odsy-1747118217038 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "đúng", Lang: es ---
[2025-05-13T06:36:57.186Z] [Language Config] Using configuration for Agent: HostAgent, Language: es
[2025-05-13T06:36:57.186Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:57.187Z] --- [Odsy-1747118217038 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:36:57.187Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:57.187Z] [Odsy-1747118217038 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 15
[2025-05-13T06:36:57.187Z] [GeminiService] Received history with 15 items before mapping (for stream).
[2025-05-13T06:36:57.188Z] [GeminiService] Mapped history (SDK Content[]) with 15 items (for stream).
[2025-05-13T06:36:57.188Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:36:57.188Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:57.188Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:57.188Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:36:57.189Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:57.189Z] [GeminiService Stream] Preparing stream request with 15 Content items.
[2025-05-13T06:36:57.189Z]   - No valid next turn added, sending only history.
[2025-05-13T06:36:58.160Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:36:58.160Z] [Odsy-1747118217038 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:36:58.161Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:58.161Z] --- [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: ConferenceAgent, Task: 9872248c-4d5f-47a4-aa6f-a9d7403f8ec3 ---
[2025-05-13T06:36:58.162Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: es
[2025-05-13T06:36:58.162Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:36:58.162Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:36:58.163Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:36:58.163Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:36:58.163Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:36:58.163Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:58.163Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:58.164Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:36:58.164Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:58.164Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:36:58.164Z]   - No valid next turn added, sending only history.
[2025-05-13T06:36:59.000Z] Model Finish Reason: STOP
[2025-05-13T06:36:59.000Z] Model requested function call: getConferences
[2025-05-13T06:36:59.001Z] Arguments: {"searchQuery":"acronym=IEEE+CIFEr"}
[2025-05-13T06:36:59.001Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:36:59.002Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161] ConferenceAgent requests function call: getConferences
[2025-05-13T06:36:59.002Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:36:59.002Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:36:59.003Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:36:59.003Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:36:59.003Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"acronym=IEEE+CIFEr"}
[2025-05-13T06:36:59.004Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:36:59.004Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:36:59.004Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:36:59.004Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:36:59.005Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:36:59.005Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:36:59.005Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=IEEE+CIFEr}
[2025-05-13T06:36:59.658Z] [BackendService] [conference] API Success (200). Data length: 109. Attempting parsing...
[2025-05-13T06:36:59.658Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[],"meta":{"curPage":1,"perPage":10,"totalItems":0,"totalPage":0,"prevPage":null,"nextPage":null}}...
[2025-05-13T06:36:59.658Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:36:59.659Z] Transforming conference data with Markdown. Search query: acronym=IEEE+CIFEr
[2025-05-13T06:36:59.659Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 10
- **Total items:** 0
- **Total page:** 0
- **Prev page:** null
- **Next page:** null

**Payload:**
---
*No conferences found matching your criteria.*
...
[2025-05-13T06:36:59.659Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="acronym=IEEE+CIFEr"
[2025-05-13T06:36:59.659Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:36:59.659Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:36:59.660Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:36:59.660Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:36:59.660Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:36:59.661Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:36:59.661Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:36:59.661Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:36:59.661Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:36:59.661Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:36:59.662Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:36:59.662Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:36:59.662Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:36:59.662Z] [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:36:59.663Z] --- [Odsy-1747118217038-Sub-ConferenceAgent-1747118218161] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:36:59.663Z] [Odsy-1747118217038 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:36:59.663Z] --- [Odsy-1747118217038 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:36:59.663Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:36:59.664Z] [Odsy-1747118217038 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 17
[2025-05-13T06:36:59.664Z] [GeminiService] Received history with 17 items before mapping (for stream).
[2025-05-13T06:36:59.664Z] [GeminiService] Mapped history (SDK Content[]) with 17 items (for stream).
[2025-05-13T06:36:59.665Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:36:59.665Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:36:59.666Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:36:59.666Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:36:59.667Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:36:59.667Z] [GeminiService Stream] Preparing stream request with 17 Content items.
[2025-05-13T06:36:59.667Z]   - No valid next turn added, sending only history.
[2025-05-13T06:37:00.445Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:37:00.445Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:00.445Z] [Odsy-1747118217038 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:37:00.446Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:00.446Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:00.533Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:00.542Z] [Odsy-1747118217038 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 60
[2025-05-13T06:37:00.542Z] [Odsy-1747118217038 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:37:00.543Z] [Odsy-1747118217038 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:37:00.543Z] --- [Odsy-1747118217038 Odsy_XSCyHzyPjPSAAAB Lang: es] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:37:00.543Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 18
[2025-05-13T06:37:00.631Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:37:00.631Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:37:00.631Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:37:00.920Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:37:00.921Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118217038][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:37:09.736Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: clear_conversation, Args: [{"conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:37:09.737Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Request received.
[2025-05-13T06:37:09.808Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Successfully processed message clearing.
[2025-05-13T06:37:09.808Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Cleared conversation was active. Emitting empty history.
[2025-05-13T06:37:09.809Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: cleared conversation 6822e711b753913854ef331e
[2025-05-13T06:37:09.809Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:37:10.087Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:37:10.089Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: cleared conversation 6822e711b753913854ef331e, Count: 12
[2025-05-13T06:37:19.896Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Hello","isStreaming":true,"language":"fa","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:37:19.897Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897] Request received. UserInput: "Hello", Streaming: true, Language: fa, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:37:19.898Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:37:19.973Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Fetched current history. Count: 0
[2025-05-13T06:37:19.974Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:37:19.974Z] --- [Odsy-1747118239897 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "Hello", Lang: fa ---
[2025-05-13T06:37:19.974Z] [Language Config] Using configuration for Agent: HostAgent, Language: fa
[2025-05-13T06:37:19.975Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:19.975Z] --- [Odsy-1747118239897 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:37:19.975Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:19.975Z] [Odsy-1747118239897 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 1
[2025-05-13T06:37:19.976Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:37:19.976Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:37:19.976Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:37:19.976Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:37:19.976Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:37:19.977Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:37:19.977Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:37:19.977Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:37:19.977Z]   - No valid next turn added, sending only history.
[2025-05-13T06:37:20.673Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:37:20.674Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:20.674Z] [Odsy-1747118239897 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:37:20.674Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:20.675Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:20.750Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:20.761Z] [Odsy-1747118239897 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 34
[2025-05-13T06:37:20.762Z] [Odsy-1747118239897 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:37:20.762Z] [Odsy-1747118239897 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:37:20.763Z] --- [Odsy-1747118239897 Odsy_XSCyHzyPjPSAAAB Lang: fa] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:37:20.763Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T06:37:20.839Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:37:20.839Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:37:20.840Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:37:21.135Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:37:21.135Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118239897][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:37:26.985Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Bạn là ai","isStreaming":true,"language":"fa","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:37:26.985Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985] Request received. UserInput: "Bạn là ai", Streaming: true, Language: fa, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:37:26.986Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:37:27.056Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Fetched current history. Count: 2
[2025-05-13T06:37:27.057Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:37:27.057Z] --- [Odsy-1747118246985 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "Bạn là ai", Lang: fa ---
[2025-05-13T06:37:27.057Z] [Language Config] Using configuration for Agent: HostAgent, Language: fa
[2025-05-13T06:37:27.057Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:27.058Z] --- [Odsy-1747118246985 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:37:27.058Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:27.058Z] [Odsy-1747118246985 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 3
[2025-05-13T06:37:27.058Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:37:27.058Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:37:27.059Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:37:27.059Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:37:27.059Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:37:27.059Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:37:27.059Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:37:27.060Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:37:27.060Z]   - No valid next turn added, sending only history.
[2025-05-13T06:37:27.705Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:37:27.706Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:27.706Z] [Odsy-1747118246985 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:37:27.707Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:27.707Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:27.778Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:27.785Z] [Odsy-1747118246985 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 28
[2025-05-13T06:37:27.786Z] [Odsy-1747118246985 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:37:27.786Z] [Odsy-1747118246985 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:37:27.786Z] --- [Odsy-1747118246985 Odsy_XSCyHzyPjPSAAAB Lang: fa] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:37:27.787Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:37:27.860Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:37:27.861Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:37:27.861Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:37:28.145Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:37:28.146Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118246985][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:37:52.266Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tìm cho tôi hội nghị tại Vietnam","isStreaming":true,"language":"fa","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:37:52.266Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266] Request received. UserInput: "tìm cho tôi hội nghị tại Vietn...", Streaming: true, Language: fa, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:37:52.267Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:37:52.338Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Fetched current history. Count: 4
[2025-05-13T06:37:52.338Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:37:52.338Z] --- [Odsy-1747118272266 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "tìm cho tôi hội nghị tại Vietnam", Lang: fa ---
[2025-05-13T06:37:52.339Z] [Language Config] Using configuration for Agent: HostAgent, Language: fa
[2025-05-13T06:37:52.340Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:52.340Z] --- [Odsy-1747118272266 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:37:52.341Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:52.341Z] [Odsy-1747118272266 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 5
[2025-05-13T06:37:52.341Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:37:52.341Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:37:52.342Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:37:52.342Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:37:52.342Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:37:52.342Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:37:52.342Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:37:52.343Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:37:52.343Z]   - No valid next turn added, sending only history.
[2025-05-13T06:37:53.202Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:37:53.203Z] [Odsy-1747118272266 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:37:53.204Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:53.205Z] --- [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: ConferenceAgent, Task: ec11de54-a6de-4ef3-86db-14db22f5d78a ---
[2025-05-13T06:37:53.205Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: fa
[2025-05-13T06:37:53.205Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:37:53.206Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:37:53.206Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:37:53.206Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:37:53.207Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:37:53.207Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:37:53.209Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:37:53.209Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:37:53.210Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:37:53.210Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:37:53.211Z]   - No valid next turn added, sending only history.
[2025-05-13T06:37:54.123Z] Model Finish Reason: STOP
[2025-05-13T06:37:54.123Z] Model requested function call: getConferences
[2025-05-13T06:37:54.123Z] Arguments: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T06:37:54.124Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:37:54.124Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205] ConferenceAgent requests function call: getConferences
[2025-05-13T06:37:54.124Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:37:54.124Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:37:54.125Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:37:54.125Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:37:54.126Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"country=Vietnam&perPage=5&page=1"}
[2025-05-13T06:37:54.126Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:37:54.126Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:37:54.126Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:37:54.127Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:37:54.127Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:37:54.127Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:37:54.127Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?country=Vietnam&perPage=5&page=1}
[2025-05-13T06:37:54.822Z] [BackendService] [conference] API Success (200). Data length: 6719. Attempting parsing...
[2025-05-13T06:37:54.822Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"0fb68c8c-6a62-466d-90ea-cac9cd0e8819","title":"Asian Conference on Computer Vision","acronym":"ACCV","location":{"cityStateProvince":"Hanoi","country":"Vietnam","address":"Hanoi, Vietnam","continent":"Asia"},"rank":"B","source":"CO...
[2025-05-13T06:37:54.822Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:37:54.823Z] Transforming conference data with Markdown. Search query: country=Vietnam&perPage=5&page=1
[2025-05-13T06:37:54.828Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 7
- **Total page:** 2
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** Asian Conference on Computer Vision
  - **Acronym:** ACCV
  - **...
[2025-05-13T06:37:54.828Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="country=Vietnam&perPage=5&page=1"
[2025-05-13T06:37:54.829Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:37:54.829Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:37:54.829Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:37:54.830Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:37:54.830Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:37:54.830Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:37:54.831Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:37:54.831Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:37:54.831Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:37:54.831Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 Odsy_XSCyHzyPjPSAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:37:54.831Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:37:54.832Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:37:54.832Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:37:54.832Z] [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:37:54.833Z] --- [Odsy-1747118272266-Sub-ConferenceAgent-1747118273205] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:37:54.833Z] [Odsy-1747118272266 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:37:54.833Z] --- [Odsy-1747118272266 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:37:54.833Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:54.834Z] [Odsy-1747118272266 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 7
[2025-05-13T06:37:54.834Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T06:37:54.834Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T06:37:54.834Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:37:54.834Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:37:54.834Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:37:54.835Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:37:54.835Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:37:54.835Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T06:37:54.836Z]   - No valid next turn added, sending only history.
[2025-05-13T06:37:55.397Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:37:55.398Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:55.398Z] [Odsy-1747118272266 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:37:55.399Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:37:55.399Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:55.545Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:55.643Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:55.792Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:55.973Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:56.203Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:56.437Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:56.472Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:37:56.475Z] [Odsy-1747118272266 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 469
[2025-05-13T06:37:56.476Z] [Odsy-1747118272266 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:37:56.477Z] [Odsy-1747118272266 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:37:56.477Z] --- [Odsy-1747118272266 Odsy_XSCyHzyPjPSAAAB Lang: fa] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:37:56.477Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T06:37:56.561Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:37:56.561Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:37:56.561Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:37:56.839Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:37:56.840Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118272266][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:38:32.253Z] [SERVER SOCKET Odsy_XSCyHzyPjPSAAAB - ON ANY] Event: send_message, Args: [{"userInput":"mở trang web của hội nghị cuối","isStreaming":true,"language":"fa","conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:38:32.254Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254] Request received. UserInput: "mở trang web của hội nghị cuối", Streaming: true, Language: fa, PayloadConvId: 6822e711b753913854ef331e, SocketDataConvId: 6822e711b753913854ef331e
[2025-05-13T06:38:32.254Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Using conversationId from payload.
[2025-05-13T06:38:32.326Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Fetched current history. Count: 8
[2025-05-13T06:38:32.326Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Calling streaming intent handler.
[2025-05-13T06:38:32.326Z] --- [Odsy-1747118312254 Socket Odsy_XSCyHzyPjPSAAAB] Handling STREAMING input: "mở trang web của hội nghị cuối", Lang: fa ---
[2025-05-13T06:38:32.326Z] [Language Config] Using configuration for Agent: HostAgent, Language: fa
[2025-05-13T06:38:32.327Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:38:32.328Z] --- [Odsy-1747118312254 HostAgent Streaming Turn 1 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:38:32.328Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:38:32.328Z] [Odsy-1747118312254 History T1 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 9
[2025-05-13T06:38:32.328Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T06:38:32.329Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T06:38:32.329Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:38:32.329Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:38:32.329Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:38:32.330Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:38:32.330Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:38:32.330Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T06:38:32.330Z]   - No valid next turn added, sending only history.
[2025-05-13T06:38:33.303Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:38:33.304Z] [Odsy-1747118312254 HostAgent Streaming T1 - Odsy_XSCyHzyPjPSAAAB] Requests function: routeToAgent
[2025-05-13T06:38:33.305Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:38:33.305Z] --- [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 Socket Odsy_XSCyHzyPjPSAAAB] Calling Sub Agent: NavigationAgent, Task: fefda6fd-3b4f-4344-bb68-309f138853f0 ---
[2025-05-13T06:38:33.306Z] [Language Config] Using configuration for Agent: NavigationAgent, Language: fa
[2025-05-13T06:38:33.306Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_thinking, Agent: NavigationAgent
[2025-05-13T06:38:33.306Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_thinking for NavigationAgent
[2025-05-13T06:38:33.306Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:38:33.307Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:38:33.307Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:38:33.307Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:38:33.307Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:38:33.308Z] Tools provided: ["navigation","openGoogleMap"]
[2025-05-13T06:38:33.308Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:38:33.308Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:38:33.308Z]   - No valid next turn added, sending only history.
[2025-05-13T06:38:34.254Z] Model Finish Reason: STOP
[2025-05-13T06:38:34.255Z] Model requested function call: navigation
[2025-05-13T06:38:34.255Z] Arguments: {"url":"https://youtube.com"}
[2025-05-13T06:38:34.255Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305] LLM result from NavigationAgent: Status requires_function_call
[2025-05-13T06:38:34.255Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305] NavigationAgent requests function call: navigation
[2025-05-13T06:38:34.256Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 Odsy_XSCyHzyPjPSAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Received request.
[2025-05-13T06:38:34.256Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_call_received, Agent: NavigationAgent
[2025-05-13T06:38:34.257Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_call_received for NavigationAgent
[2025-05-13T06:38:34.257Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 Odsy_XSCyHzyPjPSAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Executing handler...
[2025-05-13T06:38:34.258Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 Odsy_XSCyHzyPjPSAAAB] Handler: Navigation, Args: {"url":"https://youtube.com"}
[2025-05-13T06:38:34.258Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: validating_navigation_url, Agent: NavigationAgent
[2025-05-13T06:38:34.258Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: validating_navigation_url for NavigationAgent
[2025-05-13T06:38:34.259Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 Odsy_XSCyHzyPjPSAAAB] Navigation: Valid target URL: https://youtube.com
[2025-05-13T06:38:34.259Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: navigation_action_prepared, Agent: NavigationAgent
[2025-05-13T06:38:34.259Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: navigation_action_prepared for NavigationAgent
[2025-05-13T06:38:34.260Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 Odsy_XSCyHzyPjPSAAAB Agent:NavigationAgent FuncRegistry Func:navigation] Handler execution finished. Result indicates error: false
[2025-05-13T06:38:34.260Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: function_result_processed, Agent: NavigationAgent
[2025-05-13T06:38:34.260Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: function_result_processed for NavigationAgent
[2025-05-13T06:38:34.260Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Thought Added - Odsy_XSCyHzyPjPSAAAB] Step: sub_agent_processing_complete, Agent: NavigationAgent
[2025-05-13T06:38:34.261Z] [Odsy-1747118312254-Sub-NavigationAgent-1747118313305 SubAgent Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Step: sub_agent_processing_complete for NavigationAgent
[2025-05-13T06:38:34.261Z] --- [Odsy-1747118312254-Sub-NavigationAgent-1747118313305] Sub Agent NavigationAgent finished. Status: success, Thoughts collected: 6 ---
[2025-05-13T06:38:34.261Z] [Odsy-1747118312254 Streaming] Appended 6 thoughts from NavigationAgent. Total: 9
[2025-05-13T06:38:34.261Z] --- [Odsy-1747118312254 HostAgent Streaming Turn 2 Start - Odsy_XSCyHzyPjPSAAAB] ---
[2025-05-13T06:38:34.262Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:38:34.262Z] [Odsy-1747118312254 History T2 Send - Odsy_XSCyHzyPjPSAAAB] Host History Size: 11
[2025-05-13T06:38:34.262Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T06:38:34.263Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T06:38:34.263Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:38:34.265Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:38:34.265Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:38:34.266Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:38:34.269Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:38:34.270Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T06:38:34.270Z]   - No valid next turn added, sending only history.
[2025-05-13T06:38:34.953Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:38:34.954Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:38:34.954Z] [Odsy-1747118312254 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Starting...
[2025-05-13T06:38:34.955Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:38:34.955Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:38:34.990Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:38:35.005Z] [Odsy-1747118312254 Stream Processing - Odsy_XSCyHzyPjPSAAAB] Finished. Length: 27
[2025-05-13T06:38:35.005Z] [Odsy-1747118312254 Odsy_XSCyHzyPjPSAAAB] Emitting final streaming chat_result with 12 thoughts.
[2025-05-13T06:38:35.006Z] [Odsy-1747118312254 Streaming Emit Sent - Odsy_XSCyHzyPjPSAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:38:35.006Z] --- [Odsy-1747118312254 Odsy_XSCyHzyPjPSAAAB Lang: fa] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:38:35.007Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T06:38:35.086Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Successfully updated history in DB.
[2025-05-13T06:38:35.087Z] [DEBUG] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:38:35.087Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:38:35.358Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:38:35.359Z] [INFO] [coreHandlers][Odsy_XSCyHzyPjPSAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:Odsy-1747118312254][Conv:6822e711b753913854ef331e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:41:21.338Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:41:21.339Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:41:21.832Z] [MainLoader] Starting application loading process...
[2025-05-13T06:41:21.835Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:41:21.836Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:41:22.699Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:41:22.700Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:41:22.700Z] [MainLoader] Database loaded.
[2025-05-13T06:41:22.700Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:41:22.701Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:41:22.706Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:41:22.709Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:41:22.709Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:41:22.710Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:41:22.710Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:41:22.711Z] [MainLoader] Express loaded.
[2025-05-13T06:41:22.712Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:41:22.716Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:41:22.717Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:41:22.717Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:41:22.717Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:41:22.718Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:41:22.755Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:41:22.755Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:41:22.756Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:41:22.799Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:41:22.800Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:41:22.826Z] [socketAuth][y6U7i0EUwPJlRlZxAAAB] Authentication attempt. Has token: true
[2025-05-13T06:41:22.831Z] [socketAuth][y6U7i0EUwPJlRlZxAAAB] Token signature validated successfully.
[2025-05-13T06:41:22.834Z] [HistoryService] Initialized.
[2025-05-13T06:41:22.834Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB] New connection. Socket ID: y6U7i0EUwPJlRlZxAAAB. Initial socket.data.userId: null
[2025-05-13T06:41:22.835Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:41:22.835Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB] Attempting to fetch user info using token...
[2025-05-13T06:41:22.836Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:41:22.836Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:41:23.523Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:41:23.524Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:41:23.524Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:41:23.526Z] [HistoryService] Initialized.
[2025-05-13T06:41:23.526Z] [coreHandlers][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:41:23.526Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:41:23.527Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:41:23.527Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:41:23.528Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:41:23.529Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:41:23.583Z] [SERVER SOCKET y6U7i0EUwPJlRlZxAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:41:23.866Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:41:23.870Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:41:23.870Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:41:23.871Z] [SERVER GLOBAL][connection][y6U7i0EUwPJlRlZxAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:42:39.660Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:42:39.662Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:42:40.065Z] [MainLoader] Starting application loading process...
[2025-05-13T06:42:40.066Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:42:40.066Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:42:41.094Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:42:41.094Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:42:41.095Z] [MainLoader] Database loaded.
[2025-05-13T06:42:41.095Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:42:41.099Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:42:41.107Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:42:41.110Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:42:41.111Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:42:41.111Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:42:41.111Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:42:41.112Z] [MainLoader] Express loaded.
[2025-05-13T06:42:41.113Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:42:41.126Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:42:41.126Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:42:41.127Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:42:41.128Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:42:41.130Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:42:41.176Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:42:41.176Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:42:41.176Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:42:41.325Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:42:41.326Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:42:41.811Z] [socketAuth][EbQi-nyjshSwviTEAAAB] Authentication attempt. Has token: true
[2025-05-13T06:42:41.816Z] [socketAuth][EbQi-nyjshSwviTEAAAB] Token signature validated successfully.
[2025-05-13T06:42:41.819Z] [HistoryService] Initialized.
[2025-05-13T06:42:41.819Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB] New connection. Socket ID: EbQi-nyjshSwviTEAAAB. Initial socket.data.userId: null
[2025-05-13T06:42:41.820Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:42:41.820Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB] Attempting to fetch user info using token...
[2025-05-13T06:42:41.821Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:42:41.821Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:42:42.487Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:42:42.487Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:42:42.487Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:42:42.490Z] [HistoryService] Initialized.
[2025-05-13T06:42:42.490Z] [coreHandlers][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:42:42.490Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:42:42.490Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:42:42.491Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:42:42.492Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:42:42.492Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:42:42.530Z] [SERVER SOCKET EbQi-nyjshSwviTEAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:42:42.807Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:42:42.808Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:42:42.809Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:42:42.809Z] [SERVER GLOBAL][connection][EbQi-nyjshSwviTEAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:43:41.054Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:43:41.055Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:43:41.389Z] [MainLoader] Starting application loading process...
[2025-05-13T06:43:41.390Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:43:41.391Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:43:42.247Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:43:42.248Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:43:42.248Z] [MainLoader] Database loaded.
[2025-05-13T06:43:42.248Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:43:42.249Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:43:42.255Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:43:42.258Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:43:42.259Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:43:42.259Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:43:42.259Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:43:42.261Z] [MainLoader] Express loaded.
[2025-05-13T06:43:42.261Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:43:42.267Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:43:42.267Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:43:42.268Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:43:42.268Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:43:42.269Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:43:42.339Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:43:42.340Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:43:42.342Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:43:42.440Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:43:42.440Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:43:42.827Z] [socketAuth][DkaZYw6aU2DALyp2AAAB] Authentication attempt. Has token: true
[2025-05-13T06:43:42.831Z] [socketAuth][DkaZYw6aU2DALyp2AAAB] Token signature validated successfully.
[2025-05-13T06:43:42.835Z] [HistoryService] Initialized.
[2025-05-13T06:43:42.836Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB] New connection. Socket ID: DkaZYw6aU2DALyp2AAAB. Initial socket.data.userId: null
[2025-05-13T06:43:42.836Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:43:42.837Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB] Attempting to fetch user info using token...
[2025-05-13T06:43:42.838Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:43:42.839Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:43:43.531Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:43:43.532Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:43:43.532Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:43:43.535Z] [HistoryService] Initialized.
[2025-05-13T06:43:43.535Z] [coreHandlers][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:43:43.536Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:43:43.537Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:43:43.538Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:43:43.540Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:43:43.541Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:43:43.589Z] [SERVER SOCKET DkaZYw6aU2DALyp2AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:43:43.848Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:43:43.851Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:43:43.851Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:43:43.852Z] [SERVER GLOBAL][connection][DkaZYw6aU2DALyp2AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:44:35.315Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:44:35.316Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:44:36.084Z] [MainLoader] Starting application loading process...
[2025-05-13T06:44:36.086Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:44:36.095Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:44:36.997Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:44:36.998Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:44:36.998Z] [MainLoader] Database loaded.
[2025-05-13T06:44:36.998Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:44:36.999Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:44:37.011Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:44:37.016Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:44:37.016Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:44:37.018Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:44:37.018Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:44:37.030Z] [MainLoader] Express loaded.
[2025-05-13T06:44:37.032Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:44:37.045Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:44:37.047Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:44:37.048Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:44:37.049Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:44:37.049Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:44:37.118Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:44:37.119Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:44:37.119Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:44:37.228Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:44:37.229Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:44:38.822Z] [socketAuth][Q-_YnsL45WVQVaLiAAAB] Authentication attempt. Has token: true
[2025-05-13T06:44:38.826Z] [socketAuth][Q-_YnsL45WVQVaLiAAAB] Token signature validated successfully.
[2025-05-13T06:44:38.829Z] [HistoryService] Initialized.
[2025-05-13T06:44:38.830Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB] New connection. Socket ID: Q-_YnsL45WVQVaLiAAAB. Initial socket.data.userId: null
[2025-05-13T06:44:38.830Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:44:38.830Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB] Attempting to fetch user info using token...
[2025-05-13T06:44:38.831Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:44:38.831Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:44:39.530Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:44:39.530Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:44:39.531Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:44:39.532Z] [HistoryService] Initialized.
[2025-05-13T06:44:39.533Z] [coreHandlers][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:44:39.533Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:44:39.533Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:44:39.533Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:44:39.535Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:44:39.535Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:44:39.576Z] [SERVER SOCKET Q-_YnsL45WVQVaLiAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:44:39.861Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:44:39.862Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:44:39.862Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:44:39.863Z] [SERVER GLOBAL][connection][Q-_YnsL45WVQVaLiAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:45:15.907Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:45:15.908Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:45:16.838Z] [MainLoader] Starting application loading process...
[2025-05-13T06:45:16.865Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:45:16.868Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:45:17.689Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:45:17.690Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:45:17.690Z] [MainLoader] Database loaded.
[2025-05-13T06:45:17.690Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:45:17.691Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:45:17.696Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:45:17.699Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:45:17.699Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:45:17.700Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:45:17.700Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:45:17.701Z] [MainLoader] Express loaded.
[2025-05-13T06:45:17.702Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:45:17.706Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:45:17.707Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:45:17.707Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:45:17.708Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:45:17.708Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:45:17.750Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:45:17.750Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:45:17.751Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:45:17.809Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:45:17.809Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:45:18.129Z] [socketAuth][A5SV33801Ipqhwt8AAAB] Authentication attempt. Has token: true
[2025-05-13T06:45:18.133Z] [socketAuth][A5SV33801Ipqhwt8AAAB] Token signature validated successfully.
[2025-05-13T06:45:18.136Z] [HistoryService] Initialized.
[2025-05-13T06:45:18.136Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB] New connection. Socket ID: A5SV33801Ipqhwt8AAAB. Initial socket.data.userId: null
[2025-05-13T06:45:18.137Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:45:18.137Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB] Attempting to fetch user info using token...
[2025-05-13T06:45:18.138Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:45:18.138Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:45:18.802Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:45:18.802Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:45:18.802Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:45:18.804Z] [HistoryService] Initialized.
[2025-05-13T06:45:18.804Z] [coreHandlers][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:45:18.805Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:45:18.805Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:45:18.805Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:45:18.807Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:45:18.807Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:45:18.860Z] [SERVER SOCKET A5SV33801Ipqhwt8AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:45:19.092Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:45:19.093Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:45:19.093Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:45:19.094Z] [SERVER GLOBAL][connection][A5SV33801Ipqhwt8AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:46:14.512Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:46:14.515Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:46:15.152Z] [MainLoader] Starting application loading process...
[2025-05-13T06:46:15.154Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:46:15.155Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:46:16.145Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:46:16.147Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:46:16.148Z] [MainLoader] Database loaded.
[2025-05-13T06:46:16.148Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:46:16.149Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:46:16.154Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:46:16.158Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:46:16.158Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:46:16.159Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:46:16.160Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:46:16.162Z] [MainLoader] Express loaded.
[2025-05-13T06:46:16.163Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:46:16.170Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:46:16.171Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:46:16.172Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:46:16.173Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:46:16.179Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:46:16.236Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:46:16.237Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:46:16.238Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:46:16.321Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:46:16.323Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:46:16.536Z] [socketAuth][PY4Ug3zxxJ8XfJO4AAAB] Authentication attempt. Has token: true
[2025-05-13T06:46:16.545Z] [socketAuth][PY4Ug3zxxJ8XfJO4AAAB] Token signature validated successfully.
[2025-05-13T06:46:16.550Z] [HistoryService] Initialized.
[2025-05-13T06:46:16.550Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB] New connection. Socket ID: PY4Ug3zxxJ8XfJO4AAAB. Initial socket.data.userId: null
[2025-05-13T06:46:16.551Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:46:16.551Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB] Attempting to fetch user info using token...
[2025-05-13T06:46:16.552Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:46:16.552Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:46:18.676Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:46:18.677Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:46:18.677Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:46:18.681Z] [HistoryService] Initialized.
[2025-05-13T06:46:18.681Z] [coreHandlers][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:46:18.681Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:46:18.682Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:46:18.682Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:46:18.683Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:46:18.684Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:46:18.734Z] [SERVER SOCKET PY4Ug3zxxJ8XfJO4AAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:46:18.993Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:46:18.995Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:46:18.996Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:46:18.998Z] [SERVER GLOBAL][connection][PY4Ug3zxxJ8XfJO4AAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:47:35.069Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:47:35.069Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:47:35.820Z] [MainLoader] Starting application loading process...
[2025-05-13T06:47:35.821Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:47:35.822Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:47:37.097Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:47:37.098Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:47:37.098Z] [MainLoader] Database loaded.
[2025-05-13T06:47:37.098Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:47:37.099Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:47:37.105Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:47:37.112Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:47:37.112Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:47:37.113Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:47:37.113Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:47:37.114Z] [MainLoader] Express loaded.
[2025-05-13T06:47:37.115Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:47:37.121Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:47:37.121Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:47:37.121Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:47:37.122Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:47:37.126Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:47:37.186Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:47:37.187Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:47:37.192Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:47:37.269Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:47:37.269Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:47:41.825Z] [socketAuth][17ip1o6EaxmKaUeZAAAB] Authentication attempt. Has token: true
[2025-05-13T06:47:41.833Z] [socketAuth][17ip1o6EaxmKaUeZAAAB] Token signature validated successfully.
[2025-05-13T06:47:41.836Z] [HistoryService] Initialized.
[2025-05-13T06:47:41.837Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB] New connection. Socket ID: 17ip1o6EaxmKaUeZAAAB. Initial socket.data.userId: null
[2025-05-13T06:47:41.837Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:47:41.840Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB] Attempting to fetch user info using token...
[2025-05-13T06:47:41.842Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:47:41.843Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:47:42.830Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:47:42.830Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:47:42.831Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:47:42.833Z] [HistoryService] Initialized.
[2025-05-13T06:47:42.833Z] [coreHandlers][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:47:42.833Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:47:42.833Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:47:42.834Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:47:42.835Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:47:42.835Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:47:42.896Z] [SERVER SOCKET 17ip1o6EaxmKaUeZAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:47:43.211Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:47:43.212Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:47:43.213Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:47:43.213Z] [SERVER GLOBAL][connection][17ip1o6EaxmKaUeZAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:48:20.386Z] GeminiService initialized for model: gemini-2.0-flash
[2025-05-13T06:48:20.387Z] Chatbot Initialized. Model: gemini-2.0-flash, Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:48:20.750Z] [MainLoader] Starting application loading process...
[2025-05-13T06:48:20.752Z] [DatabaseLoader] Attempting database connection...
[2025-05-13T06:48:20.752Z] [Database] Attempting MongoDB connection...
[2025-05-13T06:48:21.912Z] [Database] MongoDB Connected Successfully.
[2025-05-13T06:48:21.912Z] [DatabaseLoader] Database connection successful.
[2025-05-13T06:48:21.913Z] [MainLoader] Database loaded.
[2025-05-13T06:48:21.913Z] [MainLoader] Services will be managed by DI container.
[2025-05-13T06:48:21.914Z] [ExpressLoader] Configuring Express app...
[2025-05-13T06:48:21.921Z] [ExpressLoader] Core middleware applied (CORS, JSON, URLencoded, Text, RequestLogger).
[2025-05-13T06:48:21.925Z] [ExpressLoader] Mounted API routes at /api.
[2025-05-13T06:48:21.925Z] [ExpressLoader] Registered Not Found handler.
[2025-05-13T06:48:21.926Z] [ExpressLoader] Registered Global Error handler.
[2025-05-13T06:48:21.926Z] [ExpressLoader] Express app configured successfully.
[2025-05-13T06:48:21.927Z] [MainLoader] Express loaded.
[2025-05-13T06:48:21.928Z] [SocketIOLoader] Initializing Socket.IO server...
[2025-05-13T06:48:21.934Z] [SocketIOLoader] Socket.IO authentication middleware applied.
[2025-05-13T06:48:21.935Z] [SocketIOLoader] Socket.IO connection handler registered.
[2025-05-13T06:48:21.935Z] [SocketIOLoader] Socket.IO server initialized successfully.
[2025-05-13T06:48:21.936Z] [MainLoader] Socket.IO loaded.
[2025-05-13T06:48:21.936Z] [JobsLoader] Scheduling background jobs...
[2025-05-13T06:48:22.014Z] [JobsLoader] Background jobs scheduling initiated.
[2025-05-13T06:48:22.015Z] [MainLoader] Jobs scheduled.
[2025-05-13T06:48:22.016Z] [MainLoader][Task:InitialLogAnalysis] Performing initial log analysis...
[2025-05-13T06:48:22.114Z] [MainLoader][Task:InitialLogAnalysis] Initial log analysis completed.
[2025-05-13T06:48:22.114Z] [MainLoader] All basic loaders completed successfully.
[2025-05-13T06:48:23.827Z] [socketAuth][L_9VklssV-XGkzhdAAAB] Authentication attempt. Has token: true
[2025-05-13T06:48:23.831Z] [socketAuth][L_9VklssV-XGkzhdAAAB] Token signature validated successfully.
[2025-05-13T06:48:23.834Z] [HistoryService] Initialized.
[2025-05-13T06:48:23.834Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB] New connection. Socket ID: L_9VklssV-XGkzhdAAAB. Initial socket.data.userId: null
[2025-05-13T06:48:23.835Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB] Client connected, processing authentication. Has token: true
[2025-05-13T06:48:23.835Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB] Attempting to fetch user info using token...
[2025-05-13T06:48:23.836Z] [API Client] Attempting to fetch user info.
[2025-05-13T06:48:23.836Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T06:48:24.554Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T06:48:24.555Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T06:48:24.555Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T06:48:24.556Z] [HistoryService] Initialized.
[2025-05-13T06:48:24.557Z] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T06:48:24.557Z] [INFO] Core event handlers successfully registered.
[2025-05-13T06:48:24.557Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:48:24.558Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T06:48:24.559Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T06:48:24.560Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:48:24.600Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T06:48:24.889Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:48:24.890Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T06:48:24.890Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T06:48:24.891Z] [SERVER GLOBAL][connection][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T06:52:00.301Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e2fb977aa7fe353aabac"}]
[2025-05-13T06:52:00.305Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e2fb977aa7fe353aabac"}
[2025-05-13T06:52:00.306Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Request received.
[2025-05-13T06:52:00.400Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e2fb977aa7fe353aabac] Sent history. Set as active conversation. Message Count: 0
[2025-05-13T06:52:01.038Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: load_conversation, Args: [{"conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:52:01.040Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Raw 'load_conversation' event received. Data: {"conversationId":"6822e711b753913854ef331e"}
[2025-05-13T06:52:01.041Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Request received.
[2025-05-13T06:52:01.109Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Sent history. Set as active conversation. Message Count: 8
[2025-05-13T06:52:04.226Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822e711b753913854ef331e"}]
[2025-05-13T06:52:04.227Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Request received.
[2025-05-13T06:52:04.297Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Successfully processed deletion.
[2025-05-13T06:52:04.298Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822e711b753913854ef331e] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:52:04.299Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822e711b753913854ef331e
[2025-05-13T06:52:04.299Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:52:04.555Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:52:04.556Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822e711b753913854ef331e, Count: 11
[2025-05-13T06:52:18.233Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Quelles fonctionnalités a ce site web ?","isStreaming":true,"language":"fr","conversationId":null}]
[2025-05-13T06:52:18.234Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234] Request received. UserInput: "Quelles fonctionnalités a ce s...", Streaming: true, Language: fr, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:52:18.235Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:52:18.403Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:52:18.404Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:52:18.404Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:52:18.658Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:52:18.659Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:52:18.723Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Fetched current history. Count: 0
[2025-05-13T06:52:18.723Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Calling streaming intent handler.
[2025-05-13T06:52:18.724Z] --- [L_9V-1747119138234 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "Quelles fonctionnalités a ce site web ?", Lang: fr ---
[2025-05-13T06:52:18.725Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:52:18.727Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:52:18.728Z] --- [L_9V-1747119138234 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:52:18.728Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:52:18.729Z] [L_9V-1747119138234 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 1
[2025-05-13T06:52:18.730Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:52:18.731Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:52:18.731Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:52:18.732Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:52:18.732Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:52:18.732Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:52:18.733Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:52:18.733Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:52:18.733Z]   - No valid next turn added, sending only history.
[2025-05-13T06:52:19.663Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:52:19.663Z] [L_9V-1747119138234 HostAgent Streaming T1 - L_9VklssV-XGkzhdAAAB] Requests function: routeToAgent
[2025-05-13T06:52:19.665Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:52:19.667Z] --- [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 Socket L_9VklssV-XGkzhdAAAB] Calling Sub Agent: WebsiteInfoAgent, Task: f69eb41d-d5af-4aa1-844f-95edd3ac372f ---
[2025-05-13T06:52:19.668Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: fr
[2025-05-13T06:52:19.668Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T06:52:19.669Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T06:52:19.670Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:52:19.670Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:52:19.670Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:52:19.671Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:52:19.671Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:52:19.671Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T06:52:19.671Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:52:19.672Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:52:19.672Z]   - No valid next turn added, sending only history.
[2025-05-13T06:52:20.406Z] Model Finish Reason: STOP
[2025-05-13T06:52:20.406Z] Model requested function call: getWebsiteInfo
[2025-05-13T06:52:20.407Z] Arguments: {}
[2025-05-13T06:52:20.407Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T06:52:20.407Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T06:52:20.408Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 L_9VklssV-XGkzhdAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T06:52:20.409Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T06:52:20.409Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T06:52:20.410Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 L_9VklssV-XGkzhdAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T06:52:20.410Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 L_9VklssV-XGkzhdAAAB] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T06:52:20.411Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T06:52:20.411Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T06:52:20.411Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T06:52:20.412Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T06:52:20.412Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T06:52:20.412Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 L_9VklssV-XGkzhdAAAB] API result: Success=true
[2025-05-13T06:52:20.413Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T06:52:20.413Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T06:52:20.414Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 L_9VklssV-XGkzhdAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T06:52:20.416Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T06:52:20.416Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T06:52:20.416Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T06:52:20.417Z] [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T06:52:20.417Z] --- [L_9V-1747119138234-Sub-WebsiteInfoAgent-1747119139667] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T06:52:20.417Z] [L_9V-1747119138234 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T06:52:20.418Z] --- [L_9V-1747119138234 HostAgent Streaming Turn 2 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:52:20.418Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:52:20.418Z] [L_9V-1747119138234 History T2 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 3
[2025-05-13T06:52:20.418Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:52:20.419Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:52:20.419Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:52:20.419Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:52:20.419Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:52:20.420Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:52:20.420Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:52:20.420Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:52:20.420Z]   - No valid next turn added, sending only history.
[2025-05-13T06:52:21.070Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:52:21.071Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:52:21.071Z] [L_9V-1747119138234 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:52:21.072Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:52:21.072Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:21.215Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:21.304Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:21.533Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:21.672Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:21.908Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:22.143Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:22.488Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:22.845Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:23.089Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:52:23.094Z] [L_9V-1747119138234 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 1806
[2025-05-13T06:52:23.095Z] [L_9V-1747119138234 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T06:52:23.096Z] [L_9V-1747119138234 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:52:23.096Z] --- [L_9V-1747119138234 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:52:23.096Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:52:23.249Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Successfully updated history in DB.
[2025-05-13T06:52:23.250Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:52:23.250Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:52:23.511Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:52:23.512Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119138234][Conv:6822ec22d0719e59d7eca359] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:52:50.586Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822ec22d0719e59d7eca359"}]
[2025-05-13T06:52:50.586Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ec22d0719e59d7eca359] Request received.
[2025-05-13T06:52:50.654Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ec22d0719e59d7eca359] Successfully processed deletion.
[2025-05-13T06:52:50.655Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ec22d0719e59d7eca359] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:52:50.655Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822ec22d0719e59d7eca359
[2025-05-13T06:52:50.655Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:52:50.923Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:52:50.924Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822ec22d0719e59d7eca359, Count: 11
[2025-05-13T06:53:11.698Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Comment suivre une conférence ?","isStreaming":true,"language":"fr","conversationId":null}]
[2025-05-13T06:53:11.699Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699] Request received. UserInput: "Comment suivre une conférence ...", Streaming: true, Language: fr, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:53:11.699Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:53:11.829Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:53:11.830Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:53:11.831Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:53:12.115Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:53:12.117Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:53:12.191Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Fetched current history. Count: 0
[2025-05-13T06:53:12.192Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Calling streaming intent handler.
[2025-05-13T06:53:12.192Z] --- [L_9V-1747119191699 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "Comment suivre une conférence ?", Lang: fr ---
[2025-05-13T06:53:12.192Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:53:12.193Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:12.193Z] --- [L_9V-1747119191699 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:53:12.194Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:12.194Z] [L_9V-1747119191699 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 1
[2025-05-13T06:53:12.194Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:53:12.195Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:53:12.195Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:53:12.195Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:53:12.196Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:53:12.198Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:53:12.199Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:53:12.199Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:53:12.200Z]   - No valid next turn added, sending only history.
[2025-05-13T06:53:12.882Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:53:12.883Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:12.883Z] [L_9V-1747119191699 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:53:12.883Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:12.883Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:12.959Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:12.969Z] [L_9V-1747119191699 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 34
[2025-05-13T06:53:12.969Z] [L_9V-1747119191699 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:53:12.970Z] [L_9V-1747119191699 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:53:12.970Z] --- [L_9V-1747119191699 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:53:12.970Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Intent handler returned updated history. Attempting save. New size: 2
[2025-05-13T06:53:13.048Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Successfully updated history in DB.
[2025-05-13T06:53:13.048Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:53:13.049Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:53:13.330Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:53:13.331Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119191699][Conv:6822ec57d0719e59d7eca362] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:53:41.019Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"ý tôi là theo dõi hội nghị trên trang web này","isStreaming":true,"language":"fr","conversationId":"6822ec57d0719e59d7eca362"}]
[2025-05-13T06:53:41.019Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019] Request received. UserInput: "ý tôi là theo dõi hội nghị trê...", Streaming: true, Language: fr, PayloadConvId: 6822ec57d0719e59d7eca362, SocketDataConvId: 6822ec57d0719e59d7eca362
[2025-05-13T06:53:41.020Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Using conversationId from payload.
[2025-05-13T06:53:41.086Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Fetched current history. Count: 2
[2025-05-13T06:53:41.087Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Calling streaming intent handler.
[2025-05-13T06:53:41.087Z] --- [L_9V-1747119221019 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "ý tôi là theo dõi hội nghị trên trang web này", Lang: fr ---
[2025-05-13T06:53:41.087Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:53:41.088Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:41.089Z] --- [L_9V-1747119221019 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:53:41.089Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:41.090Z] [L_9V-1747119221019 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 3
[2025-05-13T06:53:41.091Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:53:41.091Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:53:41.091Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:53:41.091Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:53:41.092Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:53:41.092Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:53:41.092Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:53:41.092Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:53:41.093Z]   - No valid next turn added, sending only history.
[2025-05-13T06:53:41.985Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:53:41.986Z] [L_9V-1747119221019 HostAgent Streaming T1 - L_9VklssV-XGkzhdAAAB] Requests function: routeToAgent
[2025-05-13T06:53:41.986Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:41.987Z] --- [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 Socket L_9VklssV-XGkzhdAAAB] Calling Sub Agent: WebsiteInfoAgent, Task: 9936a303-74ef-449c-8d77-174d0bb4b7dd ---
[2025-05-13T06:53:41.987Z] [Language Config] Using configuration for Agent: WebsiteInfoAgent, Language: fr
[2025-05-13T06:53:41.987Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_thinking, Agent: WebsiteInfoAgent
[2025-05-13T06:53:41.988Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_thinking for WebsiteInfoAgent
[2025-05-13T06:53:41.989Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:53:41.990Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:53:41.990Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:53:41.990Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:53:41.991Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:53:41.991Z] Tools provided: ["getWebsiteInfo"]
[2025-05-13T06:53:41.991Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:53:41.992Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:53:41.992Z]   - No valid next turn added, sending only history.
[2025-05-13T06:53:42.713Z] Model Finish Reason: STOP
[2025-05-13T06:53:42.713Z] Model requested function call: getWebsiteInfo
[2025-05-13T06:53:42.713Z] Arguments: {}
[2025-05-13T06:53:42.713Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987] LLM result from WebsiteInfoAgent: Status requires_function_call
[2025-05-13T06:53:42.714Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987] WebsiteInfoAgent requests function call: getWebsiteInfo
[2025-05-13T06:53:42.714Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 L_9VklssV-XGkzhdAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Received request.
[2025-05-13T06:53:42.714Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_call_received, Agent: WebsiteInfoAgent
[2025-05-13T06:53:42.715Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_call_received for WebsiteInfoAgent
[2025-05-13T06:53:42.715Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 L_9VklssV-XGkzhdAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Executing handler...
[2025-05-13T06:53:42.715Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 L_9VklssV-XGkzhdAAAB] Handler: GetWebsiteInfo, Args: {}
[2025-05-13T06:53:42.716Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: validating_function_args, Agent: WebsiteInfoAgent
[2025-05-13T06:53:42.716Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: validating_function_args for WebsiteInfoAgent
[2025-05-13T06:53:42.716Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: retrieving_info, Agent: WebsiteInfoAgent
[2025-05-13T06:53:42.716Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: retrieving_info for WebsiteInfoAgent
[2025-05-13T06:53:42.717Z] [executeGetWebsiteInfo] Successfully retrieved website description from environment variable.
[2025-05-13T06:53:42.717Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 L_9VklssV-XGkzhdAAAB] API result: Success=true
[2025-05-13T06:53:42.717Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: data_found, Agent: WebsiteInfoAgent
[2025-05-13T06:53:42.718Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: data_found for WebsiteInfoAgent
[2025-05-13T06:53:42.718Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 L_9VklssV-XGkzhdAAAB Agent:WebsiteInfoAgent FuncRegistry Func:getWebsiteInfo] Handler execution finished. Result indicates error: false
[2025-05-13T06:53:42.718Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_processed, Agent: WebsiteInfoAgent
[2025-05-13T06:53:42.718Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_processed for WebsiteInfoAgent
[2025-05-13T06:53:42.719Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_processing_complete, Agent: WebsiteInfoAgent
[2025-05-13T06:53:42.719Z] [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_processing_complete for WebsiteInfoAgent
[2025-05-13T06:53:42.720Z] --- [L_9V-1747119221019-Sub-WebsiteInfoAgent-1747119221987] Sub Agent WebsiteInfoAgent finished. Status: success, Thoughts collected: 7 ---
[2025-05-13T06:53:42.720Z] [L_9V-1747119221019 Streaming] Appended 7 thoughts from WebsiteInfoAgent. Total: 10
[2025-05-13T06:53:42.720Z] --- [L_9V-1747119221019 HostAgent Streaming Turn 2 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:53:42.721Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:42.722Z] [L_9V-1747119221019 History T2 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 5
[2025-05-13T06:53:42.723Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:53:42.724Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:53:42.724Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:53:42.724Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:53:42.724Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:53:42.725Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:53:42.725Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:53:42.725Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:53:42.725Z]   - No valid next turn added, sending only history.
[2025-05-13T06:53:43.470Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:53:43.470Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:43.471Z] [L_9V-1747119221019 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:53:43.472Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:53:43.473Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:43.574Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:43.658Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:43.878Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:44.014Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:53:44.017Z] [L_9V-1747119221019 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 429
[2025-05-13T06:53:44.017Z] [L_9V-1747119221019 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 13 thoughts.
[2025-05-13T06:53:44.018Z] [L_9V-1747119221019 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:53:44.019Z] --- [L_9V-1747119221019 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:53:44.019Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Intent handler returned updated history. Attempting save. New size: 6
[2025-05-13T06:53:44.096Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Successfully updated history in DB.
[2025-05-13T06:53:44.096Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:53:44.096Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:53:44.357Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:53:44.358Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119221019][Conv:6822ec57d0719e59d7eca362] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:55:40.291Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822ec57d0719e59d7eca362"}]
[2025-05-13T06:55:40.292Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ec57d0719e59d7eca362] Request received.
[2025-05-13T06:55:40.360Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ec57d0719e59d7eca362] Successfully processed deletion.
[2025-05-13T06:55:40.360Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ec57d0719e59d7eca362] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:55:40.361Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822ec57d0719e59d7eca362
[2025-05-13T06:55:40.361Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:55:40.619Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:55:40.619Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822ec57d0719e59d7eca362, Count: 11
[2025-05-13T06:56:01.533Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"tôi đang theo dõi các hội nghị nào","isStreaming":true,"language":"fr","conversationId":null}]
[2025-05-13T06:56:01.533Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533] Request received. UserInput: "tôi đang theo dõi các hội nghị...", Streaming: true, Language: fr, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:56:01.533Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:56:01.667Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:56:01.668Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:56:01.669Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:56:01.935Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:56:01.936Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:56:02.001Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Fetched current history. Count: 0
[2025-05-13T06:56:02.001Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Calling streaming intent handler.
[2025-05-13T06:56:02.002Z] --- [L_9V-1747119361533 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "tôi đang theo dõi các hội nghị nào", Lang: fr ---
[2025-05-13T06:56:02.002Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:56:02.002Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:02.003Z] --- [L_9V-1747119361533 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:56:02.003Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:02.003Z] [L_9V-1747119361533 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 1
[2025-05-13T06:56:02.003Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:56:02.003Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:56:02.004Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:56:02.004Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:02.004Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:02.004Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:56:02.004Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:02.004Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:56:02.004Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:02.982Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:56:02.983Z] [L_9V-1747119361533 HostAgent Streaming T1 - L_9VklssV-XGkzhdAAAB] Requests function: routeToAgent
[2025-05-13T06:56:02.984Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:02.984Z] --- [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 Socket L_9VklssV-XGkzhdAAAB] Calling Sub Agent: ConferenceAgent, Task: e4b611c1-b374-452e-8728-4d45b829a7a3 ---
[2025-05-13T06:56:02.985Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: fr
[2025-05-13T06:56:02.985Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:56:02.986Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:56:02.986Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:56:02.987Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:56:02.987Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:56:02.987Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:02.988Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:02.988Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:56:02.988Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:02.988Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:56:02.989Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:03.776Z] Model Finish Reason: STOP
[2025-05-13T06:56:03.776Z] Model requested function call: manageFollow
[2025-05-13T06:56:03.776Z] Arguments: {"itemType":"conference","action":"list"}
[2025-05-13T06:56:03.776Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:56:03.777Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984] ConferenceAgent requests function call: manageFollow
[2025-05-13T06:56:03.777Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Received request.
[2025-05-13T06:56:03.777Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:56:03.778Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:56:03.778Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Executing handler...
[2025-05-13T06:56:03.780Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 L_9VklssV-XGkzhdAAAB] Handler: ManageFollow, Args: {"itemType":"conference","action":"list"}, Auth: true
[2025-05-13T06:56:03.780Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:56:03.781Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:56:03.781Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: checking_authentication, Agent: ConferenceAgent
[2025-05-13T06:56:03.783Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: checking_authentication for ConferenceAgent
[2025-05-13T06:56:03.783Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: listing_followed_items, Agent: ConferenceAgent
[2025-05-13T06:56:03.784Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: listing_followed_items for ConferenceAgent
[2025-05-13T06:56:03.784Z] [FollowService] [GetFollowed conference] Fetching followed items: GET https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/followed
[2025-05-13T06:56:04.443Z] [FollowService] [GetFollowed conference] Success. Found 2 followed item(s).
[2025-05-13T06:56:04.445Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 L_9VklssV-XGkzhdAAAB] ManageFollow: Successfully listed 2 followed conference(s).
[2025-05-13T06:56:04.445Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: list_success, Agent: ConferenceAgent
[2025-05-13T06:56:04.446Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: list_success for ConferenceAgent
[2025-05-13T06:56:04.446Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Handler execution finished. Result indicates error: false
[2025-05-13T06:56:04.447Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:56:04.447Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:56:04.447Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:56:04.448Z] [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:56:04.448Z] --- [L_9V-1747119361533-Sub-ConferenceAgent-1747119362984] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-13T06:56:04.450Z] [L_9V-1747119361533 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-13T06:56:04.450Z] --- [L_9V-1747119361533 HostAgent Streaming Turn 2 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:56:04.451Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:04.451Z] [L_9V-1747119361533 History T2 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 3
[2025-05-13T06:56:04.451Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:56:04.452Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:56:04.452Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:56:04.452Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:04.452Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:04.453Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:56:04.453Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:04.453Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:56:04.453Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:05.137Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:56:05.138Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:05.138Z] [L_9V-1747119361533 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:56:05.139Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:05.139Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:05.205Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:05.283Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:05.437Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:05.550Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:05.623Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:05.629Z] [L_9V-1747119361533 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 307
[2025-05-13T06:56:05.630Z] [L_9V-1747119361533 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-13T06:56:05.630Z] [L_9V-1747119361533 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:56:05.631Z] --- [L_9V-1747119361533 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:56:05.631Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:56:05.704Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Successfully updated history in DB.
[2025-05-13T06:56:05.704Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:56:05.704Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:56:05.963Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:56:05.964Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119361533][Conv:6822ed01d0719e59d7eca36e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:56:28.078Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"theo dõi thêm hội nghị AAAI","isStreaming":true,"language":"fr","conversationId":"6822ed01d0719e59d7eca36e"}]
[2025-05-13T06:56:28.078Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078] Request received. UserInput: "theo dõi thêm hội nghị AAAI", Streaming: true, Language: fr, PayloadConvId: 6822ed01d0719e59d7eca36e, SocketDataConvId: 6822ed01d0719e59d7eca36e
[2025-05-13T06:56:28.079Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Using conversationId from payload.
[2025-05-13T06:56:28.146Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Fetched current history. Count: 4
[2025-05-13T06:56:28.147Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Calling streaming intent handler.
[2025-05-13T06:56:28.148Z] --- [L_9V-1747119388078 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "theo dõi thêm hội nghị AAAI", Lang: fr ---
[2025-05-13T06:56:28.148Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:56:28.150Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:28.150Z] --- [L_9V-1747119388078 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:56:28.150Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:28.151Z] [L_9V-1747119388078 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 5
[2025-05-13T06:56:28.151Z] [GeminiService] Received history with 5 items before mapping (for stream).
[2025-05-13T06:56:28.151Z] [GeminiService] Mapped history (SDK Content[]) with 5 items (for stream).
[2025-05-13T06:56:28.152Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:56:28.152Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:28.152Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:28.152Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:56:28.153Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:28.153Z] [GeminiService Stream] Preparing stream request with 5 Content items.
[2025-05-13T06:56:28.153Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:29.952Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:56:29.952Z] [L_9V-1747119388078 HostAgent Streaming T1 - L_9VklssV-XGkzhdAAAB] Requests function: routeToAgent
[2025-05-13T06:56:29.953Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:29.953Z] --- [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 Socket L_9VklssV-XGkzhdAAAB] Calling Sub Agent: ConferenceAgent, Task: bb635bbd-eef5-41f3-ad34-01c3e9b69598 ---
[2025-05-13T06:56:29.953Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: fr
[2025-05-13T06:56:29.954Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:56:29.954Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:56:29.955Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:56:29.955Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:56:29.955Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:56:29.955Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:29.955Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:29.956Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:56:29.956Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:29.956Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:56:29.956Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:30.933Z] Model Finish Reason: STOP
[2025-05-13T06:56:30.934Z] Model requested function call: manageFollow
[2025-05-13T06:56:30.934Z] Arguments: {"identifierType":"acronym","itemType":"conference","identifier":"AAAI","action":"follow"}
[2025-05-13T06:56:30.935Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:56:30.935Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953] ConferenceAgent requests function call: manageFollow
[2025-05-13T06:56:30.935Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Received request.
[2025-05-13T06:56:30.935Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:56:30.936Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:56:30.936Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Executing handler...
[2025-05-13T06:56:30.937Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 L_9VklssV-XGkzhdAAAB] Handler: ManageFollow, Args: {"identifierType":"acronym","itemType":"conference","identifier":"AAAI","action":"follow"}, Auth: true
[2025-05-13T06:56:30.937Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:56:30.937Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:56:30.937Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: checking_authentication, Agent: ConferenceAgent
[2025-05-13T06:56:30.938Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: checking_authentication for ConferenceAgent
[2025-05-13T06:56:30.938Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: finding_item_id, Agent: ConferenceAgent
[2025-05-13T06:56:30.938Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: finding_item_id for ConferenceAgent
[2025-05-13T06:56:30.939Z] [FollowService] [FindID conference Ident:"AAAI" Type:acronym] Attempting to find item ID.
[2025-05-13T06:56:30.940Z] [FollowService] [FindID conference Ident:"AAAI" Type:acronym] Constructed search query: acronym=AAAI&perPage=1&page=1
[2025-05-13T06:56:30.940Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?acronym=AAAI&perPage=1&page=1}
[2025-05-13T06:56:31.634Z] [BackendService] [conference] API Success (200). Data length: 1304. Attempting parsing...
[2025-05-13T06:56:31.634Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Association for Artificial Intelligence","acronym":"AAAI","location":{"cityStateProvince":"Philadelphia, Pennsylvania","country":"United States","ad...
[2025-05-13T06:56:31.635Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:56:31.636Z] Transforming conference data with Markdown. Search query: acronym=AAAI&perPage=1&page=1
[2025-05-13T06:56:31.638Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 1
- **Total items:** 1
- **Total page:** 1
- **Prev page:** null
- **Next page:** null

**Payload:**
---

**- Conference 1.**
  - **Title:** National Conference of the American Association for Artificia...
[2025-05-13T06:56:31.639Z] [FollowService] [FindID conference Ident:"AAAI" Type:acronym] Successfully found ID: 1c4468db-5d99-4253-9794-5e205ef37e97. Details: {"id":"1c4468db-5d99-4253-9794-5e205ef37e97","title":"National Conference of the American Associatio
[2025-05-13T06:56:31.639Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: item_id_found, Agent: ConferenceAgent
[2025-05-13T06:56:31.640Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: item_id_found for ConferenceAgent
[2025-05-13T06:56:31.640Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: checking_follow_status, Agent: ConferenceAgent
[2025-05-13T06:56:31.641Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: checking_follow_status for ConferenceAgent
[2025-05-13T06:56:31.641Z] [FollowService] [GetFollowed conference] Fetching followed items: GET https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/followed
[2025-05-13T06:56:32.276Z] [FollowService] [GetFollowed conference] Success. Found 2 followed item(s).
[2025-05-13T06:56:32.276Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: follow_status_checked, Agent: ConferenceAgent
[2025-05-13T06:56:32.277Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: follow_status_checked for ConferenceAgent
[2025-05-13T06:56:32.277Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: determining_follow_action, Agent: ConferenceAgent
[2025-05-13T06:56:32.277Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: determining_follow_action for ConferenceAgent
[2025-05-13T06:56:32.277Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: follow_action_determined, Agent: ConferenceAgent
[2025-05-13T06:56:32.278Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: follow_action_determined for ConferenceAgent
[2025-05-13T06:56:32.278Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: preparing_follow_api_call, Agent: ConferenceAgent
[2025-05-13T06:56:32.278Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: preparing_follow_api_call for ConferenceAgent
[2025-05-13T06:56:32.279Z] [FollowService] [follow conference ID: 1c4468db-5d99-4253-9794-5e205ef37e97] Executing action: POST https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/add
[2025-05-13T06:56:32.505Z] [FollowService] [follow conference ID: 1c4468db-5d99-4253-9794-5e205ef37e97] Action executed successfully.
[2025-05-13T06:56:32.506Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 L_9VklssV-XGkzhdAAAB] ManageFollow: API call for follow successful.
[2025-05-13T06:56:32.506Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: follow_update_success, Agent: ConferenceAgent
[2025-05-13T06:56:32.506Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: follow_update_success for ConferenceAgent
[2025-05-13T06:56:32.507Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Handler execution finished. Result indicates error: false
[2025-05-13T06:56:32.507Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:56:32.507Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:56:32.508Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:56:32.508Z] [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:56:32.508Z] --- [L_9V-1747119388078-Sub-ConferenceAgent-1747119389953] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 14 ---
[2025-05-13T06:56:32.509Z] [L_9V-1747119388078 Streaming] Appended 14 thoughts from ConferenceAgent. Total: 17
[2025-05-13T06:56:32.509Z] --- [L_9V-1747119388078 HostAgent Streaming Turn 2 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:56:32.509Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:32.509Z] [L_9V-1747119388078 History T2 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 7
[2025-05-13T06:56:32.510Z] [GeminiService] Received history with 7 items before mapping (for stream).
[2025-05-13T06:56:32.510Z] [GeminiService] Mapped history (SDK Content[]) with 7 items (for stream).
[2025-05-13T06:56:32.510Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:56:32.510Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:32.510Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:32.511Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:56:32.511Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:32.511Z] [GeminiService Stream] Preparing stream request with 7 Content items.
[2025-05-13T06:56:32.511Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:33.059Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:56:33.060Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:33.060Z] [L_9V-1747119388078 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:56:33.060Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:33.061Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:33.192Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:33.224Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:33.233Z] [L_9V-1747119388078 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 123
[2025-05-13T06:56:33.234Z] [L_9V-1747119388078 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 20 thoughts.
[2025-05-13T06:56:33.234Z] [L_9V-1747119388078 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:56:33.235Z] --- [L_9V-1747119388078 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:56:33.235Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Intent handler returned updated history. Attempting save. New size: 8
[2025-05-13T06:56:33.307Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Successfully updated history in DB.
[2025-05-13T06:56:33.307Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:56:33.308Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:56:33.566Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:56:33.567Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119388078][Conv:6822ed01d0719e59d7eca36e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:56:49.064Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"kiểm tra lại danh sách follow của tôi","isStreaming":true,"language":"fr","conversationId":"6822ed01d0719e59d7eca36e"}]
[2025-05-13T06:56:49.065Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065] Request received. UserInput: "kiểm tra lại danh sách follow ...", Streaming: true, Language: fr, PayloadConvId: 6822ed01d0719e59d7eca36e, SocketDataConvId: 6822ed01d0719e59d7eca36e
[2025-05-13T06:56:49.065Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Using conversationId from payload.
[2025-05-13T06:56:49.132Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Fetched current history. Count: 8
[2025-05-13T06:56:49.133Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Calling streaming intent handler.
[2025-05-13T06:56:49.133Z] --- [L_9V-1747119409065 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "kiểm tra lại danh sách follow của tôi", Lang: fr ---
[2025-05-13T06:56:49.133Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:56:49.134Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:49.134Z] --- [L_9V-1747119409065 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:56:49.135Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:49.135Z] [L_9V-1747119409065 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 9
[2025-05-13T06:56:49.135Z] [GeminiService] Received history with 9 items before mapping (for stream).
[2025-05-13T06:56:49.135Z] [GeminiService] Mapped history (SDK Content[]) with 9 items (for stream).
[2025-05-13T06:56:49.136Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:56:49.136Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:49.136Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:49.136Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:56:49.136Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:49.137Z] [GeminiService Stream] Preparing stream request with 9 Content items.
[2025-05-13T06:56:49.137Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:49.935Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:56:49.935Z] [L_9V-1747119409065 HostAgent Streaming T1 - L_9VklssV-XGkzhdAAAB] Requests function: routeToAgent
[2025-05-13T06:56:49.936Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:49.936Z] --- [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 Socket L_9VklssV-XGkzhdAAAB] Calling Sub Agent: ConferenceAgent, Task: 3d34495e-5ef3-4bcd-9ae3-df830946e519 ---
[2025-05-13T06:56:49.937Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: fr
[2025-05-13T06:56:49.937Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:56:49.937Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:56:49.938Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:56:49.938Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:56:49.938Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:56:49.939Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:49.939Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:49.939Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:56:49.939Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:49.940Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:56:49.940Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:51.703Z] Model Finish Reason: STOP
[2025-05-13T06:56:51.703Z] Model requested function call: manageFollow
[2025-05-13T06:56:51.703Z] Arguments: {"itemType":"conference","action":"list"}
[2025-05-13T06:56:51.704Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:56:51.704Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936] ConferenceAgent requests function call: manageFollow
[2025-05-13T06:56:51.704Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Received request.
[2025-05-13T06:56:51.705Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:56:51.705Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:56:51.705Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Executing handler...
[2025-05-13T06:56:51.706Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 L_9VklssV-XGkzhdAAAB] Handler: ManageFollow, Args: {"itemType":"conference","action":"list"}, Auth: true
[2025-05-13T06:56:51.706Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:56:51.706Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:56:51.707Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: checking_authentication, Agent: ConferenceAgent
[2025-05-13T06:56:51.707Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: checking_authentication for ConferenceAgent
[2025-05-13T06:56:51.707Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: listing_followed_items, Agent: ConferenceAgent
[2025-05-13T06:56:51.707Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: listing_followed_items for ConferenceAgent
[2025-05-13T06:56:51.707Z] [FollowService] [GetFollowed conference] Fetching followed items: GET https://confhub.westus3.cloudapp.azure.com/api/v1/follow-conference/followed
[2025-05-13T06:56:52.393Z] [FollowService] [GetFollowed conference] Success. Found 3 followed item(s).
[2025-05-13T06:56:52.394Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 L_9VklssV-XGkzhdAAAB] ManageFollow: Successfully listed 3 followed conference(s).
[2025-05-13T06:56:52.394Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: list_success, Agent: ConferenceAgent
[2025-05-13T06:56:52.395Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: list_success for ConferenceAgent
[2025-05-13T06:56:52.397Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:manageFollow] Handler execution finished. Result indicates error: false
[2025-05-13T06:56:52.398Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:56:52.399Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:56:52.399Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:56:52.400Z] [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:56:52.400Z] --- [L_9V-1747119409065-Sub-ConferenceAgent-1747119409936] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 8 ---
[2025-05-13T06:56:52.400Z] [L_9V-1747119409065 Streaming] Appended 8 thoughts from ConferenceAgent. Total: 11
[2025-05-13T06:56:52.401Z] --- [L_9V-1747119409065 HostAgent Streaming Turn 2 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:56:52.401Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:52.401Z] [L_9V-1747119409065 History T2 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 11
[2025-05-13T06:56:52.402Z] [GeminiService] Received history with 11 items before mapping (for stream).
[2025-05-13T06:56:52.402Z] [GeminiService] Mapped history (SDK Content[]) with 11 items (for stream).
[2025-05-13T06:56:52.402Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:56:52.403Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:56:52.403Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:56:52.404Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:56:52.404Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:56:52.404Z] [GeminiService Stream] Preparing stream request with 11 Content items.
[2025-05-13T06:56:52.404Z]   - No valid next turn added, sending only history.
[2025-05-13T06:56:52.935Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:56:52.935Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:52.936Z] [L_9V-1747119409065 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:56:52.936Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:56:52.936Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.025Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.115Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.234Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.382Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.557Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.635Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:56:53.640Z] [L_9V-1747119409065 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 476
[2025-05-13T06:56:53.641Z] [L_9V-1747119409065 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 14 thoughts.
[2025-05-13T06:56:53.641Z] [L_9V-1747119409065 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:56:53.642Z] --- [L_9V-1747119409065 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:56:53.642Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Intent handler returned updated history. Attempting save. New size: 12
[2025-05-13T06:56:53.718Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Successfully updated history in DB.
[2025-05-13T06:56:53.718Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:56:53.719Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:56:53.978Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:56:53.979Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119409065][Conv:6822ed01d0719e59d7eca36e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:57:07.147Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"danh sách đã có hội nghị vừa theo dõi thêm chưa","isStreaming":true,"language":"fr","conversationId":"6822ed01d0719e59d7eca36e"}]
[2025-05-13T06:57:07.147Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147] Request received. UserInput: "danh sách đã có hội nghị vừa t...", Streaming: true, Language: fr, PayloadConvId: 6822ed01d0719e59d7eca36e, SocketDataConvId: 6822ed01d0719e59d7eca36e
[2025-05-13T06:57:07.147Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Using conversationId from payload.
[2025-05-13T06:57:07.210Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Fetched current history. Count: 12
[2025-05-13T06:57:07.210Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Calling streaming intent handler.
[2025-05-13T06:57:07.211Z] --- [L_9V-1747119427147 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "danh sách đã có hội nghị vừa theo dõi thêm chưa", Lang: fr ---
[2025-05-13T06:57:07.211Z] [Language Config] Using configuration for Agent: HostAgent, Language: fr
[2025-05-13T06:57:07.212Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:07.212Z] --- [L_9V-1747119427147 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:57:07.213Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:07.214Z] [L_9V-1747119427147 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 13
[2025-05-13T06:57:07.214Z] [GeminiService] Received history with 13 items before mapping (for stream).
[2025-05-13T06:57:07.215Z] [GeminiService] Mapped history (SDK Content[]) with 13 items (for stream).
[2025-05-13T06:57:07.215Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:57:07.216Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:57:07.216Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:57:07.216Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:57:07.216Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:57:07.217Z] [GeminiService Stream] Preparing stream request with 13 Content items.
[2025-05-13T06:57:07.217Z]   - No valid next turn added, sending only history.
[2025-05-13T06:57:07.944Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:57:07.947Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:07.947Z] [L_9V-1747119427147 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:57:07.949Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:07.950Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:08.065Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:08.076Z] [L_9V-1747119427147 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 77
[2025-05-13T06:57:08.077Z] [L_9V-1747119427147 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 4 thoughts.
[2025-05-13T06:57:08.078Z] [L_9V-1747119427147 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:57:08.078Z] --- [L_9V-1747119427147 L_9VklssV-XGkzhdAAAB Lang: fr] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:57:08.079Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Intent handler returned updated history. Attempting save. New size: 14
[2025-05-13T06:57:08.154Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Successfully updated history in DB.
[2025-05-13T06:57:08.154Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:57:08.155Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:57:08.400Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:57:08.400Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119427147][Conv:6822ed01d0719e59d7eca36e] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T06:57:20.494Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: delete_conversation, Args: [{"conversationId":"6822ed01d0719e59d7eca36e"}]
[2025-05-13T06:57:20.495Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ed01d0719e59d7eca36e] Request received.
[2025-05-13T06:57:20.560Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ed01d0719e59d7eca36e] Successfully processed deletion.
[2025-05-13T06:57:20.560Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Conv:6822ed01d0719e59d7eca36e] Deleted conversation was active. Clearing active ID.
[2025-05-13T06:57:20.561Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Attempting to fetch and emit updated conversation list. Reason: deleted conversation 6822ed01d0719e59d7eca36e
[2025-05-13T06:57:20.561Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:57:20.822Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 11 conversations.
[2025-05-13T06:57:20.823Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted updated conversation list. Reason: deleted conversation 6822ed01d0719e59d7eca36e, Count: 11
[2025-05-13T06:57:53.830Z] [SERVER SOCKET L_9VklssV-XGkzhdAAAB - ON ANY] Event: send_message, Args: [{"userInput":"Tìm các hội nghị về Big Data trong năm nay (2025).","isStreaming":true,"language":"vi","conversationId":null}]
[2025-05-13T06:57:53.831Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831] Request received. UserInput: "Tìm các hội nghị về Big Data t...", Streaming: true, Language: vi, PayloadConvId: N/A, SocketDataConvId: N/A
[2025-05-13T06:57:53.831Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831] payloadConversationId is null/undefined. Client requests new conversation.
[2025-05-13T06:57:53.958Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Explicitly created new conversation based on payload and set as active. Title: "Chat mới"
[2025-05-13T06:57:53.958Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Attempting to fetch and emit updated conversation list. Reason: new conversation from send_message
[2025-05-13T06:57:53.959Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:57:54.208Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:57:54.209Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Emitted updated conversation list. Reason: new conversation from send_message, Count: 12
[2025-05-13T06:57:54.274Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Fetched current history. Count: 0
[2025-05-13T06:57:54.274Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Calling streaming intent handler.
[2025-05-13T06:57:54.275Z] --- [L_9V-1747119473831 Socket L_9VklssV-XGkzhdAAAB] Handling STREAMING input: "Tìm các hội nghị về Big Data trong năm nay (2025).", Lang: vi ---
[2025-05-13T06:57:54.275Z] [Language Config] Using configuration for Agent: HostAgent, Language: vi
[2025-05-13T06:57:54.276Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:54.276Z] --- [L_9V-1747119473831 HostAgent Streaming Turn 1 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:57:54.277Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:54.278Z] [L_9V-1747119473831 History T1 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 1
[2025-05-13T06:57:54.278Z] [GeminiService] Received history with 1 items before mapping (for stream).
[2025-05-13T06:57:54.278Z] [GeminiService] Mapped history (SDK Content[]) with 1 items (for stream).
[2025-05-13T06:57:54.279Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:57:54.279Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:57:54.279Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:57:54.280Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:57:54.280Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:57:54.288Z] [GeminiService Stream] Preparing stream request with 1 Content items.
[2025-05-13T06:57:54.288Z]   - No valid next turn added, sending only history.
[2025-05-13T06:57:56.220Z] [GeminiService Stream] Received function call in first chunk: routeToAgent
[2025-05-13T06:57:56.220Z] [L_9V-1747119473831 HostAgent Streaming T1 - L_9VklssV-XGkzhdAAAB] Requests function: routeToAgent
[2025-05-13T06:57:56.221Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:56.221Z] --- [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 Socket L_9VklssV-XGkzhdAAAB] Calling Sub Agent: ConferenceAgent, Task: 81ce7cb2-ee5a-4a01-93af-4ce57feb06ce ---
[2025-05-13T06:57:56.222Z] [Language Config] Using configuration for Agent: ConferenceAgent, Language: vi
[2025-05-13T06:57:56.222Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_thinking, Agent: ConferenceAgent
[2025-05-13T06:57:56.222Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_thinking for ConferenceAgent
[2025-05-13T06:57:56.222Z] [GeminiService] Received history with 1 items before mapping.
[2025-05-13T06:57:56.223Z] [GeminiService] Mapped to effectiveHistory (SDK Content[]) with 1 items.
[2025-05-13T06:57:56.223Z] [GeminiService] Last item role in effectiveHistory: user
[2025-05-13T06:57:56.223Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:57:56.223Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:57:56.224Z] Tools provided: ["getConferences","manageFollow","manageCalendar"]
[2025-05-13T06:57:56.224Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:57:56.224Z] [GeminiService] Sending total 1 Content items to API.
[2025-05-13T06:57:56.224Z]   - No valid next turn added, sending only history.
[2025-05-13T06:57:57.325Z] Model Finish Reason: STOP
[2025-05-13T06:57:57.326Z] Model requested function call: getConferences
[2025-05-13T06:57:57.326Z] Arguments: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T06:57:57.326Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221] LLM result from ConferenceAgent: Status requires_function_call
[2025-05-13T06:57:57.327Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221] ConferenceAgent requests function call: getConferences
[2025-05-13T06:57:57.327Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Received request.
[2025-05-13T06:57:57.328Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_call_received, Agent: ConferenceAgent
[2025-05-13T06:57:57.329Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_call_received for ConferenceAgent
[2025-05-13T06:57:57.329Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Executing handler...
[2025-05-13T06:57:57.330Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] Executing with args: {"searchQuery":"topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"}
[2025-05-13T06:57:57.331Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:57:57.331Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: validating_function_args, Agent: ConferenceAgent
[2025-05-13T06:57:57.331Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: validating_function_args for ConferenceAgent
[2025-05-13T06:57:57.332Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:57:57.332Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: retrieving_info, Agent: ConferenceAgent
[2025-05-13T06:57:57.332Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: retrieving_info for ConferenceAgent
[2025-05-13T06:57:57.333Z] [BackendService] [conference] Executing API call: GET https://confhub.westus3.cloudapp.azure.com/api/v1/conference?topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1}
[2025-05-13T06:57:58.088Z] [BackendService] [conference] API Success (200). Data length: 8009. Attempting parsing...
[2025-05-13T06:57:58.089Z] [BackendService] [conference] Parsed successful. Raw data: 
{"payload":[{"id":"04087b47-2ff3-4a64-b5fd-d408c49478be","title":"International Conference on Digital Society","acronym":"ICDS","location":{"cityStateProvince":"Oslo","country":"Norway","address":"Oslo, Norway","continent":"Europe"},"rank":"C","sourc...
[2025-05-13T06:57:58.089Z] [BackendService] [conference] Applying transformation function: transformConferenceData
[2025-05-13T06:57:58.089Z] Transforming conference data with Markdown. Search query: topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1
[2025-05-13T06:57:58.098Z] [BackendService] [conference] Transformation successful. Transformed data: 
**Meta:**
- **Current page:** 1
- **Per page:** 5
- **Total items:** 37
- **Total page:** 8
- **Prev page:** null
- **Next page:** 2

**Payload:**
---

**- Conference 1.**
  - **Title:** International Conference on Digital Society
  - **Acronym:** IC...
[2025-05-13T06:57:58.098Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] API Result: Success=true, Query="topics=Big+Data&fromDate=2025-01-01&toDate=2025-12-31&perPage=5&page=1"
[2025-05-13T06:57:58.098Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:57:58.099Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: api_call_success, Agent: ConferenceAgent
[2025-05-13T06:57:58.099Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: api_call_success for ConferenceAgent
[2025-05-13T06:57:58.100Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:57:58.100Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: data_found, Agent: ConferenceAgent
[2025-05-13T06:57:58.100Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: data_found for ConferenceAgent
[2025-05-13T06:57:58.100Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Handler:GetConferences Agent:ConferenceAgent] Thought added: Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:57:58.101Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_prepared, Agent: ConferenceAgent
[2025-05-13T06:57:58.101Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_prepared for ConferenceAgent
[2025-05-13T06:57:58.101Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 L_9VklssV-XGkzhdAAAB Agent:ConferenceAgent FuncRegistry Func:getConferences] Handler execution finished. Result indicates error: false
[2025-05-13T06:57:58.102Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: function_result_processed, Agent: ConferenceAgent
[2025-05-13T06:57:58.102Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: function_result_processed for ConferenceAgent
[2025-05-13T06:57:58.102Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Thought Added - L_9VklssV-XGkzhdAAAB] Step: sub_agent_processing_complete, Agent: ConferenceAgent
[2025-05-13T06:57:58.103Z] [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221 SubAgent Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Step: sub_agent_processing_complete for ConferenceAgent
[2025-05-13T06:57:58.103Z] --- [L_9V-1747119473831-Sub-ConferenceAgent-1747119476221] Sub Agent ConferenceAgent finished. Status: success, Thoughts collected: 9 ---
[2025-05-13T06:57:58.103Z] [L_9V-1747119473831 Streaming] Appended 9 thoughts from ConferenceAgent. Total: 12
[2025-05-13T06:57:58.103Z] --- [L_9V-1747119473831 HostAgent Streaming Turn 2 Start - L_9VklssV-XGkzhdAAAB] ---
[2025-05-13T06:57:58.104Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:58.104Z] [L_9V-1747119473831 History T2 Send - L_9VklssV-XGkzhdAAAB] Host History Size: 3
[2025-05-13T06:57:58.104Z] [GeminiService] Received history with 3 items before mapping (for stream).
[2025-05-13T06:57:58.104Z] [GeminiService] Mapped history (SDK Content[]) with 3 items (for stream).
[2025-05-13T06:57:58.105Z] [GeminiService] Last item role in effectiveHistory: function
[2025-05-13T06:57:58.105Z] Calling generateContent for model: gemini-2.0-flash
[2025-05-13T06:57:58.105Z] Generation Config: {"temperature":1,"topP":0.95,"topK":40,"maxOutputTokens":8192,"responseMimeType":"text/plain"}
[2025-05-13T06:57:58.105Z] Tools provided: ["routeToAgent"]
[2025-05-13T06:57:58.106Z] [GeminiService] Received empty array or unexpected type as nextTurnInput, skipping adding this turn.
[2025-05-13T06:57:58.106Z] [GeminiService Stream] Preparing stream request with 3 Content items.
[2025-05-13T06:57:58.106Z]   - No valid next turn added, sending only history.
[2025-05-13T06:57:58.780Z] [GeminiService Stream] No function call in first chunk. Returning stream generator.
[2025-05-13T06:57:58.781Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:58.781Z] [L_9V-1747119473831 Stream Processing - L_9VklssV-XGkzhdAAAB] Starting...
[2025-05-13T06:57:58.781Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: status_update, Type: status, Agent: HostAgent
[2025-05-13T06:57:58.782Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:58.850Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:58.936Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:59.166Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:59.307Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:59.549Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:57:59.723Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:58:00.029Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:58:00.339Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:58:00.621Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_update, Type: partial_result, Agent: N/A
[2025-05-13T06:58:00.628Z] [L_9V-1747119473831 Stream Processing - L_9VklssV-XGkzhdAAAB] Finished. Length: 993
[2025-05-13T06:58:00.628Z] [L_9V-1747119473831 L_9VklssV-XGkzhdAAAB] Emitting final streaming chat_result with 15 thoughts.
[2025-05-13T06:58:00.629Z] [L_9V-1747119473831 Streaming Emit Sent - L_9VklssV-XGkzhdAAAB] Event: chat_result, Type: result, Agent: N/A
[2025-05-13T06:58:00.630Z] --- [L_9V-1747119473831 L_9VklssV-XGkzhdAAAB Lang: vi] STREAMING Handler execution finished. (Socket connected: true) ---
[2025-05-13T06:58:00.630Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Intent handler returned updated history. Attempting save. New size: 4
[2025-05-13T06:58:00.701Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Successfully updated history in DB.
[2025-05-13T06:58:00.701Z] [DEBUG] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Attempting to fetch and emit updated conversation list. Reason: message saved
[2025-05-13T06:58:00.702Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T06:58:00.946Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T06:58:00.947Z] [INFO] [coreHandlers][L_9VklssV-XGkzhdAAAB][772f98c9-8a52-46c1-ba2d-a51c8fc3c851][Req:L_9V-1747119473831][Conv:6822ed71d0719e59d7eca380] Emitted updated conversation list. Reason: message saved, Count: 12
[2025-05-13T07:41:27.230Z] [SERVER GLOBAL][disconnect][L_9VklssV-XGkzhdAAAB] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: 6822ed71d0719e59d7eca380
[2025-05-13T07:41:30.014Z] [socketAuth][yk1JS1L9GrD2d4nQAAAD] Authentication attempt. Has token: true
[2025-05-13T07:41:30.017Z] [socketAuth][yk1JS1L9GrD2d4nQAAAD] Token signature validated successfully.
[2025-05-13T07:41:30.018Z] [HistoryService] Initialized.
[2025-05-13T07:41:30.018Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD] New connection. Socket ID: yk1JS1L9GrD2d4nQAAAD. Initial socket.data.userId: null
[2025-05-13T07:41:30.018Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD] Client connected, processing authentication. Has token: true
[2025-05-13T07:41:30.019Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD] Attempting to fetch user info using token...
[2025-05-13T07:41:30.019Z] [API Client] Attempting to fetch user info.
[2025-05-13T07:41:30.019Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T07:41:30.752Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T07:41:30.753Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T07:41:30.753Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T07:41:30.753Z] [HistoryService] Initialized.
[2025-05-13T07:41:30.754Z] [coreHandlers][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T07:41:30.754Z] [INFO] Core event handlers successfully registered.
[2025-05-13T07:41:30.754Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T07:41:30.754Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T07:41:30.755Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T07:41:30.755Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T07:41:30.761Z] [SERVER SOCKET yk1JS1L9GrD2d4nQAAAD - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T07:41:31.041Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T07:41:31.042Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T07:41:31.042Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T07:41:31.043Z] [SERVER GLOBAL][connection][yk1JS1L9GrD2d4nQAAAD][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T08:04:39.954Z] [SERVER GLOBAL][disconnect][yk1JS1L9GrD2d4nQAAAD] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T08:04:43.469Z] [socketAuth][CSSn2YMEe7WPQUHjAAAF] Authentication attempt. Has token: true
[2025-05-13T08:04:43.472Z] [socketAuth][CSSn2YMEe7WPQUHjAAAF] Token signature validated successfully.
[2025-05-13T08:04:43.473Z] [HistoryService] Initialized.
[2025-05-13T08:04:43.473Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF] New connection. Socket ID: CSSn2YMEe7WPQUHjAAAF. Initial socket.data.userId: null
[2025-05-13T08:04:43.473Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF] Client connected, processing authentication. Has token: true
[2025-05-13T08:04:43.474Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF] Attempting to fetch user info using token...
[2025-05-13T08:04:43.474Z] [API Client] Attempting to fetch user info.
[2025-05-13T08:04:43.474Z] [API Client] Checking user info from: https://confhub.westus3.cloudapp.azure.com/api/v1/user/me
[2025-05-13T08:04:44.225Z] [API Client] Successfully fetched user info from /user/me for ID: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851
[2025-05-13T08:04:44.225Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF] User info fetched successfully. UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Email: loicute5fps@gmail.com, Role: undefined
[2025-05-13T08:04:44.226Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers NOW.
[2025-05-13T08:04:44.226Z] [HistoryService] Initialized.
[2025-05-13T08:04:44.226Z] [coreHandlers][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Registering core event handlers for connection.
[2025-05-13T08:04:44.227Z] [INFO] Core event handlers successfully registered.
[2025-05-13T08:04:44.227Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T08:04:44.227Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Authenticated user session ready. Emitting connection_ready.
[2025-05-13T08:04:44.227Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Fetching initial conversation list...
[2025-05-13T08:04:44.228Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Fetching conversation list.
[2025-05-13T08:04:44.271Z] [SERVER SOCKET CSSn2YMEe7WPQUHjAAAF - ON ANY] Event: get_initial_conversations, Args: []
[2025-05-13T08:04:44.497Z] [HistoryService] [List User: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, Limit: 20] Found 12 conversations.
[2025-05-13T08:04:44.498Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Sent initial conversation list. Count: 12
[2025-05-13T08:04:44.499Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Core event handlers registered successfully after user auth.
[2025-05-13T08:04:44.499Z] [SERVER GLOBAL][connection][CSSn2YMEe7WPQUHjAAAF][772f98c9-8a52-46c1-ba2d-a51c8fc3c851] Emitted "server_ready" to client.
[2025-05-13T08:08:21.968Z] [SERVER GLOBAL][disconnect][CSSn2YMEe7WPQUHjAAAF] Client disconnected. Reason: transport close, UserId: 772f98c9-8a52-46c1-ba2d-a51c8fc3c851, ActiveConvId: N/A
[2025-05-13T08:42:31.506Z] [socketAuth][eS9R71B7zDpaX201AAAI] Authentication attempt. Has token: false
[2025-05-13T08:42:31.507Z] [socketAuth][eS9R71B7zDpaX201AAAI] No token provided. Treating as anonymous.
[2025-05-13T08:42:31.508Z] [HistoryService] Initialized.
[2025-05-13T08:42:31.508Z] [SERVER GLOBAL][connection][eS9R71B7zDpaX201AAAI] New connection. Socket ID: eS9R71B7zDpaX201AAAI. Initial socket.data.userId: null
[2025-05-13T08:42:31.508Z] [SERVER GLOBAL][connection][eS9R71B7zDpaX201AAAI] Client connected, processing authentication. Has token: false
[2025-05-13T08:42:31.508Z] [SERVER GLOBAL][connection][eS9R71B7zDpaX201AAAI] WARNING: No auth token found on socket. Potentially anonymous user or auth middleware issue. Disconnecting.
[2025-05-13T08:43:37.576Z] [Database] MongoDB disconnected.
[2025-05-13T08:52:09.329Z] [socketAuth][53Q1B2hNex9T6JF0AAAL] Authentication attempt. Has token: false
[2025-05-13T08:52:09.329Z] [socketAuth][53Q1B2hNex9T6JF0AAAL] No token provided. Treating as anonymous.
[2025-05-13T08:52:09.330Z] [HistoryService] Initialized.
[2025-05-13T08:52:09.330Z] [SERVER GLOBAL][connection][53Q1B2hNex9T6JF0AAAL] New connection. Socket ID: 53Q1B2hNex9T6JF0AAAL. Initial socket.data.userId: null
[2025-05-13T08:52:09.331Z] [SERVER GLOBAL][connection][53Q1B2hNex9T6JF0AAAL] Client connected, processing authentication. Has token: false
[2025-05-13T08:52:09.331Z] [SERVER GLOBAL][connection][53Q1B2hNex9T6JF0AAAL] WARNING: No auth token found on socket. Potentially anonymous user or auth middleware issue. Disconnecting.
[2025-05-13T08:53:24.101Z] [socketAuth][rCRWcw76OTitrOQjAAAO] Authentication attempt. Has token: false
[2025-05-13T08:53:24.101Z] [socketAuth][rCRWcw76OTitrOQjAAAO] No token provided. Treating as anonymous.
[2025-05-13T08:53:24.102Z] [HistoryService] Initialized.
[2025-05-13T08:53:24.102Z] [SERVER GLOBAL][connection][rCRWcw76OTitrOQjAAAO] New connection. Socket ID: rCRWcw76OTitrOQjAAAO. Initial socket.data.userId: null
[2025-05-13T08:53:24.102Z] [SERVER GLOBAL][connection][rCRWcw76OTitrOQjAAAO] Client connected, processing authentication. Has token: false
[2025-05-13T08:53:24.102Z] [SERVER GLOBAL][connection][rCRWcw76OTitrOQjAAAO] WARNING: No auth token found on socket. Potentially anonymous user or auth middleware issue. Disconnecting.
[2025-05-13T08:53:49.741Z] [socketAuth][ovHJcnJK4LMLje3xAAAR] Authentication attempt. Has token: false
[2025-05-13T08:53:49.741Z] [socketAuth][ovHJcnJK4LMLje3xAAAR] No token provided. Treating as anonymous.
[2025-05-13T08:53:49.741Z] [HistoryService] Initialized.
[2025-05-13T08:53:49.742Z] [SERVER GLOBAL][connection][ovHJcnJK4LMLje3xAAAR] New connection. Socket ID: ovHJcnJK4LMLje3xAAAR. Initial socket.data.userId: null
[2025-05-13T08:53:49.742Z] [SERVER GLOBAL][connection][ovHJcnJK4LMLje3xAAAR] Client connected, processing authentication. Has token: false
[2025-05-13T08:53:49.742Z] [SERVER GLOBAL][connection][ovHJcnJK4LMLje3xAAAR] WARNING: No auth token found on socket. Potentially anonymous user or auth middleware issue. Disconnecting.
